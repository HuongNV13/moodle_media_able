{"version":3,"file":"ableplayer.min.js","sources":["../../../src/local/able/ableplayer.js"],"sourcesContent":["/*\n\t// JavaScript for Able Player\n\n\t// HTML5 Media API:\n\t// http://www.w3.org/TR/html5/embedded-content-0.html#htmlmediaelement\n\t// http://dev.w3.org/html5/spec-author-view/video.html\n\n\t// W3C API Test Page:\n\t// http://www.w3.org/2010/05/video/mediaevents.html\n\n\t// YouTube Player API for iframe Embeds\n\thttps://developers.google.com/youtube/iframe_api_reference\n\n\t// YouTube Player Parameters\n\thttps://developers.google.com/youtube/player_parameters?playerVersion=HTML5\n\n\t// YouTube Data API\n\thttps://developers.google.com/youtube/v3\n\n\t// Vimeo Player API\n\thttps://github.com/vimeo/player.js\n\n\t// Google API Client Library for JavaScript\n\thttps://developers.google.com/api-client-library/javascript/dev/dev_jscript\n\n\t// Google API Explorer: YouTube services and methods\n\thttps://developers.google.com/apis-explorer/#s/youtube/v3/\n\n\t// Web Speech API (Speech Synthesis)\n\t// https://w3c.github.io/speech-api/#tts-section\n\t// https://developer.mozilla.org/en-US/docs/Web/API/Window/speechSynthesis\n*/\n\n/*jslint node: true, browser: true, white: true, indent: 2, unparam: true, plusplus: true */\n/*global $, jQuery */\n\"use strict\";\n\n// maintain an array of Able Player instances for use globally (e.g., for keeping prefs in sync)\nvar AblePlayerInstances = [];\n\n(function ($) {\n\t$(function () {\n\n\t\t$('video, audio').each(function (index, element) {\n\t\t\tif ($(element).data('able-player') !== undefined) {\n\t\t\t\tAblePlayerInstances.push(new AblePlayer($(this),$(element)));\n\t\t\t}\n\t\t});\n\t});\n\n\t// YouTube player support; pass ready event to jQuery so we can catch in player.\n\twindow.onYouTubeIframeAPIReady = function() {\n\t\tAblePlayer.youTubeIframeAPIReady = true;\n\t\t$('body').trigger('youTubeIframeAPIReady', []);\n\t};\n\t// If there is only one player on the page, dispatch global keydown events to it\n\t// Otherwise, keydowwn events are handled locally (see event.js > handleEventListeners())\n\t$(window).on('keydown',function(e) {\n\t\tif (AblePlayer.nextIndex === 1) {\n\t\t\tAblePlayer.lastCreated.onPlayerKeyPress(e);\n\t\t}\n\t});\n\n\t// Construct an AblePlayer object\n\t// Parameters are:\n\t// media - jQuery selector or element identifying the media.\n\twindow.AblePlayer = function(media) {\n\n\n\t\tvar thisObj = this;\n\n\t\t// Keep track of the last player created for use with global events.\n\t\tAblePlayer.lastCreated = this;\n\t\tthis.media = media;\n\n\t\tif ($(media).length === 0) {\n\t\t\tthis.provideFallback();\n\t\t\treturn;\n\t\t}\n\n\t\t///////////////////////////////\n\t\t//\n\t\t// Default variables assignment\n\t\t//\n\t\t///////////////////////////////\n\n\t\t// The following variables CAN be overridden with HTML attributes\n\n\t\t// autoplay (Boolean; if present always resolves to true, regardless of value)\n\t\tif ($(media).attr('autoplay') !== undefined) {\n\t\t\tthis.autoplay = true; // this value remains constant \n\t\t\tthis.okToPlay = true; // this value can change dynamically\n\t\t}\n\t\telse {\n\t\t\tthis.autoplay = false;\n\t\t\tthis.okToPlay = false;\n\t\t}\n\t\t\n\t\t// loop (Boolean; if present always resolves to true, regardless of value)\n\t\tif ($(media).attr('loop') !== undefined) {\n\t\t\tthis.loop = true;\n\t\t}\n\t\telse {\n\t\t\tthis.loop = false;\n\t\t}\n\n\t\t// playsinline (Boolean; if present always resolves to true, regardless of value)\n\t\tif ($(media).attr('playsinline') !== undefined) {\n\t\t\tthis.playsInline = '1'; // this value gets passed to YT.Player contructor in youtube.js\n\t\t}\n\t\telse {\n\t\t\tthis.playsInline = '0';\n\t\t}\n\n\t\t// poster (Boolean, indicating whether media element has a poster attribute)\n\t\tif ($(media).attr('poster')) {\n\t\t\tthis.hasPoster = true;\n\t\t}\n\t\telse {\n\t\t\tthis.hasPoster = false;\n\t\t}\n\n\t\t// get height and width attributes, if present \n\t\t// and add them to variables \n\t\t// Not currently used, but might be useful for resizing player  \n\t\tif ($(media).attr('width')) { \n\t\t\tthis.width = $(media).attr('width'); \n\t\t}\n\t\tif ($(media).attr('height')) { \n\t\t\tthis.height = $(media).attr('height');\n\t\t}\n\n\t\t// start-time\n\t\tif ($(media).data('start-time') !== undefined && $.isNumeric($(media).data('start-time'))) {\n\t\t\tthis.startTime = $(media).data('start-time');\n\t\t}\n\t\telse {\n\t\t\tthis.startTime = 0;\n\t\t}\n\n\t\t// debug\n\t\tif ($(media).data('debug') !== undefined && $(media).data('debug') !== false) {\n\t\t\tthis.debug = true;\n\t\t}\n\t\telse {\n\t\t\tthis.debug = false;\n\t\t}\n\n\t\t// Path to root directory of Able Player code\n\t\tif ($(media).data('root-path') !== undefined) {\n\t\t\t// add a trailing slash if there is none\n\t\t\tthis.rootPath = $(media).data('root-path').replace(/\\/?$/, '/');\n\t\t}\n\t\telse {\n\t\t\tthis.rootPath = this.getRootPath();\n\t\t}\n\n\t\t// Volume\n\t\t// Range is 0 to 10. Best not to crank it to avoid overpowering screen readers\n\t\tthis.defaultVolume = 7;\n\t\tif ($(media).data('volume') !== undefined && $(media).data('volume') !== \"\") {\n\t\t\tvar volume = $(media).data('volume');\n\t\t\tif (volume >= 0 && volume <= 10) {\n\t\t\t\tthis.defaultVolume = volume;\n\t\t\t}\n\t\t}\n\t\tthis.volume = this.defaultVolume;\n\n\t\t// Optional Buttons\n\t\t// Buttons are added to the player controller if relevant media is present\n\t\t// However, in some applications it might be undesirable to show buttons\n\t\t// (e.g., if chapters or transcripts are provided in an external container)\n\n\t\tif ($(media).data('use-chapters-button') !== undefined && $(media).data('use-chapters-button') === false) {\n\t\t\tthis.useChaptersButton = false;\n\t\t}\n\t\telse {\n\t\t\tthis.useChaptersButton = true;\n\t\t}\n\t\t\n\t\t// Control whether text descriptions are read aloud \n\t\t// set to \"false\" if the sole purpose of the WebVTT descriptions file\n\t\t// is to integrate text description into the transcript\n\t\t// set to \"true\" to write description text to a div \n\t\t// This variable does *not* control the method by which description is read. \n\t\t// For that, see below (this.descMethod) \n\t\tif ($(media).data('descriptions-audible') !== undefined && $(media).data('descriptions-audible') === false) {\n\t\t\tthis.readDescriptionsAloud = false;\n\t\t}\n\t\telse if ($(media).data('description-audible') !== undefined && $(media).data('description-audible') === false) {\n\t\t\t// support both singular and plural spelling of attribute\n\t\t\tthis.readDescriptionsAloud = false;\n\t\t}\n\t\telse {\n\t\t\tthis.readDescriptionsAloud = true;\n\t\t}\n\n\t\t// Method by which text descriptions are read  \n\t\t// valid values of data-desc-reader are:\n\t\t// 'brower' (default) - text-based audio description is handled by the browser, if supported  \n\t\t// 'screenreader' - text-based audio description is always handled by screen readers \n\t\t// The latter may be preferable by owners of websites in languages that are not well supported \n\t\t// by the Web Speech API  \n\t\tif ($(media).data('desc-reader') == 'screenreader') {\n\t\t\tthis.descReader = 'screenreader';\n\t\t}\n\t\telse {\n\t\t\tthis.descReader = 'browser';\n\t\t}\n\n\t\t// Default state of captions and descriptions \n\t\t// This setting is overridden by user preferences, if they exist \n\t\t// values for data-state-captions and data-state-descriptions are 'on' or 'off' \n\t\tif ($(media).data('state-captions') == 'off') {\n\t\t\tthis.defaultStateCaptions = 0; // off \n\t\t}\n\t\telse {\n\t\t\tthis.defaultStateCaptions = 1; // on by default\n\t\t}\n\t\tif ($(media).data('state-descriptions') == 'on') {\n\t\t\tthis.defaultStateDescriptions = 1; // on\n\t\t}\n\t\telse {\n\t\t\tthis.defaultStateDescriptions = 0; // off by default\n\t\t}\n\n\t\t// Default setting for prefDescPause  \n\t\t// Extended description (i.e., pausing during description) is on by default \n\t\t// but this settings give website owners control over that \n\t\t// since they know the nature of their videos, and whether pausing is necessary \n\t\t// This setting is overridden by user preferences, if they exist \n\t\tif ($(media).data('desc-pause-default') == 'off') {\n\t\t\tthis.defaultDescPause = 0; // off \n\t\t}\n\t\telse {\n\t\t\tthis.defaultDescPause = 1; // on by default\n\t\t}\n\n\t\t// Headings\n\t\t// By default, an off-screen heading is automatically added to the top of the media player\n\t\t// It is intelligently assigned a heading level based on context, via misc.js > getNextHeadingLevel()\n\t\t// Authors can override this behavior by manually assigning a heading level using data-heading-level\n\t\t// Accepted values are 1-6, or 0 which indicates \"no heading\"\n\t\t// (i.e., author has already hard-coded a heading before the media player; Able Player doesn't need to do this)\n\t\tif ($(media).data('heading-level') !== undefined && $(media).data('heading-level') !== \"\") {\n\t\t\tvar headingLevel = $(media).data('heading-level');\n\t\t\tif (/^[0-6]*$/.test(headingLevel)) { // must be a valid HTML heading level 1-6; or 0\n\t\t\t\tthis.playerHeadingLevel = headingLevel;\n\t\t\t}\n\t\t}\n\n\t\t// Transcripts\n\t\t// There are three types of interactive transcripts.\n\t\t// In descending of order of precedence (in case there are conflicting tags), they are:\n\t\t// 1. \"manual\" - A manually coded external transcript (requires data-transcript-src)\n\t\t// 2. \"external\" - Automatically generated, written to an external div (requires data-transcript-div)\n\t\t// 3. \"popup\" - Automatically generated, written to a draggable, resizable popup window that can be toggled on/off with a button\n\t\t// If data-include-transcript=\"false\", there is no \"popup\" transcript\n\n\t\tif ($(media).data('transcript-div') !== undefined && $(media).data('transcript-div') !== \"\") {\n\t\t\tthis.transcriptDivLocation = $(media).data('transcript-div');\n\t\t}\n\t\telse {\n\t\t\tthis.transcriptDivLocation = null;\n\t\t}\n\t\tif ($(media).data('include-transcript') !== undefined && $(media).data('include-transcript') === false) {\n\t\t\tthis.hideTranscriptButton = true;\n\t\t}\n\t\telse {\n\t\t\tthis.hideTranscriptButton = null;\n\t\t}\n\n\t\tthis.transcriptType = null;\n\t\tif ($(media).data('transcript-src') !== undefined) {\n\t\t\tthis.transcriptSrc = $(media).data('transcript-src');\n\t\t\tif (this.transcriptSrcHasRequiredParts()) {\n\t\t\t\tthis.transcriptType = 'manual';\n\t\t\t}\n\t\t\telse { \n\t\t\t\tconsole.log('ERROR: Able Player transcript is missing required parts');\n\t\t\t}\n\t\t}\n\t\telse if ($(media).find('track[kind=\"captions\"], track[kind=\"subtitles\"]').length > 0) {\n\t\t\t// required tracks are present. COULD automatically generate a transcript\n\t\t\tif (this.transcriptDivLocation) {\n\t\t\t\tthis.transcriptType = 'external';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.transcriptType = 'popup';\n\t\t\t}\n\t\t}\n\n\t\t// In \"Lyrics Mode\", line breaks in WebVTT caption files are supported in the transcript\n\t\t// If false (default), line breaks are are removed from transcripts in order to provide a more seamless reading experience\n\t\t// If true, line breaks are preserved, so content can be presented karaoke-style, or as lines in a poem\n\t\tif ($(media).data('lyrics-mode') !== undefined && $(media).data('lyrics-mode') !== false) {\n\t\t\tthis.lyricsMode = true;\n\t\t}\n\t\telse {\n\t\t\tthis.lyricsMode = false;\n\t\t}\n\n\t\t// Transcript Title\n\t\tif ($(media).data('transcript-title') !== undefined && $(media).data('transcript-title') !== \"\") {\n\t\t\tthis.transcriptTitle = $(media).data('transcript-title');\n\t\t}\n\t\telse {\n\t\t\t// do nothing. The default title will be defined later (see transcript.js)\n\t\t}\n\n\t\t// Captions\n\t\t// data-captions-position can be used to set the default captions position\n\t\t// this is only the default, and can be overridden by user preferences\n\t\t// valid values of data-captions-position are 'below' and 'overlay'\n\t\tif ($(media).data('captions-position') === 'overlay') {\n\t\t\tthis.defaultCaptionsPosition = 'overlay';\n\t\t}\n\t\telse { // the default, even if not specified\n\t\t\tthis.defaultCaptionsPosition = 'below';\n\t\t}\n\n\t\t// Chapters\n\t\tif ($(media).data('chapters-div') !== undefined && $(media).data('chapters-div') !== \"\") {\n\t\t\tthis.chaptersDivLocation = $(media).data('chapters-div');\n\t\t}\n\n\t\tif ($(media).data('chapters-title') !== undefined) {\n\t\t\t// NOTE: empty string is valid; results in no title being displayed\n\t\t\tthis.chaptersTitle = $(media).data('chapters-title');\n\t\t}\n\n\t\tif ($(media).data('chapters-default') !== undefined && $(media).data('chapters-default') !== \"\") {\n\t\t\tthis.defaultChapter = $(media).data('chapters-default');\n\t\t}\n\t\telse {\n\t\t\tthis.defaultChapter = null;\n\t\t}\n\n\t\t// Slower/Faster buttons\n\t\t// valid values of data-speed-icons are 'animals' (default) and 'arrows'\n\t\t// 'animals' uses turtle and rabbit; 'arrows' uses up/down arrows\n\t\tif ($(media).data('speed-icons') === 'arrows') {\n\t\t\tthis.speedIcons = 'arrows';\n\t\t}\n\t\telse {\n\t\t\tthis.speedIcons = 'animals';\n\t\t}\n\n\t\t// Seekbar\n\t\t// valid values of data-seekbar-scope are 'chapter' and 'video'; will also accept 'chapters'\n\t\tif ($(media).data('seekbar-scope') === 'chapter' || $(media).data('seekbar-scope') === 'chapters') {\n\t\t\tthis.seekbarScope = 'chapter';\n\t\t}\n\t\telse {\n\t\t\tthis.seekbarScope = 'video';\n\t\t}\n\n\t\t// YouTube\n\t\tif ($(media).data('youtube-id') !== undefined && $(media).data('youtube-id') !== \"\") {\n\t\t\tthis.youTubeId = this.getYouTubeId($(media).data('youtube-id'));\n\t\t}\n\n\t\tif ($(media).data('youtube-desc-id') !== undefined && $(media).data('youtube-desc-id') !== \"\") {\n\t\t\tthis.youTubeDescId = this.getYouTubeId($(media).data('youtube-desc-id'));\n\t\t}\n\n\t\tif ($(media).data('youtube-nocookie') !== undefined && $(media).data('youtube-nocookie')) {\n\t\t\tthis.youTubeNoCookie = true;\n\t\t}\n\t\telse {\n\t\t\tthis.youTubeNoCookie = false;\n\t\t}\n\n\t\t// Vimeo\n\t\tif ($(media).data('vimeo-id') !== undefined && $(media).data('vimeo-id') !== \"\") {\n\t\t\tthis.vimeoId = this.getVimeoId($(media).data('vimeo-id'));\n\t\t}\n\t\tif ($(media).data('vimeo-desc-id') !== undefined && $(media).data('vimeo-desc-id') !== \"\") {\n\t\t\tthis.vimeoDescId = this.getVimeoId($(media).data('vimeo-desc-id'));\n\t\t}\n\n\t\t// Skin\n\t\t// valid values of data-skin are:\n\t\t// 'legacy' (default), two rows of controls; seekbar positioned in available space within top row\n\t\t// '2020', all buttons in one row beneath a full-width seekbar\n\t\tif ($(media).data('skin') == '2020') {\n\t\t\tthis.skin = '2020';\n\t\t}\n\t\telse {\n\t\t\tthis.skin = 'legacy';\n\t\t}\n\n\t\t// Size \n\t\t// width of Able Player is determined using the following order of precedence: \n\t\t// 1. data-width attribute \n\t\t// 2. width attribute (for video or audio, although it is not valid HTML for audio)\n\t\t// 3. Intrinsic size from video (video only, determined later)\n\t\tif ($(media).data('width') !== undefined) {\n\t\t\tthis.playerWidth = parseInt($(media).data('width'));\n\t\t}\n\t\telse if ($(media)[0].getAttribute('width')) {\n\t\t\t// NOTE: jQuery attr() returns null for all invalid HTML attributes \n\t\t\t// (e.g., width on <audio>)\n\t\t\t// but it can be acessed via JavaScript getAttribute() \n\t\t\tthis.playerWidth = parseInt($(media)[0].getAttribute('width'));\n\t\t}\n\t\telse { \n\t\t\tthis.playerWidth = null; \n\t\t}\n\n\t\t// Icon type\n\t\t// By default, AblePlayer 3.0.33 and higher uses SVG icons for the player controls\n\t\t// Fallback for browsers that don't support SVG is scalable icomoon fonts\n\t\t// Ultimate fallback is images, if the user has a custom style sheet that overrides font-family\n\t\t// Use data-icon-type to force controls to use either 'svg', 'font', or 'images'\n\t\tthis.iconType = 'font';\n\t\tthis.forceIconType = false;\n\t\tif ($(media).data('icon-type') !== undefined && $(media).data('icon-type') !== \"\") {\n\t\t\tvar iconType = $(media).data('icon-type');\n\t\t\tif (iconType === 'font' || iconType == 'image' || iconType == 'svg') {\n\t\t\t\tthis.iconType = iconType;\n\t\t\t\tthis.forceIconType = true;\n\t\t\t}\n\t\t}\n\n\t\tif ($(media).data('allow-fullscreen') !== undefined && $(media).data('allow-fullscreen') === false) {\n\t\t\tthis.allowFullscreen = false;\n\t\t}\n\t\telse {\n\t\t\tthis.allowFullscreen = true;\n\t\t}\n\t\t// Define other variables that are used in fullscreen program flow \n\t\tthis.clickedFullscreenButton = false; \n\t\tthis.restoringAfterFullscreen = false;\t\t\t\n\n\t\t// Seek interval\n\t\t// Number of seconds to seek forward or back with Rewind & Forward buttons\n\t\t// Unless specified with data-seek-interval, the default value is re-calculated in initialize.js > setSeekInterval();\n\t\t// Calculation attempts to intelligently assign a reasonable interval based on media length\n\t\tthis.defaultSeekInterval = 10;\n\t\tthis.useFixedSeekInterval = false; // will change to true if media has valid data-seek-interval attribute\n\t\tif ($(media).data('seek-interval') !== undefined && $(media).data('seek-interval') !== \"\") {\n\t\t\tvar seekInterval = $(media).data('seek-interval');\n\t\t\tif (/^[1-9][0-9]*$/.test(seekInterval)) { // must be a whole number greater than 0\n\t\t\t\tthis.seekInterval = seekInterval;\n\t\t\t\tthis.useFixedSeekInterval = true; // do not override with calculuation\n\t\t\t}\n\t\t}\n\n\t\t// Now Playing\n\t\t// Shows \"Now Playing:\" plus the title of the current track above player\n\t\t// Only used if there is a playlist\n\t\tif ($(media).data('show-now-playing') !== undefined && $(media).data('show-now-playing') === false) {\n\t\t\tthis.showNowPlaying = false;\n\t\t}\n\t\telse {\n\t\t\tthis.showNowPlaying = true;\n\t\t}\n\n\t\t// TTML support (experimental); enabled for testing with data-use-ttml (Boolean)\n\t\tif ($(media).data('use-ttml') !== undefined) {\n\t\t\tthis.useTtml = true;\n\t\t\t// The following may result in a console error.\n\t\t\tthis.convert = require('xml-js');\n\t\t}\n\t\telse {\n\t\t\tthis.useTtml = false;\n\t\t}\n\n\t\t// Fallback\n\t\t// The data-test-fallback attribute can be used to test the fallback solution in any browser\n\t\tif ($(media).data('test-fallback') !== undefined && $(media).data('test-fallback') !== false) {\n\t\t\tif ($(media).data('test-fallback') == '2') { \n\t\t\t\tthis.testFallback = 2; // emulate browser that doesn't support HTML5 media \n\t\t\t}\n\t\t\telse { \n\t\t\t\tthis.testFallback = 1; // emulate failure to load Able Player \n\t\t\t}\n\t\t}\n\t\telse { \n\t\t\tthis.testFallback = false; \n\t\t}\n\n\t\t// Language\n\t\t// Player language is determined given the following precedence:\n\t\t// 1. The value of data-lang on the media element, if provided and a matching translation file is available\n\t\t// 2. Lang attribute on <html> or <body>, if a matching translation file is available\n\t\t// 3. English\n\t\t// Final calculation occurs in translation.js > getTranslationText()\n\t\tif ($(media).data('lang') !== undefined && $(media).data('lang') !== \"\") {\n\t\t\tthis.lang = $(media).data('lang').toLowerCase();\n\t\t}\n\t\telse {\n\t\t\tthis.lang = null;\n\t\t}\n\n\t\t// Metadata Tracks\n\t\tif ($(media).data('meta-type') !== undefined && $(media).data('meta-type') !== \"\") {\n\t\t\tthis.metaType = $(media).data('meta-type');\n\t\t}\n\n\t\tif ($(media).data('meta-div') !== undefined && $(media).data('meta-div') !== \"\") {\n\t\t\tthis.metaDiv = $(media).data('meta-div');\n\t\t}\n\n\t\t// Search\n\t\t// conducting a search requires an external div in which to write the results\n\t\tif ($(media).data('search-div') !== undefined && $(media).data('search-div') !== \"\") {\n\n\t\t\tthis.searchDiv = $(media).data('search-div');\n\n\t\t\t// Search term (optional; could be assigned later in a JavaScript application)\n\t\t\tif ($(media).data('search') !== undefined && $(media).data('search') !== \"\") {\n\t\t\t\tthis.searchString = $(media).data('search');\n\t\t\t}\n\n\t\t\t// Search Language\n\t\t\tif ($(media).data('search-lang') !== undefined && $(media).data('search-lang') !== \"\") {\n\t\t\t\tthis.searchLang = $(media).data('search-lang');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.searchLang = null; // will change to final value of this.lang in translation.js > getTranslationText()\n\t\t\t}\n\n\t\t\t// Search option: Ignore capitalization in search terms\n\t\t\tif ($(media).data('search-ignore-caps') !== undefined && $(media).data('search-ignore-caps') !== false) {\n\t\t\t\tthis.searchIgnoreCaps = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.searchIgnoreCaps = false;\n\t\t\t}\n\n\t\t\t// conducting a search currently requires an external div in which to write the results\n\t\t\tif ($(media).data('search-div') !== undefined && $(media).data('search-div') !== \"\") {\n\t\t\t\tthis.searchString = $(media).data('search');\n\t\t\t\tthis.searchDiv = $(media).data('search-div');\n\t\t\t}\n\t\t}\n\n\t\t// Hide controls when video starts playing\n\t\t// They will reappear again when user presses a key or moves the mouse\n\t\t// As of v4.0, controls are hidden automatically on playback in fullscreen mode\n\t\tif ($(media).data('hide-controls') !== undefined && $(media).data('hide-controls') !== false) {\n\t\t\tthis.hideControls = true;\n\t\t\tthis.hideControlsOriginal = true; // a copy of hideControls, since the former may change if user enters full screen mode\n\t\t}\n\t\telse {\n\t\t\tthis.hideControls = false;\n\t\t\tthis.hideControlsOriginal = false;\n\t\t}\n\n\t\t// Steno mode\n\t\t// Enable support for Able Player keyboard shortcuts in textaarea fields\n\t\t// so users can control the player while transcribing\n\t\tif ($(media).data('steno-mode') !== undefined && $(media).data('steno-mode') !== false) {\n\t\t\tthis.stenoMode = true;\n\t\t\t// Add support for stenography in an iframe via data-steno-iframe-id\n\t\t\tif ($(media).data('steno-iframe-id') !== undefined && $(media).data('steno-iframe-id') !== \"\") {\n\t\t\t\tthis.stenoFrameId = $(media).data('steno-iframe-id');\n\t\t\t\tthis.$stenoFrame = $('#' + this.stenoFrameId);\n\t\t\t\tif (!(this.$stenoFrame.length)) {\n\t\t\t\t\t// iframe not found\n\t\t\t\t\tthis.stenoFrameId = null;\n\t\t\t\t\tthis.$stenoFrame = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.stenoFrameId = null;\n\t\t\t\tthis.$stenoFrame = null;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.stenoMode = false;\n\t\t\tthis.stenoFrameId = null;\n\t\t\tthis.$stenoFrame = null;\n\t\t}\n\n\t\t// Define built-in variables that CANNOT be overridden with HTML attributes\n\t\tthis.setDefaults();\n\n\t\t////////////////////////////////////////\n\t\t//\n\t\t// End assignment of default variables\n\t\t//\n\t\t////////////////////////////////////////\n\n\t\tthis.ableIndex = AblePlayer.nextIndex;\n\t\tAblePlayer.nextIndex += 1;\n\n\t\tthis.title = $(media).attr('title');\n\n\t\t// populate translation object with localized versions of all labels and prompts\n\t\t// use defer method to defer additional processing until text is retrieved\n\t\tthis.tt = {};\n\t\tvar thisObj = this;\n\t\t$.when(this.getTranslationText()).then(\n\t\t\tfunction () {\n\t\t\t\tif (thisObj.countProperties(thisObj.tt) > 50) {\n\t\t\t\t\t// close enough to ensure that most text variables are populated\n\t\t\t\t\tthisObj.setup();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// can't continue loading player with no text\n\t\t\t\t\tthisObj.provideFallback();\n\t\t\t\t}\n\t\t\t}\n\t\t).\n\t\tfail(function() { \n\t\t\tthisObj.provideFallback(); \n\t\t});\n\t};\n\n\t// Index to increment every time new player is created.\n\tAblePlayer.nextIndex = 0;\n\n\tAblePlayer.prototype.setup = function() {\n\n\t\tvar thisObj = this;\n\t\tthis.initializing = true; // will remain true until entire sequence of function calls is complete\n\n\t\tthis.reinitialize().then(function () {\n\t\t\tif (!thisObj.player) {\n\t\t\t\t// No player for this media, show last-line fallback.\n\t\t\t\tthisObj.provideFallback();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthisObj.setupInstance().then(function () {\n\t\t\t\t\tthisObj.setupInstancePlaylist();\n\t\t\t\t\tif (thisObj.hasPlaylist) {\n\t\t\t\t\t\t// for playlists, recreatePlayer() is called from within cuePlaylistItem()\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthisObj.recreatePlayer().then(function() { \n\t\t\t\t\t\t\tthisObj.initializing = false;\n\t\t\t\t\t\t\tthisObj.playerCreated = true; // remains true until browser is refreshed\t\t\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\n\tAblePlayer.getActiveDOMElement = function () {\n\t\tvar activeElement = document.activeElement;\n\n\t\t// For shadow DOMs we need to keep digging down through the DOMs\n\t\twhile (activeElement.shadowRoot && activeElement.shadowRoot.activeElement) {\n\t\t\tactiveElement = activeElement.shadowRoot.activeElement;\n\t\t}\n\n\t\treturn activeElement;\n\t};\n\n\tAblePlayer.localGetElementById = function(element, id) {\n\t\tif (element.getRootNode)\n\t\t{\n\t\t\t// Use getRootNode() and querySelector() where supported (for shadow DOM support)\n\t\t\treturn $(element.getRootNode().querySelector('#' + id));\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// If getRootNode is not supported it should be safe to use document.getElementById (since there is no shadow DOM support)\n\t\t\treturn $(document.getElementById(id));\n\t\t}\n\t};\n\n\tAblePlayer.youTubeIframeAPIReady = false;\n\tAblePlayer.loadingYouTubeIframeAPI = false;\n})(jQuery);\n\n(function ($) {\n\t// Set default variable values.\n\tAblePlayer.prototype.setDefaults = function () {\n\n\t\tthis.playerCreated = false; // will set to true after recreatePlayer() is complete the first time\n\t\tthis.playing = false; // will change to true after 'playing' event is triggered\n\t\tthis.paused = true; // will always be the opposite of this.playing (available for convenience)\n\t\tthis.clickedPlay = false; // will change to true temporarily if user clicks 'play' (or pause)\n\t\tthis.fullscreen = false; // will change to true if player is in full screen mode\n\t\tthis.swappingSrc = false; // will change to true temporarily while media source is being swapped\n\t\tthis.initializing = false; // will change to true temporarily while initPlayer() is processing\n\t\tthis.cueingPlaylistItems = false; // will change to true temporarily while cueing next playlist item\n\t\tthis.buttonWithFocus = null; // will change to 'previous' or 'next' if user clicks either of those buttons\n\t\tthis.speechEnabled = null; // will change either to 'true' in initSpeech(), or false if not supported\n\n\t\tthis.setIconColor();\n\t\tthis.setButtonImages();\n\t};\n\n\tAblePlayer.prototype.getRootPath = function() {\n\n\t\t// returns Able Player root path (assumes ableplayer.js is in /build, one directory removed from root)\n\t\tvar scripts, i, scriptSrc, scriptFile, fullPath, ablePath, parentFolderIndex, rootPath;\n\t\tscripts= document.getElementsByTagName('script');\n\t\tfor (i=0; i < scripts.length; i++) {\n\t\t\tscriptSrc = scripts[i].src;\n\t\t\tscriptFile = scriptSrc.substring(scriptSrc.lastIndexOf('/'));\n\t\t\tif (scriptFile.indexOf('ableplayer') !== -1) {\n\t\t\t\t// this is the ableplayerscript\n\t\t\t\tfullPath = scriptSrc.split('?')[0]; // remove any ? params\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tablePath= fullPath.split('/').slice(0, -1).join('/'); // remove last filename part of path\n\t\tparentFolderIndex = ablePath.lastIndexOf('/');\n\t\trootPath = ablePath.substring(0, parentFolderIndex) + '/';\n\t\treturn rootPath;\n\t}\n\n\tAblePlayer.prototype.setIconColor = function() {\n\n\t\t// determine the best color choice (white or black) for icons,\n\t\t// given the background-color of their container elements\n\t\t// Source for relative luminance formula:\n\t\t// https://en.wikipedia.org/wiki/Relative_luminance\n\n\t\t// We need to know the color *before* creating the element\n\t\t// so the element doesn't exist yet when this function is called\n\t\t// therefore, need to create a temporary element then remove it after color is determined\n\t\t// Temp element must be added to the DOM or WebKit can't retrieve its CSS properties\n\n\t\tvar $elements, i, $el, bgColor, rgb, red, green, blue, luminance, iconColor;\n\n\t\t$elements = ['controller', 'toolbar'];\n\t\tfor (i=0; i<$elements.length; i++) {\n\t\t\tif ($elements[i] == 'controller') {\n\t\t\t\t$el =\t $('<div>', {\n\t\t\t\t\t'class': 'able-controller'\n\t\t\t\t}).hide();\n\t\t\t}\n\t\t\telse if ($elements[i] === 'toolbar') {\n\t\t\t\t$el =\t $('<div>', {\n\t\t\t\t\t'class': 'able-window-toolbar'\n\t\t\t\t}).hide();\n\t\t\t}\n\t\t\t$('body').append($el);\n\t\t\tbgColor = $el.css('background-color');\n\t\t\t// bgColor is a string in the form 'rgb(R, G, B)', perhaps with a 4th item for alpha;\n\t\t\t// split the 3 or 4 channels into an array\n\t\t\trgb = bgColor.replace(/[^\\d,]/g, '').split(',');\n\t\t\tred = rgb[0];\n\t\t\tgreen = rgb[1];\n\t\t\tblue = rgb[2];\n\t\t\tluminance = (0.2126 * red) + (0.7152 * green) + (0.0722 * blue);\n\t\t\t// range is 1 - 255; therefore 125 is the tipping point\n\t\t\tif (luminance < 125) { // background is dark\n\t\t\t\ticonColor = 'white';\n\t\t\t}\n\t\t\telse { // background is light\n\t\t\t\ticonColor = 'black';\n\t\t\t}\n\t\t\tif ($elements[i] === 'controller') {\n\t\t\t\tthis.iconColor = iconColor;\n\t\t\t}\n\t\t\telse if ($elements[i] === 'toolbar') {\n\t\t\t\tthis.toolbarIconColor = iconColor;\n\t\t\t}\n\t\t\t$el.remove();\n\t\t}\n\t};\n\n\tAblePlayer.prototype.setButtonImages = function() {\n\n\t\t// NOTE: volume button images are now set dynamically within volume.js\n\t\tthis.imgPath = this.rootPath + 'button-icons/' + this.iconColor + '/';\n\t\tthis.playButtonImg = this.imgPath + 'play.png';\n\t\tthis.pauseButtonImg = this.imgPath + 'pause.png';\n\n\t\tthis.restartButtonImg = this.imgPath + 'restart.png';\n\n\t\tthis.rewindButtonImg = this.imgPath + 'rewind.png';\n\t\tthis.forwardButtonImg = this.imgPath + 'forward.png';\n\n\t\tthis.previousButtonImg = this.imgPath + 'previous.png';\n\t\tthis.nextButtonImg = this.imgPath + 'next.png';\n\n\t\tif (this.speedIcons === 'arrows') {\n\t\t\tthis.fasterButtonImg = this.imgPath + 'slower.png';\n\t\t\tthis.slowerButtonImg = this.imgPath + 'faster.png';\n\t\t}\n\t\telse if (this.speedIcons === 'animals') {\n\t\t\tthis.fasterButtonImg = this.imgPath + 'rabbit.png';\n\t\t\tthis.slowerButtonImg = this.imgPath + 'turtle.png';\n\t\t}\n\n\t\tthis.captionsButtonImg = this.imgPath + 'captions.png';\n\t\tthis.chaptersButtonImg = this.imgPath + 'chapters.png';\n\t\tthis.signButtonImg = this.imgPath + 'sign.png';\n\t\tthis.transcriptButtonImg = this.imgPath + 'transcript.png';\n\t\tthis.descriptionsButtonImg = this.imgPath + 'descriptions.png';\n\n\t\tthis.fullscreenExpandButtonImg = this.imgPath + 'fullscreen-expand.png';\n\t\tthis.fullscreenCollapseButtonImg = this.imgPath + 'fullscreen-collapse.png';\n\n\t\tthis.prefsButtonImg = this.imgPath + 'preferences.png';\n\t\tthis.helpButtonImg = this.imgPath + 'help.png';\n\t};\n\n\tAblePlayer.prototype.getSvgData = function(button) {\n\n\t\t// returns array of values for creating <svg> tag for specified button\n\t\t// 0 = <svg> viewBox attribute\n\t\t// 1 = <path> d (description) attribute\n\t\tvar svg = Array();\n\n\t\tswitch (button) {\n\n\t\t\tcase 'play':\n\t\t\t\tsvg[0] = '0 0 16 20';\n\t\t\t\tsvg[1] = 'M0 18.393v-16.429q0-0.29 0.184-0.402t0.441 0.033l14.821 8.237q0.257 0.145 0.257 0.346t-0.257 0.346l-14.821 8.237q-0.257 0.145-0.441 0.033t-0.184-0.402z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'pause':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M0 18.036v-15.714q0-0.29 0.212-0.502t0.502-0.212h5.714q0.29 0 0.502 0.212t0.212 0.502v15.714q0 0.29-0.212 0.502t-0.502 0.212h-5.714q-0.29 0-0.502-0.212t-0.212-0.502zM10 18.036v-15.714q0-0.29 0.212-0.502t0.502-0.212h5.714q0.29 0 0.502 0.212t0.212 0.502v15.714q0 0.29-0.212 0.502t-0.502 0.212h-5.714q-0.29 0-0.502-0.212t-0.212-0.502z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'stop':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M0 18.036v-15.714q0-0.29 0.212-0.502t0.502-0.212h15.714q0.29 0 0.502 0.212t0.212 0.502v15.714q0 0.29-0.212 0.502t-0.502 0.212h-15.714q-0.29 0-0.502-0.212t-0.212-0.502z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'restart':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M18 8h-6l2.243-2.243c-1.133-1.133-2.64-1.757-4.243-1.757s-3.109 0.624-4.243 1.757c-1.133 1.133-1.757 2.64-1.757 4.243s0.624 3.109 1.757 4.243c1.133 1.133 2.64 1.757 4.243 1.757s3.109-0.624 4.243-1.757c0.095-0.095 0.185-0.192 0.273-0.292l1.505 1.317c-1.466 1.674-3.62 2.732-6.020 2.732-4.418 0-8-3.582-8-8s3.582-8 8-8c2.209 0 4.209 0.896 5.656 2.344l2.344-2.344v6z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'rewind':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M11.25 3.125v6.25l6.25-6.25v13.75l-6.25-6.25v6.25l-6.875-6.875z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'forward':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M10 16.875v-6.25l-6.25 6.25v-13.75l6.25 6.25v-6.25l6.875 6.875z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'previous':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M5 17.5v-15h2.5v6.875l6.25-6.25v13.75l-6.25-6.25v6.875z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'next':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M15 2.5v15h-2.5v-6.875l-6.25 6.25v-13.75l6.25 6.25v-6.875z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'slower':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M0 7.321q0-0.29 0.212-0.502t0.502-0.212h10q0.29 0 0.502 0.212t0.212 0.502-0.212 0.502l-5 5q-0.212 0.212-0.502 0.212t-0.502-0.212l-5-5q-0.212-0.212-0.212-0.502z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'faster':\n\t\t\t\tsvg[0] = '0 0 11 20';\n\t\t\t\tsvg[1] = 'M0 12.411q0-0.29 0.212-0.502l5-5q0.212-0.212 0.502-0.212t0.502 0.212l5 5q0.212 0.212 0.212 0.502t-0.212 0.502-0.502 0.212h-10q-0.29 0-0.502-0.212t-0.212-0.502z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'turtle':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M17.212 3.846c-0.281-0.014-0.549 0.025-0.817 0.144-1.218 0.542-1.662 2.708-2.163 3.942-1.207 2.972-7.090 4.619-11.755 5.216-0.887 0.114-1.749 0.74-2.428 1.466 0.82-0.284 2.126-0.297 2.74 0.144 0.007 0.488-0.376 1.062-0.625 1.37-0.404 0.5-0.398 0.793 0.12 0.793 0.473 0 0.752 0.007 1.635 0 0.393-0.003 0.618-0.16 1.49-1.49 3.592 0.718 5.986-0.264 5.986-0.264s0.407 1.755 1.418 1.755h1.49c0.633 0 0.667-0.331 0.625-0.433-0.448-1.082-0.68-1.873-0.769-2.5-0.263-1.857 0.657-3.836 2.524-5.457 0.585 0.986 2.253 0.845 2.909-0.096s0.446-2.268-0.192-3.221c-0.49-0.732-1.345-1.327-2.188-1.37zM8.221 4.663c-0.722-0.016-1.536 0.111-2.5 0.409-4.211 1.302-4.177 4.951-3.51 5.745 0 0-0.955 0.479-0.409 1.274 0.448 0.652 3.139 0.191 5.409-0.529s4.226-1.793 5.312-2.692c0.948-0.785 0.551-2.106-0.505-1.947-0.494-0.98-1.632-2.212-3.798-2.26zM18.846 5.962c0.325 0 0.577 0.252 0.577 0.577s-0.252 0.577-0.577 0.577c-0.325 0-0.577-0.252-0.577-0.577s0.252-0.577 0.577-0.577z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'rabbit':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M10.817 0c-2.248 0-1.586 0.525-1.154 0.505 1.551-0.072 5.199 0.044 6.851 2.428 0 0-1.022-2.933-5.697-2.933zM10.529 0.769c-2.572 0-2.837 0.51-2.837 1.106 0 0.545 1.526 0.836 2.524 0.697 2.778-0.386 4.231-0.12 5.264 0.865-1.010 0.779-0.75 1.401-1.274 1.851-1.093 0.941-2.643-0.673-4.976-0.673-2.496 0-4.712 1.92-4.712 4.76-0.157-0.537-0.769-0.913-1.442-0.913-0.974 0-1.514 0.637-1.514 1.49 0 0.769 1.13 1.791 2.861 0.938 0.499 1.208 2.265 1.364 2.452 1.418 0.538 0.154 1.875 0.098 1.875 0.865 0 0.794-1.034 1.094-1.034 1.707 0 1.070 1.758 0.873 2.284 1.034 1.683 0.517 2.103 1.214 2.788 2.212 0.771 1.122 2.572 1.408 2.572 0.625 0-3.185-4.413-4.126-4.399-4.135 0.608-0.382 2.139-1.397 2.139-3.534 0-1.295-0.703-2.256-1.755-2.861 1.256 0.094 2.572 1.205 2.572 2.74 0 1.877-0.653 2.823-0.769 2.957 1.975-1.158 3.193-3.91 3.029-6.37 0.61 0.401 1.27 0.577 1.971 0.625 0.751 0.052 1.475-0.225 1.635-0.529 0.38-0.723 0.162-2.321-0.12-2.837-0.763-1.392-2.236-1.73-3.606-1.683-1.202-1.671-3.812-2.356-5.529-2.356zM1.37 3.077l-0.553 1.538h3.726c0.521-0.576 1.541-1.207 2.284-1.538h-5.457zM18.846 5.192c0.325 0 0.577 0.252 0.577 0.577s-0.252 0.577-0.577 0.577c-0.325 0-0.577-0.252-0.577-0.577s0.252-0.577 0.577-0.577zM0.553 5.385l-0.553 1.538h3.197c0.26-0.824 0.586-1.328 0.769-1.538h-3.413z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'ellipsis':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M10.001 7.8c-1.215 0-2.201 0.985-2.201 2.2s0.986 2.2 2.201 2.2c1.215 0 2.199-0.985 2.199-2.2s-0.984-2.2-2.199-2.2zM3.001 7.8c-1.215 0-2.201 0.985-2.201 2.2s0.986 2.2 2.201 2.2c1.215 0 2.199-0.986 2.199-2.2s-0.984-2.2-2.199-2.2zM17.001 7.8c-1.215 0-2.201 0.985-2.201 2.2s0.986 2.2 2.201 2.2c1.215 0 2.199-0.985 2.199-2.2s-0.984-2.2-2.199-2.2z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'pipe':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M10.15 0.179h0.623c0.069 0 0.127 0.114 0.127 0.253v19.494c0 0.139-0.057 0.253-0.127 0.253h-1.247c-0.069 0-0.126-0.114-0.126-0.253v-19.494c0-0.139 0.057-0.253 0.126-0.253h0.623z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'captions':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M0.033 3.624h19.933v12.956h-19.933v-12.956zM18.098 10.045c-0.025-2.264-0.124-3.251-0.743-3.948-0.112-0.151-0.322-0.236-0.496-0.344-0.606-0.386-3.465-0.526-6.782-0.526s-6.313 0.14-6.907 0.526c-0.185 0.108-0.396 0.193-0.519 0.344-0.607 0.697-0.693 1.684-0.731 3.948 0.037 2.265 0.124 3.252 0.731 3.949 0.124 0.161 0.335 0.236 0.519 0.344 0.594 0.396 3.59 0.526 6.907 0.547 3.317-0.022 6.176-0.151 6.782-0.547 0.174-0.108 0.384-0.183 0.496-0.344 0.619-0.697 0.717-1.684 0.743-3.949v0 0zM9.689 9.281c-0.168-1.77-1.253-2.813-3.196-2.813-1.773 0-3.168 1.387-3.168 3.617 0 2.239 1.271 3.636 3.372 3.636 1.676 0 2.851-1.071 3.035-2.852h-2.003c-0.079 0.661-0.397 1.168-1.068 1.168-1.059 0-1.253-0.91-1.253-1.876 0-1.33 0.442-2.010 1.174-2.010 0.653 0 1.068 0.412 1.13 1.129h1.977zM16.607 9.281c-0.167-1.77-1.252-2.813-3.194-2.813-1.773 0-3.168 1.387-3.168 3.617 0 2.239 1.271 3.636 3.372 3.636 1.676 0 2.851-1.071 3.035-2.852h-2.003c-0.079 0.661-0.397 1.168-1.068 1.168-1.059 0-1.253-0.91-1.253-1.876 0-1.33 0.441-2.010 1.174-2.010 0.653 0 1.068 0.412 1.13 1.129h1.976z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'descriptions':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M17.623 3.57h-1.555c1.754 1.736 2.763 4.106 2.763 6.572 0 2.191-0.788 4.286-2.189 5.943h1.484c1.247-1.704 1.945-3.792 1.945-5.943-0-2.418-0.886-4.754-2.447-6.572v0zM14.449 3.57h-1.55c1.749 1.736 2.757 4.106 2.757 6.572 0 2.191-0.788 4.286-2.187 5.943h1.476c1.258-1.704 1.951-3.792 1.951-5.943-0-2.418-0.884-4.754-2.447-6.572v0zM11.269 3.57h-1.542c1.752 1.736 2.752 4.106 2.752 6.572 0 2.191-0.791 4.286-2.181 5.943h1.473c1.258-1.704 1.945-3.792 1.945-5.943 0-2.418-0.876-4.754-2.447-6.572v0zM10.24 9.857c0 3.459-2.826 6.265-6.303 6.265v0.011h-3.867v-12.555h3.896c3.477 0 6.274 2.806 6.274 6.279v0zM6.944 9.857c0-1.842-1.492-3.338-3.349-3.338h-0.876v6.686h0.876c1.858 0 3.349-1.498 3.349-3.348v0z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'sign':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M10.954 10.307c0.378 0.302 0.569 1.202 0.564 1.193 0.697 0.221 1.136 0.682 1.136 0.682 1.070-0.596 1.094-0.326 1.558-0.682 0.383-0.263 0.366-0.344 0.567-1.048 0.187-0.572-0.476-0.518-1.021-1.558-0.95 0.358-1.463 0.196-1.784 0.167-0.145-0.020-0.12 0.562-1.021 1.247zM14.409 17.196c-0.133 0.182-0.196 0.218-0.363 0.454-0.28 0.361 0.076 0.906 0.253 0.82 0.206-0.076 0.341-0.488 0.567-0.623 0.115-0.061 0.422-0.513 0.709-0.82 0.211-0.238 0.363-0.344 0.564-0.594 0.341-0.422 0.412-0.744 0.709-1.193 0.184-0.236 0.312-0.307 0.481-0.594 0.886-1.679 0.628-2.432 1.475-3.629 0.26-0.353 0.552-0.442 0.964-0.653 0.383-2.793-0.888-4.356-0.879-4.361-1.067 0.623-1.644 0.879-2.751 0.82-0.417-0.005-0.636-0.182-1.048-0.145-0.385 0.015-0.582 0.159-0.964 0.29-0.589 0.182-0.91 0.344-1.529 0.535-0.393 0.11-0.643 0.115-1.050 0.255-0.348 0.147-0.182 0.029-0.427 0.312-0.317 0.348-0.238 0.623-0.535 1.222-0.371 0.785-0.326 0.891-0.115 0.987-0.14 0.402-0.174 0.672-0.14 1.107 0.039 0.331-0.101 0.562 0.255 0.825 0.483 0.361 1.499 1.205 1.757 1.217 0.39-0.012 1.521 0.029 2.096-0.368 0.13-0.081 0.167-0.162 0.056 0.145-0.022 0.037-1.433 1.136-1.585 1.131-1.794 0.056-1.193 0.157-1.303 0.115-0.091 0-0.955-1.055-1.477-0.682-0.196 0.12-0.287 0.236-0.363 0.452 0.066 0.137 0.383 0.358 0.675 0.54 0.422 0.27 0.461 0.552 0.881 0.653 0.513 0.115 1.060 0.039 1.387 0.081 0.125 0.034 1.256-0.297 1.961-0.675 0.65-0.336-0.898 0.648-1.276 1.131-1.141 0.358-0.82 0.373-1.362 0.483-0.503 0.115-0.479 0.086-0.822 0.196-0.356 0.086-0.648 0.572-0.312 0.825 0.201 0.167 0.827-0.066 1.445-0.086 0.275-0.005 1.391-0.518 1.644-0.653 0.633-0.339 1.099-0.81 1.472-1.077 0.518-0.361-0.584 0.991-1.050 1.558zM8.855 9.799c-0.378-0.312-0.569-1.212-0.564-1.217-0.697-0.206-1.136-0.667-1.136-0.653-1.070 0.582-1.099 0.312-1.558 0.653-0.388 0.277-0.366 0.363-0.567 1.045-0.187 0.594 0.471 0.535 1.021 1.561 0.95-0.344 1.463-0.182 1.784-0.142 0.145 0.010 0.12-0.572 1.021-1.247zM5.4 2.911c0.133-0.191 0.196-0.228 0.368-0.454 0.27-0.371-0.081-0.915-0.253-0.849-0.211 0.096-0.346 0.508-0.599 0.653-0.093 0.052-0.4 0.503-0.682 0.82-0.211 0.228-0.363 0.334-0.564 0.599-0.346 0.407-0.412 0.729-0.709 1.161-0.184 0.258-0.317 0.324-0.481 0.621-0.886 1.669-0.631 2.422-1.475 3.6-0.26 0.38-0.552 0.461-0.964 0.682-0.383 2.788 0.883 4.346 0.879 4.336 1.068-0.609 1.639-0.861 2.751-0.825 0.417 0.025 0.636 0.201 1.048 0.174 0.385-0.025 0.582-0.169 0.964-0.285 0.589-0.196 0.91-0.358 1.499-0.54 0.422-0.12 0.672-0.125 1.080-0.285 0.348-0.128 0.182-0.010 0.427-0.282 0.312-0.358 0.238-0.633 0.508-1.217 0.398-0.8 0.353-0.906 0.142-0.991 0.135-0.412 0.174-0.677 0.14-1.107-0.044-0.336 0.101-0.572-0.255-0.82-0.483-0.375-1.499-1.22-1.752-1.222-0.395 0.002-1.526-0.039-2.101 0.339-0.13 0.101-0.167 0.182-0.056-0.11 0.022-0.052 1.433-1.148 1.585-1.163 1.794-0.039 1.193-0.14 1.303-0.088 0.091-0.007 0.955 1.045 1.477 0.682 0.191-0.13 0.287-0.245 0.368-0.452-0.071-0.147-0.388-0.368-0.68-0.537-0.422-0.282-0.464-0.564-0.881-0.655-0.513-0.125-1.065-0.049-1.387-0.11-0.125-0.015-1.256 0.317-1.956 0.68-0.66 0.351 0.893-0.631 1.276-1.136 1.136-0.339 0.81-0.353 1.36-0.479 0.501-0.101 0.476-0.071 0.82-0.172 0.351-0.096 0.648-0.577 0.312-0.849-0.206-0.152-0.827 0.081-1.44 0.086-0.28 0.020-1.396 0.533-1.649 0.677-0.633 0.329-1.099 0.8-1.472 1.048-0.523 0.38 0.584-0.967 1.050-1.529z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'mute':\n\t\t\tcase 'volume-mute':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M7.839 1.536c0.501-0.501 0.911-0.331 0.911 0.378v16.172c0 0.709-0.41 0.879-0.911 0.378l-4.714-4.713h-3.125v-7.5h3.125l4.714-4.714zM18.75 12.093v1.657h-1.657l-2.093-2.093-2.093 2.093h-1.657v-1.657l2.093-2.093-2.093-2.093v-1.657h1.657l2.093 2.093 2.093-2.093h1.657v1.657l-2.093 2.093z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'volume-soft':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M10.723 14.473c-0.24 0-0.48-0.092-0.663-0.275-0.366-0.366-0.366-0.96 0-1.326 1.584-1.584 1.584-4.161 0-5.745-0.366-0.366-0.366-0.96 0-1.326s0.96-0.366 1.326 0c2.315 2.315 2.315 6.082 0 8.397-0.183 0.183-0.423 0.275-0.663 0.275zM7.839 1.536c0.501-0.501 0.911-0.331 0.911 0.378v16.172c0 0.709-0.41 0.879-0.911 0.378l-4.714-4.713h-3.125v-7.5h3.125l4.714-4.714z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'volume-medium':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M14.053 16.241c-0.24 0-0.48-0.092-0.663-0.275-0.366-0.366-0.366-0.96 0-1.326 2.559-2.559 2.559-6.722 0-9.281-0.366-0.366-0.366-0.96 0-1.326s0.96-0.366 1.326 0c1.594 1.594 2.471 3.712 2.471 5.966s-0.878 4.373-2.471 5.966c-0.183 0.183-0.423 0.275-0.663 0.275zM10.723 14.473c-0.24 0-0.48-0.092-0.663-0.275-0.366-0.366-0.366-0.96 0-1.326 1.584-1.584 1.584-4.161 0-5.745-0.366-0.366-0.366-0.96 0-1.326s0.96-0.366 1.326 0c2.315 2.315 2.315 6.082 0 8.397-0.183 0.183-0.423 0.275-0.663 0.275zM7.839 1.536c0.501-0.501 0.911-0.331 0.911 0.378v16.172c0 0.709-0.41 0.879-0.911 0.378l-4.714-4.713h-3.125v-7.5h3.125l4.714-4.714z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'volume-loud':\n\t\t\t\tsvg[0] = '0 0 21 20';\n\t\t\t\tsvg[1] = 'M17.384 18.009c-0.24 0-0.48-0.092-0.663-0.275-0.366-0.366-0.366-0.96 0-1.326 1.712-1.712 2.654-3.988 2.654-6.408s-0.943-4.696-2.654-6.408c-0.366-0.366-0.366-0.96 0-1.326s0.96-0.366 1.326 0c2.066 2.066 3.204 4.813 3.204 7.734s-1.138 5.668-3.204 7.734c-0.183 0.183-0.423 0.275-0.663 0.275zM14.053 16.241c-0.24 0-0.48-0.092-0.663-0.275-0.366-0.366-0.366-0.96 0-1.326 2.559-2.559 2.559-6.722 0-9.281-0.366-0.366-0.366-0.96 0-1.326s0.96-0.366 1.326 0c1.594 1.594 2.471 3.712 2.471 5.966s-0.878 4.373-2.471 5.966c-0.183 0.183-0.423 0.275-0.663 0.275zM10.723 14.473c-0.24 0-0.48-0.092-0.663-0.275-0.366-0.366-0.366-0.96 0-1.326 1.584-1.584 1.584-4.161 0-5.745-0.366-0.366-0.366-0.96 0-1.326s0.96-0.366 1.326 0c2.315 2.315 2.315 6.082 0 8.397-0.183 0.183-0.423 0.275-0.663 0.275zM7.839 1.536c0.501-0.501 0.911-0.331 0.911 0.378v16.172c0 0.709-0.41 0.879-0.911 0.378l-4.714-4.713h-3.125v-7.5h3.125l4.714-4.714z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'chapters':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M5 2.5v17.5l6.25-6.25 6.25 6.25v-17.5zM15 0h-12.5v17.5l1.25-1.25v-15h11.25z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'transcript':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M0 19.107v-17.857q0-0.446 0.313-0.759t0.759-0.313h8.929v6.071q0 0.446 0.313 0.759t0.759 0.313h6.071v11.786q0 0.446-0.313 0.759t-0.759 0.312h-15q-0.446 0-0.759-0.313t-0.313-0.759zM4.286 15.536q0 0.156 0.1 0.257t0.257 0.1h7.857q0.156 0 0.257-0.1t0.1-0.257v-0.714q0-0.156-0.1-0.257t-0.257-0.1h-7.857q-0.156 0-0.257 0.1t-0.1 0.257v0.714zM4.286 12.679q0 0.156 0.1 0.257t0.257 0.1h7.857q0.156 0 0.257-0.1t0.1-0.257v-0.714q0-0.156-0.1-0.257t-0.257-0.1h-7.857q-0.156 0-0.257 0.1t-0.1 0.257v0.714zM4.286 9.821q0 0.156 0.1 0.257t0.257 0.1h7.857q0.156 0 0.257-0.1t0.1-0.257v-0.714q0-0.156-0.1-0.257t-0.257-0.1h-7.857q-0.156 0-0.257 0.1t-0.1 0.257v0.714zM11.429 5.893v-5.268q0.246 0.156 0.402 0.313l4.554 4.554q0.156 0.156 0.313 0.402h-5.268z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'preferences':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M18.238 11.919c-1.049-1.817-0.418-4.147 1.409-5.205l-1.965-3.404c-0.562 0.329-1.214 0.518-1.911 0.518-2.1 0-3.803-1.714-3.803-3.828h-3.931c0.005 0.653-0.158 1.314-0.507 1.919-1.049 1.818-3.382 2.436-5.212 1.382l-1.965 3.404c0.566 0.322 1.056 0.793 1.404 1.396 1.048 1.815 0.42 4.139-1.401 5.2l1.965 3.404c0.56-0.326 1.209-0.513 1.902-0.513 2.094 0 3.792 1.703 3.803 3.808h3.931c-0.002-0.646 0.162-1.3 0.507-1.899 1.048-1.815 3.375-2.433 5.203-1.387l1.965-3.404c-0.562-0.322-1.049-0.791-1.395-1.391zM10 14.049c-2.236 0-4.050-1.813-4.050-4.049s1.813-4.049 4.050-4.049 4.049 1.813 4.049 4.049c-0 2.237-1.813 4.049-4.049 4.049z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'close':\n\t\t\t\tsvg[0] = '0 0 16 20';\n\t\t\t\tsvg[1] = 'M1.228 14.933q0-0.446 0.312-0.759l3.281-3.281-3.281-3.281q-0.313-0.313-0.313-0.759t0.313-0.759l1.518-1.518q0.313-0.313 0.759-0.313t0.759 0.313l3.281 3.281 3.281-3.281q0.313-0.313 0.759-0.313t0.759 0.313l1.518 1.518q0.313 0.313 0.313 0.759t-0.313 0.759l-3.281 3.281 3.281 3.281q0.313 0.313 0.313 0.759t-0.313 0.759l-1.518 1.518q-0.313 0.313-0.759 0.313t-0.759-0.313l-3.281-3.281-3.281 3.281q-0.313 0.313-0.759 0.313t-0.759-0.313l-1.518-1.518q-0.313-0.313-0.313-0.759z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'fullscreen-expand':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M0 18.036v-5q0-0.29 0.212-0.502t0.502-0.212 0.502 0.212l1.607 1.607 3.705-3.705q0.112-0.112 0.257-0.112t0.257 0.112l1.272 1.272q0.112 0.112 0.112 0.257t-0.112 0.257l-3.705 3.705 1.607 1.607q0.212 0.212 0.212 0.502t-0.212 0.502-0.502 0.212h-5q-0.29 0-0.502-0.212t-0.212-0.502zM8.717 8.393q0-0.145 0.112-0.257l3.705-3.705-1.607-1.607q-0.212-0.212-0.212-0.502t0.212-0.502 0.502-0.212h5q0.29 0 0.502 0.212t0.212 0.502v5q0 0.29-0.212 0.502t-0.502 0.212-0.502-0.212l-1.607-1.607-3.705 3.705q-0.112 0.112-0.257 0.112t-0.257-0.112l-1.272-1.272q-0.112-0.112-0.112-0.257z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'fullscreen-collapse':\n\t\t\t\tsvg[0] = '0 0 20 20';\n\t\t\t\tsvg[1] = 'M0.145 16.964q0-0.145 0.112-0.257l3.705-3.705-1.607-1.607q-0.212-0.212-0.212-0.502t0.212-0.502 0.502-0.212h5q0.29 0 0.502 0.212t0.212 0.502v5q0 0.29-0.212 0.502t-0.502 0.212-0.502-0.212l-1.607-1.607-3.705 3.705q-0.112 0.112-0.257 0.112t-0.257-0.112l-1.272-1.272q-0.112-0.112-0.112-0.257zM8.571 9.464v-5q0-0.29 0.212-0.502t0.502-0.212 0.502 0.212l1.607 1.607 3.705-3.705q0.112-0.112 0.257-0.112t0.257 0.112l1.272 1.272q0.112 0.112 0.112 0.257t-0.112 0.257l-3.705 3.705 1.607 1.607q0.212 0.212 0.212 0.502t-0.212 0.502-0.502 0.212h-5q-0.29 0-0.502-0.212t-0.212-0.502z';\n\t\t\t\tbreak;\n\n\t\t\tcase 'help':\n\t\t\t\tsvg[0] = '0 0 11 20';\n\t\t\t\tsvg[1] = 'M0.577 6.317q-0.028-0.167 0.061-0.313 1.786-2.969 5.179-2.969 0.893 0 1.797 0.346t1.629 0.926 1.183 1.423 0.458 1.769q0 0.603-0.173 1.127t-0.391 0.854-0.614 0.664-0.642 0.485-0.681 0.396q-0.458 0.257-0.765 0.725t-0.307 0.748q0 0.19-0.134 0.363t-0.313 0.173h-2.679q-0.167 0-0.285-0.206t-0.117-0.419v-0.502q0-0.926 0.725-1.747t1.596-1.211q0.658-0.301 0.938-0.625t0.279-0.848q0-0.469-0.519-0.826t-1.2-0.357q-0.725 0-1.205 0.324-0.391 0.279-1.194 1.283-0.145 0.179-0.346 0.179-0.134 0-0.279-0.089l-1.83-1.395q-0.145-0.112-0.173-0.279zM3.786 16.875v-2.679q0-0.179 0.134-0.313t0.313-0.134h2.679q0.179 0 0.313 0.134t0.134 0.313v2.679q0 0.179-0.134 0.313t-0.313 0.134h-2.679q-0.179 0-0.313-0.134t-0.134-0.313z';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn svg;\n\t};\n\n\t// Initialize player based on data on page.\n\t// This sets some variables, but does not modify anything.\tSafe to call multiple times.\n\t// Can call again after updating this.media so long as new media element has the same ID.\n\tAblePlayer.prototype.reinitialize = function () {\n\n\t\tvar deferred, promise, thisObj, errorMsg, srcFile;\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\t\tthisObj = this;\n\n\t\t// if F12 Developer Tools aren't open in IE (through 9, no longer a problen in IE10)\n\t\t// console.log causes an error - can't use debug without a console to log messages to\n\t\tif (! window.console) {\n\t\t\tthis.debug = false;\n\t\t}\n\n\t\tthis.startedPlaying = false;\n\t\t// TODO: Move this setting to cookie.\n\t\tthis.autoScrollTranscript = true;\n\t\t//this.autoScrollTranscript = this.getCookie(autoScrollTranscript); // (doesn't work)\n\n\t\t// Bootstrap from this.media possibly being an ID or other selector.\n\t\tthis.$media = $(this.media).first();\n\t\tthis.media = this.$media[0];\n\n\t\t// Set media type to 'audio' or 'video'; this determines some of the behavior of player creation.\n\t\tif (this.$media.is('audio')) {\n\t\t\tthis.mediaType = 'audio';\n\t\t}\n\t\telse if (this.$media.is('video')) {\n\t\t\tthis.mediaType = 'video';\n\t\t}\n\t\telse {\n\t\t\t// Able Player was initialized with some element other than <video> or <audio>\n\t\t\tthis.provideFallback();\n\t\t\tdeferred.fail();\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.$sources = this.$media.find('source');\n\n\t\tthis.player = this.getPlayer();\n\t\tif (!this.player) {\n\t\t\t// an error was generated in getPlayer()\n\t\t\tthis.provideFallback();\n\t\t}\n\t\tthis.setIconType();\n\n\t\tdeferred.resolve();\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.setPlayerSize = function(width, height) {\n\n\t\tvar mediaId = this.$media.attr('id');\n\n\t\t// Called again after width and height are known \n\n\t\tif (this.mediaType === 'audio') { \t\t\t\n\t\t\tif (this.playerWidth) { \n\t\t\t\tthis.$ableWrapper.css('width',this.playerWidth + 'px'); \n\t\t\t}\n\t\t}\n\t\telse if (width > 0 && height > 0) { \n\t\t\tthis.playerWidth = width; \n\t\t\tthis.playerHeight = height; \n\t\t\tthis.aspectRatio = height / width; \n\t\t}\n\t};\n\n\tAblePlayer.prototype.setIconType = function() {\n\n\t\t// returns either \"svg\", \"font\" or \"image\" (in descending order of preference)\n\t\t// Test for support of each type. If not supported, test the next type.\n\t\t// last resort is image icons\n\n\t\tvar $tempButton, $testButton, controllerFont;\n\n\t\tif (this.forceIconType) {\n\t\t\t// use value specified in data-icon-type\n\t\t\treturn false;\n\t\t}\n\n\t\t// test for SVG support\n\t\t// Test this method widely; failed as expected on IE8 and below\n\t\t// https://stackoverflow.com/a/27568129/744281\n\t\tif (!!(document.createElementNS && document.createElementNS('http://www.w3.org/2000/svg','svg').createSVGRect)) {\n\t\t\t// browser supports SVG\n\t\t\tthis.iconType = 'svg';\n\t\t}\n\t\telse {\n\t\t\t// browser does NOT support SVG\n\t\t\t// test whether browser can support icon fonts, and whether user has overriding the default style sheet\n\t\t\t// which could cause problems with proper display of the icon fonts\n\t\t\tif (window.getComputedStyle) {\n\n\t\t\t\t// webkit doesn't return calculated styles unless element has been added to the DOM\n\t\t\t\t// and is visible (note: visibly clipped is considered \"visible\")\n\t\t\t\t// use playpauseButton for font-family test if it exists; otherwise must create a new temp button\n\t\t\t\tif ($('span.icon-play').length) {\n\t\t\t\t\t$testButton = $('span.icon-play');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$tempButton = $('<span>',{\n\t\t\t\t\t\t'class': 'icon-play able-clipped'\n\t\t\t\t\t});\n\t\t\t\t\t$('body').append($tempButton);\n\t\t\t\t\t$testButton = $tempButton;\n\t\t\t\t}\n\n\t\t\t\t// the following retrieves the computed value of font-family\n\t\t\t\t// tested in Firefox 45.x with \"Allow pages to choose their own fonts\" unchecked - works!\n\t\t\t\t// tested in Chrome 49.x with Font Changer plugin - works!\n\t\t\t\t// tested in IE with user-defined style sheet enables - works!\n\t\t\t\t// It does NOT account for users who have \"ignore font styles on web pages\" checked in IE\n\t\t\t\t// There is no known way to check for that ???\n\t\t\t\tcontrollerFont = window.getComputedStyle($testButton.get(0), null).getPropertyValue('font-family');\n\t\t\t\tif (typeof controllerFont !== 'undefined') {\n\t\t\t\t\tif (controllerFont.indexOf('able') !== -1) {\n\t\t\t\t\t\tthis.iconType = 'font';\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.iconType = 'image';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// couldn't get computed font-family; use images to be safe\n\t\t\t\t\tthis.iconType = 'image';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse { \n\t\t\t\t// window.getComputedStyle is not supported (IE 8 and earlier)\n\t\t\t\t// No known way to detect computed font\n\t\t\t\t// The following retrieves the value from the style sheet, not the computed font\n\t\t\t\t// controllerFont = $tempButton.get(0).currentStyle.fontFamily;\n\t\t\t\t// It will therefore return \"able\", even if the user is overriding that with a custom style sheet\n\t\t\t\t// To be safe, use images\n\t\t\t\tthis.iconType = 'image';\n\t\t\t}\n\t\t\tif (typeof $tempButton !== 'undefined') {\n\t\t\t\t$tempButton.remove();\n\t\t\t}\n\t\t}\n\t};\n\n\t// Perform one-time setup for this instance of player; called after player is first initialized.\n\tAblePlayer.prototype.setupInstance = function () {\n\n\t\tvar deferred = new $.Deferred();\n\t\tvar promise = deferred.promise();\n\n\t\tif (this.$media.attr('id')) {\n\t\t\tthis.mediaId = this.$media.attr('id');\n\t\t}\n\t\telse {\n\t\t\t// Ensure the base media element always has an ID.\n\t\t\tthis.mediaId = \"ableMediaId_\" + this.ableIndex;\n\t\t\tthis.$media.attr('id', this.mediaId);\n\t\t}\n\t\tdeferred.resolve();\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.setupInstancePlaylist = function() {\n\n\t\t// find a matching playlist and set this.hasPlaylist\n\t\t// if there is one, also set this.$playlist, this.playlistIndex, & this.playlistEmbed\n\t\tvar thisObj = this;\n\n\t\tthis.hasPlaylist = false; // will change to true if a matching playlist is found\n\n\t\t$('.able-playlist').each(function() {\n\t\t\tif ($(this).data('player') === thisObj.mediaId) {\n\t\t\t\t// this is the playlist for the current player\n\t\t\t\tthisObj.hasPlaylist = true;\n\t\t\t\t// If using an embedded player, we'll replace $playlist with the clone later.\n\t\t\t\tthisObj.$playlist = $(this).find('li');\n\n\t\t\t\t// check to see if list item has YouTube as its source\n\t\t\t\t// if it does, inject a thumbnail from YouTube\n\t\t\t\tvar $youTubeVideos = $(this).find('li[data-youtube-id]');\n\t\t\t\t$youTubeVideos.each(function() {\n\t\t\t\t\tvar youTubeId = $(this).attr('data-youtube-id');\n\t\t\t\t\tvar youTubePoster = thisObj.getYouTubePosterUrl(youTubeId,'120');\n\t\t\t\t\tvar $youTubeImg = $('<img>',{\n\t\t\t\t\t\t'src': youTubePoster,\n\t\t\t\t\t\t'alt': ''\n\t\t\t\t\t});\n\t\t\t\t\t$(this).find('button').prepend($youTubeImg);\n\t\t\t\t});\n\n\t\t\t\t// check to see if list item has Vimeo as its source\n\t\t\t\t// if it does, inject a thumbnail from Vimeo\n\t\t\t\tvar $vimeoVideos = $(this).find('li[data-vimeo-id]');\n\t\t\t\t$vimeoVideos.each(function() {\n\t\t\t\t\tvar vimeoId = $(this).attr('data-youtube-id');\n\t\t\t\t\tvar vimeoPoster = thisObj.getVimeoPosterUrl(vimeoId,'120');\n\t\t\t\t\tvar $vimeoImg = $('<img>',{\n\t\t\t\t\t\t'src': vimeoPoster,\n\t\t\t\t\t\t'alt': ''\n\t\t\t\t\t});\n\t\t\t\t\t$(this).find('button').prepend($vimeoImg);\n\t\t\t\t});\n\n\t\t\t\t// add accessibility to the list markup\n\t\t\t\t$(this).find('li span').attr('aria-hidden','true');\n\t\t\t\tthisObj.playlistIndex = 0;\n\t\t\t\tvar dataEmbedded = $(this).data('embedded');\n\t\t\t\tif (typeof dataEmbedded !== 'undefined' && dataEmbedded !== false) {\n\t\t\t\t\t// embed playlist within player\n\t\t\t\t\tthisObj.playlistEmbed = true;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthisObj.playlistEmbed = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.hasPlaylist && this.loop) {\n\t\t\t// browser will loop the current track in the playlist, rather than the playlist\n\t\t\t// therefore, need to remove loop attribute from media element\n\t\t\t// but keep this.loop as true and handle the playlist looping ourselves\n\t\t\tthis.media.removeAttribute('loop');\n\t\t}\n\t\tif (this.hasPlaylist && this.playlistEmbed) {\n\t\t\t// Copy the playlist out of the dom, so we can reinject when we build the player.\n\t\t\tvar parent = this.$playlist.parent();\n\t\t\tthis.$playlistDom = parent.clone();\n\t\t\tparent.remove();\n\t\t}\n\t\tif (this.hasPlaylist && this.$sources.length === 0) {\n\t\t\t// no source elements were provided. Construct them from the first playlist item\n\t\t\tthis.cuePlaylistItem(0);\n\t\t\t// redefine this.$sources now that media contains one or more <source> elements\n\t\t\tthis.$sources = this.$media.find('source');\n\t\t}\n\t};\n\n\tAblePlayer.prototype.recreatePlayer = function () {\n\n\t\t// Creates the appropriate player for the current source.\n\t\t// This function is called each time a new media instance is loaded \n\t\t// e.g., \n\t\t// User clicks on an item in a playlist \n\t\t// User swaps to/from described version of video \n\t\t// Blocks of code that only need to be executed once are controlled \n\t\t// by this.playerCreated \n\n\t\t// TODO: Ensure when recreating player that we carry over the mediaId\n\t\tif (!this.player) {\n\t\t\tconsole.log(\"Can't create player; no appropriate player type detected.\");\n\t\t\treturn;\n\t\t}\n\n\t\tvar deferred, promise, thisObj, prefsGroups, i;\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\t\tthisObj = this;\n\n\t\tthis.playerDeleted = false; // reset after deletePlayer() \n\n\t\t// set temp stopgap to prevent this function from executing again before finished\n\t\tthis.recreatingPlayer = true; \n\n\t\tif (!this.playerCreated) {\n\t\t\t// only call these functions once\n\t\t\tthis.loadCurrentPreferences();\n\t\t\tthis.injectPlayerCode();\n\t\t\tthis.resizePlayer(this.media.videoWidth,this.media.videoHeight); \n\t\t}\n\n\t\tthis.getSampleDescriptionText(); \n\n\t\tthis.initSignLanguage();\n\n\t\tthis.initPlayer().then(function() {\n\n\t\t\tthisObj.getTracks().then(function() { \n\n\t\t\t\tthisObj.initDescription().then(function() {\n\n\t\t\t\t\tthisObj.setupTracks().then(function() {\n\t\t\t\t\t\tif (thisObj.hasClosedDesc) { \n\t\t\t\t\t\t\tif (!thisObj.$descDiv || \n\t\t\t\t\t\t\t\t(thisObj.$descDiv && !($.contains(thisObj.$ableDiv[0], thisObj.$descDiv[0])))) {\n\t\t\t\t\t\t\t\t// descDiv either doesn't exist, or exists in an orphaned state \n\t\t\t\t\t\t\t\t// Either way, it needs to be rebuilt...  \n\t\t\t\t\t\t\t\tthisObj.injectTextDescriptionArea();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthisObj.initSpeech('init');\n\n\t\t\t\t\t\tthisObj.setupTranscript().then(function() {\n\n\t\t\t\t\t\t\tthisObj.initStenoFrame().then(function() {\n\n\t\t\t\t\t\t\t\tif (thisObj.stenoMode && thisObj.$stenoFrame) {\n\t\t\t\t\t\t\t\t\tthisObj.stenoFrameContents = thisObj.$stenoFrame.contents();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthisObj.getMediaTimes().then(function(mediaTimes) {\n\n\t\t\t\t\t\t\t\t\tthisObj.duration = mediaTimes['duration'];\n\t\t\t\t\t\t\t\t\tthisObj.elapsed = mediaTimes['elapsed'];\n\t\t\t\t\t\t\t\t\tthisObj.setFullscreen(false);\n\n\t\t\t\t\t\t\t\t\tif (typeof thisObj.volume === 'undefined') {\n\t\t\t\t\t\t\t\t\t\tthisObj.volume = thisObj.defaultVolume;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (thisObj.volume) {\n\t\t\t\t\t\t\t\t\t\tthisObj.setVolume(thisObj.volume);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (thisObj.transcriptType) {\n\t\t\t\t\t\t\t\t\t\tthisObj.addTranscriptAreaEvents();\n\t\t\t\t\t\t\t\t\t\tthisObj.updateTranscript();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (thisObj.captions.length) {\n\t\t\t\t\t\t\t\t\t\tthisObj.initDefaultCaption();\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// setMediaAttributes() sets textTrack.mode to 'disabled' for all tracks\n\t\t\t\t\t\t\t\t\t// This tells browsers to ignore the text tracks so Able Player can handle them\n\t\t\t\t\t\t\t\t\t// However, timing is critical as browsers - especially Safari - tend to ignore this request\n\t\t\t\t\t\t\t\t\t// unless it's sent late in the intialization process.\n\t\t\t\t\t\t\t\t\t// If browsers ignore the request, the result is redundant captions\n\t\t\t\t\t\t\t\t\tthisObj.setMediaAttributes();\n\t\t\t\t\t\t\t\t\tthisObj.addControls();\n\t\t\t\t\t\t\t\t\tthisObj.addEventListeners();\n\n\t\t\t\t\t\t\t\t\t// inject each of the hidden forms that will be accessed from the Preferences popup menu\n\t\t\t\t\t\t\t\t\tprefsGroups = thisObj.getPreferencesGroups();\n\t\t\t\t\t\t\t\t\tfor (i = 0; i < prefsGroups.length; i++) {\n\t\t\t\t\t\t\t\t\t\tthisObj.injectPrefsForm(prefsGroups[i]);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tthisObj.setupPopups();\n\t\t\t\t\t\t\t\t\tthisObj.updateCaption();\n\t\t\t\t\t\t\t\t\tthisObj.injectVTS();\n\t\t\t\t\t\t\t\t\tif (thisObj.chaptersDivLocation) {\n\t\t\t\t\t\t\t\t\t\tthisObj.populateChaptersDiv();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tthisObj.showSearchResults();\n\n\t\t\t\t\t\t\t\t\t// Go ahead and load media, without user requesting it\n\t\t\t\t\t\t\t\t\t// Ideally, we would wait until user clicks play, rather than unnecessarily consume their bandwidth\n\t\t\t\t\t\t\t\t\t// However, the media needs to load for us to get the media's duration\n\t\t\t\t\t\t\t\t\tif (thisObj.player === 'html5') {\n\t\t\t\t\t\t\t\t\t\tif (!thisObj.loadingMedia) { \n\t\t\t\t\t\t\t\t\t\t\tthisObj.$media[0].load();\n\t\t\t\t\t\t\t\t\t\t\tthisObj.loadingMedia = true; \n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t// refreshControls is called twice building/initializing the player\n\t\t\t\t\t\t\t\t\t// this is the second. Best to pause a bit before executing, to be sure all prior steps are complete\n\t\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\t\tthisObj.refreshControls('init'); \n\t\t\t\t\t\t\t\t\t\tdeferred.resolve(); \n\t\t\t\t\t\t\t\t\t},100);\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}); \n\t\t\t\t\t\t\t}); \n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\t\t\t \n\t\t\t});\n\t\t},\n\t\tfunction() {\t // initPlayer fail\n\t\t\tthisObj.provideFallback();\n\t\t});\n\t\treturn promise; \n\t};\n\n\tAblePlayer.prototype.initPlayer = function () {\n\n\t\tvar thisObj = this;\n\t\tvar playerPromise;\n\t\t// First run player specific initialization.\n\t\tif (this.player === 'html5') {\n\t\t\tplayerPromise = this.initHtml5Player();\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\t\t\tplayerPromise = this.initYouTubePlayer();\n\t\t}\n\t\telse if (this.player === 'vimeo') {\n\t\t\tplayerPromise = this.initVimeoPlayer();\n\t\t}\n\t\t// After player specific initialization is done, run remaining general initialization.\n\t\tvar deferred = new $.Deferred();\n\t\tvar promise = deferred.promise();\n\t\tplayerPromise.done(\n\t\t\tfunction () { // done/resolved\n\t\t\t\tif (thisObj.useFixedSeekInterval) {\n\t\t\t\t\tif (!thisObj.seekInterval) {\n\t\t\t\t\t\tthisObj.seekInterval = thisObj.defaultSeekInterval;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// fixed seekInterval was already assigned, using value of data-seek-interval attribute\n\t\t\t\t\t}\n\t\t\t\t\tthisObj.seekIntervalCalculated = true;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthisObj.setSeekInterval();\n\t\t\t\t}\n\t\t\t\tdeferred.resolve();\n\t\t\t}\n\t\t).fail(function () { // failed\n\t\t\tdeferred.reject();\n\t\t\t}\n\t\t);\n\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.initStenoFrame = function() {\n\n\t\tvar thisObj, deferred, promise, $iframe;\n\t\tthisObj = this;\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\n\t\tif (this.stenoMode && this.$stenoFrame) {\n\n\t\t\tif (this.$stenoFrame[0].contentWindow,document.readyState == 'complete') {\n\t\t\t\t// iframe has already loaded\n\t\t\t\tdeferred.resolve();\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// iframe has not loaded. Wait for it.\n\t\t\t\tthis.$stenoFrame.on('load',function() {\n\t\t\t\t\tdeferred.resolve();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// there is no stenoFrame to initialize\n\t\t\tdeferred.resolve();\n\t\t}\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.setSeekInterval = function () {\n\n\t\t// this function is only called if this.useFixedSeekInterval is false\n\t\t// if this.useChapterTimes, this is called as each new chapter is loaded\n\t\t// otherwise, it's called once, as the player is initialized\n\t\tvar thisObj, duration;\n\t\tthisObj = this;\n\t\tthis.seekInterval = this.defaultSeekInterval;\n\t\tif (this.useChapterTimes) {\n\t\t\tduration = this.chapterDuration;\n\t\t}\n\t\telse {\n\t\t\tduration = this.duration;\n\t\t}\n\t\tif (typeof duration === 'undefined' || duration < 1) {\n\t\t\t// no duration; just use default for now but keep trying until duration is available\n\t\t\tthis.seekIntervalCalculated = false;\n\t\t\treturn;\n\t\t}\n\t\telse {\n\t\t\tif (duration <= 20) {\n\t\t\t\tthis.seekInterval = 5;\t // 4 steps max\n\t\t\t}\n\t\t\telse if (duration <= 30) {\n\t\t\t\tthis.seekInterval = 6; // 5 steps max\n\t\t\t}\n\t\t\telse if (duration <= 40) {\n\t\t\t\tthis.seekInterval = 8; // 5 steps max\n\t\t\t}\n\t\t\telse if (duration <= 100) {\n\t\t\t\tthis.seekInterval = 10; // 10 steps max\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// never more than 10 steps from start to end\n\t\t\t\tthis.seekInterval = (duration / 10);\n\t\t\t}\n\t\t\tthis.seekIntervalCalculated = true;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.initDefaultCaption = function () {\n\n\t\tvar captions, i;\n\n\t\tcaptions = this.captions;\n\t\tif (captions.length > 0) {\n\t\t\tfor (i=0; i<captions.length; i++) {\n\t\t\t\tif (captions[i].def === true) {\n\t\t\t\t\tthis.captionLang = captions[i].language;\n\t\t\t\t\tthis.selectedCaptions = captions[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof this.captionLang === 'undefined') {\n\t\t\t\t// No caption track was flagged as default\n\t\t\t\t// find and use a caption language that matches the player language\n\t\t\t\tfor (i=0; i<captions.length; i++) {\n\t\t\t\t\tif (captions[i].language === this.lang) {\n\t\t\t\t\t\tthis.captionLang = captions[i].language;\n\t\t\t\t\t\tthis.selectedCaptions = captions[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof this.captionLang === 'undefined') {\n\t\t\t\t// Still no matching caption track\n\t\t\t\t// just use the first track\n\t\t\t\tthis.captionLang = captions[0].language;\n\t\t\t\tthis.selectedCaptions = captions[0];\n\t\t\t}\n\t\t\tif (typeof this.captionLang !== 'undefined') {\n\t\t\t\t// reset transcript selected <option> to this.captionLang\n\t\t\t\tif (this.$transcriptLanguageSelect) {\n\t\t\t\t\tthis.$transcriptLanguageSelect.find('option[lang=' + this.captionLang + ']').prop('selected',true);\n\t\t\t\t}\n\t\t\t\t// sync all other tracks to this same languge\n\t\t\t\tthis.syncTrackLanguages('init',this.captionLang);\n\t\t\t}\n\t\t\tif (this.player === 'vimeo') {\n\t\t\t\tif (this.usingVimeoCaptions && this.prefCaptions == 1) {\n\t\t\t\t\t\t// initialize Vimeo captions to the default language\n\t\t\t\t\t\tthis.vimeoPlayer.enableTextTrack(this.captionLang).then(function(track) {\n\t\t\t\t\t\t\t// track.language = the iso code for the language\n\t\t\t\t\t\t\t// track.kind = 'captions' or 'subtitles'\n\t\t\t\t\t\t\t// track.label = the human-readable label\n\t\t\t\t\t\t}).catch(function(error) {\n\t\t\t\t\t\t\tswitch (error.name) {\n\t\t\t\t\t\t\t\tcase 'InvalidTrackLanguageError':\n\t\t\t\t\t\t\t\t\t// no track was available with the specified language\n\t\t\t\t\t\t\t\t\tconsole.log('No ' + track.kind + ' track is available in the specified language (' + track.label + ')');\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 'InvalidTrackError':\n\t\t\t\t\t\t\t\t\t// no track was available with the specified language and kind\n\t\t\t\t\t\t\t\t\tconsole.log('No ' + track.kind + ' track is available in the specified language (' + track.label + ')');\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t// some other error occurred\n\t\t\t\t\t\t\t\t\tconsole.log('Error loading ' + track.label + ' ' + track.kind + ' track');\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// disable Vimeo captions.\n\t\t\t\t\t\tthis.vimeoPlayer.disableTextTrack().then(function() {\n\t\t\t\t\t\t\t// Vimeo captions disabled\n\t\t\t\t\t\t}).catch(function(error) {\n\t\t\t\t\t\t\tconsole.log('Error disabling Vimeo text track: ',error);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.initHtml5Player = function () {\n\t\t// Nothing special to do!\n\t\tvar deferred = new $.Deferred();\n\t\tvar promise = deferred.promise();\n\t\tdeferred.resolve();\n\t\treturn promise;\n\t};\n\n\t// Sets media/track/source attributes; is called whenever player is recreated since $media may have changed.\n\tAblePlayer.prototype.setMediaAttributes = function () {\n\t\t// Firefox puts videos in tab order; remove.\n\t\tthis.$media.attr('tabindex', -1);\n\n\t\t// Keep native player from displaying captions/subtitles by setting textTrack.mode='disabled'\n\t\t// https://dev.w3.org/html5/spec-author-view/video.html#text-track-mode\n\t\t// This *should* work but historically hasn't been supported in all browsers\n\t\t// Workaround for non-supporting browsers is to remove default attribute\n\t\t// We're doing that too in track.js > setupCaptions()\n\t\tvar textTracks = this.$media.get(0).textTracks;\n\t\tif (textTracks) {\n\t\t\tvar i = 0;\n\t\t\twhile (i < textTracks.length) {\n\t\t\t\ttextTracks[i].mode = 'disabled';\n\t\t\t\ti += 1;\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getPlayer = function() {\n\n\t\t// Determine which player to use, if any\n\t\t// return 'html5', 'youtube', 'vimeo', or null\n\n\t\tvar i, sourceType, $newItem;\n\t\tif (this.testFallback) { \n\t\t\treturn null; \n\t\t}\n\t\telse if (this.youTubeId) {\n\t\t\tif (this.mediaType !== 'video') {\n\t\t\t\t// attempting to play a YouTube video using an element other than <video>\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn 'youtube';\n\t\t\t}\n\t\t}\n\t\telse if (this.vimeoId) {\n\t\t\tif (this.mediaType !== 'video') {\n\t\t\t\t// attempting to play a Vimeo video using an element other than <video>\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn 'vimeo';\n\t\t\t}\n\n\t\t}\n\t\telse if (this.media.canPlayType) {\n\t\t\treturn 'html5';\n\t\t}\n\t\telse {\n\t\t\t// Browser does not support the available media file\n\t\t\treturn null;\n\t\t}\n\t};\n\n})(jQuery);\n\n(function ($) {\n\tAblePlayer.prototype.setCookie = function(cookieValue) {\n\n\t\tCookies.set('Able-Player', JSON.stringify(cookieValue), {\n\t\t\texpires: 90,\n\t\t\tsameSite: 'strict'\n\t\t});\n\t};\n\n\tAblePlayer.prototype.getCookie = function() {\n\n\t\tvar defaultCookie = {\n\t\t\tpreferences: {},\n\t\t\tsign: {},\n\t\t\ttranscript: {},\n\t\t\tvoices: []\n\t\t};\n\n\t\tvar cookie;\n\t\ttry {\n\t\t\tcookie = JSON.parse(Cookies.get('Able-Player'));\n\t\t}\n\t\tcatch (err) {\n\t\t\t// Original cookie can't be parsed; update to default\n\t\t\tthis.setCookie(defaultCookie);\n\t\t\tcookie = defaultCookie;\n\t\t}\n\t\tif (cookie) {\n\t\t\treturn cookie;\n\t\t}\n\t\telse {\n\t\t\treturn defaultCookie;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.updateCookie = function( setting ) {\n\n\t\t// called when a particular setting had been updated\n\t\t// useful for settings updated indepedently of Preferences dialog\n\t\t// e.g., prefAutoScrollTranscript, which is updated in control.js > handleTranscriptLockToggle()\n\t\t// setting is any supported preference name (e.g., \"prefCaptions\")\n\t\t// OR 'transcript' or 'sign' (not user-defined preferences, used to save position of draggable windows)\n\t\tvar cookie, $window, windowPos, available, i, prefName, voiceLangFound, newVoice;\n\t\tcookie = this.getCookie();\n\t\tif (setting === 'transcript' || setting === 'sign') {\n\t\t\tif (setting === 'transcript') {\n\t\t\t\t$window = this.$transcriptArea;\n\t\t\t\twindowPos = $window.position();\n\t\t\t\tif (typeof cookie.transcript === 'undefined') {\n\t\t\t\t\tcookie.transcript = {};\n\t\t\t\t}\n\t\t\t\tcookie.transcript['position'] = $window.css('position'); // either 'relative' or 'absolute'\n\t\t\t\tcookie.transcript['zindex'] = $window.css('z-index');\n\t\t\t\tcookie.transcript['top'] = windowPos.top;\n\t\t\t\tcookie.transcript['left'] = windowPos.left;\n\t\t\t\tcookie.transcript['width'] = $window.width();\n\t\t\t\tcookie.transcript['height'] = $window.height();\n\t\t\t}\n\t\t\telse if (setting === 'sign') {\n\t\t\t\t$window = this.$signWindow;\n\t\t\t\twindowPos = $window.position();\n\t\t\t\tif (typeof cookie.sign === 'undefined') {\n\t\t\t\t\tcookie.sign = {};\n\t\t\t\t}\n\t\t\t\tcookie.sign['position'] = $window.css('position'); // either 'relative' or 'absolute'\n\t\t\t\tcookie.sign['zindex'] = $window.css('z-index');\n\t\t\t\tcookie.sign['top'] = windowPos.top;\n\t\t\t\tcookie.sign['left'] = windowPos.left;\n\t\t\t\tcookie.sign['width'] = $window.width();\n\t\t\t\tcookie.sign['height'] = $window.height();\n\t\t\t}\n\t\t}\n\t\telse if (setting === 'voice') { \n\t\t\tif (typeof cookie.voices === 'undefined') {\n\t\t\t\tcookie.voices = [];\n\t\t\t}\n\t\t\t// replace preferred voice for this lang in cookie.voices array, if one exists \n\t\t\t// otherwise, add it to the array \n\t\t\tvoiceLangFound = false; \n\t\t\tfor (var v=0; v < cookie.voices.length; v++) { \t\t\t\t\t\t\n\t\t\t\tif (cookie.voices[v].lang === this.prefDescVoiceLang) { \n\t\t\t\t\tvoiceLangFound = true; \n\t\t\t\t\tcookie.voices[v].name = this.prefDescVoice; \n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!voiceLangFound) { \n\t\t\t\t// no voice has been saved yet for this language. Add it to array. \n\t\t\t\tnewVoice = {'name':this.prefDescVoice, 'lang':this.prefDescVoiceLang};\n\t\t\t\tcookie.voices.push(newVoice); \n\t\t\t}\t\t\t\t\t\t\t\t\n\t\t}\n\t\telse {\n\t\t\tavailable = this.getAvailablePreferences();\n\t\t\t// Rebuild cookie with current cookie values,\n\t\t\t// replacing the one value that's been changed\n\t\t\tfor (i = 0; i < available.length; i++) {\n\t\t\t\tprefName = available[i]['name'];\n\t\t\t\tif (prefName == setting) {\n\t\t\t\t\t// this is the one that requires an update\n\t\t\t\t\tcookie.preferences[prefName] = this[prefName];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Save updated cookie\n\t\tthis.setCookie(cookie);\n\t};\n\n\tAblePlayer.prototype.getPreferencesGroups = function() {\n\n\t\t// return array of groups in the order in which they will appear\n\t\t// in the Preferences popup menu\n\t\t// Human-readable label for each group is defined in translation table\n\t\tif (this.usingYouTubeCaptions) {\n\t\t\t// no transcript is possible \n\t\t\treturn ['captions','descriptions','keyboard']; \n\t\t}\n\t\telse if (this.usingVimeoCaptions) { \n\t\t\t// users cannot control caption appearance\n\t\t\t// and no transcript is possible\n\t\t\treturn ['descriptions','keyboard']; \n\t\t}\n\t\telse { \n\t\t\treturn ['captions','descriptions','keyboard','transcript']; \n\t\t} \n\t}\n\n\tAblePlayer.prototype.getAvailablePreferences = function() {\n\n\t\t// Return the list of currently available preferences.\n\t\t// Preferences with no 'label' are set within player, not shown in Prefs dialog\n\t\tvar prefs = [];\n\n\t\t// Modifier keys preferences\n\t\tprefs.push({\n\t\t\t'name': 'prefAltKey', // use alt key with shortcuts\n\t\t\t'label': this.tt.prefAltKey,\n\t\t\t'group': 'keyboard',\n\t\t\t'default': 1\n\t\t});\n\t\tprefs.push({\n\t\t\t'name': 'prefCtrlKey', // use ctrl key with shortcuts\n\t\t\t'label': this.tt.prefCtrlKey,\n\t\t\t'group': 'keyboard',\n\t\t\t'default': 1\n\t\t});\n\t\tprefs.push({\n\t\t\t'name': 'prefShiftKey',\n\t\t\t'label': this.tt.prefShiftKey,\n\t\t\t'group': 'keyboard',\n\t\t\t'default': 0\n\t\t});\n\n\t\t// Transcript preferences\n\t\tprefs.push({\n\t\t\t'name': 'prefTranscript', // transcript default state\n\t\t\t'label': null,\n\t\t\t'group': 'transcript',\n\t\t\t'default': 0 // off because turning it on has a certain WOW factor\n\t\t});\n\t\tprefs.push({\n\t\t\t'name': 'prefHighlight', // highlight transcript as media plays\n\t\t\t'label': this.tt.prefHighlight,\n\t\t\t'group': 'transcript',\n\t\t\t'default': 1 // on because many users can benefit\n\t\t});\n\t\tprefs.push({\n\t\t\t'name': 'prefAutoScrollTranscript',\n\t\t\t'label': null,\n\t\t\t'group': 'transcript',\n\t\t\t'default': 1\n\t\t});\n\t\tprefs.push({\n\t\t\t'name': 'prefTabbable', // tab-enable transcript\n\t\t\t'label': this.tt.prefTabbable,\n\t\t\t'group': 'transcript',\n\t\t\t'default': 0 // off because if users don't need it, it impedes tabbing elsewhere on the page\n\t\t});\n\n\t\t// Caption preferences\n\n\t\tprefs.push({\n\t\t\t'name': 'prefCaptions', // closed captions default state\n\t\t\t'label': null,\n\t\t\t'group': 'captions',\n\t\t\t'default': this.defaultStateCaptions\n\t\t});\n\n\t\tif (!this.usingYouTubeCaptions) {\n\n\t\t\t/* // not supported yet\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefCaptionsStyle',\n\t\t\t\t'label': this.tt.prefCaptionsStyle,\n\t\t\t\t'group': 'captions',\n\t\t\t\t'default': this.tt.captionsStylePopOn\n\t\t\t});\n\t\t\t*/\n\t\t\t// captions are always positioned above the player for audio \n\t\t\tif (this.mediaType === 'video') {\n\t\t\t\tprefs.push({\n\t\t\t\t\t'name': 'prefCaptionsPosition',\n\t\t\t\t\t'label': this.tt.prefCaptionsPosition,\n\t\t\t\t\t'group': 'captions',\n\t\t\t\t\t'default': this.defaultCaptionsPosition\n\t\t\t\t});\n\t\t\t}\t\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefCaptionsFont',\n\t\t\t\t'label': this.tt.prefCaptionsFont,\n\t\t\t\t'group': 'captions',\n\t\t\t\t'default': 'sans-serif'\n\t\t\t});\n\t\t}\n\t\t// This is the one option that is supported by YouTube IFrame API\n\t\tprefs.push({\n\t\t\t'name': 'prefCaptionsSize',\n\t\t\t'label': this.tt.prefCaptionsSize,\n\t\t\t'group': 'captions',\n\t\t\t'default': '100%'\n\t\t});\n\n\t\tif (!this.usingYouTubeCaptions) {\n\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefCaptionsColor',\n\t\t\t\t'label': this.tt.prefCaptionsColor,\n\t\t\t\t'group': 'captions',\n\t\t\t\t'default': 'white'\n\t\t\t});\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefCaptionsBGColor',\n\t\t\t\t'label': this.tt.prefCaptionsBGColor,\n\t\t\t\t'group': 'captions',\n\t\t\t\t'default': 'black'\n\t\t\t});\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefCaptionsOpacity',\n\t\t\t\t'label': this.tt.prefCaptionsOpacity,\n\t\t\t\t'group': 'captions',\n\t\t\t\t'default': '100%'\n\t\t\t});\n\t\t}\n\n\t\tif (this.mediaType === 'video') { \n\t\t\t// Description preferences\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefDesc', // audio description default state\n\t\t\t\t'label': null,\n\t\t\t\t'group': 'descriptions',\n\t\t\t\t'default': this.defaultStateDescriptions\n\t\t\t});\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefDescMethod', // audio description default format (if both 'video' and 'text' are available)\n\t\t\t\t'label': null,\n\t\t\t\t'group': 'descriptions',\n\t\t\t\t'default': 'video' // video (an alternative described version) always wins\n\t\t\t});\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefDescVoice',\n\t\t\t\t'label': this.tt.prefDescVoice,\n\t\t\t\t'group': 'descriptions',\n\t\t\t\t'default': null // will be set later, in injectPrefsForm()\n\t\t\t});\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefDescPitch',\n\t\t\t\t'label': this.tt.prefDescPitch,\n\t\t\t\t'group': 'descriptions',\n\t\t\t\t'default': 1 // 0 to 2\n\t\t\t});\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefDescRate',\n\t\t\t\t'label': this.tt.prefDescRate,\n\t\t\t\t'group': 'descriptions',\n\t\t\t\t'default': 1 // 0.1 to 10 (1 is normal speech; 2 is fast but decipherable; >2 is super fast)\n\t\t\t});\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefDescVolume',\n\t\t\t\t'label': this.tt.volume,\n\t\t\t\t'group': 'descriptions',\n\t\t\t\t'default': 1 // 0 to 1\n\t\t\t});\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefDescPause', // automatically pause when closed description starts\n\t\t\t\t'label': this.tt.prefDescPause,\n\t\t\t\t'group': 'descriptions',\n\t\t\t\t'default': this.defaultDescPause\n\t\t\t});\n\t\t\tprefs.push({\n\t\t\t\t'name': 'prefDescVisible', // visibly show closed description (if avilable and used)\n\t\t\t\t'label': this.tt.prefDescVisible,\n\t\t\t\t'group': 'descriptions',\n\t\t\t\t'default': 0 // off as of 4.3.16, to avoid overloading the player with visible features\n\t\t\t});\n\t\t}\n\t\t// Preferences without a category (not shown in Preferences dialogs)\n\t\tprefs.push({\n\t\t\t'name': 'prefSign', // open sign language window by default if avilable\n\t\t\t'label': null,\n\t\t\t'group': null,\n\t\t\t'default': 0 // off because clicking an icon to see the sign window has a powerful impact\n\t\t});\n\n\t\treturn prefs;\n\t};\n\n\tAblePlayer.prototype.loadCurrentPreferences = function () {\n\n\t\t// Load current/default preferences from cookie into the AblePlayer object.\n\n\t\tvar available = this.getAvailablePreferences();\n\t\tvar cookie = this.getCookie();\n\t\t// Copy current cookie values into this object, and fill in any default values.\n\t\tfor (var ii = 0; ii < available.length; ii++) {\n\t\t\tvar prefName = available[ii]['name'];\n\t\t\tvar defaultValue = available[ii]['default'];\n\t\t\tif (cookie.preferences[prefName] !== undefined) {\n\t\t\t\tthis[prefName] = cookie.preferences[prefName];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcookie.preferences[prefName] = defaultValue;\n\t\t\t\tthis[prefName] = defaultValue;\n\t\t\t}\n\t\t}\n\n\t\t// Also load array of preferred voices from cookie \n\t\tif (typeof cookie.voices !== 'undefined') { \n\t\t\tthis.prefVoices = cookie.voices;  \n\t\t}\t\t\t\n\n\t\tthis.setCookie(cookie);\n\t};\n\n\tAblePlayer.prototype.injectPrefsForm = function (form) {\n\n\t\t// Creates a preferences form and injects it.\n\t\t// form is one of the supported forms (groups) defined in getPreferencesGroups()\n\n\t\tvar thisObj, available, descLangs,\n\t\t\t$prefsDiv, formTitle, introText,\n\t\t\t$prefsIntro,$prefsIntroP2,p3Text,$prefsIntroP3,i, j,\n\t\t\t$fieldset, fieldsetClass, fieldsetId,\n\t\t\t$descFieldset, $descLegend, $legend, legendId,\n\t\t\tthisPref, $thisDiv, thisClass, thisId, $thisLabel, $thisField,\n\t\t\t$div1,id1,$radio1,$label1,\n\t\t\t$div2,id2,$radio2,$label2,\n\t\t\toptions,$thisOption,optionValue,optionLang,optionText,sampleCapsDiv,\n\t\t\tchangedPref,changedSpan,changedText,\n\t\t\tcurrentDescState, prefDescVoice, \n\t\t\t$kbHeading,$kbList,kbLabels,keys,kbListText,$kbListItem,\n\t\t\tdialog,saveButton,cancelButton;\n\n\t\tthisObj = this;\n\t\tavailable = this.getAvailablePreferences();\n\n\t\t// outer container, will be assigned role=\"dialog\"\n\t\t$prefsDiv = $('<div>',{\n\t\t\t'class': 'able-prefs-form '\n\t\t});\n\t\tvar customClass = 'able-prefs-form-' + form;\n\t\t$prefsDiv.addClass(customClass);\n\n\t\t// add titles and intros \n\t\tif (form == 'captions') {\t\t\t\n\t\t\tformTitle = this.tt.prefTitleCaptions;\n\t\t\t// Intro text removed in 4.4.32 to cut down on unnecessary verbiage \n\t\t}\n\t\telse if (form == 'descriptions') {\n\t\t\tformTitle = this.tt.prefTitleDescriptions;\n\t\t\tvar $prefsIntro = $('<p>',{\n\t\t\t\ttext: this.tt.prefIntroDescription1\n\t\t\t});\n\t\t\tvar $prefsIntroUL = $('<ul>');\n\t\t\tvar $prefsIntroLI1 = $('<li>',{\n\t\t\t\ttext: this.tt.prefDescFormatOption1\n\t\t\t});\n\t\t\tvar $prefsIntroLI2 = $('<li>',{\n\t\t\t\ttext: this.tt.prefDescFormatOption2\n\t\t\t});\n\n\t\t\t$prefsIntroUL.append($prefsIntroLI1,$prefsIntroLI2);\n\t\t\tif (this.hasOpenDesc && this.hasClosedDesc) {\n\t\t\t\tcurrentDescState = this.tt.prefIntroDescription2 + ' ';\n\t\t\t\tcurrentDescState += '<strong>' + this.tt.prefDescFormatOption1b + '</strong>';\n\t\t\t\tcurrentDescState += ' <em>' + this.tt.and + '</em> <strong>' + this.tt.prefDescFormatOption2b + '</strong>.';\n\t\t\t}\n\t\t\telse if (this.hasOpenDesc) {\n\t\t\t\tcurrentDescState = this.tt.prefIntroDescription2;\n\t\t\t\tcurrentDescState += ' <strong>' + this.tt.prefDescFormatOption1b + '</strong>.';\n\t\t\t}\n\t\t\telse if (this.hasClosedDesc) {\n\t\t\t\tcurrentDescState = this.tt.prefIntroDescription2;\n\t\t\t\tcurrentDescState += ' <strong>' + this.tt.prefDescFormatOption2b + '</strong>.';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcurrentDescState = this.tt.prefIntroDescriptionNone;\n\t\t\t}\n\t\t\t$prefsIntroP2 = $('<p>',{\n\t\t\t\thtml: currentDescState\n\t\t\t});\n\n\t\t\tp3Text = this.tt.prefIntroDescription3;\n\t\t\tif (this.hasOpenDesc || this.hasClosedDesc) {\n\t\t\t\tp3Text += ' ' + this.tt.prefIntroDescription4;\n\t\t\t}\n\t\t\t$prefsIntroP3 = $('<p>',{\n\t\t\t\ttext: p3Text\n\t\t\t});\n\n\t\t\t$prefsDiv.append($prefsIntro,$prefsIntroUL,$prefsIntroP2,$prefsIntroP3);\n\t\t}\n\t\telse if (form == 'keyboard') {\n\t\t\tformTitle = this.tt.prefTitleKeyboard;\n\t\t\tintroText = this.tt.prefIntroKeyboard1;\n\t\t\tintroText += ' ' + this.tt.prefIntroKeyboard2;\n\t\t\tintroText += ' ' + this.tt.prefIntroKeyboard3;\n\t\t\t$prefsIntro = $('<p>',{\n\t\t\t\ttext: introText\n\t\t\t});\n\t\t\t$prefsDiv.append($prefsIntro);\n\t\t}\n\t\telse if (form == 'transcript') {\n\t\t\tformTitle = this.tt.prefTitleTranscript;\n\t\t\t// Intro text removed in 4.4.32 to cut down on unnecessary verbiage \n\t\t}\n\n\t\t$fieldset = $('<div>').attr('role','group');\t\n\t\tfieldsetClass = 'able-prefs-' + form;\n\t\tfieldsetId = this.mediaId + '-prefs-' + form;\n\t\tlegendId = fieldsetId + '-legend';\n\t\t$fieldset.addClass(fieldsetClass).attr('id',fieldsetId);\n\t\tif (form === 'keyboard') {\n\t\t\t$legend = $('<h2>' + this.tt.prefHeadingKeyboard1 + '</h2>');\n\t\t\t$legend.attr('id',legendId);\n\t\t\t$fieldset.attr('aria-labelledby',legendId);\n\t\t\t$fieldset.append($legend);\n\t\t}\n\t\telse if (form === 'descriptions') {\n\t\t\t$legend = $('<h2>' + this.tt.prefHeadingTextDescription + '</h2>');\n\t\t\t$legend.attr('id',legendId);\n\t\t\t$fieldset.attr('aria-labelledby',legendId);\n\t\t\t$fieldset.append($legend);\n\t\t}\n\t\tfor (i=0; i<available.length; i++) {\n\n\t\t\t// only include prefs on the current form if they have a label\n\t\t\tif ((available[i]['group'] == form) && available[i]['label']) {\n\n\t\t\t\tthisPref = available[i]['name'];\n\t\t\t\tthisClass = 'able-' + thisPref;\n\t\t\t\tthisId = this.mediaId + '_' + thisPref;\n\t\t\t\t$thisDiv = $('<div>').addClass(thisClass);\n\n\t\t\t\tif (form === 'captions') {\n\t\t\t\t\t$thisLabel = $('<label for=\"' + thisId + '\"> ' + available[i]['label'] + '</label>');\n\t\t\t\t\t$thisField = $('<select>',{\n\t\t\t\t\t\tname: thisPref,\n\t\t\t\t\t\tid: thisId,\n\t\t\t\t\t});\n\t\t\t\t\tif (thisPref !== 'prefCaptions' && thisPref !== 'prefCaptionsStyle') {\n\t\t\t\t\t\t// add a change handler that updates the style of the sample caption text\n\t\t\t\t\t\t$thisField.change(function() {\n\t\t\t\t\t\t\tchangedPref = $(this).attr('name');\n\t\t\t\t\t\t\tthisObj.stylizeCaptions(thisObj.$sampleCapsDiv,changedPref);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\toptions = this.getCaptionsOptions(thisPref);\n\t\t\t\t\tfor (j=0; j < options.length; j++) {\n\t\t\t\t\t\tif (thisPref === 'prefCaptionsPosition') {\n\t\t\t\t\t\t\toptionValue = options[j];\n\t\t\t\t\t\t\tif (optionValue === 'overlay') {\n\t\t\t\t\t\t\t\toptionText = this.tt.captionsPositionOverlay;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (optionValue === 'below') {\n\t\t\t\t\t\t\t\toptionValue = options[j];\n\t\t\t\t\t\t\t\toptionText = this.tt.captionsPositionBelow;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (thisPref === 'prefCaptionsFont' || thisPref === 'prefCaptionsColor' || thisPref === 'prefCaptionsBGColor') {\n\t\t\t\t\t\t\toptionValue = options[j][0];\n\t\t\t\t\t\t\toptionText = options[j][1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (thisPref === 'prefCaptionsOpacity') {\n\t\t\t\t\t\t\toptionValue = options[j];\n\t\t\t\t\t\t\toptionText = options[j];\n\t\t\t\t\t\t\tif (optionValue === '0%') {\n\t\t\t\t\t\t\t\toptionText += ' (' + this.tt.transparent + ')';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (optionValue === '100%') {\n\t\t\t\t\t\t\t\toptionText += ' (' + this.tt.solid + ')';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\toptionValue = options[j];\n\t\t\t\t\t\t\toptionText = options[j];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$thisOption = $('<option>',{\n\t\t\t\t\t\t\tvalue: optionValue,\n\t\t\t\t\t\t\ttext: optionText\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (this[thisPref] === optionValue) {\n\t\t\t\t\t\t\t$thisOption.prop('selected',true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$thisField.append($thisOption);\n\t\t\t\t\t}\n\t\t\t\t\t$thisDiv.append($thisLabel,$thisField);\n\t\t\t\t}\n\t\t\t\telse if (form === 'descriptions') {\n\t\t\t\t\t$thisLabel = $('<label for=\"' + thisId + '\"> ' + available[i]['label'] + '</label>');\n\t\t\t\t\tif (thisPref === 'prefDescPause' || thisPref === 'prefDescVisible') {\n\t\t\t\t\t\t// these preferences are checkboxes\n\t\t\t\t\t\t$thisDiv.addClass('able-prefs-checkbox');\n\t\t\t\t\t\t$thisField = $('<input>',{\n\t\t\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\t\t\tname: thisPref,\n\t\t\t\t\t\t\tid: thisId,\n\t\t\t\t\t\t\tvalue: 'true'\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// check current active value for this preference\n\t\t\t\t\t\tif (this[thisPref] === 1) {\n\t\t\t\t\t\t\t$thisField.prop('checked',true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$thisDiv.append($thisField,$thisLabel);\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.synth) {\n\t\t\t\t\t\t// Only show these options if browser supports speech synthesis\n\t\t\t\t\t\t$thisDiv.addClass('able-prefs-select');\n\t\t\t\t\t\t$thisField = $('<select>',{\n\t\t\t\t\t\t\tname: thisPref,\n\t\t\t\t\t\t\tid: thisId,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (thisPref === 'prefDescVoice' && this.descVoices) {\n\t\t\t\t\t\t\tprefDescVoice = this.getPrefDescVoice(); \t\t\t\t\n\t\t\t\t\t\t\tfor (j=0; j < this.descVoices.length; j++) {\n\t\t\t\t\t\t\t\toptionValue = this.descVoices[j].name;\n\t\t\t\t\t\t\t\toptionLang = this.descVoices[j].lang.substring(0,2).toLowerCase(); \n\t\t\t\t\t\t\t\toptionText = optionValue + ' (' + this.descVoices[j].lang + ')';\n\t\t\t\t\t\t\t\t$thisOption = $('<option>',{\n\t\t\t\t\t\t\t\t\t'value': optionValue,\n\t\t\t\t\t\t\t\t\t'data-lang': optionLang,\n\t\t\t\t\t\t\t\t\ttext: optionText\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif (prefDescVoice === optionValue) {\n\t\t\t\t\t\t\t\t\t$thisOption.prop('selected',true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t$thisField.append($thisOption);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.$voiceSelectField = $thisField;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif (thisPref == 'prefDescPitch') { // 0 to 2\n\t\t\t\t\t\t\t\toptions = [0,0.5,1,1.5,2];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (thisPref == 'prefDescRate') { // 0.1 to 10\n\t\t\t\t\t\t\t\t// Tests with a variety of voices on MacOS and Windows\n\t\t\t\t\t\t\t\t// yielded the following choices that seem reasonable for audio description:\n\t\t\t\t\t\t\t\t// 0.5 - too slow (exclude this)\n\t\t\t\t\t\t\t\t// 0.7 - casual\n\t\t\t\t\t\t\t\t// 0.8 - add this\n\t\t\t\t\t\t\t\t// 0.9 - add this\n\t\t\t\t\t\t\t\t// 1 - normal\n\t\t\t\t\t\t\t\t// 1.1 - add this\n\t\t\t\t\t\t\t\t// 1.2 - add this\n\t\t\t\t\t\t\t\t// 1.5 - quick\n\t\t\t\t\t\t\t\t// 2 - speedy\n\t\t\t\t\t\t\t\t// 2.5 - fleet\n\t\t\t\t\t\t\t\t// 3 - fast! (some voices don't get any faster than this\n\n\t\t\t\t\t\t\t\t// Note: if these values are modified, must also modfiy them\n\t\t\t\t\t\t\t\t// in makePrefsValueReadable()\n\t\t\t\t\t\t\t\toptions = [0.7,0.8,0.9,1,1.1,1.2,1.5,2,2.5,3];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (thisPref == 'prefDescVolume') { // 0 (mute) to 1\n\t\t\t\t\t\t\t\toptions = [0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (typeof options !== 'undefined') {\n\t\t\t\t\t\t\t\tfor (j=0; j < options.length; j++) {\n\t\t\t\t\t\t\t\t\toptionValue = options[j];\n\t\t\t\t\t\t\t\t\toptionText = this.makePrefsValueReadable(thisPref,optionValue);\n\t\t\t\t\t\t\t\t\t$thisOption = $('<option>',{\n\t\t\t\t\t\t\t\t\t\tvalue: optionValue,\n\t\t\t\t\t\t\t\t\t\ttext: optionText\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif (this[thisPref] == optionValue) {\n\t\t\t\t\t\t\t\t\t\t$thisOption.prop('selected',true);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t$thisField.append($thisOption);\n\t\t\t\t\t\t\t\t\t$thisDiv.append($thisLabel,$thisField);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// add a change handler that announces the sample description text\n\t\t\t\t\t\t$thisField.on('change',function() {\n\t\t\t\t\t\t\tthisObj.announceDescriptionText('sample',thisObj.currentSampleText);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$thisDiv.append($thisLabel,$thisField);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // all other fields are checkboxes\n\t\t\t\t\t$thisLabel = $('<label for=\"' + thisId + '\"> ' + available[i]['label'] + '</label>');\n\t\t\t\t\t$thisField = $('<input>',{\n\t\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\t\tname: thisPref,\n\t\t\t\t\t\tid: thisId,\n\t\t\t\t\t\tvalue: 'true'\n\t\t\t\t\t});\n\t\t\t\t\t// check current active value for this preference\n\t\t\t\t\tif (this[thisPref] === 1) {\n\t\t\t\t\t\t$thisField.prop('checked',true);\n\t\t\t\t\t}\n\t\t\t\t\tif (form === 'keyboard') {\n\t\t\t\t\t\t// add a change handler that updates the list of current keyboard shortcuts\n\t\t\t\t\t\t$thisField.on('change',function() {\n\t\t\t\t\t\t\tchangedPref = $(this).attr('name');\n\t\t\t\t\t\t\tif (changedPref === 'prefAltKey') {\n\t\t\t\t\t\t\t\tchangedSpan = '.able-modkey-alt';\n\t\t\t\t\t\t\t\tchangedText = thisObj.tt.prefAltKey + ' + ';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (changedPref === 'prefCtrlKey') {\n\t\t\t\t\t\t\t\tchangedSpan = '.able-modkey-ctrl';\n\t\t\t\t\t\t\t\tchangedText = thisObj.tt.prefCtrlKey + ' + ';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (changedPref === 'prefShiftKey') {\n\t\t\t\t\t\t\t\tchangedSpan = '.able-modkey-shift';\n\t\t\t\t\t\t\t\tchangedText = thisObj.tt.prefShiftKey + ' + ';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ($(this).is(':checked')) {\n\t\t\t\t\t\t\t\t$(changedSpan).text(changedText);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$(changedSpan).text('');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t$thisDiv.append($thisField,$thisLabel);\n\t\t\t\t}\n\t\t\t\t$fieldset.append($thisDiv);\n\t\t\t}\n\t\t}\n\t\t$prefsDiv.append($fieldset);\n\n\t\tif (form === 'captions') {\n\t\t\t// add a sample closed caption div to prefs dialog\n\t\t\t// do not show this for YouTube captions, since it's not an accurate reflection\n\t\t\tif (!this.usingYouTubeCaptions) {\n\t\t\t\tthis.$sampleCapsDiv = $('<div>',{\n\t\t\t\t\t'class': 'able-captions-sample'\n\t\t\t\t}).text(this.tt.sampleCaptionText);\n\t\t\t\t$prefsDiv.append(this.$sampleCapsDiv);\n\t\t\t\tthis.stylizeCaptions(this.$sampleCapsDiv);\n\t\t\t}\n\t\t}\n\t\telse if (form === 'descriptions') {\n\t\t\tif (this.synth) {\n\t\t\t\t// add a div with sample audio description text\n\t\t\t\tthis.$sampleDescDiv = $('<div>',{\n\t\t\t\t\t'class': 'able-desc-sample'\n\t\t\t\t}).text(this.tt.sampleDescriptionText);\n\t\t\t\t$prefsDiv.append(this.$sampleDescDiv);\n\t\t\t\tthis.currentSampleText = this.tt.sampleDescriptionText; \n\t\t\t}\n\t\t}\n\t\telse if (form === 'keyboard') {\n\t\t\t// add a current list of keyboard shortcuts\n\t\t\t$kbHeading = $('<h2>',{\n\t\t\t\ttext: this.tt.prefHeadingKeyboard2\n\t\t\t});\n\t\t\t$kbList = $('<ul>');\n\t\t\t// create arrays of kbLabels and keys\n\t\t\tkbLabels = [];\n\t\t\tkeys = [];\n\t\t\tfor (i=0; i<this.controls.length; i++) {\n\t\t\t\tif (this.controls[i] === 'play') {\n\t\t\t\t\tkbLabels.push(this.tt.play + '/' + this.tt.pause);\n\t\t\t\t\tkeys.push('p</span> <em>' + this.tt.or + '</em> <span class=\"able-help-modifiers\"> ' + this.tt.spacebar);\n\t\t\t\t}\n\t\t\t\telse if (this.controls[i] === 'restart') {\n\t\t\t\t\tkbLabels.push(this.tt.restart);\n\t\t\t\t\tkeys.push('s');\n\t\t\t\t}\n\t\t\t\telse if (this.controls[i] === 'previous') {\n\t\t\t\t\tkbLabels.push(this.tt.prevTrack);\n\t\t\t\t\tkeys.push('b'); // b = back\n\t\t\t\t}\n\t\t\t\telse if (this.controls[i] === 'next') {\n\t\t\t\t\tkbLabels.push(this.tt.nextTrack);\n\t\t\t\t\tkeys.push('n');\n\t\t\t\t}\n\t\t\t\telse if (this.controls[i] === 'rewind') {\n\t\t\t\t\tkbLabels.push(this.tt.rewind);\n\t\t\t\t\tkeys.push('r');\n\t\t\t\t}\n\t\t\t\telse if (this.controls[i] === 'forward') {\n\t\t\t\t\tkbLabels.push(this.tt.forward);\n\t\t\t\t\tkeys.push('f');\n\t\t\t\t}\n\t\t\t\telse if (this.controls[i] === 'volume') {\n\t\t\t\t\tkbLabels.push(this.tt.volume);\n\t\t\t\t\tkeys.push('v</span> <em>' + this.tt.or + '</em> <span class=\"able-modkey\">1-9');\n\t\t\t\t\t// mute toggle\n\t\t\t\t\tkbLabels.push(this.tt.mute + '/' + this.tt.unmute);\n\t\t\t\t\tkeys.push('m');\n\t\t\t\t}\n\t\t\t\telse if (this.controls[i] === 'captions') {\n\t\t\t\t\tif (this.captions.length > 1) {\n\t\t\t\t\t\t// caption button launches a Captions popup menu\n\t\t\t\t\t\tkbLabels.push(this.tt.captions);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// there is only one caption track\n\t\t\t\t\t\t// therefore caption button is a toggle\n\t\t\t\t\t\tif (this.captionsOn) {\n\t\t\t\t\t\t\tkbLabels.push(this.tt.hideCaptions);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tkbLabels.push(this.tt.showCaptions);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tkeys.push('c');\n\t\t\t\t}\n\t\t\t\telse if (this.controls[i] === 'descriptions') {\n\t\t\t\t\tif (this.descOn) {\n\t\t\t\t\t\tkbLabels.push(this.tt.turnOffDescriptions);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tkbLabels.push(this.tt.turnOnDescriptions);\n\t\t\t\t\t}\n\t\t\t\t\tkeys.push('d');\n\t\t\t\t}\n\t\t\t\telse if (this.controls[i] === 'prefs') {\n\t\t\t\t\tkbLabels.push(this.tt.preferences);\n\t\t\t\t\tkeys.push('e');\n\t\t\t\t}\n\t\t\t\telse if (this.controls[i] === 'help') {\n\t\t\t\t\tkbLabels.push(this.tt.help);\n\t\t\t\t\tkeys.push('h');\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (i=0; i<keys.length; i++) {\n\t\t\t\t// alt\n\t\t\t\tkbListText = '<span class=\"able-modkey-alt\">';\n\t\t\t\tif (this.prefAltKey === 1) {\n\t\t\t\t\tkbListText += this.tt.prefAltKey + ' + ';\n\t\t\t\t}\n\t\t\t\tkbListText += '</span>';\n\t\t\t\t// ctrl\n\t\t\t\tkbListText += '<span class=\"able-modkey-ctrl\">';\n\t\t\t\tif (this.prefCtrlKey === 1) {\n\t\t\t\t\tkbListText += this.tt.prefCtrlKey + ' + ';\n\t\t\t\t}\n\t\t\t\tkbListText += '</span>';\n\t\t\t\t// shift\n\t\t\t\tkbListText += '<span class=\"able-modkey-shift\">';\n\t\t\t\tif (this.prefShiftKey === 1) {\n\t\t\t\t\tkbListText += this.tt.prefShiftKey + ' + ';\n\t\t\t\t}\n\t\t\t\tkbListText += '</span>';\n\t\t\t\tkbListText += '<span class=\"able-modkey\">' + keys[i] + '</span>';\n\t\t\t\tkbListText += ' = ' + kbLabels[i];\n\t\t\t\t$kbListItem = $('<li>',{\n\t\t\t\t\thtml: kbListText\n\t\t\t\t});\n\t\t\t\t$kbList.append($kbListItem);\n\t\t\t}\n\t\t\t// add Escape key\n\t\t\tkbListText = '<span class=\"able-modkey\">' + this.tt.escapeKey + '</span>';\n\t\t\tkbListText += ' = ' + this.tt.escapeKeyFunction;\n\t\t\t$kbListItem = $('<li>',{\n\t\t\t\thtml: kbListText\n\t\t\t});\n\t\t\t$kbList.append($kbListItem);\n\t\t\t// put it all together\n\t\t\t$prefsDiv.append($kbHeading,$kbList);\n\t\t}\n\n\t\t// $prefsDiv (dialog) must be appended to the BODY!\n\t\t// otherwise when aria-hidden=\"true\" is applied to all background content\n\t\t// that will include an ancestor of the dialog,\n\t\t// which will render the dialog unreadable by screen readers\n\t\t$('body').append($prefsDiv);\n\t\tdialog = new AccessibleDialog($prefsDiv, this.$prefsButton, 'dialog', true, formTitle, $prefsIntro, thisObj.tt.closeButtonLabel, '32em');\n\n\t\t// Add save and cancel buttons.\n\t\t$prefsDiv.append('<hr>');\n\t\tsaveButton = $('<button class=\"modal-button\">' + this.tt.save + '</button>');\n\t\tcancelButton = $('<button class=\"modal-button\">' + this.tt.cancel + '</button>');\n\t\tsaveButton.click(function () {\n\t\t\tdialog.hide();\n\t\t\tthisObj.savePrefsFromForm();\n\t\t});\n\t\tcancelButton.click(function () {\n\t\t\tdialog.hide();\n\t\t\tthisObj.resetPrefsForm();\n\t\t});\n\n\t\t$prefsDiv.append(saveButton);\n\t\t$prefsDiv.append(cancelButton);\n\n\t\t// Associate the dialog's H1 as aria-labelledby for groups of fields\n\t\t// (alternative to fieldset and legend) \n\t\tif (form === 'captions' || form === 'transcript') { \n\t\t\t$fieldset.attr('aria-labelledby',dialog.titleH1.attr('id')); \n\t\t}\n\n\t\t// add global reference for future control\n\t\tif (form === 'captions') {\n\t\t\tthis.captionPrefsDialog = dialog;\n\t\t}\n\t\telse if (form === 'descriptions') {\n\t\t\tthis.descPrefsDialog = dialog;\n\t\t}\n\t\telse if (form === 'keyboard') {\n\t\t\tthis.keyboardPrefsDialog = dialog;\n\t\t}\n\t\telse if (form === 'transcript') {\n\t\t\tthis.transcriptPrefsDialog = dialog;\n\t\t}\n\n\t\t// Add click handler for dialog close button\n\t\t// (button is added in dialog.js)\n\t\t$('div.able-prefs-form button.modalCloseButton').click(function() {\n\t\t\tthisObj.resetPrefsForm();\n\t\t})\n\t\t// Add handler for escape key\n\t\t$('div.able-prefs-form').keydown(function(e) {\n\t\t\tif (e.which === 27) { // escape\n\t\t\t\tthisObj.resetPrefsForm();\n\t\t\t}\n\t\t});\n\t};\n\n\tAblePlayer.prototype.getPrefDescVoice = function () {\n\n\t\t// return user's preferred voice for the current language from cookie.voices \n\t\tvar lang, cookie, i; \n\n\t\tif (this.selectedDescriptions) { \n\t\t\tlang = this.selectedDescriptions.language; \n\t\t}\n\t\telse if (this.captionLang) { \n\t\t\tlang = this.captionLang; \n\t\t}\n\t\telse { \n\t\t\tlang = this.lang; \n\t\t}\n\t\tcookie = this.getCookie(); \n\t\tif (cookie.voices) { \n\t\t\tfor (i=0; i < cookie.voices.length; i++) { \n\t\t\t\tif (cookie.voices[i].lang === lang) { \t\t\t\t\t\n\t\t\t\t\treturn cookie.voices[i].name; \n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null; // user has no saved preference\n\t}\n\n\tAblePlayer.prototype.rebuildDescPrefsForm = function () {\n\n\t\t// Called if this.descVoices changes, which may happen if: \n\t\t//  getBrowserVoices() succeeds after an earlier failure \n\t\t//  user changes language of captions/subtitles and descVoices changes to match the new language \n\n\t\tvar i, optionValue, optionText, $thisOption;\n\n\t\tthis.$voiceSelectField = $('#' + this.mediaId + '_prefDescVoice');\n\t\tthis.$voiceSelectField.empty();\n\t\tfor (i=0; i < this.descVoices.length; i++) {\n\t\t\toptionValue = this.descVoices[i].name;\n\t\t\toptionText = optionValue + ' (' + this.descVoices[i].lang + ')';\n\t\t\t$thisOption = $('<option>',{\n\t\t\t\t'value': optionValue,\n\t\t\t\t'data-lang': this.descVoices[i].lang.substring(0,2).toLowerCase(),\n\t\t\t\ttext: optionText\n\t\t\t});\n\t\t\tif (this.prefDescVoice == optionValue) {\n\t\t\t\t$thisOption.prop('selected',true);\n\t\t\t}\n\t\t\tthis.$voiceSelectField.append($thisOption);\n\t\t}\n\t};\n\n\t AblePlayer.prototype.makePrefsValueReadable = function(pref,value) {\n\n\t\t // The values for pitch, rate, and volume (web speech API)\n\t\t // are strange and inconsistent between variables\n\t\t // this function returns text that is more readable than the values themselves\n\n\t\t if (pref === 'prefDescPitch') {\n\t\t\t if (value === 0) {\n\t\t\t\t return this.tt.prefDescPitch1;\n\t\t\t }\n\t\t\t else if (value === 0.5) {\n\t\t\t\t return this.tt.prefDescPitch2;\n\t\t\t }\n\t\t\t else if (value === 1) {\n\t\t\t\t return this.tt.prefDescPitch3;\n\t\t\t }\n\t\t\t else if (value === 1.5) {\n\t\t\t\t return this.tt.prefDescPitch4;\n\t\t\t }\n\t\t\t else if (value === 2) {\n\t\t\t\t return this.tt.prefDescPitch5;\n\t\t\t }\n\t\t }\n\t\t else if (pref === 'prefDescRate') {\n\t\t\t // default in the API is 0.1 to 10, where 1 is normal speaking voice\n\t\t\t // our custom range offers several rates close to 1\n\t\t\t // plus a couple of crazy fast ones for sport\n\t\t\t // Our more readable options (1-10) or mapped here to API values \n\t\t\t if (value === 0.7) {\n\t\t\t\t return 1;\n\t\t\t }\n\t\t\t else if (value === 0.8) {\n\t\t\t\t return 2;\n\t\t\t }\n\t\t\t else if (value === 0.9) {\n\t\t\t\t return 3;\n\t\t\t }\n\t\t\t else if (value === 1) {\n\t\t\t\t return 4;\n\t\t\t }\n\t\t\t else if (value === 1.1) {\n\t\t\t\t return 5;\n\t\t\t }\n\t\t\t else if (value === 1.2) {\n\t\t\t\t return 6;\n\t\t\t }\n\t\t\t else if (value === 1.5) {\n\t\t\t\t return 7;\n\t\t\t }\n\t\t\t else if (value === 2) {\n\t\t\t\t return 8;\n\t\t\t }\n\t\t\t else if (value === 2.5) {\n\t\t\t\t return 9;\n\t\t\t }\n\t\t\t else if (value === 3) {\n\t\t\t\t return 10;\n\t\t\t }\n\t\t }\n\t\t else if (pref === 'prefDescVolume') {\n\t\t\t // values range from 0.1 to 1.0\n\t\t\t return value * 10;\n\t\t }\n\t\t return value;\n\t };\n\n\t AblePlayer.prototype.resetPrefsForm = function () {\n\n\t\t // Reset preferences form with default values from cookie\n\t\t // Called when:\n\t\t // User clicks cancel or close button in Prefs Dialog\n\t\t // User presses Escape to close Prefs dialog\n\t\t // User clicks Save in Prefs dialog, & there's more than one player on page\n\n\t\t var thisObj, cookie, available, i, prefName, prefId, thisDiv, thisId;\n\n\t\t thisObj = this;\n\t\t cookie = this.getCookie();\n\t\t available = this.getAvailablePreferences();\n\t\t for (i=0; i<available.length; i++) {\n\t\t\t prefName = available[i]['name'];\n\t\t\t prefId = this.mediaId + '_' + prefName;\n\t\t\t if ((prefName.indexOf('Captions') !== -1) && (prefName !== 'prefCaptions')) {\n\t\t\t\t // this is a caption-related select box\n\t\t\t\t $('select[name=\"' + prefName + '\"]').val(cookie.preferences[prefName]);\n\t\t\t }\n\t\t\t else { // all others are checkboxes\n\t\t\t\t if (this[prefName] === 1) {\n\t\t\t\t\t $('input[name=\"' + prefName + '\"]').prop('checked',true);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$('input[name=\"' + prefName + '\"]').prop('checked',false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// also restore style of sample caption div\n\t\t\tthis.stylizeCaptions(this.$sampleCapsDiv);\n\t };\n\n\tAblePlayer.prototype.savePrefsFromForm = function () {\n\n\t\t// Return a prefs object constructed from the form.\n\t\t// called when user saves the Preferences form\n\t\t// update cookie with new value\n\t\tvar cookie, available, prefName, prefId, \n\t\t\tvoiceSelectId, newVoice, newVoiceLang, numChanges, voiceLangFound, \n\t\t\tnumCapChanges, capSizeChanged, capSizeValue, newValue;\n\n\t\tnumChanges = 0;\n\t\tnumCapChanges = 0; // changes to caption-style-related preferences\n\t\tcapSizeChanged = false;\n\t\tcookie = this.getCookie();\n\t\tavailable = this.getAvailablePreferences();\n\t\tfor (var i=0; i < available.length; i++) {\n\t\t\t// only prefs with labels are used in the Prefs form\n\t\t\tif (available[i]['label']) {\n\t\t\t\tprefName = available[i]['name'];\n\t\t\t\tprefId = this.mediaId + '_' + prefName;\n\t\t\t\tif (prefName === 'prefDescVoice') { \n\t\t\t\t\tif (typeof cookie.voices === 'undefined') {\n\t\t\t\t\t\tcookie.voices = [];\n\t\t\t\t\t}\n\t\t\t\t\tvoiceSelectId = this.mediaId + '_prefDescVoice';\n\t\t\t\t\tthis.prefDescVoice = $('select#' + voiceSelectId).find(':selected').val();\n\t\t\t\t\tthis.prefDescVoiceLang = $('select#' + voiceSelectId).find(':selected').attr('data-lang');\n\t\t\t\t\t// replace preferred voice for this lang in cookie.voices array, if one exists \n\t\t\t\t\t// otherwise, add it to the array \n\t\t\t\t\tvoiceLangFound = false; \n\t\t\t\t\tfor (var v=0; v < cookie.voices.length; v++) { \t\t\t\t\t\t\n\t\t\t\t\t\tif (cookie.voices[v].lang === this.prefDescVoiceLang) { \n\t\t\t\t\t\t\tvoiceLangFound = true; \n\t\t\t\t\t\t\tcookie.voices[v].name = this.prefDescVoice; \n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!voiceLangFound) { \n\t\t\t\t\t\t// no voice has been saved yet for this language. Add it to array. \n\t\t\t\t\t\tnewVoice = {'name':this.prefDescVoice, 'lang':this.prefDescVoiceLang};\n\t\t\t\t\t\tcookie.voices.push(newVoice); \n\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t\tnumChanges++; \n\t\t\t\t}\n\t\t\t\telse if (prefName == 'prefDescMethod') {\n\t\t\t\t\t// As of v4.0.10, prefDescMethod is no longer a choice\n\t\t\t\t\t// this.prefDescMethod = $('input[name=\"' + prefName + '\"]:checked').val();\n\t\t\t\t\tthis.prefDescMethod = 'video';\n\t\t\t\t\tif (this.prefDescMethod !== cookie.preferences['prefDescMethod']) { // user's preference has changed\n\t\t\t\t\t\tcookie.preferences['prefDescMethod'] = this.prefDescMethod;\n\t\t\t\t\t\tnumChanges++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if ((prefName.indexOf('Captions') !== -1) && (prefName !== 'prefCaptions')) {\n\t\t\t\t\t// this is one of the caption-related select fields\n\t\t\t\t\tnewValue = $('select[id=\"' + prefId + '\"]').val();\n\t\t\t\t\tif (cookie.preferences[prefName] !== newValue) { // user changed setting\n\t\t\t\t\t\tcookie.preferences[prefName] = newValue;\n\t\t\t\t\t\t// also update global var for this pref (for caption fields, not done elsewhere)\n\t\t\t\t\t\tthis[prefName] = newValue;\n\t\t\t\t\t\tnumChanges++;\n\t\t\t\t\t\tnumCapChanges++;\n\t\t\t\t\t}\n\t\t\t\t\tif (prefName === 'prefCaptionsSize') {\n\t\t\t\t\t\tcapSizeChanged = true;\n\t\t\t\t\t\tcapSizeValue = newValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if ((prefName.indexOf('Desc') !== -1) && (prefName !== 'prefDescPause') && prefName !== 'prefDescVisible') {\n\t\t\t\t\t// this is one of the description-related select fields\n\t\t\t\t\tnewValue = $('select[id=\"' + prefId + '\"]').val();\n\t\t\t\t\tif (cookie.preferences[prefName] !== newValue) { // user changed setting\n\t\t\t\t\t\tcookie.preferences[prefName] = newValue;\n\t\t\t\t\t\t// also update global var for this pref\n\t\t\t\t\t\tthis[prefName] = newValue;\n\t\t\t\t\t\tnumChanges++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // all other fields are checkboxes\n\t\t\t\t\tif ($('input[id=\"' + prefId + '\"]').is(':checked')) {\n\t\t\t\t\t\tcookie.preferences[prefName] = 1;\n\t\t\t\t\t\tif (this[prefName] === 1) {\n\t\t\t\t\t\t\t// nothing has changed\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// user has just turned this pref on\n\t\t\t\t\t\t\tthis[prefName] = 1;\n\t\t\t\t\t\t\tnumChanges++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse { // thisPref is not checked\n\t\t\t\t\t\tcookie.preferences[prefName] = 0;\n\t\t\t\t\t\tif (this[prefName] === 1) {\n\t\t\t\t\t\t\t// user has just turned this pref off\n\t\t\t\t\t\t\tthis[prefName] = 0;\n\t\t\t\t\t\t\tnumChanges++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// nothing has chaged\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (numChanges > 0) {\n\t\t\tthis.setCookie(cookie);\n\t\t\tthis.showAlert(this.tt.prefSuccess);\n\t\t}\n\t\telse {\n\t\t\tthis.showAlert(this.tt.prefNoChange);\n\t\t}\n\t\tif (this.player === 'youtube' &&\n\t\t\t(typeof this.usingYouTubeCaptions !== 'undefined' && this.usingYouTubeCaptions) &&\n\t\t\tcapSizeChanged) {\n\t\t\t\t// update font size of YouTube captions\n\t\t\t\tthis.youTubePlayer.setOption('captions','fontSize',this.translatePrefs('size',capSizeValue,'youtube'));\n\t\t}\n\t\tif (AblePlayerInstances.length > 1) {\n\t\t\t// there are multiple players on this page.\n\t\t\t// update prefs for ALL of them\n\t\t\tfor (var i=0; i<AblePlayerInstances.length; i++) {\n\t\t\t\tAblePlayerInstances[i].updatePrefs();\n\t\t\t\tAblePlayerInstances[i].geteferences();\n\t\t\t\tAblePlayerInstances[i].resetPrefsForm();\n\t\t\t\tif (numCapChanges > 0) {\n\t\t\t\t\tAblePlayerInstances[i].stylizeCaptions(AblePlayerInstances[i].$captionsDiv);\n\t\t\t\t\t// also apply same changes to descriptions, if present\n\t\t\t\t\tif (typeof AblePlayerInstances[i].$descDiv !== 'undefined') {\n\t\t\t\t\t\tAblePlayerInstances[i].stylizeCaptions(AblePlayerInstances[i].$descDiv);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// there is only one player\n\t\t\tthis.updatePrefs();\n\t\t\tif (numCapChanges > 0) {\n\t\t\t\tthis.stylizeCaptions(this.$captionsDiv);\n\t\t\t\t// also apply same changes to descriptions, if present\n\t\t\t\tif (typeof this.$descDiv !== 'undefined') {\n\t\t\t\t\tthis.stylizeCaptions(this.$descDiv);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tAblePlayer.prototype.updatePrefs = function () {\n\n\t\t// Update player based on current prefs. Safe to call multiple times.\n\n\t\tif (this.$transcriptDiv) { \n\t\t\t// tabbable transcript\n\t\t\tif (this.prefTabbable === 1) {\n\t\t\t\tthis.$transcriptDiv.find('span.able-transcript-seekpoint').attr('tabindex','0');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.$transcriptDiv.find('span.able-transcript-seekpoint').removeAttr('tabindex');\n\t\t\t}\n\n\t\t\t// transcript highlights\n\t\t\tif (this.prefHighlight === 0) {\n\t\t\t\t// user doesn't want highlights; remove any existing highlights\n\t\t\t\tthis.$transcriptDiv.find('span').removeClass('able-highlight');\n\t\t\t}\n\t\t}\n\n\t\t// Re-initialize caption and description in case relevant settings have changed\n\t\tthis.updateCaption();\n\t\tthis.initDescription();\n\t};\n\n\tAblePlayer.prototype.usingModifierKeys = function(e) {\n\n\t\t// return true if user is holding down required modifier keys\n\t\tif ((this.prefAltKey === 1) && !e.altKey) {\n\t\t\treturn false;\n\t\t}\n\t\tif ((this.prefCtrlKey === 1) && !e.ctrlKey) {\n\t\t\treturn false;\n\t\t}\n\t\tif ((this.prefShiftKey === 1) && !e.shiftKey) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t};\n\n})(jQuery);\n\n(function ($) {\n\t// See section 4.1 of dev.w3.org/html5/webvtt for format details.\n\tAblePlayer.prototype.parseWebVTT = function(srcFile,text) {\n\n//\t\tvar deferred = new $.Deferred();\n//\t\tvar promise = deferred.promise();\n\n\t\t// Normalize line ends to \\n.\n\t\ttext = text.replace(/(\\r\\n|\\n|\\r)/g,'\\n');\n\n\t\tvar parserState = {\n\t\t\tsrc: srcFile,\n\t\t\ttext: text,\n\t\t\terror: null,\n\t\t\tmetadata: {},\n\t\t\tcues: [],\n\t\t\tline: 1,\n\t\t\tcolumn: 1\n\t\t};\n\n\t\ttry {\n\t\t\tact(parserState, parseFileBody);\n\t\t}\n\t\tcatch (err) {\n\t\t\tvar errString = 'Invalid WebVTT file: ' + parserState.src + '\\n';\n\t\t\terrString += 'Line: ' + parserState.line + ', ';\n\t\t\terrString += 'Column: ' + parserState.column + '\\n';\n\t\t\terrString += err;\n\t\t\tif (console.warn) {\n\t\t\t\tconsole.warn(errString);\n\t\t\t}\n\t\t\telse if (console.log) {\n\t\t\t\tconsole.log(errString);\n\t\t\t}\n\t\t}\n\t\treturn parserState;\n\t}\n\n\tfunction actList(state, list) {\n\t\tvar results = [];\n\t\tfor (var ii = 0; ii < list.length; ii++) {\n\t\t\tresults.push(act(state, list[ii]));\n\t\t}\n\t\treturn results;\n\t}\n\n\t// Applies the action and checks for errors.\n\tfunction act(state, action) {\n\t\tvar val = action(state);\n\t\tif (state.error !== null) {\n\t\t\tthrow state.error;\n\t\t}\n\t\treturn val;\n\t}\n\n\tfunction updatePosition(state, cutText) {\n\t\tfor (var ii = 0; ii < cutText.length; ii++) {\n\t\t\tif (cutText[ii] === '\\n') {\n\t\t\t\tstate.column = 1;\n\t\t\t\tstate.line += 1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstate.column += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction cut(state, length) {\n\t\tvar returnText = state.text.substring(0, length);\n\t\tupdatePosition(state, returnText);\n\t\tstate.text = state.text.substring(length);\n\t\treturn returnText;\n\t}\n\n\tfunction cutLine(state, length) {\n\t\tvar nextEOL = state.text.indexOf('\\n');\n\t\tvar returnText;\n\t\tif (nextEOL === -1) {\n\t\t\treturnText = state.text;\n\t\t\tupdatePosition(state, returnText);\n\t\t\tstate.text = '';\n\t\t}\n\t\telse {\n\t\t\treturnText = state.text.substring(0, nextEOL);\n\t\t\tupdatePosition(state, returnText + '\\n');\n\t\t\tstate.text = state.text.substring(nextEOL + 1);\n\t\t}\n\t\treturn returnText;\n\t}\n\n\tfunction peekLine(state) {\n\t\tvar nextEOL = state.text.indexOf('\\n');\n\t\tif (nextEOL === -1) {\n\t\t\treturn state.text;\n\t\t}\n\t\telse {\n\t\t\treturn state.text.substring(0, nextEOL);\n\t\t}\n\t}\n\n\tfunction parseFileBody(state) {\n\t\tactList(state, [\n\t\t\teatOptionalBOM,\n\t\t\teatSignature]);\n\t\tvar c = state.text[0];\n\t\tif (c === ' ' || c === '\\t' || c === '\\n') {\n\t\t\tactList(state, [\n\t\t\t\teatUntilEOLInclusive,\n\t\t\t\tparseMetadataHeaders,\n\t\t\t\teatAtLeast1EmptyLines,\n\t\t\t\tparseCuesAndComments]);\n\t\t}\n\t\telse {\n\t\t\tstate.error = \"WEBVTT signature not followed by whitespace.\";\n\t\t}\n\t}\n\n\t// Parses all metadata headers until a cue is discovered.\n\tfunction parseMetadataHeaders(state) {\n\t\twhile (true) {\n\t\t\tvar nextLine = peekLine(state);\n\t\t\tif (nextLine.indexOf('-->') !== -1) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if (nextLine.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar keyValue = act(state, getMetadataKeyValue);\n\t\t\t\tstate.metadata[keyValue[0]] = keyValue[1];\n\t\t\t\tact(state, eatUntilEOLInclusive);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction nextSpaceOrNewline(s) {\n\t\tvar possible = [];\n\t\tvar spaceIndex = s.indexOf(' ');\n\t\tif (spaceIndex >= 0) {\n\t\t\tpossible.push(spaceIndex);\n\t\t}\n\t\tvar tabIndex = s.indexOf('\\t');\n\t\tif (tabIndex >= 0) {\n\t\t\tpossible.push(tabIndex);\n\t\t}\n\t\tvar lineIndex = s.indexOf('\\n');\n\t\tif (lineIndex >= 0) {\n\t\t\tpossible.push(lineIndex);\n\t\t}\n\n\t\treturn Math.min.apply(null, possible);\n\t}\n\n\tfunction getMetadataKeyValue(state) {\n\t\tvar next = state.text.indexOf('\\n');\n\t\tvar pair = cut(state, next);\n\t\tvar colon = pair.indexOf(':');\n\t\tif (colon === -1) {\n\t\t\tstate.error = 'Missing colon.';\n\t\t\treturn;\n\t\t}\n\t\telse {\n\t\t\tvar pairName = pair.substring(0, colon);\n\t\t\tvar pairValue = pair.substring(colon + 1);\n\t\t\treturn [pairName, pairValue];\n\t\t}\n\t}\n\n\tfunction getSettingsKeyValue(state) {\n\t\tvar next = nextSpaceOrNewline(state.text);\n\t\tvar pair = cut(state, next);\n\t\tvar colon = pair.indexOf(':');\n\t\tif (colon === -1) {\n\t\t\tstate.error = 'Missing colon.';\n\t\t\treturn;\n\t\t}\n\t\telse {\n\t\t\tvar pairName = pair.substring(0, colon);\n\t\t\tvar pairValue = pair.substring(colon + 1);\n\t\t\treturn [pairName, pairValue];\n\t\t}\n\t}\n\n\tfunction parseCuesAndComments(state) {\n\t\twhile (true) {\n\t\t\tvar nextLine = peekLine(state);\n\t\t\t// If NOTE is not on a line all its own, it must be followed by a space or tab.\n\t\t\tif (nextLine.indexOf('NOTE') === 0 && ((nextLine.length === 4) || (nextLine[4] === ' ') || (nextLine[4] === '\\t'))) {\n\t\t\t\tactList(state, [eatComment, eatEmptyLines]);\n\t\t\t}\n\t\t\telse if ($.trim(nextLine).length === 0 && state.text.length > 0) {\n\t\t\t\tact(state, eatEmptyLines);\n\t\t\t}\n\t\t\telse if ($.trim(nextLine).length > 0) {\n\t\t\t\tact(state, parseCue);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Everythings parsed!\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction parseCue(state) {\n\n\t\tvar nextLine = peekLine(state);\n\t\tvar cueId;\n\t\tvar errString;\n\n\t\tif(nextLine.indexOf('-->') === -1) {\n\t\t\tcueId = cutLine(state);\n\t\t\tnextLine = peekLine(state);\n\t\t\tif(nextLine.indexOf('-->') === -1) {\n\t\t\t\terrString = 'Invalid WebVTT file: ' + state.src + '\\n';\n\t\t\t\terrString += 'Line: ' + state.line + ', ';\n\t\t\t\terrString += 'Column: ' + state.column + '\\n';\n\t\t\t\terrString += 'Expected cue timing for cueId \\''+cueId+'\\' but found: ' + nextLine + '\\n';\n\t\t\t\tif (console.warn) {\n\t\t\t\t\tconsole.warn(errString);\n\t\t\t\t}\n\t\t\t\telse if (console.log) {\n\t\t\t\t\tconsole.log(errString);\n\t\t\t\t}\n\t\t\t\treturn; // Return leaving line for parseCuesAndComments to handle\n\t\t\t}\n\t\t}\n\n\t\tvar cueTimings = actList(state, [getTiming,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t eatAtLeast1SpacesOrTabs,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t eatArrow,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t eatAtLeast1SpacesOrTabs,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t getTiming]);\n\n\t\tvar startTime = cueTimings[0];\n\t\tvar endTime = cueTimings[4];\n\t\tif (startTime >= endTime) {\n\t\t\tstate.error = 'Start time is not sooner than end time.';\n\t\t\treturn;\n\t\t}\n\n\t\tact(state, eatSpacesOrTabs);\n\t\tvar cueSettings = act(state, getCueSettings);\n\t\t// Cut the newline.\n\t\tcut(state, 1);\n\t\tvar components = act(state, getCuePayload);\n\n\t\tif (typeof cueId === 'undefined') {\n\t\t\tcueId = state.cues.length + 1;\n\t\t}\n\t\tstate.cues.push({\n\t\t\tid: cueId,\n\t\t\tstart: startTime,\n\t\t\tend: endTime,\n\t\t\tsettings: cueSettings,\n\t\t\tcomponents: components\n\t\t});\n\t}\n\n\tfunction getCueSettings(state) {\n\t\tvar cueSettings = {};\n\t\twhile (state.text.length > 0 && state.text[0] !== '\\n') {\n\t\t\tvar keyValue = act(state, getSettingsKeyValue);\n\t\t\tcueSettings[keyValue[0]] = keyValue[1];\n\t\t\tact(state, eatSpacesOrTabs);\n\t\t}\n\t\treturn cueSettings;\n\t}\n\n\tfunction getCuePayload(state) {\n\t\t// Parser based on instructions in draft.\n\t\tvar result = {type: 'internal', tagName: '', value: '', classes: [], annotation: '', parent: null, children: [], language: ''};\n\t\tvar current = result;\n\t\tvar languageStack = [];\n\t\twhile (state.text.length > 0) {\n\t\t\tvar nextLine = peekLine(state);\n\t\t\tif (nextLine.indexOf('-->') !== -1 || /^\\s+$/.test(nextLine)) {\n\t\t\t\tbreak; // Handle empty cues\n\t\t\t}\n\t\t\t// Have to separately detect double-lines ending cue due to our non-standard parsing.\n\t\t\t// TODO: Redo outer algorithm to conform to W3 spec?\n\t\t\tif (state.text.length >= 2 && state.text[0] === '\\n' && state.text[1] === '\\n') {\n\t\t\t\tcut(state, 2);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvar token = getCueToken(state);\n\t\t\t// We'll use the tokens themselves as objects where possible.\n\t\t\tif (token.type === 'string') {\n\t\t\t\tcurrent.children.push(token);\n\t\t\t}\n\t\t\telse if (token.type === 'startTag') {\n\t\t\t\ttoken.type = token.tagName;\n\t\t\t\t// Define token.parent; added by Terrill to fix bug end 'endTag' loop\n\t\t\t\ttoken.parent = current;\n\t\t\t\tif ($.inArray(token.tagName, ['i', 'b', 'u', 'ruby']) !== -1) {\n\t\t\t\t\tif (languageStack.length > 0) {\n\t\t\t\t\t\tcurrent.language = languageStack[languageStack.length - 1];\n\t\t\t\t\t}\n\t\t\t\t\tcurrent.children.push(token);\n\t\t\t\t\tcurrent = token;\n\t\t\t\t}\n\t\t\t\telse if (token.tagName === 'rt' && current.tagName === 'ruby') {\n\t\t\t\t\tif (languageStack.length > 0) {\n\t\t\t\t\t\tcurrent.language = languageStack[languageStack.length - 1];\n\t\t\t\t\t}\n\t\t\t\t\tcurrent.children.push(token);\n\t\t\t\t\tcurrent = token;\n\t\t\t\t}\n\t\t\t\telse if (token.tagName === 'c') {\n\t\t\t\t\ttoken.value = token.annotation;\n\t\t\t\t\tif (languageStack.length > 0) {\n\t\t\t\t\t\tcurrent.language = languageStack[languageStack.length - 1];\n\t\t\t\t\t}\n\t\t\t\t\tcurrent.children.push(token);\n\t\t\t\t\tcurrent = token;\n\t\t\t\t}\n\t\t\t\telse if (token.tagName === 'v') {\n\t\t\t\t\ttoken.value = token.annotation;\n\t\t\t\t\tif (languageStack.length > 0) {\n\t\t\t\t\t\tcurrent.language = languageStack[languageStack.length - 1];\n\t\t\t\t\t}\n\t\t\t\t\tcurrent.children.push(token);\n\t\t\t\t\tcurrent = token;\n\t\t\t\t}\n\t\t\t\telse if (token.tagName === 'lang') {\n\t\t\t\t\tlanguageStack.push(token.annotation);\n\t\t\t\t\tif (languageStack.length > 0) {\n\t\t\t\t\t\tcurrent.language = languageStack[languageStack.length - 1];\n\t\t\t\t\t}\n\t\t\t\t\tcurrent.children.push(token);\n\t\t\t\t\tcurrent = token;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (token.type === 'endTag') {\n\t\t\t\tif (token.tagName === current.type && $.inArray(token.tagName, ['c', 'i', 'b', 'u', 'ruby', 'rt', 'v']) !== -1) {\n\t\t\t\t\t// NOTE from Terrill: This was resulting in an error because current.parent was undefined\n\t\t\t\t\t// Fixed (I think) by assigning current token to token.parent in 'startTag' loop\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t\telse if (token.tagName === 'lang' && current.type === 'lang') {\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t\tlanguageStack.pop();\n\t\t\t\t}\n\t\t\t\telse if (token.tagName === 'ruby' && current.type === 'rt') {\n\t\t\t\t\tcurrent = current.parent.parent;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (token.type === 'timestampTag') {\n\t\t\t\tvar tempState = {\n\t\t\t\t\ttext: token.value,\n\t\t\t\t\terror: null,\n\t\t\t\t\tmetadata: {},\n\t\t\t\t\tcues: [],\n\t\t\t\t\tline: 1,\n\t\t\t\t\tcolumn: 1\n\t\t\t\t};\n\t\t\t\ttry {\n\t\t\t\t\tvar timing = act(tempState, getTiming);\n\t\t\t\t\tif (tempState.text.length === 0) {\n\t\t\t\t\t\ttoken.value = timing;\n\t\t\t\t\t\tcurrent.push(token);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcatch (err) {\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\t// Gets a single cue token; uses the method in the w3 specification.\n\tfunction getCueToken(state) {\n\t\tvar tokenState = 'data';\n\t\tvar result = [];\n\t\tvar buffer = '';\n\t\tvar token = {type: '', tagName: '', value: '', classes: [], annotation: '', children: []}\n\n\t\twhile (true) {\n\t\t\tvar c;\n\t\t\t// Double newlines indicate end of token.\n\t\t\tif (state.text.length >= 2 && state.text[0] === '\\n' && state.text[1] === '\\n') {\n\t\t\t\tc = '\\u0004';\n\t\t\t}\n\t\t\telse if (state.text.length > 0) {\n\t\t\t\tc = state.text[0];\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// End of file.\n\t\t\t\tc = '\\u0004';\n\t\t\t}\n\t\t\tif (tokenState === 'data') {\n\t\t\t\tif (c === '&') {\n\t\t\t\t\tbuffer = '&';\n\t\t\t\t\ttokenState = 'escape';\n\t\t\t\t}\n\t\t\t\telse if (c === '<') {\n\t\t\t\t\tif (result.length === 0) {\n\t\t\t\t\t\ttokenState = 'tag';\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\ttoken.type = 'string';\n\t\t\t\t\t\ttoken.value = result.join('');\n\t\t\t\t\t\treturn token;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (c === '\\u0004') {\n\t\t\t\t\treturn {type: 'string', value: result.join('')};\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tresult.push(c);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (tokenState === 'escape') {\n\t\t\t\tif (c === '&') {\n\t\t\t\t\tresult.push(buffer);\n\t\t\t\t\tbuffer = '&';\n\t\t\t\t}\n\t\t\t\telse if (c.match(/[0-9a-z]/)) {\n\t\t\t\t\tbuffer += c;\n\t\t\t\t}\n\t\t\t\telse if (c === ';') {\n\t\t\t\t\tif (buffer === '&amp') {\n\t\t\t\t\t\tresult.push('&');\n\t\t\t\t\t}\n\t\t\t\t\telse if (buffer === '&lt') {\n\t\t\t\t\t\tresult.push('<');\n\t\t\t\t\t}\n\t\t\t\t\telse if (buffer === '&gt') {\n\t\t\t\t\t\tresult.push('>');\n\t\t\t\t\t}\n\t\t\t\t\telse if (buffer === '&lrm') {\n\t\t\t\t\t\tresult.push('\\u200e');\n\t\t\t\t\t}\n\t\t\t\t\telse if (buffer === '&rlm') {\n\t\t\t\t\t\tresult.push('\\u200f');\n\t\t\t\t\t}\n\t\t\t\t\telse if (buffer === '&nbsp') {\n\t\t\t\t\t\tresult.push('\\u00a0');\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tresult.push(buffer);\n\t\t\t\t\t\tresult.push(';');\n\t\t\t\t\t}\n\t\t\t\t\ttokenState = 'data';\n\t\t\t\t}\n\t\t\t\telse if (c === '<' || c === '\\u0004') {\n\t\t\t\t\tresult.push(buffer);\n\t\t\t\t\ttoken.type = 'string';\n\t\t\t\t\ttoken.value = result.join('');\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse if (c === '\\t' || c === '\\n' || c === '\\u000c' || c === ' ') { // Handle unescaped & chars as strings\n\t\t\t\t\tresult.push(buffer);\n\t\t\t\t\ttoken.type = 'string';\n\t\t\t\t\ttoken.value = result.join('');\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tresult.push(buffer);\n\t\t\t\t\ttokenState = 'data';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (tokenState === 'tag') {\n\t\t\t\tif (c === '\\t' || c === '\\n' || c === '\\u000c' || c === ' ') {\n\t\t\t\t\ttokenState = 'startTagAnnotation';\n\t\t\t\t}\n\t\t\t\telse if (c === '.') {\n\t\t\t\t\ttokenState = 'startTagClass';\n\t\t\t\t}\n\t\t\t\telse if (c === '/') {\n\t\t\t\t\ttokenState = 'endTag';\n\t\t\t\t}\n\t\t\t\telse if (c.match('[0-9]')) {\n\t\t\t\t\ttokenState = 'timestampTag';\n\t\t\t\t\tresult.push(c);\n\t\t\t\t}\n\t\t\t\telse if (c === '>') {\n\t\t\t\t\tcut(state, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse if (c === '\\u0004') {\n\t\t\t\t\ttoken.tagName = '';\n\t\t\t\t\ttoken.type = 'startTag';\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tresult.push(c);\n\t\t\t\t\ttokenState = 'startTag';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (tokenState === 'startTag') {\n\t\t\t\tif (c === '\\t' || c === '\\u000c' || c === ' ') {\n\t\t\t\t\ttokenState = 'startTagAnnotation';\n\t\t\t\t}\n\t\t\t\telse if (c === '\\n') {\n\t\t\t\t\tbuffer = c;\n\t\t\t\t\ttokenState = 'startTagAnnotation';\n\t\t\t\t}\n\t\t\t\telse if (c === '.') {\n\t\t\t\t\ttokenState = 'startTagClass';\n\t\t\t\t}\n\t\t\t\telse if (c === '>') {\n\t\t\t\t\tcut(state, 1);\n\t\t\t\t\ttoken.tagName = result.join('');\n\t\t\t\t\ttoken.type = 'startTag';\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse if (c === '\\u0004') {\n\t\t\t\t\ttoken.tagName = result.join('');\n\t\t\t\t\ttoken.type = 'startTag';\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tresult.push(c);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (tokenState === 'startTagClass') {\n\t\t\t\tif (c === '\\t' || c === '\\u000c' || c === ' ') {\n\t\t\t\t\ttoken.classes.push(buffer);\n\t\t\t\t\tbuffer = '';\n\t\t\t\t\ttokenState = 'startTagAnnotation';\n\t\t\t\t}\n\t\t\t\telse if (c === '\\n') {\n\t\t\t\t\ttoken.classes.push(buffer);\n\t\t\t\t\tbuffer = c;\n\t\t\t\t\ttokenState = 'startTagAnnotation';\n\t\t\t\t}\n\t\t\t\telse if (c === '.') {\n\t\t\t\t\ttoken.classes.push(buffer);\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t}\n\t\t\t\telse if (c === '>') {\n\t\t\t\t\tcut(state, 1);\n\t\t\t\t\ttoken.classes.push(buffer);\n\t\t\t\t\ttoken.type = 'startTag';\n\t\t\t\t\ttoken.tagName = result.join('');\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse if (c === '\\u0004') {\n\t\t\t\t\ttoken.classes.push(buffer);\n\t\t\t\t\ttoken.type = 'startTag';\n\t\t\t\t\ttoken.tagName = result.join('');\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tbuffer += 'c';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (tokenState === 'startTagAnnotation') {\n\t\t\t\tif (c === '>') {\n\t\t\t\t\tcut(state, 1);\n\t\t\t\t\tbuffer = $.trim(buffer).replace(/ +/, ' ');\n\t\t\t\t\ttoken.type = 'startTag';\n\t\t\t\t\ttoken.tagName = result.join('');\n\t\t\t\t\ttoken.annotation = buffer;\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse if (c === '\\u0004') {\n\t\t\t\t\tbuffer = $.trim(buffer).replace(/ +/, ' ');\n\t\t\t\t\ttoken.type = 'startTag';\n\t\t\t\t\ttoken.tagName = result.join('');\n\t\t\t\t\ttoken.annotation = buffer;\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tbuffer += c;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (tokenState === 'endTag') {\n\t\t\t\tif (c === '>') {\n\t\t\t\t\tcut(state, 1);\n\t\t\t\t\ttoken.type = 'endTag';\n\t\t\t\t\ttoken.tagName = result.join('');\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse if (c === '\\u0004') {\n\t\t\t\t\ttoken.type = 'endTag';\n\t\t\t\t\ttoken.tagName = result.join('');\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tresult.push(c);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (tokenState === 'timestampTag') {\n\t\t\t\tif (c === '>') {\n\t\t\t\t\tcut(state, 1);\n\t\t\t\t\ttoken.type = 'timestampTag';\n\t\t\t\t\ttoken.name = result.join('');\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse if (c === '\\u0004') {\n\t\t\t\t\ttoken.type = 'timestampTag';\n\t\t\t\t\ttoken.name = result.join('');\n\t\t\t\t\treturn token;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tresult.push(c);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthrow 'Unknown tokenState ' + tokenState;\n\t\t\t}\n\n\t\t\tcut(state, 1);\n\t\t}\n\t}\n\n\tfunction eatComment(state) {\n\t\t// Cut the NOTE line.\n\t\tvar noteLine = cutLine(state);\n\t\tif (noteLine.indexOf('-->') !== -1) {\n\t\t\tstate.error = 'Invalid syntax: --> in NOTE line.';\n\t\t\treturn;\n\t\t}\n\t\twhile (true) {\n\t\t\tvar nextLine = peekLine(state);\n\t\t\tif ($.trim(nextLine).length === 0) {\n\t\t\t\t// End of comment.\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if (nextLine.indexOf('-->') !== -1) {\n\t\t\t\tstate.error = 'Invalid syntax: --> in comment.';\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcutLine(state);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Initial byte order mark.\n\tfunction eatOptionalBOM(state) {\n\t\tif (state.text[0] === '\\ufeff') {\n\t\t\tcut(state, 1);\n\t\t}\n\n\t}\n\n\t// \"WEBVTT\" string.\n\tfunction eatSignature(state) {\n\t\tif (state.text.substring(0,6) === 'WEBVTT') {\n\t\t\tcut(state, 6);\n\t\t}\n\t\telse {\n\t\t\tstate.error = 'Invalid signature.';\n\t\t}\n\t}\n\n\tfunction eatArrow(state) {\n\t\tif (state.text.length < 3 || state.text.substring(0,3) !== '-->') {\n\t\t\tstate.error = 'Missing -->';\n\t\t}\n\t\telse {\n\t\t\tcut(state, 3);\n\t\t}\n\t}\n\n\tfunction eatSingleSpaceOrTab(state) {\n\t\tif (state.text[0] === '\\t' || state.text[0] === ' ') {\n\t\t\tcut(state, 1);\n\t\t}\n\t\telse {\n\t\t\tstate.error = 'Missing space.';\n\t\t}\n\t}\n\n\tfunction eatSpacesOrTabs(state) {\n\t\twhile (state.text[0] === '\\t' || state.text[0] === ' ') {\n\t\t\tcut(state, 1);\n\t\t}\n\t}\n\n\tfunction eatAtLeast1SpacesOrTabs(state) {\n\t\tvar numEaten = 0;\n\t\twhile (state.text[0] === '\\t' || state.text[0] === ' ') {\n\t\t\tcut(state, 1);\n\t\t\tnumEaten += 1;\n\t\t}\n\t\tif (numEaten === 0) {\n\t\t\tstate.error = 'Missing space.';\n\t\t}\n\t}\n\n\tfunction eatUntilEOLInclusive(state) {\n\t\tvar nextEOL = state.text.indexOf('\\n');\n\t\tif (nextEOL === -1) {\n\t\t\tstate.error = 'Missing EOL.';\n\t\t}\n\t\telse {\n\t\t\tcut(state, nextEOL + 1);\n\t\t}\n\t}\n\n\tfunction eatEmptyLines(state) {\n\t\twhile (state.text.length > 0) {\n\t\t\tvar nextLine = peekLine(state);\n\t\t\tif ($.trim(nextLine).length === 0) {\n\t\t\t\tcutLine(state);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Eats empty lines, but throws an error if there's not at least one.\n\tfunction eatAtLeast1EmptyLines(state) {\n\t\tvar linesEaten = 0;\n\t\twhile (state.text.length > 0) {\n\t\t\tvar nextLine = peekLine(state);\n\t\t\tif ($.trim(nextLine).length === 0) {\n\t\t\t\tcutLine(state);\n\t\t\t\tlinesEaten += 1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (linesEaten === 0) {\n\t\t\tstate.error = 'Missing empty line.';\n\t\t}\n\t}\n\n\tfunction getTiming(state) {\n\t\tvar nextSpace = nextSpaceOrNewline(state.text);\n\t\tif (nextSpace === -1) {\n\t\t\tstate.error('Missing timing.');\n\t\t\treturn;\n\t\t}\n\t\tvar timestamp = cut(state, nextSpace);\n\n\t\tvar results = /((\\d\\d):)?((\\d\\d):)(\\d\\d).(\\d\\d\\d)|(\\d+).(\\d\\d\\d)/.exec(timestamp);\n\n\t\tif (!results) {\n\t\t\tstate.error = 'Unable to parse timestamp';\n\t\t\treturn;\n\t\t}\n\t\tvar time = 0;\n\t\tvar hours = results[2];\n\t\tvar minutes = results[4];\n\n\t\tif (minutes) {\n\t\t\tif (parseInt(minutes, 10) > 59) {\n\t\t\t\tstate.error = 'Invalid minute range';\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (hours) {\n\t\t\t\ttime += 3600 * parseInt(hours, 10);\n\t\t\t}\n\t\t\ttime += 60 * parseInt(minutes, 10);\n\t\t\tvar seconds = results[5];\n\t\t\tif (parseInt(seconds, 10) > 59) {\n\t\t\t\tstate.error = 'Invalid second range';\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttime += parseInt(seconds, 10);\n\t\t\ttime += parseInt(results[6], 10) / 1000;\n\t\t}\n\t\telse {\n\t\t\ttime += parseInt(results[7], 10);\n\t\t\ttime += parseInt(results[8], 10) / 1000;\n\t\t}\n\n\t\treturn time;\n\t}\n})(jQuery);\n\n(function ($) {\n\n\tAblePlayer.prototype.injectPlayerCode = function() {\n\n\t\t// create and inject surrounding HTML structure\n\t\t// If IOS:\n\t\t//\tIf video:\n\t\t//\t IOS does not support any of the player's functionality\n\t\t//\t - everything plays in its own player\n\t\t//\t Therefore, AblePlayer is not loaded & all functionality is disabled\n\t\t//\t (this all determined. If this is IOS && video, this function is never called)\n\t\t//\tIf audio:\n\t\t//\t HTML cannot be injected as a *parent* of the <audio> element\n\t\t//\t It is therefore injected *after* the <audio> element\n\t\t//\t This is only a problem in IOS 6 and earlier,\n\t\t//\t & is a known bug, fixed in IOS 7\n\n\t\tvar thisObj, captionsContainer, prefsGroups, i;\n\t\tthisObj = this;\n\n\t\t// create three wrappers and wrap them around the media element. \n\t\t// From inner to outer:\n\t\t// $mediaContainer - contains the original media element\n\t\t// $ableDiv - contains the media player and all its objects (e.g., captions, controls, descriptions)\n\t\t// $ableWrapper - contains additional widgets (e.g., transcript window, sign window)\n\t\tthis.$mediaContainer = this.$media.wrap('<div class=\"able-media-container\"></div>').parent();\n\t\tthis.$ableDiv = this.$mediaContainer.wrap('<div class=\"able\"></div>').parent();\n\t\tthis.$ableWrapper = this.$ableDiv.wrap('<div class=\"able-wrapper\"></div>').parent();\n\t\tthis.$ableWrapper.addClass('able-skin-' + this.skin);\n\t\t\t\t\n\t\tthis.$ableWrapper.css({\n\t\t\t'width': this.playerWidth + 'px' \n\t\t});\n\n\t\tif (this.mediaType === 'video') {\n\t\t\t// youtube adds its own big play button\n\t\t\t// don't show ours *unless* video has a poster attribute\n\t\t\t// (which obstructs the YouTube poster & big play button)\n\t\t\tif (this.iconType != 'image' && (this.player !== 'youtube' || this.hasPoster)) {\n\t\t\t\tthis.injectBigPlayButton();\n\t\t\t}\n\t\t}\n\n\t\t// add container that captions or description will be appended to\n\t\t// Note: new Jquery object must be assigned _after_ wrap, hence the temp captionsContainer variable\n\t\tcaptionsContainer = $('<div>'); \n\t\tif (this.mediaType === 'video') { \n\t\t\tcaptionsContainer.addClass('able-vidcap-container'); \n\t\t}\n\t\telse if (this.mediaType === 'audio') { \n\t\t\tcaptionsContainer.addClass('able-audcap-container'); \n\t\t\t// hide this by default. It will be shown if captions are available \n\t\t\tcaptionsContainer.addClass('captions-off');\n\t\t}\n\n\t\tthis.injectPlayerControlArea(); // this may need to be injected after captions??? \n\t\tthis.$captionsContainer = this.$mediaContainer.wrap(captionsContainer).parent();\n\t\tthis.injectAlert();\n\t\tthis.injectPlaylist();\n\n\t\t// Do this last, as it should be prepended to the top of this.$ableDiv\n\t\t// after everything else has prepended\n\t\tthis.injectOffscreenHeading();\n\t};\n\n\tAblePlayer.prototype.injectOffscreenHeading = function () {\n\n\t\t// Inject an offscreen heading to the media container.\n\t\t// If heading hasn't already been manually defined via data-heading-level,\n\t\t// automatically assign a level that is one level deeper than the closest parent heading\n\t\t// as determined by getNextHeadingLevel()\n\t\tvar headingType;\n\t\tif (this.playerHeadingLevel == '0') {\n\t\t\t// do NOT inject a heading (at author's request)\n\t\t}\n\t\telse {\n\t\t\tif (typeof this.playerHeadingLevel === 'undefined') {\n\t\t\t\tthis.playerHeadingLevel = this.getNextHeadingLevel(this.$ableDiv); // returns in integer 1-6\n\t\t\t}\n\t\t\theadingType = 'h' + this.playerHeadingLevel.toString();\n\t\t\tthis.$headingDiv = $('<' + headingType + '>');\n\t\t\tthis.$ableDiv.prepend(this.$headingDiv);\n\t\t\tthis.$headingDiv.addClass('able-offscreen');\n\t\t\tthis.$headingDiv.text(this.tt.playerHeading);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.injectBigPlayButton = function () {\n\n\t\tvar thisObj, svgData, buttonIcon, svgPath;\n\n\t\tthisObj = this; \n\n\t\tthis.$bigPlayButton = $('<button>', {\n\t\t\t'class': 'able-big-play-button',\n\t\t\t'aria-hidden': false,\n\t\t\t'aria-label': this.tt.play,\n\t\t\t'tabindex': 0\n\t\t});\n\n\t\tif (this.iconType == 'svg') { \n\t\t\tsvgData = this.getSvgData('play');\n\t\t\tbuttonIcon = $('<svg>',{\n\t\t\t\t'focusable': 'false',\n\t\t\t\t'aria-hidden': 'true',\n\t\t\t\t'viewBox': svgData[0]\n\t\t\t});\n\t\t\tsvgPath = $('<path>',{\n\t\t\t\t'd': svgData[1]\n\t\t\t});\n\t\t\tbuttonIcon.append(svgPath);\n\t\t\tthis.$bigPlayButton.html(buttonIcon);\n\n\t\t\t// Final step: Need to refresh the DOM in order for browser to process & display the SVG\n\t\t\tthis.$bigPlayButton.html(this.$bigPlayButton.html());\n\t\t}\n\t\telse { // use icon font \n\t\t\tthis.$bigPlayIcon = $('<span>', {\n\t\t\t\t'class': 'icon-play',\n\t\t\t});\n\t\t\tthis.$bigPlayButton.append(this.$bigPlayIcon);\n\t\t}\n\n\t\tthis.$bigPlayButton.click(function (event) {\n\t\t\tevent.preventDefault();\n\t\t\tthisObj.handlePlay();\n\t\t});\n\t\t\n\t\tthis.$mediaContainer.append(this.$bigPlayButton);\n\t};\n\n\tAblePlayer.prototype.injectPlayerControlArea = function () {\n\n\t\tthis.$playerDiv = $('<div>', {\n\t\t\t'class' : 'able-player',\n\t\t\t'role' : 'region',\n\t\t\t'aria-label' : this.mediaType + ' player'\n\t\t});\n\t\tthis.$playerDiv.addClass('able-'+this.mediaType);\n\t\tif (this.hasPlaylist && this.showNowPlaying) { \n\t\t\tthis.$nowPlayingDiv = $('<div>',{\n\t\t\t\t'class' : 'able-now-playing',\n\t\t\t\t'aria-live' : 'assertive',\n\t\t\t\t'aria-atomic': 'true'\n\t\t\t});\n\t\t}\n\t\tthis.$controllerDiv = $('<div>',{\n\t\t\t'class' : 'able-controller'\n\t\t});\n\t\tthis.$controllerDiv.addClass('able-' + this.iconColor + '-controls');\n\n\t\tthis.$statusBarDiv = $('<div>',{\n\t\t\t'class' : 'able-status-bar'\n\t\t});\n\t\tthis.$timer = $('<span>',{\n\t\t\t'class' : 'able-timer'\n\t\t});\n\t\tthis.$elapsedTimeContainer = $('<span>',{\n\t\t\t'class': 'able-elapsedTime',\n\t\t\ttext: '0:00'\n\t\t});\n\t\tthis.$durationContainer = $('<span>',{\n\t\t\t'class': 'able-duration'\n\t\t});\n\t\tthis.$timer.append(this.$elapsedTimeContainer).append(this.$durationContainer);\n\n\t\tthis.$speed = $('<span>',{\n\t\t\t'class' : 'able-speed',\n\t\t\t'aria-live' : 'assertive'\n\t\t}).text(this.tt.speed + ': 1x');\n\n\t\tthis.$status = $('<span>',{\n\t\t\t'class' : 'able-status',\n\t\t\t'aria-live' : 'polite'\n\t\t});\n\n\t\t// Put everything together.\n\t\tthis.$statusBarDiv.append(this.$timer, this.$speed, this.$status);\n\t\tif (this.showNowPlaying) {\n\t\t\tthis.$playerDiv.append(this.$nowPlayingDiv, this.$controllerDiv, this.$statusBarDiv);\n\t\t}\n\t\telse { \n\t\t\tthis.$playerDiv.append(this.$controllerDiv, this.$statusBarDiv);\n\t\t}\n\t\tif (this.mediaType === 'video') { \n\t\t\t// the player controls go after the media & captions \n\t\t\tthis.$ableDiv.append(this.$playerDiv);\n\t\t}\n\t\telse { \n\t\t\t// the player controls go before the media & captions \n\t\t\tthis.$ableDiv.prepend(this.$playerDiv);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.injectTextDescriptionArea = function () {\n\n\t\t// create a div for writing description text\n\t\tthis.$descDiv = $('<div>',{\n\t\t\t'class': 'able-descriptions'\n\t\t});\n\t\t// Add ARIA so description will be announced by screen readers\n\t\t// Later (in description.js > showDescription()), \n\t\t// if browser supports Web Speech API and this.descMethod === 'browser'\n\t\t// these attributes will be removed \n\t\tthis.$descDiv.attr({\n\t\t\t'aria-live': 'assertive',\n\t\t\t'aria-atomic': 'true'\n\t\t});\n\t\t// Start off with description hidden.\n\t\t// It will be exposed conditionally within description.js > initDescription()\n\t\tthis.$descDiv.hide();\n\t\tthis.$ableDiv.append(this.$descDiv);\n\t};\n\n\tAblePlayer.prototype.getDefaultWidth = function(which) {\n\n\t\t// return default width of resizable elements\n\t\t// these values are somewhat arbitrary, but seem to result in good usability\n\t\t// if users disagree, they can resize (and resposition) them\n\t\tif (which === 'transcript') {\n\t\t\treturn 450;\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\treturn 400;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.positionDraggableWindow = function (which, width) {\n\n\t\t// which is either 'transcript' or 'sign'\n\n\t\tvar cookie, cookiePos, $window, dragged, windowPos, currentWindowPos, firstTime, zIndex;\n\n\t\tcookie = this.getCookie();\n\t\tif (which === 'transcript') {\n\t\t\t$window = this.$transcriptArea;\n\t\t\tif (typeof cookie.transcript !== 'undefined') {\n\t\t\t\tcookiePos = cookie.transcript;\n\t\t\t}\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\t$window = this.$signWindow;\n\t\t\tif (typeof cookie.transcript !== 'undefined') {\n\t\t\t\tcookiePos = cookie.sign;\n\t\t\t}\n\t\t}\n\t\tif (typeof cookiePos !== 'undefined' && !($.isEmptyObject(cookiePos))) {\n\t\t\t// position window using stored values from cookie\n\t\t\t$window.css({\n\t\t\t\t'position': cookiePos['position'],\n\t\t\t\t'width': cookiePos['width'],\n\t\t\t\t'z-index': cookiePos['zindex']\n\t\t\t});\n\t\t\tif (cookiePos['position'] === 'absolute') {\n\t\t\t\t$window.css({\n\t\t\t\t\t'top': cookiePos['top'],\n\t\t\t\t\t'left': cookiePos['left']\n\t\t\t\t});\n\t\t\t}\n\t\t\t// since cookie is not page-specific, z-index needs may vary across different pages\n\t\t\tthis.updateZIndex(which);\n\t\t}\n\t\telse {\n\t\t\t// position window using default values\n\t\t\twindowPos = this.getOptimumPosition(which, width);\n\t\t\tif (typeof width === 'undefined') {\n\t\t\t\twidth = this.getDefaultWidth(which);\n\t\t\t}\n\t\t\t$window.css({\n\t\t\t\t'position': windowPos[0],\n\t\t\t\t'width': width,\n\t\t\t\t'z-index': windowPos[3]\n\t\t\t});\n\t\t\tif (windowPos[0] === 'absolute') {\n\t\t\t\t$window.css({\n\t\t\t\t\t'top': windowPos[1] + 'px',\n\t\t\t\t\t'left': windowPos[2] + 'px',\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getOptimumPosition = function (targetWindow, targetWidth) {\n\n\t\t// returns optimum position for targetWindow, as an array with the following structure:\n\t\t// 0 - CSS position ('absolute' or 'relative')\n\t\t// 1 - top\n\t\t// 2 - left\n\t\t// 3 - zindex (if not default)\n\t\t// targetWindow is either 'transcript' or 'sign'\n\t\t// if there is room to the right of the player, position element there\n\t\t// else if there is room the left of the player, position element there\n\t\t// else position element beneath player\n\n\t\tvar gap, position, ableWidth, ableHeight, ableOffset, ableTop, ableLeft,\n\t\t\t windowWidth, otherWindowWidth, zIndex;\n\n\t\tif (typeof targetWidth === 'undefined') {\n\t\t\ttargetWidth = this.getDefaultWidth(targetWindow);\n\t\t}\n\n\t\tgap = 5; // number of pixels to preserve between Able Player objects\n\n\t\tposition = []; // position, top, left\n\n\t\tableWidth = this.$ableDiv.width();\n\t\tableHeight = this.$ableDiv.height();\n\t\tableOffset = this.$ableDiv.offset();\n\t\tableTop = ableOffset.top;\n\t\tableLeft = ableOffset.left;\n\t\twindowWidth = $(window).width();\n\t\totherWindowWidth = 0; // width of other visiable draggable windows will be added to this\n\n\t\tif (targetWindow === 'transcript') {\n\t\t\tif (typeof this.$signWindow !== 'undefined') {\n\t\t\t\tif (this.$signWindow.is(':visible')) {\n\t\t\t\t\totherWindowWidth = this.$signWindow.width() + gap;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (targetWindow === 'sign') {\n\t\t\tif (typeof this.$transcriptArea !== 'undefined') {\n\t\t\t\tif (this.$transcriptArea.is(':visible')) {\n\t\t\t\t\totherWindowWidth = this.$transcriptArea.width() + gap;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (targetWidth < (windowWidth - (ableLeft + ableWidth + gap + otherWindowWidth))) {\n\t\t\t// there's room to the left of $ableDiv\n\t\t\tposition[0] = 'absolute';\n\t\t\tposition[1] = 0;\n\t\t\tposition[2] = ableWidth + otherWindowWidth + gap;\n\t\t}\n\t\telse if (targetWidth + gap < ableLeft) {\n\t\t\t// there's room to the right of $ableDiv\n\t\t\tposition[0] = 'absolute';\n\t\t\tposition[1] = 0;\n\t\t\tposition[2] = ableLeft - targetWidth - gap;\n\t\t}\n\t\telse {\n\t\t\t// position element below $ableDiv\n\t\t\tposition[0] = 'relative';\n\t\t\t// no need to define top, left, or z-index\n\t\t}\n\t\treturn position;\n\t};\n\n\tAblePlayer.prototype.injectAlert = function () {\n\n\t\t// inject two alerts, one visible for all users and one for screen reader users only\n\n\t\tvar top;\n\n\t\tthis.$alertBox = $('<div role=\"alert\"></div>');\n\t\tthis.$alertBox.addClass('able-alert');\n\t\tthis.$alertBox.hide();\n\t\tthis.$alertBox.appendTo(this.$ableDiv);\n\t\tif (this.mediaType == 'audio') {\n\t\t\ttop = '-10';\n\t\t}\n\t\telse {\n\t\t\t// position just below top of video by default \n\t\t\t// but this will change after video player is fully sized \n\t\t\t// see control.js > resizePlayer() \n\t\t\ttop = '10'; \n\t\t}\n\t\tthis.$alertBox.css({\n\t\t\ttop: top + 'px'\n\t\t});\n\n\t\tthis.$srAlertBox = $('<div role=\"alert\"></div>');\n\t\tthis.$srAlertBox.addClass('able-screenreader-alert');\n\t\tthis.$srAlertBox.appendTo(this.$ableDiv);\n\t};\n\n\tAblePlayer.prototype.injectPlaylist = function () {\n\n\t\tif (this.playlistEmbed === true) {\n\t\t\t// move playlist into player, immediately before statusBarDiv\n\t\t\tvar playlistClone = this.$playlistDom.clone();\n\t\t\tplaylistClone.insertBefore(this.$statusBarDiv);\n\t\t\t// Update to the new playlist copy.\n\t\t\tthis.$playlist = playlistClone.find('li');\n\t\t}\n\t};\n\n\tAblePlayer.prototype.createPopup = function (which, tracks) {\n\n\t\t// Create popup menu and append to player\n\t\t// 'which' parameter is either 'captions', 'chapters', 'prefs', 'transcript-window' or 'sign-window'\n\t\t// 'tracks', if provided, is a list of tracks to be used as menu items\n\n\t\tvar thisObj, $menu, includeMenuItem, prefCats, i, $menuItem, prefCat, whichPref,\n\t\t\thasDefault, track, windowOptions, whichPref, whichMenu,\n\t\t\t$thisItem, $prevItem, $nextItem;\n\n\t\tthisObj = this;\n\n\t\t$menu = $('<ul>',{\n\t\t\t'id': this.mediaId + '-' + which + '-menu',\n\t\t\t'class': 'able-popup',\n\t\t\t'role': 'menu'\n\t\t}).hide();\n\n\t\tif (which === 'captions') {\n\t\t\t$menu.addClass('able-popup-captions');\n\t\t}\n\n\t\t// Populate menu with menu items\n\t\tif (which === 'prefs') {\n\t\t\tif (this.prefCats.length > 1) {\n\t\t\t\tfor (i = 0; i < this.prefCats.length; i++) {\n\t\t\t\t\t$menuItem = $('<li></li>',{\n\t\t\t\t\t\t'role': 'menuitem',\n\t\t\t\t\t\t'tabindex': '-1'\n\t\t\t\t\t});\n\t\t\t\t\tprefCat = this.prefCats[i];\n\t\t\t\t\tif (prefCat === 'captions') {\n\t\t\t\t\t\t$menuItem.text(this.tt.prefMenuCaptions);\n\t\t\t\t\t}\n\t\t\t\t\telse if (prefCat === 'descriptions') {\n\t\t\t\t\t\t$menuItem.text(this.tt.prefMenuDescriptions);\n\t\t\t\t\t}\n\t\t\t\t\telse if (prefCat === 'keyboard') {\n\t\t\t\t\t\t$menuItem.text(this.tt.prefMenuKeyboard);\n\t\t\t\t\t}\n\t\t\t\t\telse if (prefCat === 'transcript') {\n\t\t\t\t\t\t$menuItem.text(this.tt.prefMenuTranscript);\n\t\t\t\t\t}\n\t\t\t\t\t$menuItem.on('click',function() {\n\t\t\t\t\t\twhichPref = $(this).text();\n\t\t\t\t\t\tthisObj.showingPrefsDialog = true;\n\t\t\t\t\t\tthisObj.setFullscreen(false);\n\t\t\t\t\t\tif (whichPref === thisObj.tt.prefMenuCaptions) {\n\t\t\t\t\t\t\tthisObj.captionPrefsDialog.show();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (whichPref === thisObj.tt.prefMenuDescriptions) {\n\t\t\t\t\t\t\tthisObj.descPrefsDialog.show();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (whichPref === thisObj.tt.prefMenuKeyboard) {\n\t\t\t\t\t\t\tthisObj.keyboardPrefsDialog.show();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (whichPref === thisObj.tt.prefMenuTranscript) {\n\t\t\t\t\t\t\tthisObj.transcriptPrefsDialog.show();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthisObj.closePopups();\n\t\t\t\t\t\tthisObj.showingPrefsDialog = false;\n\t\t\t\t\t});\n\t\t\t\t\t$menu.append($menuItem);\n\t\t\t\t}\n\t\t\t\tthis.$prefsButton.attr('data-prefs-popup','menu');\n\t\t\t}\n\t\t\telse if (this.prefCats.length == 1) {\n\t\t\t\t// only 1 category, so don't create a popup menu.\n\t\t\t\t// Instead, open dialog directly when user clicks Prefs button\n\t\t\t\tthis.$prefsButton.attr('data-prefs-popup',this.prefCats[0]);\n\t\t\t}\n\t\t}\n\t\telse if (which === 'captions' || which === 'chapters') {\n\t\t\thasDefault = false;\n\t\t\tfor (i = 0; i < tracks.length; i++) {\n\t\t\t\ttrack = tracks[i];\n\t\t\t\tif (which === 'captions' && this.player === 'html5' && typeof track.cues === 'undefined') {\t\t\t\t\t\t\n\t\t\t\t\tincludeMenuItem = false; \n\t\t\t\t}\n\t\t\t\telse { \n\t\t\t\t\tincludeMenuItem = true; \n\t\t\t\t}\n\t\t\t\tif (includeMenuItem) {\n\t\t\t\t\t$menuItem = $('<li></li>',{\n\t\t\t\t\t\t'role': 'menuitemradio',\n\t\t\t\t\t\t'tabindex': '-1',\n\t\t\t\t\t\t'lang': track.language\n\t\t\t\t\t});\n\t\t\t\t\tif (track.def && this.prefCaptions == 1) {\n\t\t\t\t\t\t$menuItem.attr('aria-checked','true');\n\t\t\t\t\t\thasDefault = true;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$menuItem.attr('aria-checked','false');\n\t\t\t\t\t}\t\t\t\n\t\t\t\t\t// Get a label using track data\n\t\t\t\t\tif (which == 'captions') {\n\t\t\t\t\t\t$menuItem.text(track.label);\n\t\t\t\t\t\t$menuItem.on('click',this.getCaptionClickFunction(track));\n\t\t\t\t\t}\n\t\t\t\t\telse if (which == 'chapters') {\n\t\t\t\t\t\t$menuItem.text(this.flattenCueForCaption(track) + ' - ' + this.formatSecondsAsColonTime(track.start));\n\t\t\t\t\t\t$menuItem.on('click',this.getChapterClickFunction(track.start));\n\t\t\t\t\t}\n\t\t\t\t\t$menu.append($menuItem);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (which === 'captions') {\n\t\t\t\t// add a 'captions off' menu item\n\t\t\t\t$menuItem = $('<li></li>',{\n\t\t\t\t\t'role': 'menuitemradio',\n\t\t\t\t\t'tabindex': '-1',\n\t\t\t\t}).text(this.tt.captionsOff);\n\t\t\t\tif (this.prefCaptions === 0) {\n\t\t\t\t\t$menuItem.attr('aria-checked','true');\n\t\t\t\t\thasDefault = true;\n\t\t\t\t}\n\t\t\t\telse { \n\t\t\t\t\t$menuItem.attr('aria-checked','false');\n\t\t\t\t}\n\t\t\t\t$menuItem.on('click',this.getCaptionOffFunction());\n\t\t\t\t$menu.append($menuItem);\n\t\t\t}\n\t\t}\n\t\telse if (which === 'transcript-window' || which === 'sign-window') {\n\t\t\twindowOptions = [];\n\t\t\twindowOptions.push({\n\t\t\t\t'name': 'move',\n\t\t\t\t'label': this.tt.windowMove\n\t\t\t});\n\t\t\twindowOptions.push({\n\t\t\t\t'name': 'resize',\n\t\t\t\t'label': this.tt.windowResize\n\t\t\t});\n\t\t\twindowOptions.push({\n\t\t\t\t'name': 'close',\n\t\t\t\t'label': this.tt.windowClose\n\t\t\t});\n\t\t\tfor (i = 0; i < windowOptions.length; i++) {\n\t\t\t\t$menuItem = $('<li></li>',{\n\t\t\t\t\t'role': 'menuitem',\n\t\t\t\t\t'tabindex': '-1',\n\t\t\t\t\t'data-choice': windowOptions[i].name\n\t\t\t\t});\n\t\t\t\t$menuItem.text(windowOptions[i].label);\n\t\t\t\t$menuItem.on('click mousedown',function(e) {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tif (typeof e.button !== 'undefined' && e.button !== 0) {\n\t\t\t\t\t\t// this was a mouse click (if click is triggered by keyboard, e.button is undefined)\n\t\t\t\t\t\t// and the button was not a left click (left click = 0)\n\t\t\t\t\t\t// therefore, ignore this click\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tif (!thisObj.windowMenuClickRegistered && !thisObj.finishingDrag) {\n\t\t\t\t\t\tthisObj.windowMenuClickRegistered = true;\n\t\t\t\t\t\tthisObj.handleMenuChoice(which.substring(0, which.indexOf('-')), $(this).attr('data-choice'), e);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t$menu.append($menuItem);\n\t\t\t}\n\t\t}\n\t\t// assign default item, if there isn't one already\n\t\tif (which === 'captions' && !hasDefault) {\n\t\t\t// check the menu item associated with the default language\n\t\t\t// as determined in control.js > syncTrackLanguages()\n\t\t\tif ($menu.find('li[lang=' + this.captionLang + ']')) {\n\t\t\t\t// a track exists for the default language. Check that item in the menu\n\t\t\t\t$menu.find('li[lang=' + this.captionLang + ']').attr('aria-checked','true');\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// check the last item (captions off)\n\t\t\t\t$menu.find('li').last().attr('aria-checked','true');\n\t\t\t}\n\t\t}\n\t\telse if (which === 'chapters') {\n\t\t\tif ($menu.find('li:contains(\"' + this.defaultChapter + '\")')) {\n\t\t\t\t$menu.find('li:contains(\"' + this.defaultChapter + '\")').attr('aria-checked','true').addClass('able-focus');\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$menu.find('li').first().attr('aria-checked','true').addClass('able-focus');\n\t\t\t}\n\t\t}\n\t\t// add keyboard handlers for navigating within popups\n\t\t$menu.on('keydown',function (e) {\n\t\t\t\n\t\t\twhichMenu = $(this).attr('id').split('-')[1];\n\t\t\t$thisItem = $(this).find('li:focus');\n\t\t\tif ($thisItem.is(':first-child')) {\n\t\t\t\t// this is the first item in the menu\n\t\t\t\t$prevItem = $(this).find('li').last(); // wrap to bottom\n\t\t\t\t$nextItem = $thisItem.next();\n\t\t\t}\n\t\t\telse if ($thisItem.is(':last-child')) {\n\t\t\t\t// this is the last Item\n\t\t\t\t$prevItem = $thisItem.prev();\n\t\t\t\t$nextItem = $(this).find('li').first(); // wrap to top\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$prevItem = $thisItem.prev();\n\t\t\t\t$nextItem = $thisItem.next();\n\t\t\t}\n\t\t\tif (e.which === 9) { // Tab\n\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t$thisItem.removeClass('able-focus');\n\t\t\t\t\t$prevItem.focus().addClass('able-focus');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$thisItem.removeClass('able-focus');\n\t\t\t\t\t$nextItem.focus().addClass('able-focus');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (e.which === 40 || e.which === 39) { // down or right arrow\n\t\t\t\t$thisItem.removeClass('able-focus');\n\t\t\t\t$nextItem.focus().addClass('able-focus');\n\t\t\t}\n\t\t\telse if (e.which == 38 || e.which === 37) { // up or left arrow\n\t\t\t\t$thisItem.removeClass('able-focus');\n\t\t\t\t$prevItem.focus().addClass('able-focus');\n\t\t\t}\n\t\t\telse if (e.which === 32 || e.which === 13) { // space or enter\n\t\t\t\t$thisItem.click();\n\t\t\t}\n\t\t\telse if (e.which === 27) {\t// Escape\n\t\t\t\t$thisItem.removeClass('able-focus');\n\t\t\t\tthisObj.closePopups();\n\t\t\t\te.stopPropagation;\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t});\n\t\tthis.$controllerDiv.append($menu);\n\t\treturn $menu;\n\t};\n\n\tAblePlayer.prototype.closePopups = function () {\n\n\t\tvar thisObj = this;\n\n\t\tif (this.chaptersPopup && this.chaptersPopup.is(':visible')) {\n\t\t\tthis.chaptersPopup.hide();\n\t\t\tthis.$chaptersButton.attr('aria-expanded','false').focus();\n\t\t}\n\t\tif (this.captionsPopup && this.captionsPopup.is(':visible')) {\n\t\t\tthis.captionsPopup.hide();\n\t\t\tthis.$ccButton.attr('aria-expanded', 'false');\n\t\t\tthis.waitThenFocus(this.$ccButton);\n\t\t}\n\t\tif (this.prefsPopup && this.prefsPopup.is(':visible') && !this.hidingPopup) {\n\t\t\tthis.hidingPopup = true; // stopgap to prevent popup from re-opening again on keypress\n\t\t\tthis.prefsPopup.hide();\n\t\t\t// restore menu items to their original state\n\t\t\tthis.prefsPopup.find('li').removeClass('able-focus').attr('tabindex','-1');\n\t\t\tthis.$prefsButton.attr('aria-expanded', 'false');\n\t\t\tif (!this.showingPrefsDialog) {\n\t\t\t\tthis.waitThenFocus(thisObj.$prefsButton);\n\t\t\t}\n\t\t\t// wait briefly, then reset hidingPopup\n\t\t\tsetTimeout(function() {\n\t\t\t\tthisObj.hidingPopup = false;\n\t\t\t},100);\n\t\t}\n\t\tif (this.$volumeSlider && this.$volumeSlider.is(':visible')) {\n\t\t\tthis.$volumeSlider.hide().attr('aria-hidden','true');\t\t\t\n\t\t\tthis.$volumeButton.attr('aria-expanded', 'false').focus();\n\t\t}\n\t\tif (this.$transcriptPopup && this.$transcriptPopup.is(':visible')) {\n\t\t\tthis.hidingPopup = true; \n\t\t\tthis.$transcriptPopup.hide();\n\t\t\t// restore menu items to their original state\n\t\t\tthis.$transcriptPopup.find('li').removeClass('able-focus').attr('tabindex','-1');\n\t\t\tthis.$transcriptPopupButton.attr('aria-expanded','false').focus();\t\t\t\n\t\t\t// wait briefly, then reset hidingPopup\n\t\t\tsetTimeout(function() {\n\t\t\t\tthisObj.hidingPopup = false;\n\t\t\t},100);\n\t\t}\n\t\tif (this.$signPopup && this.$signPopup.is(':visible')) {\n\t\t\tthis.$signPopup.hide();\n\t\t\t// restore menu items to their original state\n\t\t\tthis.$signPopup.find('li').removeClass('able-focus').attr('tabindex','-1');\n\t\t\tthis.$signPopupButton.attr('aria-expanded','false').focus();\n\t\t}\n\t};\n\n\tAblePlayer.prototype.setupPopups = function (which) {\n\n\t\t// Create and fill in the popup menu forms for various controls.\n\t\t// parameter 'which' is passed if refreshing content of an existing popup ('captions' or 'chapters')\n\t\t// If which is undefined, automatically setup 'captions', 'chapters', and 'prefs' popups\n\t\t// However, only setup 'transcript-window' and 'sign-window' popups if passed as value of which\n\t\tvar popups, thisObj, hasDefault, i, j,\n\t\t\t\ttracks, track, $trackButton, $trackLabel,\n\t\t\t\tradioName, radioId, $menu, $menuItem,\n\t\t\t\tprefCats, prefCat, prefLabel;\n\n\t\tpopups = [];\n\t\tif (typeof which === 'undefined') {\n\t\t\tpopups.push('prefs');\n\t\t}\n\n\t\tif (which === 'captions' || (typeof which === 'undefined')) {\n\t\t\tif (this.captions.length > 0) {\n\t\t\t\tpopups.push('captions');\n\t\t\t}\n\t\t}\n\t\tif (which === 'chapters' || (typeof which === 'undefined')) {\n\t\t\tif (this.chapters.length > 0 && this.useChaptersButton) {\n\t\t\t\tpopups.push('chapters');\n\t\t\t}\n\t\t}\n\t\tif (which === 'transcript-window' && this.transcriptType === 'popup') {\n\t\t\tpopups.push('transcript-window');\n\t\t}\n\t\tif (which === 'sign-window' && this.hasSignLanguage) {\n\t\t\tpopups.push('sign-window');\n\t\t}\n\t\tif (popups.length > 0) {\n\t\t\tthisObj = this;\n\t\t\tfor (var i=0; i<popups.length; i++) {\n\t\t\t\tvar popup = popups[i];\n\t\t\t\thasDefault = false;\n\t\t\t\tif (popup == 'prefs') {\n\t\t\t\t\tthis.prefsPopup = this.createPopup('prefs');\n\t\t\t\t}\n\t\t\t\telse if (popup == 'captions') {\n\t\t\t\t\tif (typeof this.captionsPopup === 'undefined' || !this.captionsPopup) {\n\t\t\t\t\t\tthis.captionsPopup = this.createPopup('captions',this.captions);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (popup == 'chapters') {\n\t\t\t\t\tif (this.selectedChapters) {\n\t\t\t\t\t\ttracks = this.selectedChapters.cues;\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.chapters.length >= 1) {\n\t\t\t\t\t\ttracks = this.chapters[0].cues;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\ttracks = [];\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof this.chaptersPopup === 'undefined' || !this.chaptersPopup) {\n\t\t\t\t\t\tthis.chaptersPopup = this.createPopup('chapters',tracks);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (popup == 'transcript-window') {\n\t\t\t\t\treturn this.createPopup('transcript-window');\n\t\t\t\t}\n\t\t\t\telse if (popup == 'sign-window') {\n\t\t\t\t\treturn this.createPopup('sign-window');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.provideFallback = function() {\n\n\t\t// provide fallback in case of a critical error building the player \n\t\t// to test, set data-test-fallback to either of the following values: \n\t\t// 1 = emulate failure to build Able Player \n\t\t// 2 = emulate browser that doesn't support HTML5 media \n\n\t\tvar i, $fallback;\n\n\t\tif (this.usingFallback) { \n\t\t\t// fallback has already been implemented. \n\t\t\t// stopgap to prevent this function from executing twice on the same media element\n\t\t\treturn; \n\t\t}\n\t\telse { \n\t\t\tthis.usingFallback = true; \n\t\t}\n\n\t\tif (!this.testFallback) { \n\t\t\t// this is not a test. \n\t\t\t// an actual error has resulted in this function being called. \n\t\t\t// use scenario 1 \n\t\t\tthis.testFallback = 1; \n\t\t}\n\n\t\tif (typeof this.$media === 'undefined') { \n\t\t\t// this function has been called prior to initialize.js > reinitialize() \n\t\t\t// before doing anything, need to create the jQuery media object\n\t\t\tthis.$media = $(this.media); \n\t\t} \n\n\t\t// get/assign an id for the media element \n\t\tif (this.$media.attr('id')) { \n\t\t\tthis.mediaId = this.$media.attr('id'); \n\t\t}\n\t\telse { \n\t\t\tthis.mediaId = 'media' + Math.floor(Math.random() * 1000000000).toString();\n\t\t} \n\n\t\t// check whether element has nested fallback content \n\t\tthis.hasFallback = false; \n\t\tif (this.$media.children().length) { \n\t\t\ti = 0; \n\t\t\twhile (i < this.$media.children().length && !this.hasFallback) { \n\t\t\t\tif (!(this.$media.children()[i].tagName === 'SOURCE' || \n\t\t\t\t\tthis.$media.children()[i].tagName === 'TRACK')) { \n\t\t\t\t\t// this element is something other than <source> or <track> \n\t\t\t\t\tthis.hasFallback = true; \n\t\t\t\t}\n\t\t\t\ti++; \n\t\t\t}\n\t\t}\n\t\tif (!this.hasFallback) { \n\t\t\t// the HTML code does not include any nested fallback content \n\t\t\t// inject our own \n\t\t\t// NOTE: this message is not translated, since fallback may be needed \n\t\t\t// due to an error loading the translation file \n\t\t\t// This will only be needed on very rare occasions, so English is ok. \n\t\t\t$fallback = $('<p>').text('Media player unavailable.'); \n\t\t\tthis.$media.append($fallback); \n\t\t}\n\n\t\t// get height and width attributes, if present \n\t\t// and add them to a style attribute\n\t\tif (this.$media.attr('width')) { \n\t\t\tthis.$media.css('width',this.$media.attr('width') + 'px'); \n\t\t}\n\t\tif (this.$media.attr('height')) { \n\t\t\tthis.$media.css('height',this.$media.attr('height') + 'px'); \n\t\t}\n\t\t// Remove data-able-player attribute \n\t\tthis.$media.removeAttr('data-able-player'); \n\n\t\t// Add controls attribute (so browser will add its own controls)\n\t\tthis.$media.prop('controls',true); \n\n\t\tif (this.testFallback == 2) { \n\n\t\t\t// emulate browser failure to support HTML5 media by changing the media tag name \n\t\t\t// browsers should display the supported content that's nested inside \n\t\t\t$(this.$media).replaceWith($('<foobar id=\"foobar-' + this.mediaId + '\">'));\n\t\t\tthis.$newFallbackElement = $('#foobar-' + this.mediaId); \t\t\t\n\n\t\t\t// append all children from the original media \n\t\t\tif (this.$media.children().length) { \n\t\t\t\ti = this.$media.children().length - 1; \n\t\t\t\twhile (i >= 0) { \n\t\t\t\t\tthis.$newFallbackElement.prepend($(this.$media.children()[i])); \n\t\t\t\t\ti--; \n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!this.hasFallback) { \n\t\t\t\t// inject our own fallback content, defined above\n\t\t\t\tthis.$newFallbackElement.append($fallback);\n\t\t\t}\n\t\t}\n\t\treturn; \n\t};\n\n\tAblePlayer.prototype.calculateControlLayout = function () {\n\n\t\t// Calculates the layout for controls based on media and options.\n\t\t// Returns an array with 4 keys (for legacy skin) or 2 keys (for 2020 skin)\n\t\t// Keys are the following order:\n\t\t// 0 = Top left\n\t\t// 1 = Top right\n\t\t// 2 = Bottom left (legacy skin only)\n\t\t// 3 = Bottom right (legacy skin only)\n\t\t// Each key contains an array of control names to put in that section.\n\n\t\tvar controlLayout, volumeSupported, playbackSupported, totalButtonWidth, numA11yButtons;\n\n\t\tcontrolLayout = [];\n\t\tcontrolLayout[0] = [];\n\t\tcontrolLayout[1] = [];\n\t\tif (this.skin === 'legacy') {\n\t\t\tcontrolLayout[2] = [];\n\t\t\tcontrolLayout[3] = [];\n\t\t}\n\n\t\tcontrolLayout[0].push('play');\n\t\tcontrolLayout[0].push('restart');\n\t\tcontrolLayout[0].push('rewind');\n\t\tcontrolLayout[0].push('forward');\n\n\t\tif (this.skin === 'legacy') {\n\t\t\tcontrolLayout[1].push('seek');\n\t\t}\n\n\t\tif (this.hasPlaylist) {\n\t\t\tif (this.skin === 'legacy') {\n\t\t\t\tcontrolLayout[0].push('previous');\n\t\t\t\tcontrolLayout[0].push('next');\n\t\t\t}\n\t\t\telse if (this.skin == '2020') {\n\t\t\t\tcontrolLayout[0].push('previous');\n\t\t\t\tcontrolLayout[0].push('next');\n\t\t\t}\n\t\t}\n\n\t\tif (this.isPlaybackRateSupported()) {\n\t\t\tplaybackSupported = true;\n\t\t\tif (this.skin === 'legacy') {\n\t\t\t\tcontrolLayout[2].push('slower');\n\t\t\t\tcontrolLayout[2].push('faster');\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tplaybackSupported = false;\n\t\t}\n\n\t\tnumA11yButtons = 0;\n\t\tif (this.hasCaptions) {\n\t\t\tnumA11yButtons++;\n\t\t\tif (this.skin === 'legacy') {\n\t\t\t\tcontrolLayout[2].push('captions');\n\t\t\t}\n\t\t\telse if (this.skin == '2020') {\n\t\t\t\tcontrolLayout[1].push('captions');\n\t\t\t}\n\t\t}\n\t\tif (this.hasSignLanguage) {\n\t\t\tnumA11yButtons++;\n\t\t\tif (this.skin === 'legacy') {\n\t\t\t\tcontrolLayout[2].push('sign');\n\t\t\t}\n\t\t\telse if (this.skin == '2020') {\n\t\t\t\tcontrolLayout[1].push('sign');\n\t\t\t}\n\t\t}\n\t\tif (this.mediaType === 'video') { \n\t\t\tif (this.hasOpenDesc || this.hasClosedDesc) {\n\t\t\t\tnumA11yButtons++;\n\t\t\t\tif (this.skin === 'legacy') {\n\t\t\t\t\tcontrolLayout[2].push('descriptions');\n\t\t\t\t}\n\t\t\t\telse if (this.skin == '2020') {\n\t\t\t\t\tcontrolLayout[1].push('descriptions');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this.transcriptType === 'popup' && !(this.hideTranscriptButton)) {\n\t\t\tnumA11yButtons++;\n\t\t\tif (this.skin === 'legacy') {\n\t\t\t\tcontrolLayout[2].push('transcript');\n\t\t\t}\n\t\t\telse if (this.skin == '2020') {\n\t\t\t\tcontrolLayout[1].push('transcript');\n\t\t\t}\n\t\t}\n\t\tif (this.hasChapters && this.useChaptersButton) {\n\t\t\tnumA11yButtons++;\n\t\t\tif (this.skin === 'legacy') {\n\t\t\t\tcontrolLayout[2].push('chapters');\n\t\t\t}\n\t\t\telse if (this.skin == '2020') {\n\t\t\t\tcontrolLayout[1].push('chapters');\n\t\t\t}\n\t\t}\n\n\t\tif (this.skin == '2020' && numA11yButtons > 0) {\n\t\t\tcontrolLayout[1].push('pipe');\n\t\t}\n\n\t\tif (playbackSupported && this.skin === '2020') {\n\t\t\tcontrolLayout[1].push('faster');\n\t\t\tcontrolLayout[1].push('slower');\n\t\t\tcontrolLayout[1].push('pipe');\n\t\t}\n\n\t\tif (this.skin === 'legacy') {\n\t\t\tcontrolLayout[3].push('preferences');\n\t\t}\n\t\telse if (this.skin == '2020') {\n\t\t\tcontrolLayout[1].push('preferences');\n\t\t}\n\n\t\tif (this.mediaType === 'video' && this.allowFullscreen) {\n\t\t\tif (this.skin === 'legacy') {\n\t\t\t\tcontrolLayout[3].push('fullscreen');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcontrolLayout[1].push('fullscreen');\n\t\t\t}\n\t\t}\n\n\t\tif (this.browserSupportsVolume()) {\n\t\t\tvolumeSupported = true; // defined in case we decide to move volume button elsewhere\n\t\t\tthis.volumeButton = 'volume-' + this.getVolumeName(this.volume);\n\t\t\tif (this.skin === 'legacy') {\n\t\t\t\tcontrolLayout[1].push('volume');\n\t\t\t}\n\t\t\telse if (this.skin == '2020') {\n\t\t\t\tcontrolLayout[1].push('volume');\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tvolumeSupported = false;\n\t\t\tthis.volume = false;\n\t\t}\n\t\treturn controlLayout;\n\t};\n\n\tAblePlayer.prototype.addControls = function() {\n\n\t\t// determine which controls to show based on several factors:\n\t\t// mediaType (audio vs video)\n\t\t// availability of tracks (e.g., for closed captions & audio description)\n\t\t// browser support (e.g., for sliders and speedButtons)\n\t\t// user preferences (???)\n\t\t// some controls are aligned on the left, and others on the right\n\n\t\tvar thisObj, baseSliderWidth, controlLayout, numSections,\n\t\ti, j, k, controls, $controllerSpan, $sliderDiv, sliderLabel, $pipe, $pipeImg,\n\t\tsvgData, svgPath, control,\n\t\t$buttonLabel, $buttonImg, buttonImgSrc, buttonTitle, $newButton, iconClass, buttonIcon,\n\t\tbuttonUse, buttonText, position, buttonHeight, buttonWidth, buttonSide, controllerWidth,\n\t\ttooltipId, tooltipY, tooltipX, tooltipWidth, tooltipStyle, tooltip, tooltipTimerId,\n\t\tcaptionLabel, popupMenuId;\n\n\t\tthisObj = this;\n\n\t\tbaseSliderWidth = 100; // arbitrary value, will be recalculated in refreshControls()\n\n\t\t// Initialize the layout into the this.controlLayout variable.\n\t\tcontrolLayout = this.calculateControlLayout();\n\t\tnumSections = controlLayout.length;\n\n\t\t// add an empty div to serve as a tooltip\n\t\ttooltipId = this.mediaId + '-tooltip';\n\t\tthis.$tooltipDiv = $('<div>',{\n\t\t\t'id': tooltipId,\n\t\t\t'class': 'able-tooltip'\n\t\t}).hide();\n\t\tthis.$controllerDiv.append(this.$tooltipDiv);\n\n\t\tif (this.skin == '2020') {\t\t\t\n\t\t\t// add a full-width seek bar\n\t\t\t$sliderDiv = $('<div class=\"able-seekbar\"></div>');\n\t\t\tsliderLabel = this.mediaType + ' ' + this.tt.seekbarLabel;\n\t\t\tthis.$controllerDiv.append($sliderDiv);\n\t\t\tthis.seekBar = new AccessibleSlider(this.mediaType, $sliderDiv, 'horizontal', baseSliderWidth, 0, this.duration, this.seekInterval, sliderLabel, 'seekbar', true, 'visible');\n\t\t}\n\n\t\tfor (i = 0; i < numSections; i++) {\n\t\t\tcontrols = controlLayout[i];\n\t\t\tif ((i % 2) === 0) { // even keys on the left\n\t\t\t\t$controllerSpan = $('<div>',{\n\t\t\t\t\t'class': 'able-left-controls'\n\t\t\t\t});\n\t\t\t}\n\t\t\telse { // odd keys on the right\n\t\t\t\t$controllerSpan = $('<div>',{\n\t\t\t\t\t'class': 'able-right-controls'\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.$controllerDiv.append($controllerSpan);\n\n\t\t\tfor (j=0; j<controls.length; j++) {\n\t\t\t\tcontrol = controls[j];\n\t\t\t\tif (control === 'seek') {\n\t\t\t\t\t$sliderDiv = $('<div class=\"able-seekbar\"></div>');\n\t\t\t\t\tsliderLabel = this.mediaType + ' ' + this.tt.seekbarLabel;\n\t\t\t\t\t$controllerSpan.append($sliderDiv);\n\t\t\t\t\tif (typeof this.duration === 'undefined' || this.duration === 0) {\n\t\t\t\t\t\t// set arbitrary starting duration, and change it when duration is known\n\t\t\t\t\t\tthis.duration = 60;\n\t\t\t\t\t\t// also set elapsed to 0\n\t\t\t\t\t\tthis.elapsed = 0;\n\t\t\t\t\t}\n\t\t\t\t\tthis.seekBar = new AccessibleSlider(this.mediaType, $sliderDiv, 'horizontal', baseSliderWidth, 0, this.duration, this.seekInterval, sliderLabel, 'seekbar', true, 'visible');\n\t\t\t\t}\n\t\t\t\telse if (control === 'pipe') {\n\t\t\t\t\t$pipe = $('<span>', {\n\t\t\t\t\t\t'tabindex': '-1',\n\t\t\t\t\t\t'aria-hidden': 'true'\n\t\t\t\t\t});\n\t\t\t\t\tif (this.iconType === 'font') {\n\t\t\t\t\t\t$pipe.addClass('icon-pipe');\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$pipeImg = $('<img>', {\n\t\t\t\t\t\t\tsrc: this.rootPath + 'button-icons/' + this.iconColor + '/pipe.png',\n\t\t\t\t\t\t\talt: '',\n\t\t\t\t\t\t\trole: 'presentation'\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$pipe.append($pipeImg);\n\t\t\t\t\t}\n\t\t\t\t\t$controllerSpan.append($pipe);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// this control is a button\n\t\t\t\t\tif (control === 'volume') {\n\t\t\t\t\t\tbuttonImgSrc = this.rootPath + 'button-icons/' + this.iconColor + '/' + this.volumeButton + '.png';\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'fullscreen') {\n\t\t\t\t\t\tbuttonImgSrc = this.rootPath + 'button-icons/' + this.iconColor + '/fullscreen-expand.png';\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'slower') {\n\t\t\t\t\t\tif (this.speedIcons === 'animals') {\n\t\t\t\t\t\t\tbuttonImgSrc = this.rootPath + 'button-icons/' + this.iconColor + '/turtle.png';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tbuttonImgSrc = this.rootPath + 'button-icons/' + this.iconColor + '/slower.png';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'faster') {\n\t\t\t\t\t\tif (this.speedIcons === 'animals') {\n\t\t\t\t\t\t\tbuttonImgSrc = this.rootPath + 'button-icons/' + this.iconColor + '/rabbit.png';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tbuttonImgSrc = this.rootPath + 'button-icons/' + this.iconColor + '/faster.png';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tbuttonImgSrc = this.rootPath + 'button-icons/' + this.iconColor + '/' + control + '.png';\n\t\t\t\t\t}\n\t\t\t\t\tbuttonTitle = this.getButtonTitle(control);\n\n\t\t\t\t\t// icomoon documentation recommends the following markup for screen readers:\n\t\t\t\t\t// 1. link element (or in our case, button). Nested inside this element:\n\t\t\t\t\t// 2. span that contains the icon font (in our case, buttonIcon)\n\t\t\t\t\t// 3. span that contains a visually hidden label for screen readers (buttonLabel)\n\t\t\t\t\t// In addition, we are adding aria-label to the button (but not title)\n\t\t\t\t\t// And if iconType === 'image', we are replacing #2 with an image (with alt=\"\" and role=\"presentation\")\n\t\t\t\t\t// This has been thoroughly tested and works well in all screen reader/browser combinations\n\t\t\t\t\t// See https://github.com/ableplayer/ableplayer/issues/81\n\n\t\t\t\t\t// NOTE: Changed from <button> to <div role=\"button\" as of 4.2.18\n\t\t\t\t\t// because <button> elements are rendered poorly in high contrast mode\n\t\t\t\t\t// in some OS/browser/plugin combinations\n\t\t\t\t\t$newButton = $('<div>',{\n\t\t\t\t\t\t'role': 'button',\n\t\t\t\t\t\t'tabindex': '0',\n\t\t\t\t\t\t'aria-label': buttonTitle,\n\t\t\t\t\t\t'class': 'able-button-handler-' + control\n\t\t\t\t\t});\n\n\t\t\t\t\tif (control === 'volume' || control === 'preferences' || control === 'captions') {\n\t\t\t\t\t\tif (control == 'preferences') {\n\t\t\t\t\t\t\tthis.prefCats = this.getPreferencesGroups();\n\t\t\t\t\t\t\tif (this.prefCats.length > 1) {\n\t\t\t\t\t\t\t\t// Prefs button will trigger a menu\n\t\t\t\t\t\t\t\tpopupMenuId = this.mediaId + '-prefs-menu';\n\t\t\t\t\t\t\t\t$newButton.attr({\n\t\t\t\t\t\t\t\t\t'aria-controls': popupMenuId,\n\t\t\t\t\t\t\t\t\t'aria-haspopup': 'menu',\n\t\t\t\t\t\t\t\t\t'aria-expanded': 'false'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (this.prefCats.length === 1) {\n\t\t\t\t\t\t\t\t// Prefs button will trigger a dialog\n\t\t\t\t\t\t\t\t$newButton.attr({\n\t\t\t\t\t\t\t\t\t'aria-haspopup': 'dialog'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (control === 'volume') {\n\t\t\t\t\t\t\tpopupMenuId = this.mediaId + '-volume-slider';\n\t\t\t\t\t\t\t// volume slider popup is not a menu or a dialog\n\t\t\t\t\t\t\t// therefore, using aria-expanded rather than aria-haspopup to communicate properties/state\n\t\t\t\t\t\t\t$newButton.attr({\n\t\t\t\t\t\t\t\t'aria-controls': popupMenuId,\n\t\t\t\t\t\t\t\t'aria-expanded': 'false'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (control === 'captions' && this.captions) {\n\t\t\t\t\t\t\tif (this.captions.length > 1) {\n\t\t\t\t\t\t\t\t$newButton.attr('aria-expanded', 'false')\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$newButton.attr('aria-pressed', 'false')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (this.iconType === 'font') {\n\t\t\t\t\t\tif (control === 'volume') {\n\t\t\t\t\t\t\ticonClass = 'icon-' + this.volumeButton;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (control === 'slower') {\n\t\t\t\t\t\t\tif (this.speedIcons === 'animals') {\n\t\t\t\t\t\t\t\ticonClass = 'icon-turtle';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\ticonClass = 'icon-slower';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (control === 'faster') {\n\t\t\t\t\t\t\tif (this.speedIcons === 'animals') {\n\t\t\t\t\t\t\t\ticonClass = 'icon-rabbit';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\ticonClass = 'icon-faster';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\ticonClass = 'icon-' + control;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbuttonIcon = $('<span>',{\n\t\t\t\t\t\t\t'class': iconClass,\n\t\t\t\t\t\t\t'aria-hidden': 'true'\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$newButton.append(buttonIcon);\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.iconType === 'svg') {\n\n\t\t\t\t\t/*\n\t\t\t\t\t\t// Unused option for adding SVG:\n\t\t\t\t\t\t// Use <use> element to link to button-icons/able-icons.svg\n\t\t\t\t\t\t// Advantage: SVG file can be cached\n\t\t\t\t\t\t// Disadvantage: Not supported by Safari 6, IE 6-11, or Edge 12\n\t\t\t\t\t\t// Instead, adding <svg> element within each <button>\n\t\t\t\t\t\tif (control === 'volume') {\n\t\t\t\t\t\t\ticonClass = 'svg-' + this.volumeButton;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (control === 'fullscreen') {\n\t\t\t\t\t\t\ticonClass = 'svg-fullscreen-expand';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (control === 'slower') {\n\t\t\t\t\t\t\tif (this.speedIcons === 'animals') {\n\t\t\t\t\t\t\t\ticonClass = 'svg-turtle';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\ticonClass = 'svg-slower';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (control === 'faster') {\n\t\t\t\t\t\t\tif (this.speedIcons === 'animals') {\n\t\t\t\t\t\t\t\ticonClass = 'svg-rabbit';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\ticonClass = 'svg-faster';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\ticonClass = 'svg-' + control;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbuttonIcon = $('<svg>',{\n\t\t\t\t\t\t\t'class': iconClass\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbuttonUse = $('<use>',{\n\t\t\t\t\t\t\t'xlink:href': this.rootPath + 'button-icons/able-icons.svg#' + iconClass\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbuttonIcon.append(buttonUse);\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tvar svgData;\n\t\t\t\t\t\tif (control === 'volume') {\n\t\t\t\t\t\t\tsvgData = this.getSvgData(this.volumeButton);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (control === 'fullscreen') {\n\t\t\t\t\t\t\tsvgData = this.getSvgData('fullscreen-expand');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (control === 'slower') {\n\t\t\t\t\t\t\tif (this.speedIcons === 'animals') {\n\t\t\t\t\t\t\t\tsvgData = this.getSvgData('turtle');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tsvgData = this.getSvgData('slower');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (control === 'faster') {\n\t\t\t\t\t\t\tif (this.speedIcons === 'animals') {\n\t\t\t\t\t\t\t\tsvgData = this.getSvgData('rabbit');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tsvgData = this.getSvgData('faster');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tsvgData = this.getSvgData(control);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbuttonIcon = $('<svg>',{\n\t\t\t\t\t\t\t'focusable': 'false',\n\t\t\t\t\t\t\t'aria-hidden': 'true',\n\t\t\t\t\t\t\t'viewBox': svgData[0]\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsvgPath = $('<path>',{\n\t\t\t\t\t\t\t'd': svgData[1]\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbuttonIcon.append(svgPath);\n\t\t\t\t\t\t$newButton.html(buttonIcon);\n\n\t\t\t\t\t\t// Final step: Need to refresh the DOM in order for browser to process & display the SVG\n\t\t\t\t\t\t$newButton.html($newButton.html());\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// use images\n\t\t\t\t\t\t$buttonImg = $('<img>',{\n\t\t\t\t\t\t\t'src': buttonImgSrc,\n\t\t\t\t\t\t\t'alt': '',\n\t\t\t\t\t\t\t'role': 'presentation'\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$newButton.append($buttonImg);\n\t\t\t\t\t}\n\t\t\t\t\t// add the visibly-hidden label for screen readers that don't support aria-label on the button\n\t\t\t\t\tvar $buttonLabel = $('<span>',{\n\t\t\t\t\t\t'class': 'able-clipped'\n\t\t\t\t\t}).text(buttonTitle);\n\t\t\t\t\t$newButton.append($buttonLabel);\n\t\t\t\t\t// add an event listener that displays a tooltip on mouseenter or focus\n\t\t\t\t\t$newButton.on('mouseenter focus',function(e) {\n\n\t\t\t\t\t\t// when entering a new tooltip, we can forget about hiding the previous tooltip.\n\t\t\t\t\t\t// since the same tooltip div is used, it's location just changes.\n\t\t\t\t\t\tclearTimeout(tooltipTimerId);\n\n\t\t\t\t\t\tvar buttonText = $(this).attr('aria-label');\n\t\t\t\t\t\t// get position of this button\n\t\t\t\t\t\tvar position = $(this).position();\n\t\t\t\t\t\tvar buttonHeight = $(this).height();\n\t\t\t\t\t\tvar buttonWidth = $(this).width();\n\t\t\t\t\t\t// position() is expressed using top and left (of button);\n\t\t\t\t\t\t// add right (of button) too, for convenience\n\t\t\t\t\t\tvar controllerWidth = thisObj.$controllerDiv.width();\n\t\t\t\t\t\tposition.right = controllerWidth - position.left - buttonWidth;\n\n\t\t\t\t\t\t// The following formula positions tooltip above the button  \n\t\t\t\t\t\t// var tooltipY = position.top - buttonHeight - 15;\n\n\t\t\t\t\t\t// The following formula positions tooltip below the button \n\t\t\t\t\t\t// which allows the tooltip to be hoverable as per WCAG 2.x SC 1.4.13\n\t\t\t\t\t\t// without obstructing the seekbar \n\t\t\t\t\t\tvar tooltipY = position.top + buttonHeight + 5; \n\n\t\t\t\t\t\tif ($(this).parent().hasClass('able-right-controls')) {\n\t\t\t\t\t\t\t// this control is on the right side\n\t\t\t\t\t\t\tvar buttonSide = 'right';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// this control is on the left side\n\t\t\t\t\t\t\tvar buttonSide = 'left';\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// populate tooltip, then calculate its width before showing it\n\t\t\t\t\t\tvar tooltipWidth = AblePlayer.localGetElementById($newButton[0], tooltipId).text(buttonText).width();\n\t\t\t\t\t\t// center the tooltip horizontally over the button\n\t\t\t\t\t\tif (buttonSide == 'left') {\n\t\t\t\t\t\t\tvar tooltipX = position.left - tooltipWidth/2;\n\t\t\t\t\t\t\tif (tooltipX < 0) {\n\t\t\t\t\t\t\t\t// tooltip would exceed the bounds of the player. Adjust.\n\t\t\t\t\t\t\t\ttooltipX = 2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar tooltipStyle = {\n\t\t\t\t\t\t\t\tleft: tooltipX + 'px',\n\t\t\t\t\t\t\t\tright: '',\n\t\t\t\t\t\t\t\ttop: tooltipY + 'px'\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tvar tooltipX = position.right - tooltipWidth/2;\n\t\t\t\t\t\t\tif (tooltipX < 0) {\n\t\t\t\t\t\t\t\t// tooltip would exceed the bounds of the player. Adjust.\n\t\t\t\t\t\t\t\ttooltipX = 2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar tooltipStyle = {\n\t\t\t\t\t\t\t\tleft: '',\n\t\t\t\t\t\t\t\tright: tooltipX + 'px',\n\t\t\t\t\t\t\t\ttop: tooltipY + 'px'\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar tooltip = AblePlayer.localGetElementById($newButton[0], tooltipId).text(buttonText).css(tooltipStyle);\n\t\t\t\t\t\tthisObj.showTooltip(tooltip);\n\t\t\t\t\t\t$(this).on('mouseleave blur',function() {\n\n\t\t\t\t\t\t\t// hide tooltip  (original line of code)\n\t\t\t\t\t\t\t// AblePlayer.localGetElementById($newButton[0], tooltipId).text('').hide();\n\n\t\t\t\t\t\t\t// The above line was replaced with the following block \n\t\t\t\t\t\t\t// in order to meet WCAG 2.x SC 1.4.13 \n\t\t\t\t\t\t\t// (keep the tooltip visible if user hovers over it)\n\t\t\t\t\t\t\t// This causes unwanted side effects if tooltips are positioned above the buttons \n\t\t\t\t\t\t\t// as the persistent tooltip obstructs the seekbar, \n\t\t\t\t\t\t\t// blocking users from being able to move a pointer from a button to the seekbar \n\t\t\t\t\t\t\t// This limitation was addressed in 4.4.49 by moving the tooltip below the buttons \n\n\t\t\t\t\t\t\t// clear existing timeout before reassigning variable\n\t\t\t\t\t\t\tclearTimeout(tooltipTimerId);\n\t\t\t\t\t\t\ttooltipTimerId = setTimeout(function() {\n\t\t\t\t\t\t\t\t// give the user a half second to move cursor to tooltip before removing\n\t\t\t\t\t\t\t\t// see https://www.w3.org/WAI/WCAG21/Understanding/content-on-hover-or-focus#hoverable\n\t\t\t\t\t\t\t\tAblePlayer.localGetElementById($newButton[0], tooltipId).text('').hide();\n\t\t\t\t\t\t\t}, 500);\n\n\t\t\t\t\t\t\tthisObj.$tooltipDiv.on('mouseenter focus', function() {\n\t\t\t\t\t\t\t\tclearTimeout(tooltipTimerId);\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthisObj.$tooltipDiv.on('mouseleave blur', function() {\n\t\t\t\t\t\t\t\tAblePlayer.localGetElementById($newButton[0], tooltipId).text('').hide();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}); \n\t\t\t\t\t});\n\n\t\t\t\t\tif (control === 'captions') {\n\t\t\t\t\t\tif (!this.prefCaptions || this.prefCaptions !== 1) {\n\t\t\t\t\t\t\t// captions are available, but user has them turned off\n\t\t\t\t\t\t\tif (this.captions.length > 1) {\n\t\t\t\t\t\t\t\tcaptionLabel = this.tt.captions;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tcaptionLabel = this.tt.showCaptions;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$newButton.addClass('buttonOff').attr('title',captionLabel);\n\t\t\t\t\t\t\t$newButton.attr('aria-pressed', 'false');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'descriptions') {\n\t\t\t\t\t\tif (!this.prefDesc || this.prefDesc !== 1) {\n\t\t\t\t\t\t\t// user prefer non-audio described version\n\t\t\t\t\t\t\t// Therefore, load media without description\n\t\t\t\t\t\t\t// Description can be toggled on later with this button\n\t\t\t\t\t\t\t$newButton.addClass('buttonOff').attr('title',this.tt.turnOnDescriptions);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t$controllerSpan.append($newButton);\n\n\t\t\t\t\t// create variables of buttons that are referenced throughout the AblePlayer object\n\t\t\t\t\tif (control === 'play') {\n\t\t\t\t\t\tthis.$playpauseButton = $newButton;\n\t\t\t\t\t}\n\t\t\t\t\telse if (control == 'previous') {\n\t\t\t\t\t\tthis.$prevButton = $newButton;\n\t\t\t\t\t\t// if player is being rebuilt because user clicked the Prev button\n\t\t\t\t\t\t// return focus to that (newly built) button\n\t\t\t\t\t\tif (this.buttonWithFocus == 'previous') {\n\t\t\t\t\t\t\tthis.$prevButton.focus();\n\t\t\t\t\t\t\tthis.buttonWithFocus = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (control == 'next') {\n\t\t\t\t\t\tthis.$nextButton = $newButton;\n\t\t\t\t\t\t// if player is being rebuilt because user clicked the Next button\n\t\t\t\t\t\t// return focus to that (newly built) button\n\t\t\t\t\t\tif (this.buttonWithFocus == 'next') {\n\t\t\t\t\t\t\tthis.$nextButton.focus();\n\t\t\t\t\t\t\tthis.buttonWithFocus = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'captions') {\n\t\t\t\t\t\tthis.$ccButton = $newButton;\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'sign') {\n\t\t\t\t\t\tthis.$signButton = $newButton;\n\t\t\t\t\t\t// gray out sign button if sign language window is not active\n\t\t\t\t\t\tif (!(this.$signWindow.is(':visible'))) {\n\t\t\t\t\t\t\tthis.$signButton.addClass('buttonOff');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'descriptions') {\n\t\t\t\t\t\tthis.$descButton = $newButton;\n\t\t\t\t\t\t// button will be enabled or disabled in description.js > initDescription()\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'mute') {\n\t\t\t\t\t\tthis.$muteButton = $newButton;\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'transcript') {\n\t\t\t\t\t\tthis.$transcriptButton = $newButton;\n\t\t\t\t\t\t// gray out transcript button if transcript is not active\n\t\t\t\t\t\tif (!(this.$transcriptDiv.is(':visible'))) {\n\t\t\t\t\t\t\tthis.$transcriptButton.addClass('buttonOff').attr('title',this.tt.showTranscript);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'fullscreen') {\n\t\t\t\t\t\tthis.$fullscreenButton = $newButton;\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'chapters') {\n\t\t\t\t\t\tthis.$chaptersButton = $newButton;\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'preferences') {\n\t\t\t\t\t\tthis.$prefsButton = $newButton;\n\t\t\t\t\t}\n\t\t\t\t\telse if (control === 'volume') {\n\t\t\t\t\t\tthis.$volumeButton = $newButton;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (control === 'volume') {\n\t\t\t\t\t// in addition to the volume button, add a hidden slider\n\t\t\t\t\tthis.addVolumeSlider($controllerSpan);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ((i % 2) == 1) {\n\t\t\t\tthis.$controllerDiv.append('<div style=\"clear:both;\"></div>');\n\t\t\t}\n\t\t}\n\n\t\tif (typeof this.$captionsDiv !== 'undefined') {\n\t\t\t// stylize captions based on user prefs\n\t\t\tthis.stylizeCaptions(this.$captionsDiv);\n\t\t}\n\t\tif (typeof this.$descDiv !== 'undefined') {\n\t\t\t// stylize descriptions based on user's caption prefs\n\t\t\tthis.stylizeCaptions(this.$descDiv);\n\t\t}\n\n\t\t// combine left and right controls arrays for future reference\n\t\tthis.controls = [];\n\t\tfor (var sec in controlLayout) if (controlLayout.hasOwnProperty(sec)) {\n\t\t\tthis.controls = this.controls.concat(controlLayout[sec]);\n\t\t}\n\n\t\t// Update state-based display of controls.\n\t\tthis.refreshControls('init');\n\t};\n\n\tAblePlayer.prototype.useSvg = function () {\n\n\t\t// Modified from IcoMoon.io svgxuse\n\t\t// @copyright Copyright (c) 2016 IcoMoon.io\n\t\t// @license\t\tLicensed under MIT license\n\t\t// See https://github.com/Keyamoon/svgxuse\n\t\t// @version\t\t1.1.16\n\n\t\tvar cache = Object.create(null); // holds xhr objects to prevent multiple requests\n\t\tvar checkUseElems,\n\t\t\t\ttid; // timeout id\n\t\tvar debouncedCheck = function () {\n\t\t\tclearTimeout(tid);\n\t\t\ttid = setTimeout(checkUseElems, 100);\n\t\t};\n\t\tvar unobserveChanges = function () {\n\t\t\treturn;\n\t\t};\n\t\tvar observeChanges = function () {\n\t\t\tvar observer;\n\t\t\twindow.addEventListener('resize', debouncedCheck, false);\n\t\t\twindow.addEventListener('orientationchange', debouncedCheck, false);\n\t\t\tif (window.MutationObserver) {\n\t\t\t\tobserver = new MutationObserver(debouncedCheck);\n\t\t\t\tobserver.observe(document.documentElement, {\n\t\t\t\t\tchildList: true,\n\t\t\t\t\tsubtree: true,\n\t\t\t\t\tattributes: true\n\t\t\t\t});\n\t\t\t\tunobserveChanges = function () {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tobserver.disconnect();\n\t\t\t\t\t\twindow.removeEventListener('resize', debouncedCheck, false);\n\t\t\t\t\t\twindow.removeEventListener('orientationchange', debouncedCheck, false);\n\t\t\t\t\t} catch (ignore) {}\n\t\t\t\t};\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdocument.documentElement.addEventListener('DOMSubtreeModified', debouncedCheck, false);\n\t\t\t\tunobserveChanges = function () {\n\t\t\t\t\tdocument.documentElement.removeEventListener('DOMSubtreeModified', debouncedCheck, false);\n\t\t\t\t\twindow.removeEventListener('resize', debouncedCheck, false);\n\t\t\t\t\twindow.removeEventListener('orientationchange', debouncedCheck, false);\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t\tvar xlinkNS = 'http://www.w3.org/1999/xlink';\n\t\tcheckUseElems = function () {\n\t\t\tvar base,\n\t\t\t\t\tbcr,\n\t\t\t\t\tfallback = '', // optional fallback URL in case no base path to SVG file was given and no symbol definition was found.\n\t\t\t\t\thash,\n\t\t\t\t\ti,\n\t\t\t\t\tRequest,\n\t\t\t\t\tinProgressCount = 0,\n\t\t\t\t\tisHidden,\n\t\t\t\t\turl,\n\t\t\t\t\tuses,\n\t\t\t\t\txhr;\n\t\t\tif (window.XMLHttpRequest) {\n\t\t\t\tRequest = new XMLHttpRequest();\n\t\t\t\tif (Request.withCredentials !== undefined) {\n\t\t\t\t\tRequest = XMLHttpRequest;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tRequest = XDomainRequest || undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (Request === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfunction observeIfDone() {\n\t\t\t\t// If done with making changes, start watching for chagnes in DOM again\n\t\t\t\tinProgressCount -= 1;\n\t\t\t\tif (inProgressCount === 0) { // if all xhrs were resolved\n\t\t\t\t\tobserveChanges(); // watch for changes to DOM\n\t\t\t\t}\n\t\t\t}\n\t\t\tfunction attrUpdateFunc(spec) {\n\t\t\t\treturn function () {\n\t\t\t\t\tif (cache[spec.base] !== true) {\n\t\t\t\t\t\tspec.useEl.setAttributeNS(xlinkNS, 'xlink:href', '#' + spec.hash);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\tfunction onloadFunc(xhr) {\n\t\t\t\treturn function () {\n\t\t\t\t\tvar body = document.body;\n\t\t\t\t\tvar x = document.createElement('x');\n\t\t\t\t\tvar svg;\n\t\t\t\t\txhr.onload = null;\n\t\t\t\t\tx.innerHTML = xhr.responseText;\n\t\t\t\t\tsvg = x.getElementsByTagName('svg')[0];\n\t\t\t\t\tif (svg) {\n\t\t\t\t\t\tsvg.setAttribute('aria-hidden', 'true');\n\t\t\t\t\t\tsvg.style.position = 'absolute';\n\t\t\t\t\t\tsvg.style.width = 0;\n\t\t\t\t\t\tsvg.style.height = 0;\n\t\t\t\t\t\tsvg.style.overflow = 'hidden';\n\t\t\t\t\t\tbody.insertBefore(svg, body.firstChild);\n\t\t\t\t\t}\n\t\t\t\t\tobserveIfDone();\n\t\t\t\t};\n\t\t\t}\n\t\t\tfunction onErrorTimeout(xhr) {\n\t\t\t\treturn function () {\n\t\t\t\t\txhr.onerror = null;\n\t\t\t\t\txhr.ontimeout = null;\n\t\t\t\t\tobserveIfDone();\n\t\t\t\t};\n\t\t\t}\n\t\t\tunobserveChanges(); // stop watching for changes to DOM\n\t\t\t// find all use elements\n\t\t\tuses = document.getElementsByTagName('use');\n\t\t\tfor (i = 0; i < uses.length; i += 1) {\n\t\t\t\ttry {\n\t\t\t\t\tbcr = uses[i].getBoundingClientRect();\n\t\t\t\t} catch (ignore) {\n\t\t\t\t\t// failed to get bounding rectangle of the use element\n\t\t\t\t\tbcr = false;\n\t\t\t\t}\n\t\t\t\turl = uses[i].getAttributeNS(xlinkNS, 'href').split('#');\n\t\t\t\tbase = url[0];\n\t\t\t\thash = url[1];\n\t\t\t\tisHidden = bcr && bcr.left === 0 && bcr.right === 0 && bcr.top === 0 && bcr.bottom === 0;\n\t\t\t\tif (bcr && bcr.width === 0 && bcr.height === 0 && !isHidden) {\n\t\t\t\t\t// the use element is empty\n\t\t\t\t\t// if there is a reference to an external SVG, try to fetch it\n\t\t\t\t\t// use the optional fallback URL if there is no reference to an external SVG\n\t\t\t\t\tif (fallback && !base.length && hash && !document.getElementById(hash)) {\n\t\t\t\t\t\tbase = fallback;\n\t\t\t\t\t}\n\t\t\t\t\tif (base.length) {\n\t\t\t\t\t\t// schedule updating xlink:href\n\t\t\t\t\t\txhr = cache[base];\n\t\t\t\t\t\tif (xhr !== true) {\n\t\t\t\t\t\t\t// true signifies that prepending the SVG was not required\n\t\t\t\t\t\t\tsetTimeout(attrUpdateFunc({\n\t\t\t\t\t\t\t\tuseEl: uses[i],\n\t\t\t\t\t\t\t\tbase: base,\n\t\t\t\t\t\t\t\thash: hash\n\t\t\t\t\t\t\t}), 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (xhr === undefined) {\n\t\t\t\t\t\t\txhr = new Request();\n\t\t\t\t\t\t\tcache[base] = xhr;\n\t\t\t\t\t\t\txhr.onload = onloadFunc(xhr);\n\t\t\t\t\t\t\txhr.onerror = onErrorTimeout(xhr);\n\t\t\t\t\t\t\txhr.ontimeout = onErrorTimeout(xhr);\n\t\t\t\t\t\t\txhr.open('GET', base);\n\t\t\t\t\t\t\txhr.send();\n\t\t\t\t\t\t\tinProgressCount += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (!isHidden) {\n\t\t\t\t\t\tif (cache[base] === undefined) {\n\t\t\t\t\t\t\t// remember this URL if the use element was not empty and no request was sent\n\t\t\t\t\t\t\tcache[base] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (cache[base].onload) {\n\t\t\t\t\t\t\t// if it turns out that prepending the SVG is not necessary,\n\t\t\t\t\t\t\t// abort the in-progress xhr.\n\t\t\t\t\t\t\tcache[base].abort();\n\t\t\t\t\t\t\tcache[base].onload = undefined;\n\t\t\t\t\t\t\tcache[base] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tuses = '';\n\t\t\tinProgressCount += 1;\n\t\t\tobserveIfDone();\n\t\t};\n/*\n\t\t// The load event fires when all resources have finished loading, which allows detecting whether SVG use elements are empty.\n\t\twindow.addEventListener('load', function winLoad() {\n\t\t\twindow.removeEventListener('load', winLoad, false); // to prevent memory leaks\n\t\t\ttid = setTimeout(checkUseElems, 0);\n\t\t}, false);\n*/\n\t};\n\n\tAblePlayer.prototype.cuePlaylistItem = function(sourceIndex) {\n\n\t\t// Move to a new item in a playlist.\n\t\t// NOTE: Swapping source for audio description is handled elsewhere;\n\t\t// see description.js > swapDescription()\n\n\t\t/*\n\t\t\t// Decided against preventing a reload of the current item in the playlist.\n\t\t\t// If it's clickable, users should be able to click on it and expect something to happen.\n\t\t\t// Leaving here though in case it's determined to be desirable.\n\t\tif (sourceIndex === this.playlistItemIndex) {\n\t\t\t// user has requested the item that's currently playing\n\t\t\t// just ignore the request\n\t\t\treturn;\n\t\t}\n\t\tthis.playlistItemIndex = sourceIndex;\n\t\t*/\n\n\t\tvar $newItem, prevPlayer, newPlayer, itemTitle, itemLang, sources, s, i, $newSource, nowPlayingSpan;\n\n\t\tvar thisObj = this;\n\n\t\tprevPlayer = this.player;\n\n\t\tif (this.initializing) { // this is the first track - user hasn't pressed play yet\n\t\t\t// do nothing.\n\t\t}\n\t\telse {\n\t\t\t\tif (this.playerCreated) {\n\t\t\t\t// remove the old\n\t\t\t\tthis.deletePlayer('playlist');\n\t\t\t}\n\t\t}\n\n\t\t// set swappingSrc; needs to be true within recreatePlayer(), called below\n\t\tthis.swappingSrc = true;\n\n\t\t// if a new playlist item is being requested, and playback has already started,  \n\t\t// it should be ok to play automatically, regardless of how it was requested \n\t\tif (this.startedPlaying) { \n\t\t\tthis.okToPlay = true; \n\t\t}\n\t\telse { \n\t\t\tthis.okToPlay = false; \n\t\t}\n\n\t\t// We are no longer loading the previous media source \n\t\t// Only now, as a new source is requested, is it safe to reset this var \n\t\t// It will be reset to true when media.load() is called \n\t\tthis.loadingMedia = false; \n\n\t\t// Determine appropriate player to play this media\n\t\t$newItem = this.$playlist.eq(sourceIndex);\n\t\tif (this.hasAttr($newItem,'data-youtube-id')) {\n\t\t\tthis.youTubeId = this.getYouTubeId($newItem.attr('data-youtube-id'));\n\t\t\tif (this.hasAttr($newItem,'data-youtube-desc-id')) {\n\t\t\t\tthis.youTubeDescId = this.getYouTubeId($newItem.attr('data-youtube-desc-id'));\n\t\t\t}\n\t\t\tnewPlayer = 'youtube';\n\t\t}\n\t\telse if (this.hasAttr($newItem,'data-vimeo-id')) {\n\t\t\tthis.vimeoId = this.getVimeoId($newItem.attr('data-vimeo-id'));\n\t\t\tif (this.hasAttr($newItem,'data-vimeo-desc-id')) {\n\t\t\t\tthis.vimeoDescId = this.getVimeoId($newItem.attr('data-vimeo-desc-id'));\n\t\t\t}\n\t\t\tnewPlayer = 'vimeo';\n\t\t}\n\t\telse {\n\t\t\t\tnewPlayer = 'html5';\n\t\t}\n\t\tif (newPlayer === 'youtube') {\n\t\t\tif (prevPlayer === 'html5') {\n\t\t\t\t// pause and hide the previous media\n\t\t\t\tif (this.playing) {\n\t\t\t\t\tthis.pauseMedia();\n\t\t\t\t}\n\t\t\t\tthis.$media.hide();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t\t// the new player is not youtube\n\t\t\tthis.youTubeId = false;\n\t\t\tif (prevPlayer === 'youtube') {\n\t\t\t\t// unhide the media element\n\t\t\t\tthis.$media.show();\n\t\t\t}\n\t\t}\n\t\tthis.player = newPlayer;\n\n\t\t// remove source and track elements from previous playlist item\n\t\tthis.$media.empty();\n\n\t\t// transfer media attributes from playlist to media element\n\t\tif (this.hasAttr($newItem,'data-poster')) {\n\t\t\tthis.$media.attr('poster',$newItem.attr('data-poster'));\n\t\t}\n\t\tif (this.hasAttr($newItem,'data-youtube-desc-id')) {\n\t\t\tthis.$media.attr('data-youtube-desc-id',$newItem.attr('data-youtube-desc-id'));\n\t\t}\n\t\tif (this.youTubeId) {\n\t\t\tthis.$media.attr('data-youtube-id',$newItem.attr('data-youtube-id'));\n\t\t}\n\n\t\t// add new <source> elements from playlist data\n\t\tvar $sourceSpans = $newItem.children('span.able-source');\n\t\tif ($sourceSpans.length) {\n\t\t\t$sourceSpans.each(function() {\n\t\t\t\tif (thisObj.hasAttr($(this),'data-src')) {\n\t\t\t\t\t// this is the only required attribute\n\t\t\t\t\tvar $newSource = $('<source>',{\n\t\t\t\t\t\t'src': $(this).attr('data-src')\n\t\t\t\t\t});\n\t\t\t\t\tif (thisObj.hasAttr($(this),'data-type')) {\n\t\t\t\t\t\t$newSource.attr('type',$(this).attr('data-type'));\n\t\t\t\t\t}\n\t\t\t\t\tif (thisObj.hasAttr($(this),'data-desc-src')) {\n\t\t\t\t\t\t$newSource.attr('data-desc-src',$(this).attr('data-desc-src'));\n\t\t\t\t\t}\n\t\t\t\t\tif (thisObj.hasAttr($(this),'data-sign-src')) {\n\t\t\t\t\t\t$newSource.attr('data-sign-src',$(this).attr('data-sign-src'));\n\t\t\t\t\t}\n\t\t\t\t\tthisObj.$media.append($newSource);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// add new <track> elements from playlist data\n\t\tvar $trackSpans = $newItem.children('span.able-track');\n\t\tif ($trackSpans.length) {\n\t\t\t // for each element in $trackSpans, create a new <track> element\n\t\t\t$trackSpans.each(function() {\n\t\t\t\tif (thisObj.hasAttr($(this),'data-src') &&\n\t\t\t\t\tthisObj.hasAttr($(this),'data-kind') &&\n\t\t\t\t\tthisObj.hasAttr($(this),'data-srclang')) {\n\t\t\t\t\t// all required attributes are present\n\t\t\t\t\tvar $newTrack = $('<track>',{\n\t\t\t\t\t\t'src': $(this).attr('data-src'),\n\t\t\t\t\t\t'kind': $(this).attr('data-kind'),\n\t\t\t\t\t\t'srclang': $(this).attr('data-srclang')\n\t\t\t\t\t});\n\t\t\t\t\tif (thisObj.hasAttr($(this),'data-label')) {\n\t\t\t\t\t\t$newTrack.attr('label',$(this).attr('data-label'));\n\t\t\t\t\t}\n\t\t\t\t\tif (thisObj.hasAttr($(this),'data-desc')) {\n\t\t\t\t\t\t$newTrack.attr('data-desc',$(this).attr('data-desc'));\n\t\t\t\t\t}\n\t\t\t\t\tthisObj.$media.append($newTrack);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\titemTitle = $newItem.text();\n\t\tif (this.hasAttr($newItem,'lang')) {\n\t\t\titemLang = $newItem.attr('lang');\n\t\t}\n\t\t// Update relevant arrays\n\t\tthis.$sources = this.$media.find('source');\n\n\t\t// recreate player, informed by new attributes and track elements\n\t\tif (this.recreatingPlayer) { \n\t\t\t// stopgap to prevent multiple firings of recreatePlayer()\n\t\t\treturn; \n\t\t}\n\t\tthis.recreatePlayer().then(function() { \n\n\t\t\t// update playlist to indicate which item is playing\n\t\t\tthisObj.$playlist.removeClass('able-current')\n\t\t\t\t.children('button').removeAttr('aria-current');\n\t\t\tthisObj.$playlist.eq(sourceIndex).addClass('able-current')\n\t\t\t\t.children('button').attr('aria-current','true'); \n\t\t\t\n\t\t\t// update Now Playing div\n\t\t\tif (thisObj.showNowPlaying === true) {\n\t\t\t\tif (typeof thisObj.$nowPlayingDiv !== 'undefined') {\n\t\t\t\t\tnowPlayingSpan = $('<span>');\n\t\t\t\t\tif (typeof itemLang !== 'undefined') {\n\t\t\t\t\t\tnowPlayingSpan.attr('lang',itemLang);\n\t\t\t\t\t}\n\t\t\t\t\tnowPlayingSpan.html('<span>' + thisObj.tt.selectedTrack + ':</span>' + itemTitle);\n\t\t\t\t\tthisObj.$nowPlayingDiv.html(nowPlayingSpan);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// if thisObj.swappingSrc is true, media will autoplay when ready\n\t\t\tif (thisObj.initializing) { // this is the first track - user hasn't pressed play yet\n\t\t\t\tthisObj.swappingSrc = false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (thisObj.player === 'html5') {\n\t\t\t\t\tif (!thisObj.loadingMedia) { \n\t\t\t\t\t\tthisObj.media.load();\n\t\t\t\t\t\tthisObj.loadingMedia = true; \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (thisObj.player === 'youtube') {\n\t\t\t\t\tthisObj.okToPlay = true; \n\t\t\t\t}\n\t\t\t}\n\t\t\tthisObj.initializing = false;\n\t\t\tthisObj.playerCreated = true; // remains true until browser is refreshed\t\t\n\t\t});\t\n\t};\n\n\tAblePlayer.prototype.deletePlayer = function(context) {\n\n\t\t// remove player components that need to be rebuilt \n\t\t// after swapping media sources that have different durations \n\t\t// or explicitly declared data-desc attributes  \n\n\t\t// Context is one of the following: \n\t\t// playlist - called from cuePlaylistItem() \n\t\t// swap-desc-html - called from swapDescription with this.player == 'html'\n\t\t// swap-desc-youtube - called from swapDescription with this.player == 'youtube'  \n\t\t// swap-desc-vimeo -  called from swapDescription with this.player == 'vimeo'  \n\n\t\tif (this.player === 'youtube' && this.youTubePlayer) { \n\t\t\tthis.youTubePlayer.destroy(); \n\t\t}\n\n\t\tif (this.player === 'vimeo' && this.vimeoPlayer) { \n\t\t\tthis.vimeoPlayer.destroy(); \n\t\t}\n\n\n/*\tTODO - Investigate: when is this needed? \n\t\t// remove previous video's attributes and child elements from media element\n\t\tthis.$media.removeAttr('poster width height');\n\t\tthis.$media.empty();\n*/\n\t\t// Empty elements that will be rebuilt\n\t\tthis.$controllerDiv.empty();\n\t\t// this.$statusBarDiv.empty();\n\t\t// this.$timer.empty();\n\t\tthis.$elapsedTimeContainer.empty().text('0:00'); // span.able-elapsedTime\n\t\tthis.$durationContainer.empty(); // span.able-duration\n\t\t\n\t\t// Remove popup windows and modal dialogs; these too will be rebuilt\n\t\tif (this.$signWindow) {\n\t\t\t\tthis.$signWindow.remove();\n\t\t}\n\t\tif (this.$transcriptArea) {\n\t\t\t\tthis.$transcriptArea.remove();\n\t\t}\n\t\t$('.able-modal-dialog').remove();\n\t\t\n\t\t// Remove caption and description wrappers \n\t\tif (this.$captionsWrapper) {\n\t\t\tthis.$captionsWrapper.remove();\n\t\t}\n\t\tif (this.$descDiv) { \n\t\t\tthis.$descDiv.remove(); \n\t\t}\n\t\t\n\t\t// reset key variables\n\t\tthis.hasCaptions = false;\n\t\tthis.hasChapters = false;\n\t\tthis.hasDescTracks = false; \n\t\tthis.hasOpenDesc = false;\n\t\tthis.hasClosedDesc = false; \n\n\t\tthis.captionsPopup = null;\n\t\tthis.chaptersPopup = null;\n\t\tthis.transcriptType = null;\n\n\t\tthis.playerDeleted = true; // will reset to false in recreatePlayer() \n\t};\n\n\tAblePlayer.prototype.getButtonTitle = function(control) {\n\n\t\tif (control === 'playpause') {\n\t\t\treturn this.tt.play;\n\t\t}\n\t\telse if (control === 'play') {\n\t\t\treturn this.tt.play;\n\t\t}\n\t\telse if (control === 'pause') {\n\t\t\treturn this.tt.pause;\n\t\t}\n\t\telse if (control === 'restart') {\n\t\t\treturn this.tt.restart;\n\t\t}\n\t\telse if (control === 'previous') {\n\t\t\treturn this.tt.prevTrack;\n\t\t}\n\t\telse if (control === 'next') {\n\t\t\treturn this.tt.nextTrack;\n\t\t}\n\t\telse if (control === 'rewind') {\n\t\t\treturn this.tt.rewind;\n\t\t}\n\t\telse if (control === 'forward') {\n\t\t\treturn this.tt.forward;\n\t\t}\n\t\telse if (control === 'captions') {\n\t\t\tif (this.captions.length > 1) {\n\t\t\t\treturn this.tt.captions;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (this.captionsOn) {\n\t\t\t\t\treturn this.tt.hideCaptions;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn this.tt.showCaptions;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (control === 'descriptions') {\n\t\t\tif (this.descOn) {\n\t\t\t\treturn this.tt.turnOffDescriptions;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn this.tt.turnOnDescriptions;\n\t\t\t}\n\t\t}\n\t\telse if (control === 'transcript') {\n\t\t\tif (this.$transcriptDiv.is(':visible')) {\n\t\t\t\treturn this.tt.hideTranscript;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn this.tt.showTranscript;\n\t\t\t}\n\t\t}\n\t\telse if (control === 'chapters') {\n\t\t\treturn this.tt.chapters;\n\t\t}\n\t\telse if (control === 'sign') {\n\t\t\treturn this.tt.sign;\n\t\t}\n\t\telse if (control === 'volume') {\n\t\t\treturn this.tt.volume;\n\t\t}\n\t\telse if (control === 'faster') {\n\t\t\treturn this.tt.faster;\n\t\t}\n\t\telse if (control === 'slower') {\n\t\t\treturn this.tt.slower;\n\t\t}\n\t\telse if (control === 'preferences') {\n\t\t\treturn this.tt.preferences;\n\t\t}\n\t\telse if (control === 'help') {\n\t\t\t// return this.tt.help;\n\t\t}\n\t\telse if (control === 'fullscreen') { \n\t\t\tif (!this.fullscreen) {\n\t\t\t\treturn this.tt.enterFullscreen; \n\t\t\t}\n\t\t\telse { \n\t\t\t\treturn this.tt.exitFullscreen; \n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// there should be no other controls, but just in case:\n\t\t\t// return the name of the control with first letter in upper case\n\t\t\t// ultimately will need to get a translated label from this.tt\n\t\t\tif (this.debug) {\n\t\t\t\tconsole.log('Found an untranslated label: ' + control);\n\t\t\t}\n\t\t\treturn control.charAt(0).toUpperCase() + control.slice(1);\n\t\t}\n\t};\n\n\n})(jQuery);\n\n(function ($) {\n\t// Loads files referenced in track elements, and performs appropriate setup.\n\t// For example, captions and text descriptions.\n\t// This will be called whenever the player is recreated.\n\t// Added in v2.2.23: Also handles YouTube caption tracks\n\n\tAblePlayer.prototype.setupTracks = function () {\n\n\t\tvar thisObj, deferred, promise, loadingPromises, loadingPromise,\n\t\t\ti, tracks, track, kind;\n\n\t\tthisObj = this;\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\n\t\tloadingPromises = [];\n\n\t\tif ($('#able-vts').length) {\n\t\t\t// Page includes a container for a VTS instance\n\t\t\tthis.vtsTracks = [];\n\t\t\tthis.hasVts = true;\n\t\t} else {\n\t\t\tthis.hasVts = false;\n\t\t}\n\n\t\t// Source array for populating the above arrays \n\t\t// varies, depending on whether there are dedicated description tracks \n\t\tif (this.hasDescTracks && this.descOn) {\n\t\t\ttracks = this.altTracks;\n\t\t} else {\n\t\t\ttracks = this.tracks;\n\t\t}\n\t\tfor (i = 0; i < tracks.length; i++) {\n\n\t\t\ttrack = tracks[i];\n\t\t\tkind = track.kind;\n\n\t\t\tif (!track.src) {\n\t\t\t\tif (thisObj.usingYouTubeCaptions || thisObj.usingVimeoCaptions) {\n\t\t\t\t\t// skip all the hullabaloo and go straight to setupCaptions\n\t\t\t\t\tthisObj.setupCaptions(track);\n\t\t\t\t} else {\n\t\t\t\t\t// Nothing to load!\n\t\t\t\t\t// Skip this track; move on to next i\n\t\t\t\t}\t\t\t\t\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar trackSrc = track.src;\n\t\t\tloadingPromise = this.loadTextObject(track.src); // resolves with src, trackText\n\t\t\tloadingPromises.push(loadingPromise.catch(function (src) {\n\t\t\t\tconsole.warn('Failed to load captions track from ' + src);\n\t\t\t}));\n\t\t\tloadingPromise.then((function (track, kind) {\n\t\t\t\tvar trackSrc = track.src;\n\t\t\t\tvar trackLang = track.language;\n\t\t\t\tvar trackLabel = track.label;\n\t\t\t\tvar trackDesc = track.desc;\n\n\t\t\t\treturn function (trackSrc, trackText) {\n\t\t\t\t\t// these are the two vars returned from loadTextObject\n\n\t\t\t\t\tvar trackContents = trackText;\n\t\t\t\t\tvar cues = thisObj.parseWebVTT(trackSrc, trackContents).cues;\n\t\t\t\t\tif (thisObj.hasVts) {\n\n\t\t\t\t\t\t// setupVtsTracks() is in vts.js\n\t\t\t\t\t\tthisObj.setupVtsTracks(kind, trackLang, trackDesc, trackLabel, trackSrc, trackContents);\n\t\t\t\t\t}\n\t\t\t\t\tif (kind === 'captions' || kind === 'subtitles') {\n\t\t\t\t\t\tthisObj.setupCaptions(track, cues);\n\t\t\t\t\t} else if (kind === 'descriptions') {\n\t\t\t\t\t\tthisObj.setupDescriptions(track, cues);\n\t\t\t\t\t} else if (kind === 'chapters') {\n\t\t\t\t\t\tthisObj.setupChapters(track, cues);\n\t\t\t\t\t} else if (kind === 'metadata') {\n\t\t\t\t\t\tthisObj.setupMetadata(track, cues);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})(track, kind));\n\t\t}\n\t\tif (thisObj.usingYouTubeCaptions || thisObj.usingVimeoCaptions) {\n\t\t\tdeferred.resolve(); \n\t\t}\n\t\telse { \t\t\t\n\t\t\t$.when.apply($, loadingPromises).then(function () {\n\t\t\t\tdeferred.resolve();\n\t\t\t});\n\t\t}\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.getTracks = function () {\n\t\t\n\t\t// define an array tracks with the following structure:\n\t\t// kind - string, e.g. \"captions\", \"descriptions\"\n\t\t// src - string, URL of WebVTT source file\n\t\t// language - string, lang code\n\t\t// label - string to display, e.g., in CC menu\n\t\t// def - Boolean, true if this is the default track\n\t\t// cues - array with startTime, endTime, and payload\n\t\t// desc - Boolean, true if track includes a data-desc attribute\n\n\t\tvar thisObj, deferred, promise, captionTracks, altCaptionTracks,\n\t\t\ttrackLang, trackLabel, isDefault, forDesc, hasDefault, hasTrackInDefLang,\n\t\t\ttrackFound, i, j, capLabel, inserted;\n\n\t\tthisObj = this;\n\t\thasDefault = false; \n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\n\t\tthis.$tracks = this.$media.find('track');\n\t\tthis.tracks = []; // only includes tracks that do NOT have data-desc\n\t\tthis.altTracks = []; // only includes tracks that DO have data-desc \n\n\t\t// Arrays for each kind, to be populated later  \n\t\tthis.captions = [];\n\t\tthis.descriptions = [];\n\t\tthis.chapters = [];\n\t\tthis.meta = [];\n\n\t\tthis.hasCaptionsTrack = false; // will change to true if one or more tracks has kind=\"captions\"\n\t\tthis.hasDescTracks = false; // will change to true if one or more tracks has data-desc\n\n\t\tif (this.$tracks.length) {\t\t\t\n\n\t\t\tthis.usingYouTubeCaptions = false; \n\t\t\t// create object from HTML5 tracks\n\t\t\tthis.$tracks.each(function (index, element) {\n\n\t\t\t\tif ($(this).attr('kind') === 'captions') {\n\t\t\t\t\tthisObj.hasCaptionsTrack = true; \n\t\t\t\t}\n\t\t\t\telse if ($(this).attr('kind') === 'descriptions') {\n\t\t\t\t\tthisObj.hasClosedDesc = true; \n\t\t\t\t}\n\n\t\t\t\t// srcLang should always be included with <track>, but HTML5 spec doesn't require it\n\t\t\t\t// if not provided, assume track is the same language as the default player language\n\t\t\t\tif ($(this).attr('srclang')) {\n\t\t\t\t\ttrackLang = $(this).attr('srclang');\n\t\t\t\t} \n\t\t\t\telse {\n\t\t\t\t\ttrackLang = thisObj.lang;\n\t\t\t\t}\n\t\t\t\tif ($(this).attr('label')) {\n\t\t\t\t\ttrackLabel = $(this).attr('label');\n\t\t\t\t} \n\t\t\t\telse {\n\t\t\t\t\ttrackLabel = thisObj.getLanguageName(trackLang);\n\t\t\t\t}\n\n\t\t\t\tif (typeof $(this).attr('default') !== 'undefined' && !hasDefault) {\t\n\t\t\t\t\tisDefault = true;\n\t\t\t\t\thasDefault = true; \n\t\t\t\t} \n\t\t\t\telse if (trackLang === thisObj.lang) {\n\t\t\t\t\t// this track is in the default lang of the player \n\t\t\t\t\t// save this for later \n\t\t\t\t\t// if there is no other default track specified \n\t\t\t\t\t// this will be the default \n\t\t\t\t\thasTrackInDefLang = true; \n\t\t\t\t\tisDefault = false; // for now; this could change if there's no default attribute\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tisDefault = false;\n\t\t\t\t}\n\t\t\t\tif (isDefault) {\n\t\t\t\t\t// this.captionLang will also be the default language for non-caption tracks\n\t\t\t\t\tthisObj.captionLang = trackLang;\n\t\t\t\t}\n\n\t\t\t\tif ($(this).data('desc') !== undefined) {\n\t\t\t\t\tforDesc = true;\n\t\t\t\t\tthisObj.hasDescTracks = true;\n\t\t\t\t} \n\t\t\t\telse {\n\t\t\t\t\tforDesc = false;\n\t\t\t\t}\n\t\t\t\tif (forDesc) {\n\t\t\t\t\tthisObj.altTracks.push({\n\t\t\t\t\t\t'kind': $(this).attr('kind'),\n\t\t\t\t\t\t'src': $(this).attr('src'),\n\t\t\t\t\t\t'language': trackLang,\n\t\t\t\t\t\t'label': trackLabel,\n\t\t\t\t\t\t'def': isDefault,\n\t\t\t\t\t\t'desc': forDesc\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthisObj.tracks.push({\n\t\t\t\t\t\t'kind': $(this).attr('kind'),\n\t\t\t\t\t\t'src': $(this).attr('src'),\n\t\t\t\t\t\t'language': trackLang,\n\t\t\t\t\t\t'label': trackLabel,\n\t\t\t\t\t\t'def': isDefault,\n\t\t\t\t\t\t'desc': forDesc\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (index == thisObj.$tracks.length - 1) {\n\t\t\t\t\t// This is the last track. \n\t\t\t\t\tif (!hasDefault) { \n\t\t\t\t\t\tif (hasTrackInDefLang) { \n\t\t\t\t\t\t\tthisObj.captionLang = thisObj.lang; \n\t\t\t\t\t\t\ttrackFound = false; \t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ti = 0; \n\t\t\t\t\t\t\twhile (i < thisObj.tracks.length && !trackFound) { \n\t\t\t\t\t\t\t\tif (thisObj.tracks[i]['language'] === thisObj.lang) { \n\t\t\t\t\t\t\t\t\tthisObj.tracks[i]['def'] = true; \n\t\t\t\t\t\t\t\t\ttrackFound = true; \n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ti++; \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse { \n\t\t\t\t\t\t\t// use the first track \n\t\t\t\t\t\t\tthisObj.tracks[0]['def'] = true; \n\t\t\t\t\t\t\tthisObj.captionLang = thisObj.tracks[0]['language']; \n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Remove 'default' attribute from all <track> elements\n\t\t\t\t\t// This data has already been saved to this.tracks\n\t\t\t\t\t// and some browsers will display the default captions, \n\t\t\t\t\t// despite all standard efforts to suppress them\n\t\t\t\t\tthisObj.$media.find('track').removeAttr('default'); \n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (!this.$tracks.length || !this.hasCaptionsTrack) { \n\t\t\t// this media has no track elements \n\t\t\t// if this is a youtube or vimeo player, check there for captions/subtitles\n\t\t\tif (this.player === 'youtube') {\n\t\t\t\tthis.getYouTubeCaptionTracks(this.youTubeId).then(function() {\n\t\t\t\t\tif (thisObj.hasCaptions) { \n\t\t\t\t\t\tthisObj.usingYouTubeCaptions = true; \n\t\t\t\t\t\tif (thisObj.$captionsWrapper) {\n\t\t\t\t\t\t\tthisObj.$captionsWrapper.remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t\tdeferred.resolve();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (this.player === 'vimeo') {\n\t\t\t\tthis.getVimeoCaptionTracks().then(function() {\n\t\t\t\t\tif (thisObj.hasCaptions) { \n\t\t\t\t\t\tthisObj.usingVimeoCaptions = true; \n\t\t\t\t\t\tif (thisObj.$captionsWrapper) {\n\t\t\t\t\t\t\tthisObj.$captionsWrapper.remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdeferred.resolve();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// this is neither YouTube nor Vimeo\n\t\t\t\t// there just ain't no tracks (captions or otherwise)\n\t\t\t\tthis.hasCaptions = false; \n\t\t\t\tif (thisObj.$captionsWrapper) {\n\t\t\t\t\tthisObj.$captionsWrapper.remove();\n\t\t\t\t}\n\t\t\t\tdeferred.resolve();\n\t\t\t}\n\t\t}\n\t\telse { \n\t\t\t// there is at least one track with kind=\"captions\" \n\t\t\tdeferred.resolve(); \n\n\t\t}\n\t\treturn promise;\n\n\t};\n\n\tAblePlayer.prototype.setupCaptions = function (track, cues) {\n\n\t\t// Setup player for display of captions (one track at a time)\n\t\tvar thisObj, captions, inserted, i, capLabel;\n\n\t\t// Insert track into captions array \n\t\t// in its proper alphabetical sequence by label  \n\t\tif (typeof cues === 'undefined') {\n\t\t\tcues = null;\n\t\t}\n\n\t\tif (this.usingYouTubeCaptions || this.usingVimeoCaptions) { \n\t\t\t// this.captions has already been populated \n\t\t\t// For YouTube, this happens in youtube.js > getYouTubeCaptionTracks()\n\t\t\t// For VImeo, this happens in vimeo.js > getVimeoCaptionTracks() \n\t\t\t// So, nothing to do here... \n\t\t}\n\t\telse { \n\n\t\t\tif (this.captions.length === 0) { // this is the first\t\n\t\t\t\tthis.captions.push({\n\t\t\t\t\t'language': track.language,\n\t\t\t\t\t'label': track.label,\n\t\t\t\t\t'def': track.def,\n\t\t\t\t\t'cues': cues\n\t\t\t\t});\n\t\t\t} \n\t\t\telse { // there are already captions in the array\t\t\t\n\t\t\t\tinserted = false;\n\t\t\t\tfor (i = 0; i < this.captions.length; i++) {\n\t\t\t\t\tcapLabel = track.label;\n\t\t\t\t\tif (capLabel.toLowerCase() < this.captions[i].label.toLowerCase()) {\n\t\t\t\t\t\t// insert before track i\n\t\t\t\t\t\tthis.captions.splice(i, 0, {\n\t\t\t\t\t\t\t'language': track.language,\n\t\t\t\t\t\t\t'label': track.label,\n\t\t\t\t\t\t\t'def': track.def,\n\t\t\t\t\t\t\t'cues': cues\n\t\t\t\t\t\t});\n\t\t\t\t\t\tinserted = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!inserted) {\n\t\t\t\t\t// just add track to the end\n\t\t\t\t\tthis.captions.push({\n\t\t\t\t\t\t'language': track.language,\n\t\t\t\t\t\t'label': track.label,\n\t\t\t\t\t\t'def': track.def,\n\t\t\t\t\t\t'cues': cues\n\t\t\t\t\t});\n\t\t\t\t}\t\n\t\t\t}\n\t\t}\n\n\t\t// there are captions available \n\t\tthis.hasCaptions = true;\n\t\tthis.currentCaption = -1; \n\t\tif (this.prefCaptions === 1) {\n\t\t\tthis.captionsOn = true;\n\t\t} else if (this.prefCaptions === 0) {\n\t\t\tthis.captionsOn = false;\n\t\t} else {\n\t\t\t// user has no prefs. Use default state.\n\t\t\tif (this.defaultStateCaptions === 1) {\n\t\t\t\tthis.captionsOn = true;\n\t\t\t} else {\n\t\t\t\tthis.captionsOn = false;\n\t\t\t}\n\t\t}\n\t\tif (this.mediaType === 'audio' && this.captionsOn) {\n\t\t\tthis.$captionsContainer.removeClass('captions-off');\n\t\t}\n\n\t\tif (!this.$captionsWrapper || \n\t\t\t(this.$captionsWrapper && !($.contains(this.$ableDiv[0], this.$captionsWrapper[0])))) {\n\t\t\t// captionsWrapper either doesn't exist, or exists in an orphaned state \n\t\t\t// Either way, it needs to be rebuilt...  \n\t\t\tthis.$captionsDiv = $('<div>', {\n\t\t\t\t'class': 'able-captions',\n\t\t\t});\n\t\t\tthis.$captionsWrapper = $('<div>', {\n\t\t\t\t'class': 'able-captions-wrapper',\n\t\t\t\t'aria-hidden': 'true'\n\t\t\t}).hide();\n\t\t\tif (this.prefCaptionsPosition === 'below') {\n\t\t\t\tthis.$captionsWrapper.addClass('able-captions-below');\n\t\t\t} else {\n\t\t\t\tthis.$captionsWrapper.addClass('able-captions-overlay');\n\t\t\t}\n\t\t\tthis.$captionsWrapper.append(this.$captionsDiv);\n\t\t\tthis.$captionsContainer.append(this.$captionsWrapper);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.setupDescriptions = function (track, cues) {\n\n\t\t// called via setupTracks() only if there is track with kind=\"descriptions\"\n\t\t// prepares for delivery of text description , in case it's needed\n\t\t// whether and how it's delivered is controlled within description.js > initDescription()\n\n\t\tthis.hasClosedDesc = true;\n\t\tthis.currentDescription = -1;\n\t\tthis.descriptions.push({\n\t\t\tcues: cues,\n\t\t\tlanguage: track.language\n\t\t});\n\t};\n\n\tAblePlayer.prototype.setupChapters = function (track, cues) {\n\n\t\t// NOTE: WebVTT supports nested timestamps (to form an outline)\n\t\t// This is not currently supported.\n\n\t\tthis.hasChapters = true;\n\t\tthis.chapters.push({\n\t\t\tcues: cues,\n\t\t\tlanguage: track.language\n\t\t});\n\t};\n\n\tAblePlayer.prototype.setupMetadata = function (track, cues, trackDesc) {\n\n\t\tif (this.metaType === 'text') {\n\t\t\t// Metadata is only supported if data-meta-div is provided\n\t\t\t// The player does not display metadata internally\n\t\t\tif (this.metaDiv) {\n\t\t\t\tif ($('#' + this.metaDiv)) {\n\t\t\t\t\t// container exists\n\t\t\t\t\tthis.$metaDiv = $('#' + this.metaDiv);\n\t\t\t\t\tthis.hasMeta = true;\n\t\t\t\t\tthis.meta = cues;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (this.metaType === 'selector') {\n\t\t\tthis.hasMeta = true;\n\t\t\tthis.visibleSelectors = [];\n\t\t\tthis.meta = cues;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.loadTextObject = function (src) {\n\n\t\t// TODO: Incorporate the following function, moved from setupTracks()\n\t\t// convert XMl/TTML captions file\n\t\t/*\n\t\tif (thisObj.useTtml && (trackSrc.endsWith('.xml') || trackText.startsWith('<?xml'))) {\n\t\t\ttrackContents = thisObj.ttml2webvtt(trackText);\n\t\t}\n\t\t*/\n\t\tvar deferred, promise, thisObj, $tempDiv;\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\t\tthisObj = this;\n\n\t\t// create a temp div for holding data\n\t\t$tempDiv = $('<div>', {\n\t\t\tstyle: 'display:none'\n\t\t});\n\t\t$tempDiv.load(src, function (trackText, status, req) {\n\t\t\tif (status === 'error') {\n\t\t\t\tif (thisObj.debug) {\n\t\t\t\t\tconsole.log('error reading file ' + src + ': ' + status);\n\t\t\t\t}\n\t\t\t\tdeferred.reject(src);\n\t\t\t} else {\n\t\t\t\tdeferred.resolve(src, trackText);\n\t\t\t}\n\t\t\t$tempDiv.remove();\n\t\t});\n\t\treturn promise;\n\t};\n\n})(jQuery);\n\n(function ($) {\n\tAblePlayer.prototype.initYouTubePlayer = function () {\n\n\t\tvar thisObj, deferred, promise, youTubeId, googleApiPromise, json;\n\t\tthisObj = this;\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\n\t\tthis.youTubePlayerReady = false; \n\n\t\t// if a described version is available && user prefers desription\n\t\t// init player using the described version\n\t\tif (this.youTubeDescId && this.prefDesc) {\n\t\t\tyouTubeId = this.youTubeDescId;\n\t\t}\n\t\telse {\n\t\t\tyouTubeId = this.youTubeId;\n\t\t}\n\t\tthis.activeYouTubeId = youTubeId;\n\t\tif (AblePlayer.youTubeIframeAPIReady) {\n\t\t\t// Script already loaded and ready.\n\t\t\tthisObj.finalizeYoutubeInit().then(function() {\n\t\t\t\tdeferred.resolve();\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\t// Has another player already started loading the script? If so, abort...\n\t\t\tif (!AblePlayer.loadingYouTubeIframeAPI) {\n\t\t\t\t$.getScript('https://www.youtube.com/iframe_api').fail(function () {\n\t\t\t\t\tdeferred.fail();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Otherwise, keeping waiting for script load event...\n\t\t\t$('body').on('youTubeIframeAPIReady', function () {\n\t\t\t\tthisObj.finalizeYoutubeInit().then(function() {\n\t\t\t\t\tdeferred.resolve();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.finalizeYoutubeInit = function () {\n\n\t\t// This is called once we're sure the Youtube iFrame API is loaded -- see above\n\n\t\tvar deferred, promise, thisObj, containerId, ccLoadPolicy, videoDimensions, autoplay;\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\n\t\tthisObj = this;\n\n\t\tcontainerId = this.mediaId + '_youtube';\n\n\t\tthis.$mediaContainer.prepend($('<div>').attr('id', containerId));\n\t\t// NOTE: Tried the following in place of the above in January 2016\n\t\t// because in some cases two videos were being added to the DOM\n\t\t// However, once v2.2.23 was fairly stable, unable to reproduce that problem\n\t\t// so maybe it's not an issue. This is preserved here temporarily, just in case it's needed...\n\t\t// thisObj.$mediaContainer.html($('<div>').attr('id', containerId));\n\n\t\t// cc_load_policy:\n\t\t// 0 - show captions depending on user's preference on YouTube\n\t\t// 1 - show captions by default, even if the user has turned them off\n\t\t// IMPORTANT: This *must* be set to 1 or some browsers \n\t\t// fail to load any texttracks (observed in Chrome, not in Firefox) \n\t\tccLoadPolicy = 1;\n\n\t\tif (this.okToPlay) {\n\t\t\tautoplay = 1;\n\t\t}\n\t\telse {\n\t\t\tautoplay = 0;\n\t\t}\n\n\t\t// Documentation https://developers.google.com/youtube/player_parameters\n\n\t\tif (typeof this.captionLang == 'undefined') { \n\t\t\t// init using the default player lang\n\t\t\tthis.captionLang = this.lang; \n\t\t}\n\t\tthis.youTubePlayer = new YT.Player(containerId, {\n\t\t\tvideoId: this.activeYouTubeId,\n\t\t\thost: this.youTubeNoCookie ? 'https://www.youtube-nocookie.com' : 'https://www.youtube.com',\n\t\t\tplayerVars: {\n\t\t\t\tautoplay: autoplay,\n\t\t\t\tenablejsapi: 1,\n\t\t\t\tdisableKb: 1, // disable keyboard shortcuts, using our own\n\t\t\t\tplaysinline: this.playsInline,\n\t\t\t\tstart: this.startTime,\n\t\t\t\tcontrols: 0, // no controls, using our own\n\t\t\t\tcc_load_policy: ccLoadPolicy,\n\t\t\t\tcc_lang_pref: this.captionLang, // set the caption language \n\t\t\t\thl: this.lang, // set the UI language to match Able Player \n\t\t\t\tmodestbranding: 1, // no YouTube logo in controller\n\t\t\t\trel: 0, // when video ends, show only related videos from same channel (1 shows any)\n\t\t\t\tiv_load_policy: 3 // do not show video annotations\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonReady: function () {\n\t\t\t\t\tthisObj.youTubePlayerReady = true; \n\t\t\t\t\tif (!thisObj.playerWidth || !thisObj.playerHeight) { \n\t\t\t\t\t\tthisObj.getYouTubeDimensions();\n\t\t\t\t\t}\n\t\t\t\t\tif (thisObj.playerWidth && thisObj.playerHeight) { \n\t\t\t\t\t\tthisObj.youTubePlayer.setSize(thisObj.playerWidth,thisObj.playerHeight);\n\t\t\t\t\t\tthisObj.$ableWrapper.css({\n\t\t\t\t\t\t\t'width': thisObj.playerWidth + 'px'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (thisObj.swappingSrc) {\n\t\t\t\t\t\t// swap is now complete\n\t\t\t\t\t\tthisObj.swappingSrc = false;\n\t\t\t\t\t\tthisObj.restoreFocus();\n\t\t\t\t\t\tthisObj.cueingPlaylistItem = false;\n\t\t\t\t\t\tif (thisObj.playing || thisObj.okToPlay) {\n\t\t\t\t\t\t\t// resume playing\n\t\t\t\t\t\t\tthisObj.playMedia();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (thisObj.userClickedPlaylist) {\n\t\t\t\t\t\tthisObj.userClickedPlaylist = false; // reset\n\t\t\t\t\t}\n\t\t\t\t\tif (thisObj.recreatingPlayer) { \n\t\t\t\t\t\tthisObj.recreatingPlayer = false; // reset\n\t\t\t\t\t}\n\t\t\t\t\tdeferred.resolve();\n\t\t\t\t},\n\t\t\t\tonError: function (x) {\n\t\t\t\t\tdeferred.fail();\n\t\t\t\t},\n\t\t\t\tonStateChange: function (x) {\t\t\t\t\n\t\t\t\t\tthisObj.getPlayerState().then(function(playerState) {\n\t\t\t\t\t\t// values of playerState: 'playing','paused','buffering','ended'\n\t\t\t\t\t\tif (playerState === 'playing') {\n\t\t\t\t\t\t\tthisObj.playing = true;\n\t\t\t\t\t\t\tthisObj.startedPlaying = true;\n\t\t\t\t\t\t\tthisObj.paused = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (playerState == 'ended') {\n\t\t\t\t\t\t\tthisObj.onMediaComplete();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthisObj.playing = false;\n\t\t\t\t\t\t\tthisObj.paused = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (thisObj.stoppingYouTube && playerState === 'paused') {\n\t\t\t\t\t\t\tif (typeof thisObj.$posterImg !== 'undefined') {\n\t\t\t\t\t\t\t\tthisObj.$posterImg.show();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthisObj.stoppingYouTube = false;\n\t\t\t\t\t\t\tthisObj.seeking = false;\n\t\t\t\t\t\t\tthisObj.playing = false;\n\t\t\t\t\t\t\tthisObj.paused = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// If caption tracks are hosted locally, but are also available on YouTube,\n\t\t\t\t\t// we need to turn them off on YouTube or there will be redundant captions \n\t\t\t\t\t// This is the most reliable event on which to unload the caption module \n\t\t\t\t\tif (thisObj.player === 'youtube' && !thisObj.usingYouTubeCaptions) { \t\t\t\t\t\t\n\t\t\t\t\t\tif (thisObj.youTubePlayer.getOptions('captions')) { \t\t\t\t\t\t\t\n\t\t\t\t\t\t\tthisObj.youTubePlayer.unloadModule('captions');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\t\t\t \t\t\t\n\t\t\t\t},\n\t\t\t\tonPlaybackQualityChange: function () {\n\t\t\t\t\t// do something\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\t\tif (!this.hasPlaylist) {\n\t\t\t// remove the media element, since YouTube replaces that with its own element in an iframe\n\t\t\t// this is handled differently for playlists. See buildplayer.js > cuePlaylistItem()\n\t\t\tthis.$media.remove();\n\t\t}\t\t\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.getYouTubeDimensions = function (youTubeContainerId) {\n\n\t\t// The YouTube iframe API does not have a getSize() of equivalent method \n\t\t// so, need to get dimensions from YouTube's iframe \n\n\t\tvar $iframe, width, height; \n\n\t\t$iframe = this.$ableWrapper.find('iframe'); \n\t\tif (typeof $iframe !== 'undefined') {\n\t\t\tif ($iframe.prop('width')) { \n\t\t\t\twidth = $iframe.prop('width');\t\t\t\n\t\t\t\tif ($iframe.prop('height')) { \n\t\t\t\t\theight = $iframe.prop('height');\n\t\t\t\t\tthis.resizePlayer(width,height); \n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getYouTubeCaptionTracks = function (youTubeId) {\n\n\t\t// get data via YouTube IFrame Player API, and push data to this.tracks & this.captions\n\t\t// NOTE: Caption tracks are not available through the IFrame Player API \n\t\t// until AFTER the video has started playing. \n\t\t// Therefore, this function plays the video briefly in order to load the captions module\n\t\t// then stops the video and collects the data needed to build the cc menu \n\t\t// This is stupid, but seemingly unavoidable. \n\t\t// Caption tracks could be obtained through the YouTube Data API \n\t\t// but this required authors to have a Google API key, \n\t\t// which would complicate Able Player installation \n\n\t\tvar deferred = new $.Deferred();\n\t\tvar promise = deferred.promise();\n\n\t\tvar thisObj, ytTracks, i, trackLang, trackLabel, isDefaultTrack;\n\n\t\tthisObj = this;\n\t\t\n\t\tif (!this.youTubePlayer.getOption('captions','tracklist')) { \n\n\t\t\t// no tracks were found, probably because the captions module hasn't loaded  \n\t\t\t// play video briefly (required in order to load the captions module) \n\t\t\t// and after the apiChange event is triggered, try again to retreive tracks\n\t\t\tthis.youTubePlayer.addEventListener('onApiChange',function(x) { \n\n\t\t\t\t// getDuration() also requires video to play briefly \n\t\t\t\t// so, let's set that while we're here \t\t\t\t\n\t\t\t\tthisObj.duration = thisObj.youTubePlayer.getDuration();\t\t\t\t\n\n\t\t\t\tif (thisObj.loadingYouTubeCaptions) { \t\t\t\t\n\t\t\t\t\t// loadingYouTubeCaptions is a stopgap in case onApiChange is called more than once \n\t\t\t\t\tytTracks = thisObj.youTubePlayer.getOption('captions','tracklist');\t\t\t\t\t\n\t\t\t\t\tif (!thisObj.okToPlay) { \n\t\t\t\t\t\t// Don't stopVideo() - that cancels loading \n\t\t\t\t\t\t// Just pause \n\t\t\t\t\t\t// No need to seekTo(0) - so little time has passed it isn't noticeable to the user \n\t\t\t\t\t\tthisObj.youTubePlayer.pauseVideo(); \n\t\t\t\t\t}\n\t\t\t\t\tif (ytTracks && ytTracks.length) { \n\t\t\t\t\t\t// Step through ytTracks and add them to global tracks array\n\t\t\t\t\t\t// Note: Unlike YouTube Data API, the IFrame Player API only returns \n\t\t\t\t\t\t// tracks that are published, and does NOT include ASR captions \n\t\t\t\t\t\t// So, no additional filtering is required \n\t\t\t\t\t\tfor (i=0; i < ytTracks.length; i++) {\n\t\t\t\t\t\t\ttrackLang = ytTracks[i].languageCode; \n\t\t\t\t\t\t\ttrackLabel = ytTracks[i].languageName; // displayName and languageName seem to always have the same value\n\t\t\t\t\t\t\tisDefaultTrack = false; \n\t\t\t\t\t\t\tif (typeof thisObj.captionLang !== 'undefined') { \n\t\t\t\t\t\t\t\tif (trackLang === thisObj.captionLang) {\n\t\t\t\t\t\t\t\t\tisDefaultTrack = true;\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (typeof thisObj.lang !== 'undefined') { \n\t\t\t\t\t\t\t\tif (trackLang === thisObj.lang) {\n\t\t\t\t\t\t\t\t\tisDefaultTrack = true;\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthisObj.tracks.push({\n\t\t\t\t\t\t\t\t'kind': 'captions',\n\t\t\t\t\t\t\t\t'language': trackLang,\n\t\t\t\t\t\t\t\t'label': trackLabel,\n\t\t\t\t\t\t\t\t'def': isDefaultTrack\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthisObj.captions.push({\n\t\t\t\t\t\t\t\t'language': trackLang,\n\t\t\t\t\t\t\t\t'label': trackLabel,\n\t\t\t\t\t\t\t\t'def': isDefaultTrack,\n\t\t\t\t\t\t\t\t'cues': null\n\t\t\t\t\t\t\t});\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthisObj.hasCaptions = true;\n\t\t\t\t\t\t// setupPopups again with new captions array, replacing original\n\t\t\t\t\t\tthisObj.setupPopups('captions');\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\telse { \n\t\t\t\t\t\t// there are no YouTube captions \n\t\t\t\t\t\tthisObj.usingYouTubeCaptions = false; \n\t\t\t\t\t\tthisObj.hasCaptions = false;\n\t\t\t\t\t}\n\t\t\t\t\tthisObj.loadingYouTubeCaptions = false; \n\t\t\t\t\tif (thisObj.okToPlay) { \n\t\t\t\t\t\tthisObj.youTubePlayer.playVideo();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (thisObj.captionLangPending) { \n\t\t\t\t\t// user selected a new caption language prior to playback starting \n\t\t\t\t\t// set it now \n\t\t\t\t\tthisObj.youTubePlayer.setOption('captions', 'track', {'languageCode': thisObj.captionLangPending});\n\t\t\t\t\tthisObj.captionLangPending = null; \n\t\t\t\t}\n\t\t\t\tif (typeof thisObj.prefCaptionsSize !== 'undefined') { \n\t\t\t\t\t// set the default caption size \n\t\t\t\t\t// this doesn't work until the captions module is loaded \n\t\t\t\t\tthisObj.youTubePlayer.setOption('captions','fontSize',thisObj.translatePrefs('size',thisObj.prefCaptionsSize,'youtube'));\n\t\t\t\t}\n\t\t\t\tdeferred.resolve();\n\t\t\t});\n\t\t\t// Trigger the above event listener by briefly playing the video \t\t\n\t\t\tthis.loadingYouTubeCaptions = true; \t\n\t\t\tthis.youTubePlayer.playVideo();\t\t\n\t\t}\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.getYouTubeTimedTextUrl = function (youTubeId, trackName, trackLang) {\n\n\t\t// return URL for retrieving WebVTT source via YouTube's timedtext API\n\t\t// Note: This API seems to be undocumented, and could break anytime\n\t\t// UPDATE: Google removed this API on November 10, 2021 \n\t\t// This function is no longer called, but is preserved here for reference \n\t\tvar url = 'https://www.youtube.com/api/timedtext?fmt=vtt';\n\t\turl += '&v=' + youTubeId;\n\t\turl += '&lang=' + trackLang;\n\t\t// if track has a value in the name field, it's *required* in the URL\n\t\tif (trackName !== '') {\n\t\t\turl += '&name=' + trackName;\n\t\t}\n\t\treturn url;\n\t};\n\n\tAblePlayer.prototype.getYouTubePosterUrl = function (youTubeId, width) {\n\n\t\t\t // return a URL for retrieving a YouTube poster image\n\t\t\t // supported values of width: 120, 320, 480, 640\n\n\t\t\t var url = 'https://img.youtube.com/vi/' + youTubeId;\n\t\t\t if (width == '120') {\n\t\t\t\t // default (small) thumbnail, 120 x 90\n\t\t\t\t return url + '/default.jpg';\n\t\t\t }\n\t\t\t else if (width == '320') {\n\t\t\t\t // medium quality thumbnail, 320 x 180\n\t\t\t\t return url + '/hqdefault.jpg';\n\t\t\t }\n\t\t\t else if (width == '480') {\n\t\t\t\t // high quality thumbnail, 480 x 360\n\t\t\t\t return url + '/hqdefault.jpg';\n\t\t\t }\n\t\t\t else if (width == '640') {\n\t\t\t\t // standard definition poster image, 640 x 480\n\t\t\t\t return url + '/sddefault.jpg';\n\t\t\t }\n\t\t\t return false;\n\t};\n\n\tAblePlayer.prototype.getYouTubeId = function (url) {\n\n\t\t// return a YouTube ID, extracted from a full YouTube URL\n\t\t// Supported URL patterns (with http or https): \n\t\t// https://youtu.be/xxx\n\t\t// https://www.youtube.com/watch?v=xxx\n\t\t// https://www.youtube.com/embed/xxx\n\n\t\t// in all supported patterns, the id is the last 11 characters \n\t\tvar idStartPos, id; \n\n\t\tif (url.indexOf('youtu') !== -1) { \n\t\t\t// this is a full Youtube URL \n\t\t\turl = url.trim(); \n\t\t\tidStartPos = url.length - 11; \n\t\t\tid = url.substring(idStartPos); \n\t\t\treturn id; \n\t\t}\n\t\telse { \n\t\t\treturn url; \n\t\t}\n};\n\n})(jQuery);\n\n(function ($) {\n\n\n\t// Events:\n\t//\t startTracking(event, position)\n\t//\t tracking(event, position)\n\t//\t stopTracking(event, position)\n\n\twindow. AccessibleSlider = function(mediaType, div, orientation, length, min, max, bigInterval, label, className, trackingMedia, initialState) {\n\n\t\t// mediaType is either 'audio' or 'video'\n\t\t// div is the host element around which the slider will be built\n\t\t// orientation is either 'horizontal' or 'vertical'\n\t\t// length is the width or height of the slider, depending on orientation\n\t\t// min is the low end of the slider scale\n\t\t// max is the high end of the slider scale\n\t\t// bigInterval is the number of steps supported by page up/page down (set to 0 if not supported)\n\t\t// (smallInterval, defined as nextStep below, is always set to 1) - this is the interval supported by arrow keys\n\t\t// label is used within an aria-label attribute to identify the slider to screen reader users\n\t\t// className is used as the root within class names (e.g., 'able-' + classname + '-head')\n\t\t// trackingMedia is true if this is a media timeline; otherwise false\n\t\t// initialState is either 'visible' or 'hidden'\n\n\t\tvar thisObj, coords;\n\n\t\tthisObj = this;\n\n\t\t// Initialize some variables.\n\t\tthis.position = 0; // Note: position does not change while tracking.\n\t\tthis.tracking = false;\n\t\tthis.trackDevice = null; // 'mouse' or 'keyboard'\n\t\tthis.keyTrackPosition = 0;\n\t\tthis.lastTrackPosition = 0;\n\t\tthis.nextStep = 1;\n\t\tthis.inertiaCount = 0;\n\n\t\tthis.bodyDiv = $(div);\n\n\t\t// Add divs for tracking amount of media loaded and played\n\t\tif (trackingMedia) {\n\t\t\tthis.loadedDiv = $('<div></div>');\n\t\t\tthis.playedDiv = $('<div></div>');\n\t\t}\n\n\t\t// Add a seekhead\n\t\tthis.seekHead = $('<div>',{\n\t\t\t'aria-orientation': orientation,\n\t\t\t'class': 'able-' + className + '-head'\n\t\t});\n\n\t\tif (initialState === 'visible') {\n\t\t\tthis.seekHead.attr('tabindex', '0');\n\t\t}\n\t\telse {\n\t\t\tthis.seekHead.attr('tabindex', '-1');\n\t\t}\n\t\t// Since head is focusable, it gets the aria roles/titles.\n\t\tthis.seekHead.attr({\n\t\t\t'role': 'slider',\n\t\t\t'aria-label': label,\n\t\t\t'aria-valuemin': min,\n\t\t\t'aria-valuemax': max\n\t\t});\n\n\t\tthis.timeTooltipTimeoutId = null;\n\t\tthis.overTooltip = false;\n\t\tthis.timeTooltip = $('<div>');\n\t\tthis.bodyDiv.append(this.timeTooltip);\n\n\t\tthis.timeTooltip.attr('role', 'tooltip');\n\t\tthis.timeTooltip.addClass('able-tooltip');\n\t\tthis.timeTooltip.on('mouseenter focus', function(){\n\t\t\tthisObj.overTooltip = true;\n\t\t\tclearInterval(thisObj.timeTooltipTimeoutId);\n\t\t});\n\t\tthis.timeTooltip.on('mouseleave blur', function(){\n\t\t\tthisObj.overTooltip = false;\n\t\t\t$(this).hide();\n\t\t});\n\t\tthis.timeTooltip.hide();\n\n\t\tthis.bodyDiv.append(this.loadedDiv);\n\t\tthis.bodyDiv.append(this.playedDiv);\n\t\tthis.bodyDiv.append(this.seekHead);\n\n\t\tthis.bodyDiv.wrap('<div></div>');\n\t\tthis.wrapperDiv = this.bodyDiv.parent();\n\n\t\tif (this.skin === 'legacy') {\n\t\t\tif (orientation === 'horizontal') {\n\t\t\t\tthis.wrapperDiv.width(length);\n\t\t\t\tthis.loadedDiv.width(0);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.wrapperDiv.height(length);\n\t\t\t\tthis.loadedDiv.height(0);\n\t\t\t}\n\t\t}\n\t\tthis.wrapperDiv.addClass('able-' + className + '-wrapper');\n\n\t\tif (trackingMedia) {\n\t\t\tthis.loadedDiv.addClass('able-' + className + '-loaded');\n\n\t\t\tthis.playedDiv.width(0);\n\t\t\tthis.playedDiv.addClass('able-' + className + '-played');\n\n\t\t\t// Set a default duration. User can call this dynamically if duration changes.\n\t\t\tthis.setDuration(max);\n\t\t}\n\n\t\t// handle seekHead events\n\t\tthis.seekHead.on('mouseenter mouseleave mousemove mousedown mouseup focus blur touchstart touchmove touchend', function (e) {\n\n\t\t\tcoords = thisObj.pointerEventToXY(e);\n\n\t\t\tif (e.type === 'mouseenter' || e.type === 'focus') {\n\t\t\t\tthisObj.overHead = true;\n\t\t\t}\n\t\t\telse if (e.type === 'mouseleave' || e.type === 'blur') {\n\t\t\t\tthisObj.overHead = false;\n\t\t\t\tif (!thisObj.overBody && thisObj.tracking && thisObj.trackDevice === 'mouse') {\n\t\t\t\t\tthisObj.stopTracking(thisObj.pageXToPosition(coords.x));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (e.type === 'mousemove' || e.type === 'touchmove') {\n\t\t\t\tif (thisObj.tracking && thisObj.trackDevice === 'mouse') {\n\t\t\t\t\tthisObj.trackHeadAtPageX(coords.x);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (e.type === 'mousedown' || e.type === 'touchstart') {\n\t\t\t\tthisObj.startTracking('mouse', thisObj.pageXToPosition(thisObj.seekHead.offset() + (thisObj.seekHead.width() / 2)));\n\t\t\t\tif (!thisObj.bodyDiv.is(':focus')) {\n\t\t\t\t\tthisObj.bodyDiv.focus();\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\telse if (e.type === 'mouseup' || e.type === 'touchend') {\n\t\t\t\tif (thisObj.tracking && thisObj.trackDevice === 'mouse') {\n\t\t\t\t\tthisObj.stopTracking(thisObj.pageXToPosition(coords.x));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (e.type !== 'mousemove' && e.type !== 'mousedown' && e.type !== 'mouseup' && e.type !== 'touchstart' && e.type !== 'touchend') {\n\t\t\t\tthisObj.refreshTooltip();\n\t\t\t}\n\t\t});\n\n\t\t// handle bodyDiv events\n\t\tthis.bodyDiv.on(\n\t\t\t'mouseenter mouseleave mousemove mousedown mouseup keydown keyup touchstart touchmove touchend', function (e) {\n\n\t\t\tcoords = thisObj.pointerEventToXY(e);\n\n\t\t\tif (e.type === 'mouseenter') {\n\t\t\t\tthisObj.overBody = true;\n\t\t\t\tthisObj.overBodyMousePos = {\n\t\t\t\t\tx: coords.x,\n\t\t\t\t\ty: coords.y\n\t\t\t\t};\n\t\t\t}\n\t\t\telse if (e.type === 'mouseleave') {\n\t\t\t\tthisObj.overBody = false;\n\t\t\t\tthisObj.overBodyMousePos = null;\n\t\t\t\tif (!thisObj.overHead && thisObj.tracking && thisObj.trackDevice === 'mouse') {\n\t\t\t\t\tthisObj.stopTracking(thisObj.pageXToPosition(coords.x));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (e.type === 'mousemove' || e.type === 'touchmove') {\n\t\t\t\tthisObj.overBodyMousePos = {\n\t\t\t\t\tx: coords.x,\n\t\t\t\t\ty: coords.y\n\t\t\t\t};\n\t\t\t\tif (thisObj.tracking && thisObj.trackDevice === 'mouse') {\n\t\t\t\t\tthisObj.trackHeadAtPageX(coords.x);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (e.type === 'mousedown' || e.type === 'touchstart') {\n\t\t\t\tthisObj.startTracking('mouse', thisObj.pageXToPosition(coords.x));\n\t\t\t\tthisObj.trackHeadAtPageX(coords.x);\n\t\t\t\tif (!thisObj.seekHead.is(':focus')) {\n\t\t\t\t\tthisObj.seekHead.focus();\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\telse if (e.type === 'mouseup' || e.type === 'touchend') {\n\t\t\t\tif (thisObj.tracking && thisObj.trackDevice === 'mouse') {\n\t\t\t\t\tthisObj.stopTracking(thisObj.pageXToPosition(coords.x));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (e.type === 'keydown') {\n\t\t\t\t// Home\n\t\t\t\tif (e.which === 36) {\n\t\t\t\t\tthisObj.trackImmediatelyTo(0);\n\t\t\t\t}\n\t\t\t\t// End\n\t\t\t\telse if (e.which === 35) {\n\t\t\t\t\tthisObj.trackImmediatelyTo(thisObj.duration);\n\t\t\t\t}\n\t\t\t\t// Left arrow or down arrow\n\t\t\t\telse if (e.which === 37 || e.which === 40) {\n\t\t\t\t\tthisObj.arrowKeyDown(-1);\n\t\t\t\t}\n\t\t\t\t// Right arrow or up arrow\n\t\t\t\telse if (e.which === 39 || e.which === 38) {\n\t\t\t\t\tthisObj.arrowKeyDown(1);\n\t\t\t\t}\n\t\t\t\t// Page up\n\t\t\t\telse if (e.which === 33 && bigInterval > 0) {\n\t\t\t\t\tthisObj.arrowKeyDown(bigInterval);\n\t\t\t\t}\n\t\t\t\t// Page down\n\t\t\t\telse if (e.which === 34 && bigInterval > 0) {\n\t\t\t\t\tthisObj.arrowKeyDown(-bigInterval);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\telse if (e.type === 'keyup') {\n\t\t\t\tif (e.which >= 33 && e.which <= 40) {\n\t\t\t\t\tif (thisObj.tracking && thisObj.trackDevice === 'keyboard') {\n\t\t\t\t\t\tthisObj.stopTracking(thisObj.keyTrackPosition);\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!thisObj.overTooltip && e.type !== 'mouseup' && e.type !== 'keydown' && e.type !== 'keydown') {\n\t\t\t\tthisObj.refreshTooltip();\n\t\t\t}\n\t\t});\n\t}\n\n\tAccessibleSlider.prototype.arrowKeyDown = function (multiplier) {\n\t\tif (this.tracking && this.trackDevice === 'keyboard') {\n\t\t\tthis.keyTrackPosition = this.boundPos(this.keyTrackPosition + (this.nextStep * multiplier));\n\t\t\tthis.inertiaCount += 1;\n\t\t\tif (this.inertiaCount === 20) {\n\t\t\t\tthis.inertiaCount = 0;\n\t\t\t\tthis.nextStep *= 2;\n\t\t\t}\n\t\t\tthis.trackHeadAtPosition(this.keyTrackPosition);\n\t\t}\n\t\telse {\n\t\t\tthis.nextStep = 1;\n\t\t\tthis.inertiaCount = 0;\n\t\t\tthis.keyTrackPosition = this.boundPos(this.position + (this.nextStep * multiplier));\n\t\t\tthis.startTracking('keyboard', this.keyTrackPosition);\n\t\t\tthis.trackHeadAtPosition(this.keyTrackPosition);\n\t\t}\n\t};\n/*\n\tAccessibleSlider.prototype.pageUp = function (multiplier) {\n\t\tif (this.tracking && this.trackDevice === 'keyboard') {\n\t\t\tthis.keyTrackPosition = this.boundPos(this.keyTrackPosition + (this.nextStep * multiplier));\n\t\t\tthis.inertiaCount += 1;\n\t\t\tif (this.inertiaCount === 20) {\n\t\t\t\tthis.inertiaCount = 0;\n\t\t\t\tthis.nextStep *= 2;\n\t\t\t}\n\t\t\tthis.trackHeadAtPosition(this.keyTrackPosition);\n\t\t}\n\t\telse {\n\t\t\tthis.nextStep = 1;\n\t\t\tthis.inertiaCount = 0;\n\t\t\tthis.keyTrackPosition = this.boundPos(this.position + (this.nextStep * multiplier));\n\t\t\tthis.startTracking('keyboard', this.keyTrackPosition);\n\t\t\tthis.trackHeadAtPosition(this.keyTrackPosition);\n\t\t}\n\t};\n*/\n\tAccessibleSlider.prototype.pageXToPosition = function (pageX) {\n\t\tvar offset = pageX - this.bodyDiv.offset().left;\n\t\tvar position = this.duration * (offset / this.bodyDiv.width());\n\t\treturn this.boundPos(position);\n\t};\n\n\tAccessibleSlider.prototype.boundPos = function (position) {\n\t\treturn Math.max(0, Math.min(position, this.duration));\n\t}\n\n\tAccessibleSlider.prototype.setDuration = function (duration) {\n\t\tif (duration !== this.duration) {\n\t\t\tthis.duration = duration;\n\t\t\tthis.resetHeadLocation();\n\t\t\tthis.seekHead.attr('aria-valuemax', duration);\n\t\t}\n\t};\n\n\tAccessibleSlider.prototype.setWidth = function (width) {\n\t\tthis.wrapperDiv.width(width);\n\t\tthis.resizeDivs();\n\t\tthis.resetHeadLocation();\n\t};\n\n\tAccessibleSlider.prototype.getWidth = function () {\n\t\treturn this.wrapperDiv.width();\n\t};\n\n\tAccessibleSlider.prototype.resizeDivs = function () {\n\t\tthis.playedDiv.width(this.bodyDiv.width() * (this.position / this.duration));\n\t\tthis.loadedDiv.width(this.bodyDiv.width() * this.buffered);\n\t};\n\n\t// Stops tracking, sets the head location to the current position.\n\tAccessibleSlider.prototype.resetHeadLocation = function () {\n\t\tvar ratio = this.position / this.duration;\n\t\tvar center = this.bodyDiv.width() * ratio;\n\t\tthis.seekHead.css('left', center - (this.seekHead.width() / 2));\n\n\t\tif (this.tracking) {\n\t\t\tthis.stopTracking(this.position);\n\t\t}\n\t};\n\n\tAccessibleSlider.prototype.setPosition = function (position, updateLive) {\n\t\tthis.position = position;\n\t\tthis.resetHeadLocation();\n\t\tif (this.overHead) {\n\t\t\tthis.refreshTooltip();\n\t\t}\n\t\tthis.resizeDivs();\n\t\tthis.updateAriaValues(position, updateLive);\n\t}\n\n\t// TODO: Native HTML5 can have several buffered segments, and this actually happens quite often.\tChange this to display them all.\n\tAccessibleSlider.prototype.setBuffered = function (ratio) {\n\t\tif (!isNaN(ratio)) {\n\t\t\tthis.buffered = ratio;\n\t\t\tthis.redrawDivs;\n\t\t}\n\t}\n\n\tAccessibleSlider.prototype.startTracking = function (device, position) {\n\t\tif (!this.tracking) {\n\t\t\tthis.trackDevice = device;\n\t\t\tthis.tracking = true;\n\t\t\tthis.bodyDiv.trigger('startTracking', [position]);\n\t\t}\n\t};\n\n\tAccessibleSlider.prototype.stopTracking = function (position) {\n\t\tthis.trackDevice = null;\n\t\tthis.tracking = false;\n\t\tthis.bodyDiv.trigger('stopTracking', [position]);\n\t\tthis.setPosition(position, true);\n\t};\n\n\tAccessibleSlider.prototype.trackHeadAtPageX = function (pageX) {\n\t\tvar position = this.pageXToPosition(pageX);\n\t\tvar newLeft = pageX - this.bodyDiv.offset().left - (this.seekHead.width() / 2);\n\t\tnewLeft = Math.max(0, Math.min(newLeft, this.bodyDiv.width() - this.seekHead.width()));\n\t\tthis.lastTrackPosition = position;\n\t\tthis.seekHead.css('left', newLeft);\n\t\tthis.reportTrackAtPosition(position);\n\t};\n\n\tAccessibleSlider.prototype.trackHeadAtPosition = function (position) {\n\t\tvar ratio = position / this.duration;\n\t\tvar center = this.bodyDiv.width() * ratio;\n\t\tthis.lastTrackPosition = position;\n\t\tthis.seekHead.css('left', center - (this.seekHead.width() / 2));\n\t\tthis.reportTrackAtPosition(position);\n\t};\n\n\tAccessibleSlider.prototype.reportTrackAtPosition = function (position) {\n\t\tthis.bodyDiv.trigger('tracking', [position]);\n\t\tthis.updateAriaValues(position, true);\n\t};\n\n\tAccessibleSlider.prototype.updateAriaValues = function (position, updateLive) {\n\t\t// TODO: Localize, move to another function.\n\t\tvar pHours = Math.floor(position / 3600);\n\t\tvar pMinutes = Math.floor((position % 3600) / 60);\n\t\tvar pSeconds = Math.floor(position % 60);\n\n\t\tvar pHourWord = pHours === 1 ? 'hour' : 'hours';\n\t\tvar pMinuteWord = pMinutes === 1 ? 'minute' : 'minutes';\n\t\tvar pSecondWord = pSeconds === 1 ? 'second' : 'seconds';\n\n\t\tvar descriptionText;\n\t\tif (pHours > 0) {\n\t\t\tdescriptionText = pHours +\n\t\t\t\t' ' + pHourWord +\n\t\t\t\t', ' + pMinutes +\n\t\t\t\t' ' + pMinuteWord +\n\t\t\t\t', ' + pSeconds +\n\t\t\t\t' ' + pSecondWord;\n\t\t}\n\t\telse if (pMinutes > 0) {\n\t\t\tdescriptionText\t = pMinutes +\n\t\t\t\t' ' + pMinuteWord +\n\t\t\t\t', ' + pSeconds +\n\t\t\t\t' ' + pSecondWord;\n\t\t}\n\t\telse {\n\t\t\tdescriptionText = pSeconds + ' ' + pSecondWord;\n\t\t}\n\n\t\t/* Comment to stop live region from generating or being used. */\n\t\tif (!this.liveAriaRegion) {\n\t\t\tthis.liveAriaRegion = $('<span>', {\n\t\t\t\t'class': 'able-offscreen',\n\t\t\t\t'aria-live': 'polite'\n\t\t\t});\n\t\t\tthis.wrapperDiv.append(this.liveAriaRegion);\n\t\t}\n\t\tif (updateLive && (this.liveAriaRegion.text() !== descriptionText)) {\n\t\t\tthis.liveAriaRegion.text(descriptionText);\n\t\t}\n\n\t\t// Uncomment the following lines to use aria values instead of separate live region.\n\t\tthis.seekHead.attr('aria-valuetext', descriptionText);\n\t\tthis.seekHead.attr('aria-valuenow', Math.floor(position).toString());\n\t};\n\n\tAccessibleSlider.prototype.trackImmediatelyTo = function (position) {\n\t\tthis.startTracking('keyboard', position);\n\t\tthis.trackHeadAtPosition(position);\n\t\tthis.keyTrackPosition = position;\n\t};\n\n\tAccessibleSlider.prototype.refreshTooltip = function () {\n\t\tif (this.overHead) {\n\t\t\tthis.timeTooltip.show();\n\t\t\tif (this.tracking) {\n\t\t\t\tthis.timeTooltip.text(this.positionToStr(this.lastTrackPosition));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.timeTooltip.text(this.positionToStr(this.position));\n\t\t\t}\n\t\t\tthis.setTooltipPosition(this.seekHead.position().left + (this.seekHead.width() / 2));\n\t\t}\n\t\telse if (this.overBody && this.overBodyMousePos) {\n\t\t\tthis.timeTooltip.show();\n\t\t\tthis.timeTooltip.text(this.positionToStr(this.pageXToPosition(this.overBodyMousePos.x)));\n\t\t\tthis.setTooltipPosition(this.overBodyMousePos.x - this.bodyDiv.offset().left);\n\t\t}\n\t\telse {\n\n\t\t\tclearTimeout(this.timeTooltipTimeoutId);\n\t\t\tvar _this = this;\n\t\t\tthis.timeTooltipTimeoutId = setTimeout(function() {\n\t\t\t\t// give user a half second move cursor over tooltip\n\t\t\t\t_this.timeTooltip.hide();\n\t\t\t}, 500);\n\t\t}\n\t};\n\n\tAccessibleSlider.prototype.hideSliderTooltips = function () {\n\t\tthis.overHead = false;\n\t\tthis.overBody = false;\n\t\tthis.timeTooltip.hide();\n\t};\n\n\tAccessibleSlider.prototype.setTooltipPosition = function (x) {\n\t\tthis.timeTooltip.css({\n\t\t\tleft: x - (this.timeTooltip.width() / 2) - 10,\n\t\t\tbottom: this.seekHead.height() + 10\n\t\t});\n\t};\n\n\tAccessibleSlider.prototype.positionToStr = function (seconds) {\n\n\t\t// same logic as misc.js > formatSecondsAsColonTime()\n\t\tvar dHours = Math.floor(seconds / 3600);\n\t\tvar dMinutes = Math.floor(seconds / 60) % 60;\n\t\tvar dSeconds = Math.floor(seconds % 60);\n\t\tif (dSeconds < 10) {\n\t\t\tdSeconds = '0' + dSeconds;\n\t\t}\n\t\tif (dHours > 0) {\n\t\t\tif (dMinutes < 10) {\n\t\t\t\tdMinutes = '0' + dMinutes;\n\t\t\t}\n\t\t\treturn dHours + ':' + dMinutes + ':' + dSeconds;\n\t\t}\n\t\telse {\n\t\t\treturn dMinutes + ':' + dSeconds;\n\t\t}\n\t};\n\n\tAccessibleSlider.prototype.pointerEventToXY = function(e) {\n\n\t\t// returns array of coordinates x and y in response to both mouse and touch events\n\t\t// for mouse events, this comes from e.pageX and e.pageY\n\t\t// for touch events, it's a bit more complicated\n\t\tvar out = {x:0, y:0};\n\t\tif (e.type == 'touchstart' || e.type == 'touchmove' || e.type == 'touchend' || e.type == 'touchcancel') {\n\t\t\tvar touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];\n\t\t\tout.x = touch.pageX;\n\t\t\tout.y = touch.pageY;\n\t\t}\n\t\telse if (e.type == 'mousedown' || e.type == 'mouseup' || e.type == 'mousemove' || e.type == 'mouseover'|| e.type=='mouseout' || e.type=='mouseenter' || e.type=='mouseleave') {\n\t\t\tout.x = e.pageX;\n\t\t\tout.y = e.pageY;\n\t\t}\n\t\treturn out;\n\t};\n\n})(jQuery);\n\n(function ($) {\n\n\tAblePlayer.prototype.addVolumeSlider = function($div) {\n\n\t\t// Prior to v4.4.64, we were using a custom-build vertical volunme slider \n\t\t// Changed to input type=\"range\" because it's standard and gaining more widespread support \n\t\t// including screen reader support  \n\t\t// TODO: Improve presentation of vertical slider. That requires some CSS finesse.  \n\n\t\tvar thisObj, volumeSliderId, volumeHelpId, volumePct, tickLabelsId, $tickLabels, i, $tickOption, tickLabel;\n\n\t\tthisObj = this;\n\n\t\t// define a few variables\n\t\tvolumeSliderId = this.mediaId + '-volume-slider';\n\t\tvolumeHelpId = this.mediaId + '-volume-help';\n\t\ttickLabelsId = this.mediaId + '-volume-tick-labels';\n\n\t\tthis.$volumeSlider = $('<div>',{\n\t\t\t'id': volumeSliderId,\n\t\t\t'class': 'able-volume-slider',\n\t\t\t'aria-hidden': 'true'\n\t\t}).hide();\n\t\tthis.$volumeSliderTooltip = $('<div>',{\n\t\t\t'class': 'able-tooltip',\n\t\t\t'role': 'tooltip'\n\t\t}).hide();\n\t\tthis.$volumeRange = $('<input>',{ \n\t\t\t'type': 'range',\n\t\t\t'min': '0',\n\t\t\t'max': '10',\n\t\t\t'step': '1',\n\t\t\t'orient': 'vertical', // non-standard, but required for Firefox \n\t\t\t'aria-label': this.tt.volumeUpDown,\n\t\t\t'value': this.volume\n\t\t\t// 'list': tickLabelsId // Uncomment this to use tickLabels (see note below)\n\t\t});\n\t\tvolumePct = parseInt(thisObj.volume) / 10 * 100;\n\t\tthis.$volumeHelp = $('<div>',{\n\t\t\t'id': volumeHelpId,\n\t\t\t'class': 'able-volume-help',\n\t\t\t'aria-live': 'polite'\n\t\t}).text(volumePct + '%');\n\t\tthis.$volumeButton.attr({\n\t\t\t'aria-describedby': volumeHelpId\n\t\t});\n\t\t$tickLabels = $('<datalist>',{\n\t\t\t'id': tickLabelsId\n\t\t}); \n\t\tfor (i = 0; i <= 10; i++) { \n\t\t\tif (i === 0) { \n\t\t\t\ttickLabel = this.tt.mute; \n\t\t\t}\n\t\t\telse { \n\t\t\t\ttickLabel = (i * 10) + '%'; \n\t\t\t}\n\t\t\t$tickOption = $('<option>',{ \n\t\t\t\t'value': i, \n\t\t\t\t'label': tickLabel\n\t\t\t})\n\t\t\t$tickLabels.append($tickOption); \n\t\t}\t\t\n\t\tthis.$volumeSlider.append(this.$volumeSliderTooltip,this.$volumeRange,this.$volumeHelp);\n\t\t// To add $tickLabels, use the following line of code to replace the one above \n\t\t// and uncommnet the 'list' property in the definition of this.$volumeRange above \n\t\t// As of Nov 2022, this feature is not supported by any screen reader \n\t\t// this.$volumeSlider.append(this.$volumeSliderTooltip,this.$volumeRange,this.$volumeHelp,$tickLabels);\n\n\t\t$div.append(this.$volumeSlider);\n\n\t\t// add event listeners\n\t\tthis.$volumeRange.on('change',function (e) {\n\t\t\tthisObj.handleVolumeChange($(this).val());\n\t\t});\n\n\t\tthis.$volumeRange.on('input',function (e) {\n\t\t\tthisObj.handleVolumeChange($(this).val());\n\t\t});\n\t\t\t\n\t\tthis.$volumeRange.on('keydown',function (e) {\n\n\t\t\t// Escape key or Enter key or Tab key\n\t\t\tif (e.which === 27 || e.which === 13 || e.which === 9) {\n\t\t\t\t// close popup\n\t\t\t\tif (thisObj.$volumeSlider.is(':visible')) {\n\t\t\t\t\tthisObj.closingVolume = true; // stopgap\n\t\t\t\t\tthisObj.hideVolumePopup();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (!thisObj.closingVolume) {\n\t\t\t\t\t\tthisObj.showVolumePopup();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\t};\n\n\tAblePlayer.prototype.refreshVolumeHelp = function(volume) {\n\n\t\t// make adjustments based on current volume\n\t\tvar volumePct;\n\t\tvolumePct = (volume/10) * 100;\n\n\t\t// Update help text \n\t\tif (this.$volumeHelp) { \n\t\t\tthis.$volumeHelp.text(volumePct + '%'); \n\t\t}\n\n\t\t// Update the default value of the volume slider input field \n\t\t// This doesn't seem to be necessary; browsers remember the previous setting during a session \n\t\t// but this is a fallback in case they don't \n\t\tthis.$volumeRange.attr('value',volume);   \n\t};\n\n\tAblePlayer.prototype.refreshVolumeButton = function(volume) {\n\n\t\tvar volumeName, volumePct, volumeLabel, volumeIconClass, volumeImg, newSvgData;\n\n\t\tvolumeName = this.getVolumeName(volume);\n\t\tvolumePct = (volume/10) * 100;\n\t\tvolumeLabel = this.tt.volume + ' ' + volumePct + '%';\n\n\t\tif (this.iconType === 'font') {\n\t\t\tvolumeIconClass = 'icon-volume-' + volumeName;\n\t\t\tthis.$volumeButton.find('span').first().removeClass().addClass(volumeIconClass);\n\t\t\tthis.$volumeButton.find('span.able-clipped').text(volumeLabel);\n\t\t}\n\t\telse if (this.iconType === 'image') {\n\t\t\tvolumeImg = this.imgPath + 'volume-' + volumeName + '.png';\n\t\t\tthis.$volumeButton.find('img').attr('src',volumeImg);\n\t\t}\n\t\telse if (this.iconType === 'svg') {\n\t\t\tif (volumeName !== 'mute') {\n\t\t\t\tvolumeName = 'volume-' + volumeName;\n\t\t\t}\n\t\t\tnewSvgData = this.getSvgData(volumeName);\n\t\t\tthis.$volumeButton.find('svg').attr('viewBox',newSvgData[0]);\n\t\t\tthis.$volumeButton.find('path').attr('d',newSvgData[1]);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.handleVolumeButtonClick = function() {\n\n\t\tif (this.$volumeSlider.is(':visible')) {\n\t\t\tthis.hideVolumePopup();\t\t\t\n\t\t}\n\t\telse {\n\t\t\tthis.showVolumePopup();\n\t\t}\n\t}; \n\n\tAblePlayer.prototype.handleVolumeKeystroke = function(keycode) {\n\n\t\t// keycode is an ASCII key code 49-57 (numeric keys 1-9), \n\t\t// keyboard shortcuts for changing volume \n\n\t\tvar volume; \n\n\t\tif (keycode >= 49 && keycode <= 57) {\n\t\t\tvolume = keycode - 48;\n\t\t}\n\t\telse { \n\t\t\treturn false; \n\t\t}\n\n\t\tif (this.isMuted() && volume > 0) {\n\t\t\tthis.setMute(false);\n\t\t}\n\t\telse if (volume === 0) {\n\t\t\tthis.setMute(true);\n\t\t}\n\t\telse {\n\t\t\tthis.setVolume(volume); // this.volume will be updated after volumechange event fires (event.js)\n\t\t\tthis.refreshVolumeHelp(volume);\n\t\t\tthis.refreshVolumeButton(volume);\n\t\t}\n\t}; \n\n\n\tAblePlayer.prototype.handleVolumeChange = function(volume) {\n\n\t\t// handle volume change using the volume input slider  \n\n\t\tif (this.isMuted() && volume > 0) {\n\t\t\tthis.setMute(false);\n\t\t}\n\t\telse if (volume === 0) {\n\t\t\tthis.setMute(true);\n\t\t}\n\t\telse {\n\t\t\tthis.setVolume(volume); // this.volume will be updated after volumechange event fires (event.js)\n\t\t\tthis.refreshVolumeHelp(volume);\n\t\t\tthis.refreshVolumeButton(volume);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.handleMute = function() {\n\n\t\tif (this.isMuted()) {\n\t\t\tthis.setMute(false);\n\t\t}\n\t\telse {\n\t\t\tthis.setMute(true);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.showVolumePopup = function() {\n\n\t\tthis.closePopups();\n\t\tthis.$tooltipDiv.hide();\n\t\tthis.$volumeSlider.show().attr('aria-hidden','false');\n\t\tthis.$volumeButton.attr('aria-expanded','true');\n\t\tthis.$volumeButton.focus(); // for screen reader expanded state to be read\n\t\tthis.waitThenFocus(this.$volumeRange);\n\t};\n\n\tAblePlayer.prototype.hideVolumePopup = function() {\n\n\t\tvar thisObj = this;\n\n\t\tthis.$volumeSlider.hide().attr('aria-hidden','true');\n\t\tthis.$volumeButton.attr('aria-expanded','false').focus();\n\t\t// wait a second before resetting stopgap var\n\t\t// otherwise the keypress used to close volume popup will trigger the volume button\n\t\tsetTimeout(function() {\n\t\t\tthisObj.closingVolume = false;\n\t\t}, 1000);\n\t};\n\n\tAblePlayer.prototype.isMuted = function () {\n\n\t\tif (this.player === 'html5') {\n\t\t\treturn this.media.muted;\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\t\t\treturn this.youTubePlayer.isMuted();\n\t\t}\n\t};\n\n\tAblePlayer.prototype.setMute = function(mute) {\n\n\t\t// mute is either true (muting) or false (unmuting)\n\t\tif (mute) {\n\t\t\t// save current volume so it can be restored after unmute\n\t\t\tthis.lastVolume = this.volume;\n\t\t\tthis.volume = 0;\n\t\t}\n\t\telse { // restore to previous volume\n\t\t\tif (typeof this.lastVolume !== 'undefined') {\n\t\t\t\tthis.volume = this.lastVolume;\n\t\t\t}\n\t\t}\n\n\t\tif (this.player === 'html5') {\n\t\t\tthis.media.muted = mute;\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\t\t\tif (mute) {\n\t\t\t\tthis.youTubePlayer.mute();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.youTubePlayer.unMute();\n\t\t\t}\n\t\t}\n\t\tthis.setVolume(this.volume); \n\t\tthis.refreshVolumeHelp(this.volume);\n\t\tthis.refreshVolumeButton(this.volume);\n\t};\n\n\tAblePlayer.prototype.setVolume = function (volume) {\n\n\t\t// volume is 1 to 10\n\t\t// convert as needed depending on player\n\n\t\tvar newVolume; \n\n\t\tif (this.player === 'html5') {\n\t\t\t// volume is 0 to 1\n\t\t\tnewVolume = volume / 10; \n\t\t\tthis.media.volume = newVolume;\n\t\t\t\n\t\t\tif (this.hasSignLanguage && this.signVideo) {\n\t\t\t\tthis.signVideo.volume = 0; // always mute\n\t\t\t}\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\t\t\t// volume is 0 to 100\n\t\t\tnewVolume = volume * 10; \n\t\t\tthis.youTubePlayer.setVolume(newVolume);\n\t\t\tthis.volume = volume;\n\t\t}\n\t\telse if (this.player === 'vimeo') {\n\t\t\t// volume is 0 to 1\n\t\t\tnewVolume = volume / 10; \n\t\t\tthis.vimeoPlayer.setVolume(newVolume).then(function() {\n\t\t\t\t// setVolume finished.\n\t\t\t\t// could do something here\n\t\t\t\t// successful completion also fires a 'volumechange' event (see event.js)\n\t\t\t});\n\t\t}\n\t\tthis.lastVolume = volume;\n\t};\n\n\tAblePlayer.prototype.getVolume = function (volume) {\n\n\t\t// return volume using common audio control scale 1 to 10\n\t\tif (this.player === 'html5') {\n\t\t\t// uses 0 to 1 scale\n\t\t\treturn this.media.volume * 10;\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\t\t\t// uses 0 to 100 scale\n\t\t\tif (this.youTubePlayerReady) { \n\t\t\t\treturn this.youTubePlayer.getVolume() / 10;\n\t\t\t}\n\t\t}\n\t\tif (this.player === 'vimeo') {\n\t\t\t// uses 0 to 1 scale\n\t\t\t// this.vimeoPlayer.getVolume() takes too long to resolve with a value\n\t\t\t// Just use variable that's already been defined (should be the same value anyway)\n\t\t\treturn this.volume;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getVolumeName = function (volume) {\n\n\t\t// returns 'mute','soft','medium', or 'loud' depending on volume level\n\t\tif (volume == 0) {\n\t\t\treturn 'mute';\n\t\t}\n\t\telse if (volume == 10) {\n\t\t\treturn 'loud';\n\t\t}\n\t\telse if (volume < 5) {\n\t\t\treturn 'soft';\n\t\t}\n\t\telse {\n\t\t\treturn 'medium';\n\t\t}\n\t};\n\n})(jQuery);\n\n(function ($) {\n\tvar focusableElementsSelector = \"a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]\";\n\n\t// Based on the incredible accessible modal dialog.\n\twindow.AccessibleDialog = function(modalDiv, $returnElement, dialogRole, isModal, title, $descDiv, closeButtonLabel, width, fullscreen, escapeHook) {\n\n\t\tthis.title = title;\n\t\tthis.closeButtonLabel = closeButtonLabel;\n\t\tthis.focusedElementBeforeModal = $returnElement;\n\t\tthis.escapeHook = escapeHook;\n\t\tthis.baseId = $(modalDiv).attr('id') || Math.floor(Math.random() * 1000000000).toString();\n\t\tvar thisObj = this;\n\t\tvar modal = modalDiv;\n\t\tthis.modal = modal;\n\t\tmodal.css({\n\t\t\t'width': width || '50%'\n\t\t});\n\t\tmodal.addClass('able-modal-dialog');\n\n\t\tif (!fullscreen) {\n\t\t\tvar closeButton = $('<button>',{\n\t\t\t\t 'class': 'modalCloseButton',\n\t\t\t\t 'title': thisObj.closeButtonLabel,\n\t\t\t\t 'aria-label': thisObj.closeButtonLabel\n\t\t\t}).text('X');\n\t\t\tcloseButton.keydown(function (e) {\n\t\t\t\t// Space key down\n\t\t\t\tif (e.which === 32) {\n\t\t\t\t\tthisObj.hide();\n\t\t\t\t}\n\t\t\t}).click(function () {\n\t\t\t\tthisObj.hide();\n\t\t\t});\n\n\t\t\tvar titleH1 = $('<h1></h1>');\n\t\t\ttitleH1.attr('id', 'modalTitle-' + this.baseId);\n\t\t\ttitleH1.css('text-align', 'center');\n\t\t\ttitleH1.text(title);\n\t\t\tthis.titleH1 = titleH1; \n\n\t\t\tmodal.attr({\n\t\t\t\t'aria-labelledby': 'modalTitle-' + this.baseId,\n\t\t\t});\n\t\t\tmodal.prepend(titleH1);\n\t\t\tmodal.prepend(closeButton);\n\t\t}\n\n\t\tmodal.attr({\n\t\t\t'aria-hidden': 'true',\n\t\t\t'role': dialogRole,\n\t\t});\n\t\tif (isModal) { \n\t\t\tmodal.attr('aria-modal','true');\n\t\t}\n\n\t\tmodal.keydown(function (e) {\n\t\t\t// Escape\n\t\t\tif (e.which === 27) {\n\t\t\t\tif (thisObj.escapeHook) {\n\t\t\t\t\tthisObj.escapeHook(e, this);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthisObj.hide();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Tab\n\t\t\telse if (e.which === 9) {\n\t\t\t\t// Manually loop tab navigation inside the modal.\n\t\t\t\tvar parts = modal.find('*');\n\t\t\t\tvar focusable = parts.filter(focusableElementsSelector).filter(':visible');\n\n\t\t\t\tif (focusable.length === 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar focused = $(':focus');\n\t\t\t\tvar currentIndex = focusable.index(focused);\n\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t// If backwards from first element, go to last.\n\t\t\t\t\tif (currentIndex === 0) {\n\t\t\t\t\t\tfocusable.get(focusable.length - 1).focus();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (currentIndex === focusable.length - 1) {\n\t\t\t\t\t\tfocusable.get(0).focus();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\te.stopPropagation();\n\t\t});\n\n\t\t$('body > *').not('.able-modal-overlay').not('.able-modal-dialog').removeAttr('aria-hidden');\n\t};\n\n\tAccessibleDialog.prototype.show = function () {\n\t\tif (!this.overlay) {\n\t\t\t// Generate overlay.\n\t\t\tvar overlay = $('<div></div>').attr({\n\t\t\t\t 'class': 'able-modal-overlay',\n\t\t\t\t 'tabindex': '-1'\n\t\t\t});\n\t\t\tthis.overlay = overlay;\n\t\t\t$('body').append(overlay);\n\n\t\t\t// Keep from moving focus out of dialog when clicking outside of it.\n\t\t\toverlay.on('mousedown.accessibleModal', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t});\n\t\t}\n\n\t\t$('body > *').not('.able-modal-overlay').not('.able-modal-dialog').attr('aria-hidden', 'true');\n\n\t\tthis.overlay.css('display', 'block');\n\t\tthis.modal.css('display', 'block');\n\t\tthis.modal.attr({\n\t\t\t'aria-hidden': 'false',\n\t\t\t'tabindex': '-1'\n\t\t});\n\n\t\tvar focusable = this.modal.find(\"*\").filter(focusableElementsSelector).filter(':visible');\n\t\tif (focusable.length === 0) {\n\t\t\tthis.focusedElementBeforeModal.blur();\n\t\t}\n\t\tvar thisObj = this;\n\t\tsetTimeout(function () {\n\t\t\t// set focus on the first focusable element\n\t\t\tthisObj.modal.find('button.modalCloseButton').first().focus();\n\t\t}, 300);\n\t};\n\n\tAccessibleDialog.prototype.hide = function () {\n\t\tif (this.overlay) {\n\t\t\tthis.overlay.css('display', 'none');\n\t\t}\n\t\tthis.modal.css('display', 'none');\n\t\tthis.modal.attr('aria-hidden', 'true');\n\t\t$('body > *').not('.able-modal-overlay').not('.able-modal-dialog').removeAttr('aria-hidden');\n\n\t\tthis.focusedElementBeforeModal.focus();\n\t};\n\n\tAccessibleDialog.prototype.getInputs = function () {\n\n\t\t// return an array of input elements within this dialog\n\t\tif (this.modal) {\n\t\t\tvar inputs = this.modal.find('input');\n\t\t\treturn inputs;\n\t\t}\n\t\treturn false;\n\t};\n\n})(jQuery);\n\n(function ($) {\n\n\tAblePlayer.prototype.getNextHeadingLevel = function($element) {\n\n\t\t// Finds the nearest heading in the ancestor tree\n\t\t// Loops over each parent of the current element until a heading is found\n\t\t// If multiple headings are found beneath a given parent, get the closest\n\t\t// Returns an integer (1-6) representing the next available heading level\n\n\t\tvar $parents, $foundHeadings, numHeadings, headingType, headingNumber;\n\n\t\t$parents = $element.parents();\n\t\t$parents.each(function(){\n\t\t\t$foundHeadings = $(this).children(':header');\n\t\t\tnumHeadings = $foundHeadings.length;\n\t\t\tif (numHeadings) {\n\t\t\t\theadingType = $foundHeadings.eq(numHeadings-1).prop('tagName');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\tif (typeof headingType === 'undefined') {\n\t\t\t// page has no headings\n\t\t\theadingNumber = 1;\n\t\t}\n\t\telse {\n\t\t\t// Increment closest heading by one if less than 6.\n\t\t\theadingNumber = parseInt(headingType[1]);\n\t\t\theadingNumber += 1;\n\t\t\tif (headingNumber > 6) {\n\t\t\t\theadingNumber = 6;\n\t\t\t}\n\t\t}\n\t\treturn headingNumber;\n\t};\n\n\tAblePlayer.prototype.countProperties = function(obj) {\n\n\t\t// returns the number of properties in an object\n\t\tvar count, prop;\n\t\tcount = 0;\n\t\tfor (prop in obj) {\n\t\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\t\t++count;\n\t\t\t}\n\t\t}\n\t\treturn count;\n\t};\n\n\tAblePlayer.prototype.formatSecondsAsColonTime = function (seconds, showFullTime) {\n\n\t\t// Takes seconds and converts to string of form hh:mm:ss\n\t\t// If showFullTime is true, shows 00 for hours if time is less than an hour\n\t\t//\t and show milliseconds\t(e.g., 00:00:04.123 as in Video Track Sorter)\n\t\t// Otherwise, omits empty hours and milliseconds (e.g., 00:04 as in timer on controller)\n\n\t\tvar dHours, dMinutes, dSeconds,\n\t\t\t\tparts, milliSeconds, numShort, i;\n\n\t\tif (showFullTime) {\n\t\t\t// preserve milliseconds, if included in seconds\n\t\t\tparts = seconds.toString().split('.');\n\t\t\tif (parts.length === 2) {\n\t\t\t\tmilliSeconds = parts[1];\n\t\t\t\tif (milliSeconds.length < 3) {\n\t\t\t\t\tnumShort = 3 - milliSeconds.length;\n\t\t\t\t\tfor (i=1; i <= numShort; i++) {\n\t\t\t\t\t\tmilliSeconds += '0';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tmilliSeconds = '000';\n\t\t\t}\n\t\t}\n\t\tdHours = Math.floor(seconds / 3600);\n\t\tdMinutes = Math.floor(seconds / 60) % 60;\n\t\tdSeconds = Math.floor(seconds % 60);\n\t\tif (dSeconds < 10) {\n\t\t\tdSeconds = '0' + dSeconds;\n\t\t}\n\t\tif (dHours > 0) {\n\t\t\tif (dMinutes < 10) {\n\t\t\t\tdMinutes = '0' + dMinutes;\n\t\t\t}\n\t\t\tif (showFullTime) {\n\t\t\t\treturn dHours + ':' + dMinutes + ':' + dSeconds + '.' + milliSeconds;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn dHours + ':' + dMinutes + ':' + dSeconds;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (showFullTime) {\n\t\t\t\tif (dHours < 1) {\n\t\t\t\t\tdHours = '00';\n\t\t\t\t}\n\t\t\t\telse if (dHours < 10) {\n\t\t\t\t\tdHours = '0' + dHours;\n\t\t\t\t}\n\t\t\t\tif (dMinutes < 1) {\n\t\t\t\t\tdMinutes = '00';\n\t\t\t\t}\n\t\t\t\telse if (dMinutes < 10) {\n\t\t\t\t\tdMinutes = '0' + dMinutes;\n\t\t\t\t}\n\t\t\t\treturn dHours + ':' + dMinutes + ':' + dSeconds + '.' + milliSeconds;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn dMinutes + ':' + dSeconds;\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getSecondsFromColonTime = function (timeStr) {\n\n\t\t// Converts string of form hh:mm:ss to seconds\n\t\tvar timeParts, hours, minutes, seconds, newTime;\n\n\t\ttimeParts = timeStr.split(':');\n\t\tif (timeParts.length === 3) {\n\t\t\thours = parseInt(timeParts[0]);\n\t\t\tminutes = parseInt(timeParts[1]);\n\t\t\tseconds = parseFloat(timeParts[2]);\n\t\t\treturn ((hours * 3600) + (minutes * 60) + (seconds));\n\t\t}\n\t\telse if (timeParts.length === 2) {\n\t\t\tminutes = parseInt(timeParts[0]);\n\t\t\tseconds = parseFloat(timeParts[1]);\n\t\t\treturn ((minutes * 60) + (seconds));\n\t\t}\n\t\telse if (timeParts.length === 1) {\n\t\t\tseconds = parseFloat(timeParts[0]);\n\t\t\treturn seconds;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.capitalizeFirstLetter = function (string) {\n\t\treturn string.charAt(0).toUpperCase() + string.slice(1);\n\t};\n\n\tAblePlayer.prototype.roundDown = function (value, decimals) {\n\n\t\t// round value down to the nearest X decimal points\n\t\t// where X is the value of the decimals parameter\n\t\treturn Number(Math.floor(value+'e'+decimals)+'e-'+decimals);\n\t};\n\n\tAblePlayer.prototype.hasAttr = function (object, attribute) {\n\n\t\t // surprisingly, there is no hasAttr() function in Jquery as of 3.2.1\n\t\t // return true if object has attribute; otherwise false\n\t\t // selector is a Jquery object\n\t\t // attribute is a string\n\n\t\tvar attr = object.attr(attribute);\n\n\t\t// For some browsers, `attr` is undefined; for others,\n\t\t// `attr` is false.\t Check for both.\n\t\tif (typeof attr !== typeof undefined && attr !== false) {\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\t return false;\n\t\t}\n\t};\n\n\tNumber.isInteger = Number.isInteger || function(value) {\n\n\t\t// polyfill for IE11, which doesn't otherwise support Number.isInteger\n\t\t// https://stackoverflow.com/a/31720368/744281\n\t\treturn typeof value === \"number\" && isFinite(value) && Math.floor(value) === value;\n\t};\n\n})(jQuery);\n\n(function ($) {\n\tAblePlayer.prototype.initDescription = function() {\n\n\t\t// set default mode for delivering description (open vs closed)\n\t\t// based on availability and user preference\n\n\t\t// called when player is being built, or when a user\n\t\t// toggles the Description button or changes a description-related preference\n\n\t\t// The following variables are applicable to delivery of description:\n\t\t// defaultStateDescriptions == 'on' or 'off', defined by website owner (overridden by prefDesc) \n\t\t// prefDesc == 1 if user wants description (i.e., Description button is on); else 0\n\t\t// prefDescPause == 1 to pause video when description starts; else 0\n\t\t// prefDescVisible == 1 to visibly show text-based description area; else 0\n\t\t// prefDescMethod == either 'video' or 'text' (as of v4.0.10, prefDescMethod is always 'video')\n\t\t// descMethod is the format actually used ('video' or 'text'), regardless of user preference \n\t\t// hasOpenDesc == true if a described version of video is available via data-desc-src attribute\n\t\t// hasClosedDesc == true if a description text track is available\n\t\t// descOn == true if description of either type is on\n\t\t// readDescriptionsAloud == true if text description is to be announced audibly; otherwise false\n\t\t// descReader == either 'browser' or 'screenreader'\n\n\t\tvar deferred, promise, thisObj;\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\t\tthisObj = this;\n\n\t\tif (this.mediaType === 'audio') { \n\t\t\tdeferred.resolve(); \n\t\t}\n\n\t\t// check to see if there's an open-described version of this video\n\t\t// checks only the first source since if a described version is provided,\n\t\t// it must be provided for all sources\n\t\tthis.descFile = this.$sources.first().attr('data-desc-src');\n\t\tif (typeof this.descFile !== 'undefined') {\n\t\t\tthis.hasOpenDesc = true;\n\t\t}\n\t\telse {\n\t\t\t// there's no open-described version via data-desc-src,\n\t\t\t// but what about data-youtube-desc-src or data-vimeo-desc-src?\n\t\t\t// if these exist, they would have been defined earlier \n\t\t\tif (this.youTubeDescId || this.vimeoDescId) {\n\t\t\t\tthis.hasOpenDesc = true;\n\t\t\t}\n\t\t\telse { // there are no open-described versions from any source\n\t\t\t\tthis.hasOpenDesc = false;\n\t\t\t}\n\t\t}\n\n\t\t// Set this.descMethod based on media availability & user preferences\n\t\tif (this.hasOpenDesc && this.hasClosedDesc) {\n\t\t\t// both formats are available. User gets their preference. \n\t\t\tif (this.prefDescMethod) { \n\t\t\t\tthis.descMethod = this.prefDescMethod;\n\t\t\t}\n\t\t\telse { \n\t\t\t\t// user has no preference. Video is default. \n\t\t\t\tthis.descMethod = 'video'; \n\t\t\t}\n\t\t}\n\t\telse if (this.hasOpenDesc) {\n\t\t\tthis.descMethod = 'video';\n\t\t}\n\t\telse if (this.hasClosedDesc) {\n\t\t\tthis.descMethod = 'text';\n\t\t}\n\t\telse { \n\t\t\t// no description is available for this video \n\t\t\tthis.descMethod = null; \n\t\t}\n\n\t\t// Set the default state of descriptions\n\t\tif (this.descMethod) { \n\t\t\tif (this.prefDesc === 1) { \n\t\t\t\tthis.descOn = true; \n\t\t\t}\n\t\t\telse if (this.prefDesc === 0) { \n\t\t\t\tthis.descOn = false; \n\t\t\t}\n\t\t\telse { \t\t\t\t\n\t\t\t\t// user has no prefs. Use default state. \n\t\t\t\tif (this.defaultStateDescriptions === 1)\t{ \t\t\t\n\t\t\t\t\tthis.descOn = true; \n\t\t\t\t}\n\t\t\t\telse { \n\t\t\t\t\tthis.descOn = false; \n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse { \t\t\t\n\t\t\tthis.descOn = false;\n\t\t}\n\t\tif (typeof this.$descDiv === 'undefined' && this.hasClosedDesc && this.descMethod === 'text') {\t\t\n\t\t\tthis.injectTextDescriptionArea();\n\t\t}\n\n\t\tif (this.descOn) {\n\t\t\tif (this.descMethod === 'video') {\n\t\t\t\tif (!this.usingDescribedVersion()) {\n\t\t\t\t\t// switched from non-described to described version\n\t\t\t\t\tthis.swapDescription();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.hasClosedDesc) {\n\t\t\t\tif (this.prefDescVisible) {\n\t\t\t\t\t// make description text visible\n\t\t\t\t\tif (typeof this.$descDiv !== 'undefined') {\n\t\t\t\t\t\tthis.$descDiv.show();\n\t\t\t\t\t\tthis.$descDiv.removeClass('able-clipped');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// keep it visible to screen readers, but hide it visibly\n\t\t\t\t\tif (typeof this.$descDiv !== 'undefined') {\n\t\t\t\t\t\tthis.$descDiv.addClass('able-clipped');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse { // description is off.\n\t\t\tif (this.descMethod === 'video') { // user has turned off described version of video\n\t\t\t\tif (this.usingDescribedVersion()) {\n\t\t\t\t\t// user was using the described verion. Swap for non-described version\n\t\t\t\t\tthis.swapDescription();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.descMethod === 'text') { // user has turned off text description\n\t\t\t\t// hide description div from everyone, including screen reader users\n\t\t\t\tif (typeof this.$descDiv !== 'undefined') {\n\t\t\t\t\tthis.$descDiv.hide();\n\t\t\t\t\tthis.$descDiv.removeClass('able-clipped');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdeferred.resolve();\n\t\treturn promise; \n\t};\n\n\tAblePlayer.prototype.usingDescribedVersion = function () {\n\n\t\t// Returns true if currently using audio description, false otherwise.\n\n\t\tif (this.player === 'youtube') {\n\t\t\treturn (this.activeYouTubeId === this.youTubeDescId);\n\t\t}\n\t\telse if (this.player === 'vimeo') {\n\t\t\treturn (this.activeVimeoId === this.vimeoDescId);\n\t\t}\n\t\telse {\n\t\t\treturn (this.$sources.first().attr('data-desc-src') === this.$sources.first().attr('src'));\n\t\t}\n\t};\n\n\tAblePlayer.prototype.initSpeech = function (context) { \n\n\t\t// Some browsers &/or operating systems require a user-initiated click \n\t\t// before this.synth.getVoices() will work. As of Nov 2022: \n\t\t// Chrome requires a click before synth.getVoices() will work\n\t\t// iOS requires a click before synth.speak() will work \n\t\t// A hack to address this: Listen for ANY click, then play an inaudible utterance \n\t\t// to intitiate speech synthesis \t\t\n\t\t// https://stackoverflow.com/questions/32193704/js-speech-synthesis-issue-on-ios\n\t\t// This function does that, and sets this.speechEnabled\n\t\t// It's called with either of these contexts: \n\t\t// 'init' - player is being initialized \n\t\t// 'play' - user has clicked play \n\t\t// 'prefs' - user has clicked prefs button\n\t\t// 'desc' - it's time to announce a description!  \n\n\t\tvar thisObj = this; \n\t\t\n\t\tif (this.speechEnabled === null) {  \n\n\t\t\tif (typeof this.synth !== 'undefined') { \n\t\t\t\t// cancel any previous synth instance and reinitialize  \n\t\t\t\tthis.synth.cancel(); \n\t\t\t}\t\n\n\t\t\tif (window.speechSynthesis) {\n\n\t\t\t\t// browser supports speech synthesis \n\n\t\t\t\tthis.synth = window.speechSynthesis;\n\n\t\t\t\tif (context === 'init') { \n\t\t\t\t\t// handle a click on anything, in case the user \n\t\t\t\t\t// clicks something before they click 'play' or 'prefs' buttons\n\t\t\t\t\t// that would allow us to init speech before it's needed \n\t\t\t\t\t$(document).on('click',function() { \t\t\t\n\t\t\t\t\t\tvar greeting = new SpeechSynthesisUtterance('Hi!');\n\t\t\t\t\t\tgreeting.volume = 0; // silent \n\t\t\t\t\t\tgreeting.rate = 10; // fastest speed supported by the API  \n\t\t\t\t\t\tthisObj.synth.speak(greeting);\n\t\t\t\t\t\tgreeting.onstart = function(e) { \t\t\t\t\t\t\n\t\t\t\t\t\t\t// utterance has started \n\t\t\t\t\t\t\t$(document).off('click'); // unbind the click event listener \t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgreeting.onend = function(e) {\n\t\t\t\t\t\t\t// should now be able to get browser voices \n\t\t\t\t\t\t\t// in browsers that require a click \n\t\t\t\t\t\t\tthisObj.getBrowserVoices(); \n\t\t\t\t\t\t\tif (thisObj.descVoices.length) { \n\t\t\t\t\t\t\t\tthisObj.speechEnabled = true; \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}); \n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t// go ahead and call get browser voices in case it might work, \n\t\t\t\t\t// for browsers that don't require a click \n\t\t\t\t\tthis.getBrowserVoices(); \n\t\t\t\t\tif (this.descVoices.length) { \n\t\t\t\t\t\tthis.speechEnabled = true; \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {  // context is either 'play' or 'prefs' or 'desc'\n\t\t\t\t\tvar greeting = new SpeechSynthesisUtterance('Hi!');\n\t\t\t\t\tgreeting.volume = 0; // silent \n\t\t\t\t\tgreeting.rate = 10; // fastest speed supported by the API  \n\t\t\t\t\tthisObj.synth.speak(greeting);\n\t\t\t\t\tgreeting.onstart = function(e) { \t\t\t\t\t\t\n\t\t\t\t\t\t// utterance has started \n\t\t\t\t\t\t$(document).off('click'); // unbind the click event listener \t\t\t\n\t\t\t\t\t};\n\t\t\t\t\tgreeting.onend = function(e) {\n\t\t\t\t\t\t// should now be able to get browser voices \n\t\t\t\t\t\t// in browsers that require a click \n\t\t\t\t\t\tthisObj.getBrowserVoices(); \n\t\t\t\t\t\tif (thisObj.descVoices.length) { \n\t\t\t\t\t\t\tthisObj.speechEnabled = true; \n\t\t\t\t\t\t}\n\t\t\t\t\t};\t\t\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\telse { \n\t\t\t\t// browser does not support speech synthesis\n\t\t\t\tthis.speechEnabled = false; \n\t\t\t}\n\t\t}\n\t}; \n\n\tAblePlayer.prototype.getBrowserVoices = function () {\n\t\t\n\t\t// define this.descVoices array \n\t\t// includes only languages that match the language of the captions or player \n\n\t\tvar voices, descLangs, voiceLang, preferredLang;\n\n\t\tif (this.captionLang) { \n\t\t\tpreferredLang = this.captionLang.substring(0,2).toLowerCase();\n\t\t}\n\t\telse { \n\t\t\tpreferredLang = this.lang.substring(0,2).toLowerCase();\n\t\t}\n\t\tthis.descVoices = []; \n\t\tvoices = this.synth.getVoices();\n\t\tdescLangs = this.getDescriptionLangs();\n\t\tif (voices.length > 0) {\n\t\t\tthis.descVoices = [];\n\t\t\t// available languages are identified with local suffixes (e.g., en-US)\n\t\t\tfor (var i=0; i<voices.length; i++) {\n\t\t\t\t// match only the first 2 characters of the lang code\n\t\t\t\tvoiceLang = voices[i].lang.substring(0,2).toLowerCase();\n\t\t\t\tif (voiceLang === preferredLang && (descLangs.indexOf(voiceLang) !== -1)) {\n\t\t\t\t\t// this voice matches preferredLang \n\t\t\t\t\t// AND there's a matching description track in this language\n\t\t\t\t\t// Add this voice to final array \n\t\t\t\t\tthis.descVoices.push(voices[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!this.descVoices.length) {\n\t\t\t\t// no voices available in the default language(s)\n\t\t\t\t// just use all voices, regardless of language\n\t\t\t\tthis.descVoices = voices;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\tAblePlayer.prototype.getDescriptionLangs = function () {\n\n\t\t// returns an array of languages (from srclang atttributes)\n\t\t// in which there are description tracks\n\t\t// use only first two characters of the lang code\n\t\tvar descLangs = [];\n\t\tif (this.tracks) {\n\t\t\tfor (var i=0; i < this.tracks.length; i++) {\n\t\t\t\tif (this.tracks[i].kind === 'descriptions') {\n\t\t\t\t\tdescLangs.push(this.tracks[i].language.substring(0,2).toLowerCase());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn descLangs;\n\t};\n\n\tAblePlayer.prototype.setDescriptionVoice = function () {\n\n\t\t// set description voice on player init, or when user changes caption language \n\t\t// Voice is determined in the following order of precedence: \n\t\t// 1. User's preferred voice for this language, saved in a cookie\n\t\t// 2. The first available voice in the array of available voices for this browser in this language\n\n\t\tvar cookie, voices, prefDescVoice, descVoice, descLang, prefVoiceFound;\n\t\tcookie = this.getCookie(); \n\t\tif (typeof cookie.voices !== 'undefined') { \t\t\t\n\t\t\tprefDescVoice = this.getPrefDescVoice(); \n\t\t}\n\t\telse { \n\t\t\tprefDescVoice = null; \n\t\t}\n\t\n\t\tthis.getBrowserVoices();\n\t\tthis.rebuildDescPrefsForm();\n\n\t\tif (this.selectedDescriptions) { \n\t\t\tdescLang = this.selectedDescriptions.language;\n\t\t}\n\t\telse if (this.captionLang) { \n\t\t\tdescLang = this.captionLang; \n\t\t}\n\t\telse { \n\t\t\tdescLang = this.lang; \n\t\t}\n\n\t\tif (this.synth) {\n\t\t\tvoices = this.synth.getVoices();\n\t\t\tif (voices.length > 0) {\n\t\t\t\tif (prefDescVoice) { \n\t\t\t\t\t// select the language that matches prefDescVoice, if it's available \n\t\t\t\t\tprefVoiceFound = false; \n\t\t\t\t\tfor (var i=0; i<voices.length; i++) {\n\t\t\t\t\t\t// first, be sure voice is the correct language\n\t\t\t\t\t\tif (voices[i].lang.substring(0,2).toLowerCase() === descLang.substring(0,2).toLowerCase()) {\n\t\t\t\t\t\t\tif (voices[i].name === prefDescVoice) { \n\t\t\t\t\t\t\t\tdescVoice = voices[i].name; \n\t\t\t\t\t\t\t\tprefVoiceFound = true; \n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!prefVoiceFound) { \n\t\t\t\t\t// select the first language that matches the first 2 characters of the lang code\n\t\t\t\t\tfor (var i=0; i<voices.length; i++) {\n\t\t\t\t\t\tif (voices[i].lang.substring(0,2).toLowerCase() === descLang.substring(0,2).toLowerCase()) {\n\t\t\t\t\t\t\tdescVoice = voices[i].name;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// make this the user's current preferred voice\n\t\t\t\tthis.prefDescVoice = descVoice;\n\t\t\t\tthis.prefDescVoiceLang = descLang;\n\t\t\t\t// select this voice in the Description Prefs dialog\n\t\t\t\tif (this.$voiceSelectField) {\n\t\t\t\t\tvar selectedOption = this.$voiceSelectField.find('option[value=\"' + this.prefDescVoice + '\"]');\n\t\t\t\t\tthis.$voiceSelectField.val(this.prefDescVoice);\n\t\t\t\t}\n\t\t\t\tthis.updateCookie('voice'); \n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.swapDescription = function() {\n\n\t\t// swap described and non-described source media, depending on which is playing\n\t\t// this function is only called in two circumstances:\n\t\t// 1. Swapping to described version when initializing player (based on user prefs & availability)\n\t\t// (playerCreated == false)\n\t\t// 2. User is toggling description\n\t\t// (playerCreated == true)\n\n\t\tvar thisObj, i, origSrc, descSrc, srcType, newSource;\n\n\t\tthisObj = this;\n\n\t\t// We are no longer loading the previous media source \n\t\t// Only now, as a new source is requested, is it safe to reset this var \n\t\t// It will be reset to true when media.load() is called \n\t\tthis.loadingMedia = false; \n\n\t\t// get element that has focus at the time swap is initiated \n\t\t// after player is rebuilt, focus will return to that same element \n\t\t// (if it exists)\n\t\tthis.$focusedElement = $(':focus'); \n\n\t\t// get current time of current source, and attempt to start new video at the same time\n\t\t// whether this is possible will be determined after the new media source has loaded \n\t\t// see onMediaNewSourceLoad() \n\t\tif (this.elapsed > 0) { \n\t\t\tthis.swapTime = this.elapsed; \n\t\t}\n\t\telse { \n\t\t\tthis.swapTime = 0; \n\t\t}\n\t\tif (this.duration > 0) { \n\t\t\tthis.prevDuration = this.duration; \t\t\t\t\t\t\t\t\t\t\n\t\t}\n\n\t\t// Capture current playback state, so media can resume after source is swapped \n\t\tif (!this.okToPlay) { \n\t\t\tthis.okToPlay = this.playing; \n\t\t}\n\n\t\tif (this.descOn) {\n\t\t\t// user has requested the described version\n\t\t\tthis.showAlert(this.tt.alertDescribedVersion);\n\t\t}\n\t\telse {\n\t\t\t// user has requested the non-described version\n\t\t\tthis.showAlert(this.tt.alertNonDescribedVersion);\n\t\t}\n\n\t\tif (this.player === 'html5') {\n\n\t\t\tthis.swappingSrc = true;\n\t\t\tthis.paused = true; \n\n\t\t\tif (this.usingDescribedVersion()) {\n\t\t\t\t// the described version is currently playing. Swap to non-described\n\t\t\t\tfor (i=0; i < this.$sources.length; i++) {\n\t\t\t\t\t// for all <source> elements, replace src with data-orig-src\n\t\t\t\t\torigSrc = this.$sources[i].getAttribute('data-orig-src');\n\t\t\t\t\tsrcType = this.$sources[i].getAttribute('type');\n\t\t\t\t\tif (origSrc) {\n\t\t\t\t\t\tthis.$sources[i].setAttribute('src',origSrc);\n\t\t\t\t\t}\n\t\t\t\t}\t\t\t\t\t\t\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// the non-described version is currently playing. Swap to described.\n\t\t\t\tfor (i=0; i < this.$sources.length; i++) {\n\t\t\t\t\t// for all <source> elements, replace src with data-desc-src (if one exists)\n\t\t\t\t\t// then store original source in a new data-orig-src attribute\n\t\t\t\t\torigSrc = this.$sources[i].getAttribute('src');\n\t\t\t\t\tdescSrc = this.$sources[i].getAttribute('data-desc-src');\n\t\t\t\t\tsrcType = this.$sources[i].getAttribute('type');\n\t\t\t\t\tif (descSrc) {\n\t\t\t\t\t\tthis.$sources[i].setAttribute('src',descSrc);\n\t\t\t\t\t\tthis.$sources[i].setAttribute('data-orig-src',origSrc);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.recreatingPlayer) { \n\t\t\t\t// stopgap to prevent multiple firings of recreatePlayer()\n\t\t\t\treturn; \n\t\t\t}\t\n\t\t\tif (this.playerCreated) { \n\t\t\t\t// delete old player, then recreate it with new source & tracks \n\t\t\t\tthis.deletePlayer('swap-desc-html'); \t\t\t\n\t\t\t\tthis.recreatePlayer().then(function() { \n\t\t\t\t\tif (!thisObj.loadingMedia) { \n\t\t\t\t\t\tthisObj.media.load();\n\t\t\t\t\t\tthisObj.loadingMedia = true; \n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse { \n\t\t\t\t// player is in the process of being created\n\t\t\t\t// no need to recreate it \t\n\t\t\t} \n\t\t}\n\t\telse if (this.player === 'youtube') {\n\n\t\t\tif (this.usingDescribedVersion()) {\n\t\t\t\t// the described version is currently playing. Swap to non-described\n\t\t\t\tthis.activeYouTubeId = this.youTubeId;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// the non-described version is currently playing. Swap to described.\n\t\t\t\tthis.activeYouTubeId = this.youTubeDescId;\n\t\t\t}\n\t\t\tif (typeof this.youTubePlayer !== 'undefined') {\n\t\t\t\tthisObj.swappingSrc = true; \n\t\t\t\tif (thisObj.playing) {\n\t\t\t\t\t// loadVideoById() loads and immediately plays the new video at swapTime\n\t\t\t\t\tthisObj.youTubePlayer.loadVideoById(thisObj.activeYouTubeId,thisObj.swapTime);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// cueVideoById() loads the new video and seeks to swapTime, but does not play\n\t\t\t\t\tthisObj.youTubePlayer.cueVideoById(thisObj.activeYouTubeId,thisObj.swapTime);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.playerCreated) { \n\t\t\t\tthis.deletePlayer('swap-desc-youtube'); \t\t\t\t\n\t\t\t}\n\t\t\t// player needs to be recreated with new source \n\t\t\tif (this.recreatingPlayer) { \n\t\t\t\t// stopgap to prevent multiple firings of recreatePlayer()\n\t\t\t\treturn; \n\t\t\t}\t\n\t\t\tthis.recreatePlayer().then(function() { \n\t\t\t\t// nothing to do here \n\t\t\t\t// next steps occur when youtube onReady event fires \n\t\t\t\t// see youtube.js > finalizeYoutubeInit() \n\t\t\t});\t\t\t\t\n\t\t}\n\t\telse if (this.player === 'vimeo') {\n\t\t\tif (this.usingDescribedVersion()) {\n\t\t\t\t// the described version is currently playing. Swap to non-described\n\t\t\t\tthis.activeVimeoId = this.vimeoId;\n\t\t\t\tthis.showAlert(this.tt.alertNonDescribedVersion);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// the non-described version is currently playing. Swap to described.\n\t\t\t\tthis.activeVimeoId = this.vimeoDescId;\n\t\t\t\tthis.showAlert(this.tt.alertDescribedVersion);\n\t\t\t}\n\t\t\tif (this.playerCreated) { \n\t\t\t\tthis.deletePlayer('swap-desc-vimeo'); \t\t\t\t\n\t\t\t}\n\t\t\t// player needs to be recreated with new source \n\t\t\tif (this.recreatingPlayer) { \n\t\t\t\t// stopgap to prevent multiple firings of recreatePlayer()\n\t\t\t\treturn; \n\t\t\t}\t\n\t\t\tthis.recreatePlayer().then(function() { \n\t\t\t\t// load the new video source\n\t\t\t\tthisObj.vimeoPlayer.loadVideo(thisObj.activeVimeoId).then(function() {\n\t\t\t\t\tif (thisObj.playing) {\n\t\t\t\t\t\t// video was playing when user requested an alternative version\n\t\t\t\t\t\t// seek to swapTime and continue playback (playback happens automatically)\n\t\t\t\t\t\tthisObj.vimeoPlayer.setCurrentTime(thisObj.swapTime);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Vimeo autostarts immediately after video loads\n\t\t\t\t\t\t// The \"Described\" button should not trigger playback, so stop this before the user notices.\n\t\t\t\t\t\tthisObj.vimeoPlayer.pause();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t};\n\n\tAblePlayer.prototype.showDescription = function(now) {\n\n\t\tif (!this.hasClosedDesc || this.swappingSrc || !this.descOn || this.descMethod === 'video') {\t\t\t\n\t\t\treturn;\n\t\t}\n\n\t\tvar thisObj, i, cues, d, thisDescription, descText, msg;\n\t\tthisObj = this;\n\n\t\tvar flattenComponentForDescription = function (component) {\n\t\t\tvar result = [];\n\t\t\tif (component.type === 'string') {\n\t\t\t\tresult.push(component.value);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (var i = 0; i < component.children.length; i++) {\n\t\t\t\t\tresult.push(flattenComponentForDescription(component.children[i]));\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result.join('');\n\t\t};\n\n\t\tif (this.selectedDescriptions) {\n\t\t\tcues = this.selectedDescriptions.cues;\n\t\t}\n\t\telse if (this.descriptions.length >= 1) {\n\t\t\tcues = this.descriptions[0].cues;\n\t\t}\n\t\telse {\n\t\t\tcues = [];\n\t\t}\n\t\tfor (d = 0; d < cues.length; d++) {\n\t\t\tif ((cues[d].start <= now) && (cues[d].end > now)) {\n\t\t\t\tthisDescription = d;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (typeof thisDescription !== 'undefined') {\n\t\t\tif (this.currentDescription !== thisDescription) {\n\t\t\t\t// temporarily remove aria-live from $status in order to prevent description from being interrupted\n\t\t\t\tthis.$status.removeAttr('aria-live');\n\t\t\t\tdescText = flattenComponentForDescription(cues[thisDescription].components);\n\t\t\t\tif (this.descReader === 'screenreader') { \t\t\t\t\t\n\t\t\t\t\t// load the new description into the container div for screen readers to read\n\t\t\t\t\tthis.$descDiv.html(descText);\n\t\t\t\t}\n\t\t\t\telse if (this.speechEnabled) { \n\t\t\t\t\t// use browser's built-in speech synthesis\n\t\t\t\t\tthis.announceDescriptionText('description',descText);\n\t\t\t\t\tif (this.prefDescVisible) {\n\t\t\t\t\t\t// write description to the screen for sighted users\n\t\t\t\t\t\t// but remove ARIA attributes since it isn't intended to be read by screen readers\n\t\t\t\t\t\tthis.$descDiv.html(descText).removeAttr('aria-live aria-atomic');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// browser does not support speech synthesis\n\t\t\t\t\t// load the new description into the container div for screen readers to read\n\t\t\t\t\tthis.$descDiv.html(descText);\n\t\t\t\t}\n\t\t\t\tif (this.prefDescPause && this.descMethod === 'text') {\n\t\t\t\t\tthis.pauseMedia();\n\t\t\t\t\tthis.pausedForDescription = true;\n\t\t\t\t}\n\t\t\t\tthis.currentDescription = thisDescription;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.$descDiv.html('');\n\t\t\tthis.currentDescription = -1;\n\t\t\t// restore aria-live to $status\n\t\t\tthis.$status.attr('aria-live','polite');\n\t\t}\n\t};\n\n\tAblePlayer.prototype.syncSpeechToPlaybackRate = function(rate) { \n\n\t\t// called when user changed playback rate \n\t\t// adjust rate of audio description to match \n\n\t\tvar speechRate; \n\n\t\tif (rate === 0.5) { \n\t\t\tspeechRate = 0.7; // option 1 in prefs menu \n\t\t}\n\t\telse if (rate === 0.75) { \n\t\t\tspeechRate =  0.8; // option 2 in prefs menu \n\t\t}\n\t\telse if (rate === 1.0) { \t\t\n\t\t\tspeechRate =  1; // option 4 in prefs menu (normal speech, default)\n\t\t}\n\t\telse if (rate === 1.25) { \n\t\t\tspeechRate =  1.1; // option 5 in prefs menu\n\t\t}\n\t\telse if (rate === 1.5) { \n\t\t\tspeechRate =  1.2; // option 6 in prefs menu \n\t\t}\n\t\telse if (rate === 1.75) { \n\t\t\tspeechRate =  1.5; // option 7 in prefs menu \n\t\t}\n\t\telse if (rate === 2.0) { \n\t\t\tspeechRate =  2; // option 8 in prefs menu (fast)\n\t\t}\n\t\telse if (rate === 2.25) { \n\t\t\tspeechRate =  2.5; // option 9 in prefs menu (very fast)\n\t\t}\n\t\telse if (rate >= 2.5) { \n\t\t\tspeechRate =  3; // option 10 in prefs menu (super fast) \n\t\t}\n\t\tthis.prefDescRate = speechRate;\n\t}; \n\n\tAblePlayer.prototype.announceDescriptionText = function(context, text) {\n\n\t\t// this function announces description text using speech synthesis\n\t\t// it's only called if already determined that browser supports speech synthesis\n\t\t// context is either:\n\t\t// 'description' - actual description text extracted from WebVTT file\n\t\t// 'sample' - called when user changes a setting in Description Prefs dialog\n\n\t\tvar thisObj, voiceName, i, voice, pitch, rate, volume, utterance,\n\t\t\ttimeElapsed, secondsElapsed;\n\n\t\tthisObj = this;\n\n\t\t// As of Feb 2021,\n\t\t// 1. In some browsers (e.g., Chrome) window.speechSynthesis.getVoices()\n\t\t//  returns 0 voices unless the request is triggered with a user click\n\t\t//  Therefore, description may have failed to initialize when the page loaded\n\t\t//  This function cannot have been called without a mouse click.\n\t\t//  Therefore, this is a good time to check that, and try again if needed\n\t\t// 2. In some browsers, the window.speechSynthesis.speaking property fails to reset,\n\t\t//  and onend event is never fired. This prevents new speech from being spoken.\n\t\t//  window.speechSynthesis.cancel() also fails, so it's impossible to recover.\n\t\t//  This only seems to happen with some voices.\n\t\t//  Typically the first voice in the getVoices() array (index 0) is realiable\n\t\t//  When speech synthesis gets wonky, this is a deep problem that impacts all browsers\n\t\t//  and typically requires a computer reboot to make right again.\n\t\t//  This has been observed frequently in macOS Big Sur, but also in Windows 10\n\t\t//  To ignore user's voice preferences and always use the first voice, set the following var to true\n\t\t//\tThis is for testing only; not recommended for production\n\t\t// \tunless the voice select field is also removed from the Prefs dialog\n\t\tvar useFirstVoice = false;\n\t\n\t\tif (!this.speechEnabled) {\n\t\t\t// voices array failed to load the first time. Try again\n\t\t\tthis.initSpeech('desc');\n\t\t}\n\n\t\tif (context === 'sample') {\n\t\t\t// get settings from form\n\t\t\tvoiceName = $('#' + this.mediaId + '_prefDescVoice').val();\n\t\t\tpitch = $('#' + this.mediaId + '_prefDescPitch').val();\n\t\t\trate = $('#' + this.mediaId + '_prefDescRate').val();\n\t\t\tvolume = $('#' + this.mediaId + '_prefDescVolume').val();\n\t\t}\n\t\telse {\n\t\t\t// get settings from global prefs\n\t\t\tvoiceName = this.prefDescVoice;\n\t\t\tpitch = this.prefDescPitch;\n\t\t\trate = this.prefDescRate;\n\t\t\tvolume = this.prefDescVolume;\n\t\t}\n\n\t\t// get the voice associated with the user's chosen voice name\n\t\tif (this.descVoices) {\n\t\t\tif (this.descVoices.length > 0) {\n\t\t\t\tif (useFirstVoice) {\n\t\t\t\t\tvoice = this.descVoices[0];\n\t\t\t\t}\n\t\t\t\telse if (voiceName) {\n\t\t\t\t\t// get the voice that matches user's preferred voiceName\n\t\t\t\t\tfor (i = 0; i < this.descVoices.length; i++) {\n\t\t\t\t\t\tif (this.descVoices[i].name == voiceName) {\n\t\t\t\t\t\t\tvoice = this.descVoices[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof voice === 'undefined') {\n\t\t\t\t\t// no matching voice was found\n\t\t\t\t\t// use the first voice in the array\n\t\t\t\t\tvoice = this.descVoices[0];\n\t\t\t\t}\n\t\t\t\tutterance = new SpeechSynthesisUtterance();\n\t\t\t\tutterance.voice = voice;\n\t\t\t\tutterance.voiceURI = 'native';\n\t\t\t\tutterance.volume = volume;\n\t\t\t\tutterance.rate = rate;\n\t\t\t\tutterance.pitch = pitch;\n\t\t\t\tutterance.text = text;\n\t\t\t\t// TODO: Consider the best language for the utterance:\n\t\t\t\t// language of the web page? (this.lang)\n\t\t\t\t// language of the WebVTT description track?\n\t\t\t\t// language of the user's chosen voice?\n\t\t\t\t// If there's a mismatch between any of these, the description will likely be unintelligible\n\t\t\t\tutterance.lang = this.lang;\n\t\t\t\tutterance.onstart = function(e) { \n\t\t\t\t\t// utterance has started \n\t\t\t\t};\n\t\t\t\tutterance.onpause = function(e) { \n\t\t\t\t\t// utterance has paused \n\t\t\t\t};\n\t\t\t\tutterance.onend = function(e) {\n\t\t\t\t\t// utterance has ended \n\t\t\t\t\tthis.speakingDescription = false; \n\t\t\t\t\ttimeElapsed = e.elapsedTime; \n\t\t\t\t\t// As of Firefox 95, e.elapsedTime is expressed in seconds \n\t\t\t\t\t// Other browsers (tested in Chrome & Edge) express this in milliseconds \n\t\t\t\t\t// Assume no utterance will require over 100 seconds to express... \n\t\t\t\t\tif (timeElapsed > 100) { \n\t\t\t\t\t\t// time is likely expressed in milliseconds \n\t\t\t\t\t\tsecondsElapsed = (e.elapsedTime/1000).toFixed(2); \n\t\t\t\t\t}\n\t\t\t\t\telse { \n\t\t\t\t\t\t// time is likely already expressed in seconds; just need to round it\n\t\t\t\t\t\tsecondsElapsed = (e.elapsedTime).toFixed(2); \n\t\t\t\t\t}\n\t\t\t\t\tif (this.debug) { \n\t\t\t\t\t\tconsole.log('Finished speaking. That took ' + secondsElapsed + ' seconds.');\n\t\t\t\t\t}\n\t\t\t\t\tif (context === 'description') {\n\t\t\t\t\t\tif (thisObj.prefDescPause) {\n\t\t\t\t\t\t\tif (thisObj.pausedForDescription) {\n\t\t\t\t\t\t\t\tthisObj.playMedia();\n\t\t\t\t\t\t\t\tthis.pausedForDescription = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tutterance.onerror = function(e) {\n\t\t\t\t\t// handle error\n\t\t\t\t\tconsole.log('Web Speech API error',e);\n\t\t\t\t};\n\t\t\t\tif (this.synth.paused) { \n\t\t\t\t\tthis.synth.resume();\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tthis.synth.speak(utterance);\n\t\t\t\tthis.speakingDescription = true; \n\t\t\t}\n\t\t}\n\t};\n\n})(jQuery);\n\n(function ($) {\n\n\tAblePlayer.prototype.isIOS = function(version) {\n\n\t\t// return true if this is IOS\n\t\t// if version is provided check for a particular version\n\n\t\tvar userAgent, iOS;\n\n\t\tuserAgent = navigator.userAgent.toLowerCase();\n\t\tiOS = /ipad|iphone|ipod/.exec(userAgent);\n\t\tif (iOS) {\n\t\t\tif (typeof version !== 'undefined') {\n\t\t\t\tif (userAgent.indexOf('os ' + version) !== -1) {\n\t\t\t\t\t// this is the target version of iOS\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// no version was specified\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// this is not IOS\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.browserSupportsVolume = function() {\n\n\t\t// To test whether the browser supports changing the volume, \n\t\t\t// create a new audio element and try setting the volume to something other than 1. \n\t\t\t// Then, retrieve the current setting to see if it preserved it. \n\n\t\t\t// Unfortunately, this doesn't work in iOS. In 2022, our tests yield the same results as reported here:  \n\t\t\t// https://stackoverflow.com/questions/72861253/how-do-i-detect-if-a-browser-does-not-support-changing-html-audio-volume\n\n\t\t\t// So, unfortunately we have to resort to sniffing for iOS  \n\t\t\t// before testing for support in other browsers \n\t\t\tvar audio, testVolume; \n \n\t\t\tif (this.isIOS()) { \n\t\t\t\treturn false; \n\t\t\t}\n\n\t\t\ttestVolume = 0.9;  // any value between 0.1 and 0.9 \n\t\t\taudio = new Audio();\n      audio.volume = testVolume;\n\t\t\tif (audio.volume === testVolume) { \n\t\t\t\treturn true; \n\t\t\t} \n\t\t\telse { \n\t\t\t\treturn false; \n\t\t\t}\n\t};\n\n\tAblePlayer.prototype.nativeFullscreenSupported = function () {\n\n\t\treturn document.fullscreenEnabled ||\n\t\t\tdocument.webkitFullscreenEnabled ||\n\t\t\tdocument.mozFullscreenEnabled ||\n\t\t\tdocument.msFullscreenEnabled;\n\t};\n\n})(jQuery);\n\n(function ($) {\n\tAblePlayer.prototype.seekTo = function (newTime) {\n\n\t\tvar thisObj = this;\n\n\t\t// define variables to be used for analytics\n\t\t// e.g., to measure the extent to which users seek back and forward\n\t\tthis.seekFromTime = this.media.currentTime;\n\t\tthis.seekToTime = newTime;\n\n\t\tthis.seeking = true;\n\t\tthis.liveUpdatePending = true;\n\n\t\tif (this.speakingDescription) { \t\t\t\n\t\t\tthis.synth.cancel(); \n\t\t}\n\n\t\tif (this.player === 'html5') {\n\t\t\tvar seekable;\n\n\t\t\tthis.startTime = newTime;\n\t\t\t// Check HTML5 media \"seekable\" property to be sure media is seekable to startTime\n\t\t\tseekable = this.media.seekable;\n\t\t\tif (seekable.length > 0 && this.startTime >= seekable.start(0) && this.startTime <= seekable.end(0)) {\n\t\t\t\t// ok to seek to startTime\n\t\t\t\t// canplaythrough will be triggered when seeking is complete\n\t\t\t\t// this.seeking will be set to false at that point\n\t\t\t\tthis.media.currentTime = this.startTime; \n\t\t\t\tthis.seekStatus = 'complete'; \n\t\t\t\tif (this.hasSignLanguage && this.signVideo) {\n\t\t\t\t\t// keep sign languge video in sync\n\t\t\t\t\tthis.signVideo.currentTime = this.startTime;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\t\t\tthis.youTubePlayer.seekTo(newTime,true);\n\t\t\tif (newTime > 0) {\n\t\t\t\tif (typeof this.$posterImg !== 'undefined') {\n\t\t\t\t\tthis.$posterImg.hide();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (this.player === 'vimeo') {\n\t\t\tthis.vimeoPlayer.setCurrentTime(newTime).then(function() {\n\t\t\t\t// seek finished.\n\t\t\t\t// successful completion also fires a 'seeked' event (see event.js)\n\t\t\t\tthisObj.elapsed = newTime;\n\t\t\t\tthisObj.refreshControls('timeline');\n\t\t\t})\n\t\t}\n\t\tthis.refreshControls('timeline');\n\t};\n\n\tAblePlayer.prototype.getMediaTimes = function (duration, elapsed) {\n\n\t\t // Returns an array with keys 'duration' and 'elapsed'\n\t\t // Vars passed to this function come courtesy of select Vimeo events\n\t\t // Use those if they're available.\n\t\t // Otherwise, will need to call the relevant media API\n\t\t // This function should only be called from onMediaUpdateTime()\n\t\t // If duration and elapsed are needed other times, use this.duration and this.elapsed\n\n\t\t// both values are expressed in seconds, and all player APIs are similar:\n\t\t// they return a value that is rounded to the nearest second before playback begins,\n\t\t// then to the nearest thousandth of a second after playback begins\n\t\t// With HTML5 media API, some browsers are more precise (e.g., Firefox rounds to 6 decimal points)\n\t\t// but inconsistent (values with 9 decimal points have been sporadically observed in Safari)\n\t\t// For standardization, values are rounded to 6 decimal points before they're returned\n\n\t\tvar deferred, promise, thisObj, mediaTimes;\n\t\tmediaTimes = {};\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\t\tthisObj = this;\n\t\tif (typeof duration !== 'undefined' && typeof elapsed !== 'undefined') {\n\t\t\tmediaTimes['duration'] = duration;\n\t\t\tmediaTimes['elapsed'] = elapsed;\n\t\t\tdeferred.resolve(mediaTimes);\n\t\t}\n\t\telse {\n\t\t\tthis.getDuration().then(function(duration) {\n\t\t\t\tmediaTimes['duration'] = thisObj.roundDown(duration,6);\n\t\t\t\tthisObj.getElapsed().then(function(elapsed) {\n\t\t\t\t\tmediaTimes['elapsed'] = thisObj.roundDown(elapsed,6);\n\t\t\t\t\tdeferred.resolve(mediaTimes);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.getDuration = function () {\n\n\t\t// returns duration of the current media, expressed in seconds\n\t\t// function is called by getMediaTimes, and return value is sanitized there\n\t\tvar deferred, promise, thisObj;\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\t\tthisObj = this;\n\n\t\tif (this.player === 'vimeo') {\n\t\t\tif (this.vimeoPlayer) {\n\t\t\t\t this.vimeoPlayer.getDuration().then(function(duration) {\n\t\t\t\t\tif (duration === undefined || isNaN(duration) || duration === -1) {\n\t\t\t\t\t\tdeferred.resolve(0);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdeferred.resolve(duration);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse { // vimeoPlayer hasn't been initialized yet.\n\t\t\t\tdeferred.resolve(0);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tvar duration;\n\t\t\tif (this.player === 'html5') {\n\t\t\t\tduration = this.media.duration;\t\t\t\n\t\t\t}\n\t\t\telse if (this.player === 'youtube') {\n\t\t\t\tif (this.youTubePlayerReady) {\n\t\t\t\t\tif (this.duration > 0) { \n\t\t\t\t\t\t// duration was already retrieved while checking for captions\n\t\t\t\t\t\tduration = this.duration; \n\t\t\t\t\t}\n\t\t\t\t\telse { \n\t\t\t\t\t\tduration = this.youTubePlayer.getDuration();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // the YouTube player hasn't initialized yet\n\t\t\t\t\tduration = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (duration === undefined || isNaN(duration) || duration === -1) {\n\t\t\t\tdeferred.resolve(0);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdeferred.resolve(duration);\n\t\t\t}\n\t\t}\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.getElapsed = function () {\n\n\t\t// returns elapsed time of the current media, expressed in seconds\n\t\t// function is called by getMediaTimes, and return value is sanitized there\n\n\t\tvar deferred, promise, thisObj;\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\t\tthisObj = this;\n\n\t\tif (this.player === 'vimeo') {\n\t\t\tif (this.vimeoPlayer) {\n\t\t\t\tthis.vimeoPlayer.getCurrentTime().then(function(elapsed) {\n\t\t\t\t\tif (elapsed === undefined || isNaN(elapsed) || elapsed === -1) {\n\t\t\t\t\t\tdeferred.resolve(0);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdeferred.resolve(elapsed);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse { // vimeoPlayer hasn't been initialized yet.\n\t\t\t\tdeferred.resolve(0);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tvar elapsed;\n\t\t\tif (this.player === 'html5') {\n\t\t\t\telapsed = this.media.currentTime;\n\t\t\t}\n\t\t\telse if (this.player === 'youtube') {\n\t\t\t\tif (this.youTubePlayerReady) {\n\t\t\t\t\telapsed = this.youTubePlayer.getCurrentTime();\n\t\t\t\t}\n\t\t\t\telse { // the YouTube player hasn't initialized yet\n\t\t\t\t\telapsed = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (elapsed === undefined || isNaN(elapsed) || elapsed === -1) {\n\t\t\t\tdeferred.resolve(0);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdeferred.resolve(elapsed);\n\t\t\t}\n\t\t}\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.getPlayerState = function () {\n\n\t\t// Returns one of the following states:\n\t\t//\t'stopped' - Not yet played for the first time, or otherwise reset to unplayed.\n\t\t//\t'ended' - Finished playing.\n\t\t//\t'paused' - Not playing, but not stopped or ended.\n\t\t//\t'buffering' - Momentarily paused to load, but will resume once data is loaded.\n\t\t//\t'playing' - Currently playing.\n\n\t\t// Commented out the following in 3.2.1 - not sure of its intended purpose\n\t\t// It can be useful to know player state even when swapping src\n\t\t// and the overhead is seemingly minimal\n\t\t// TODO - Investigate this further. Delete if it's not needed\n\t\t/*\n\t\tif (this.swappingSrc) {\n\t\t\treturn;\n\t\t}\n\t\t*/\n\t\tvar deferred, promise, thisObj, duration, elapsed;\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\t\tthisObj = this;\n\n\t\tif (this.player === 'html5') {\n\t\t\tif (this.media.ended) {\n\t\t\t\tdeferred.resolve('ended');\n\t\t\t}\n\t\t\telse if (this.media.paused) {\n\t\t\t\tdeferred.resolve('paused');\n\t\t\t}\n\t\t\telse if (this.media.readyState !== 4) {\n\t\t\t\tdeferred.resolve('buffering');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdeferred.resolve('playing');\n\t\t\t}\n\t\t}\n\t\telse if (this.player === 'youtube' && this.youTubePlayerReady) {\n\t\t\tvar state = this.youTubePlayer.getPlayerState();\n\t\t\tif (state === -1 || state === 5) {\n\t\t\t\tdeferred.resolve('stopped');\n\t\t\t}\n\t\t\telse if (state === 0) {\n\t\t\t\tdeferred.resolve('ended');\n\t\t\t}\n\t\t\telse if (state === 1) {\n\t\t\t\tdeferred.resolve('playing');\n\t\t\t}\n\t\t\telse if (state === 2) {\n\t\t\t\tdeferred.resolve('paused');\n\t\t\t}\n\t\t\telse if (state === 3) {\n\t\t\t\tdeferred.resolve('buffering');\n\t\t\t}\n\t\t}\n\t\telse if (this.player === 'vimeo' && this.vimeoPlayer) {\n\t\t\t\t// curiously, Vimeo's API has no getPlaying(), getBuffering(), or getState() methods\n\t\t\t// so maybe if it's neither paused nor ended, it must be playing???\n\t\t\tthis.vimeoPlayer.getPaused().then(function(paused) {\n\t\t\t\tif (paused) {\n\t\t\t\t\tdeferred.resolve('paused');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthisObj.vimeoPlayer.getEnded().then(function(ended) {\n\t\t\t\t\t\tif (ended) {\n\t\t\t\t\t\t\tdeferred.resolve('ended');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tdeferred.resolve('playing');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.isPlaybackRateSupported = function () {\n\n\t\tif (this.player === 'html5') {\n\t\t\tif (this.media.playbackRate) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\t\t\t// Youtube supports varying playback rates per video.\t \n\t\t\t// Only expose controls if more than one playback rate is available.\n\t\t\tif (this.youTubePlayerReady) { \n\t\t\t\tif (this.youTubePlayer.getAvailablePlaybackRates().length > 1) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse { \n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse if (this.player === 'vimeo') {\n\t\t\t// since this takes longer to determine, it was set previously in initVimeoPlayer()\n\t\t\treturn this.vimeoSupportsPlaybackRateChange;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.setPlaybackRate = function (rate) {\n\t\t\n\t\trate = Math.max(0.5, rate);\n\n\t\tif (this.hasClosedDesc && this.descMethod === 'text') { \n\t\t\t// keep speech rate in sync with playback rate even if descOn is false \n\t\t\tthis.syncSpeechToPlaybackRate(rate); \n\t\t}\n\n\t\tif (this.player === 'html5') {\n\t\t\tthis.media.playbackRate = rate;\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\t\t\tthis.youTubePlayer.setPlaybackRate(rate);\n\t\t}\n\t\telse if (this.player === 'vimeo') {\n\t\t\tthis.vimeoPlayer.setPlaybackRate(rate);\n\t\t}\n\t\tif (this.hasSignLanguage && this.signVideo) {\n\t\t\tthis.signVideo.playbackRate = rate;\n\t\t}\n\t\tthis.playbackRate = rate;\n\t\tthis.$speed.text(this.tt.speed + ': ' + rate.toFixed(2).toString() + 'x');\n\t};\t\n\n\tAblePlayer.prototype.getPlaybackRate = function () {\n\n\t\tif (this.player === 'html5') {\n\t\t\treturn this.media.playbackRate;\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\t\t\tif (this.youTubePlayerReady) {\n\t\t\t\treturn this.youTubePlayer.getPlaybackRate();\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.isPaused = function () {\n\n\t\t // Note there are three player states that count as paused in this sense,\n\t\t// and one of them is named 'paused'.\n\t\t// A better name would be 'isCurrentlyNotPlayingOrBuffering'\n\n\t\tvar state;\n\n\t\tif (this.player === 'vimeo') {\n\t\t\t// just rely on value of this.playing\n\t\t\tif (this.playing) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.getPlayerState().then(function(state) {\n\t\t\t\t// if any of the following is true, consider the media 'paused'\n\t\t\t\treturn state === 'paused' || state === 'stopped' || state === 'ended';\n\t\t\t});\n\t\t}\n\t};\n\n\tAblePlayer.prototype.pauseMedia = function () {\n\n\t\tvar thisObj = this;\n\n\t\tif (this.player === 'html5') {\n\t\t\tthis.media.pause(true);\n\t\t\tif (this.hasSignLanguage && this.signVideo) {\n\t\t\t\tthis.signVideo.pause(true);\n\t\t\t}\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\t\t\tthis.youTubePlayer.pauseVideo();\n\t\t}\n\t\telse if (this.player === 'vimeo') {\n\t\t\tthis.vimeoPlayer.pause();\n\t\t}\n\t};\n\n\tAblePlayer.prototype.playMedia = function () {\n\n\t\tvar thisObj = this;\n\n\t\tif (this.player === 'html5') {\n\t\t\tthis.media.play(true);\n\t\t\tif (this.hasSignLanguage && this.signVideo) {\n\t\t\t\tthis.signVideo.play(true);\n\t\t\t}\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\n\t\t\tthis.youTubePlayer.playVideo();\n\t\t\tif (typeof this.$posterImg !== 'undefined') {\n\t\t\t\tthis.$posterImg.hide();\n\t\t\t}\n\t\t\tthis.stoppingYouTube = false;\n\t\t}\n\t\telse if (this.player === 'vimeo') {\n\t\t\t this.vimeoPlayer.play();\n\t\t}\n\t\tthis.startedPlaying = true;\n\t\tif (this.hideControls) {\n\t\t\t// wait briefly after playback begins, then hide controls\n\t\t\tthis.hidingControls = true;\n\t\t\tthis.invokeHideControlsTimeout();\n\t\t}\n\t};\n\n\tAblePlayer.prototype.fadeControls = function(direction) {\n\n\t\t// Visibly fade controls without hiding them from screen reader users\n\n\t\t// direction is either 'out' or 'in'\n\n\t\t// TODO: This still needs work.\n\t\t// After the player fades, it's replaced by an empty space\n\t\t// Would be better if the video and captions expanded to fill the void\n\t\t// Attempted to fade out to 0 opacity, then move the playerDiv offscreen\n\t\t// and expand the mediaContainer to fill the vacated space\n\t\t// However, my attempts to do this have been choppy and buggy\n\t\t// Code is preserved below and commented out\n\n\t\tvar thisObj, mediaHeight, playerHeight, newMediaHeight;\n\t\tvar thisObj = this;\n\n\t\tif (direction == 'out') {\n\t\t\t// get the original height of two key components:\n\t\t\tmediaHeight = this.$mediaContainer.height();\n\t\t\tplayerHeight = this.$playerDiv.height();\n\t\t\tnewMediaHeight = mediaHeight + playerHeight;\n\n\t\t\t// fade slowly to transparency\n\t\t\tthis.$playerDiv.fadeTo(2000,0,function() {\n\t\t\t\t/*\n\t\t\t\t// when finished, position playerDiv offscreen\n\t\t\t\t// thisObj.$playerDiv.addClass('able-offscreen');\n\t\t\t\t// Expand the height of mediaContainer to fill the void (needs work)\n\t\t\t\tthisObj.$mediaContainer.animate({\n\t\t\t\t\theight: newMediaHeight\n\t\t\t\t},500);\n\t\t\t\t*/\n\t\t\t});\n\t\t}\n\t\telse if (direction == 'in') {\n\t\t\t// restore captionsContainer to its original height (needs work)\n\t\t\t// this.$mediaContainer.removeAttr('style');\n\t\t\t// fade relatively quickly back to its original position with full opacity\n\t\t\t// this.$playerDiv.removeClass('able-offscreen').fadeTo(100,1);\n\t\t\tthis.$playerDiv.fadeTo(100,1);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.invokeHideControlsTimeout = function () {\n\n\t\t// invoke timeout for waiting a few seconds after a mouse move or key down\n\t\t// before hiding controls again\n\t\tvar thisObj = this;\n\t\tthis.hideControlsTimeout = window.setTimeout(function() {\n\t\t\tif (typeof thisObj.playing !== 'undefined' && thisObj.playing === true && thisObj.hideControls) {\n\t\t\t\tthisObj.fadeControls('out');\n\t\t\t\tthisObj.controlsHidden = true;\n\t\t\t}\n\t\t},5000);\n\t\tthis.hideControlsTimeoutStatus = 'active';\n\t};\n\n\tAblePlayer.prototype.refreshControls = function(context, duration, elapsed) {\n\n\t\t// context is one of the following:\n\t\t// 'init' - initial build (or subsequent change that requires full rebuild)\n\t\t// 'timeline' - a change may effect time-related controls\n\t\t// 'captions' - a change may effect caption-related controls\n\t\t// 'descriptions' - a change may effect description-related controls\n\t\t// 'transcript' - a change may effect the transcript window or button\n\t\t// 'fullscreen' - a change has been triggered by full screen toggle\n\t\t// 'playpause' - a change triggered by either a 'play' or 'pause' event\n\n\t\t// NOTE: context is not currently supported.\n\t\t// The steps in this function have too many complex interdependencies\n\t\t// The gains in efficiency are offset by the possibility of introducing bugs\n\t\t// For now, executing everything\n\t\tcontext = 'init';\n\n\t\t// duration and elapsed are passed from callback functions of Vimeo API events\n\t\t// duration is expressed as sss.xxx\n\t\t// elapsed is expressed as sss.xxx\n\n\t\tvar thisObj, duration, elapsed, lastChapterIndex, displayElapsed,\n\t\t\tupdateLive, textByState, timestamp, widthUsed,\n\t\t\tleftControls, rightControls, seekbarWidth, seekbarSpacer, captionsCount,\n\t\t\tbuffered, newTop, statusBarHeight, speedHeight, statusBarWidthBreakpoint,\n\t\t\tnewSvgData;\n\n\t\tthisObj = this;\n\t\tif (this.swappingSrc) {\n\t\t\tif (this.playing) {\n\t\t\t\t// wait until new source has loaded before refreshing controls\n\t\t\t\t// can't wait if player is NOT playing because some critical events\n\t\t\t\t// won't fire until playback of new media starts\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (context === 'timeline' || context === 'init') {\n\t\t\t// all timeline-related functionality requires both duration and elapsed\n\t\t\tif (typeof this.duration === 'undefined') {\n\t\t\t \t// wait until duration is known before proceeding with refresh\n\t\t\t \treturn;\n\t\t\t}\n\t\t\tif (this.useChapterTimes) {\n\t\t\t\tthis.chapterDuration = this.getChapterDuration();\n\t\t\t\tthis.chapterElapsed = this.getChapterElapsed();\n\t\t\t}\n\n\t\t\tif (this.useFixedSeekInterval === false && this.seekIntervalCalculated === false && this.duration > 0) {\n\t\t\t\t// couldn't calculate seekInterval previously; try again.\n\t\t\t\tthis.setSeekInterval();\n\t\t\t}\n\n\t\t\tif (this.seekBar) {\n\t\t\t\tif (this.useChapterTimes) {\n\t\t\t\t\tlastChapterIndex = this.selectedChapters.cues.length-1;\n\t\t\t\t\tif (this.selectedChapters.cues[lastChapterIndex] == this.currentChapter) {\n\t\t\t\t\t\t// this is the last chapter\n\t\t\t\t\t\tif (this.currentChapter.end !== this.duration) {\n\t\t\t\t\t\t\t// chapter ends before or after video ends\n\t\t\t\t\t\t\t// need to adjust seekbar duration to match video end\n\t\t\t\t\t\t\tthis.seekBar.setDuration(this.duration - this.currentChapter.start);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthis.seekBar.setDuration(this.chapterDuration);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// this is not the last chapter\n\t\t\t\t\t\tthis.seekBar.setDuration(this.chapterDuration);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (!(this.duration === undefined || isNaN(this.duration) || this.duration === -1)) {\n\t\t\t\t\t\tthis.seekBar.setDuration(this.duration);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!(this.seekBar.tracking)) {\n\t\t\t\t\t// Only update the aria live region if we have an update pending\n\t\t\t\t\t// (from a seek button control) or if the seekBar has focus.\n\t\t\t\t\t// We use document.activeElement instead of $(':focus') due to a strange bug:\n\t\t\t\t\t// \tWhen the seekHead element is focused, .is(':focus') is failing and $(':focus') is returning an undefined element.\n\t\t\t\t\tupdateLive = this.liveUpdatePending || this.seekBar.seekHead.is($(document.activeElement));\n\t\t\t\t\tthis.liveUpdatePending = false;\n\t\t\t\t\tif (this.useChapterTimes) {\n\t\t\t\t\t\tthis.seekBar.setPosition(this.chapterElapsed, updateLive);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.seekBar.setPosition(this.elapsed, updateLive);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// When seeking, display the seek bar time instead of the actual elapsed time.\n\t\t\t\tif (this.seekBar.tracking) {\n\t\t\t\t\tdisplayElapsed = this.seekBar.lastTrackPosition;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (this.useChapterTimes) {\n\t\t\t\t\t\tdisplayElapsed = this.chapterElapsed;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdisplayElapsed = this.elapsed;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// update elapsed & duration\n\t\t\tif (typeof this.$durationContainer !== 'undefined') {\n\t\t\t\tif (this.useChapterTimes) {\n\t\t\t\t\tthis.$durationContainer.text(' / ' + this.formatSecondsAsColonTime(this.chapterDuration));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.$durationContainer.text(' / ' + this.formatSecondsAsColonTime(this.duration));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof this.$elapsedTimeContainer !== 'undefined') {\n\t\t\t\tthis.$elapsedTimeContainer.text(this.formatSecondsAsColonTime(displayElapsed));\n\t\t\t}\n\n\t\t\tif (this.skin === 'legacy') {\n\t\t\t\t// Update seekbar width.\n\t\t\t\t// To do this, we need to calculate the width of all buttons surrounding it.\n\t\t\t\tif (this.seekBar) {\n\t\t\t\t\twidthUsed = 0;\n\t\t\t\t\tleftControls = this.seekBar.wrapperDiv.parent().prev('div.able-left-controls');\n\t\t\t\t\trightControls = leftControls.next('div.able-right-controls');\n\t\t\t\t\tleftControls.children().each(function () {\n\t\t\t\t\t\tif ($(this).attr('role')=='button') {\n\t\t\t\t\t\t\twidthUsed += $(this).outerWidth(true); // true = include margin\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\trightControls.children().each(function () {\n\t\t\t\t\t\tif ($(this).attr('role')=='button') {\n\t\t\t\t\t\t\twidthUsed += $(this).outerWidth(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (this.fullscreen) {\n\t\t\t\t\t\tseekbarWidth = $(window).width() - widthUsed;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// seekbar is wide enough to fill the remaining space\n\t\t\t\t\t\t// include a 5px buffer to account for minor browser differences  \n\t\t\t\t\t\tseekbarWidth = this.$ableWrapper.width() - widthUsed - 5;\n\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t\t// Sometimes some minor fluctuations based on browser weirdness, so set a threshold.\n\t\t\t\t\tif (Math.abs(seekbarWidth - this.seekBar.getWidth()) > 5) {\n\t\t\t\t\t\tthis.seekBar.setWidth(seekbarWidth);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Update buffering progress.\n\t\t\t// TODO: Currently only using the first HTML5 buffered interval,\n\t\t\t// but this fails sometimes when buffering is split into two or more intervals.\n\t\t\tif (this.player === 'html5') {\n\t\t\t\tif (this.media.buffered.length > 0) {\n\t\t\t\t\tbuffered = this.media.buffered.end(0);\n\t\t\t\t\tif (this.useChapterTimes) {\n\t\t\t\t\t\tif (buffered > this.chapterDuration) {\n\t\t\t\t\t\t\tbuffered = this.chapterDuration;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.seekBar) {\n\t\t\t\t\t\t\tthis.seekBar.setBuffered(buffered / this.chapterDuration);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (this.seekBar) {\n\t\t\t\t\t\t\tif (!isNaN(buffered)) {\n\t\t\t\t\t\t\t\tthis.seekBar.setBuffered(buffered / duration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.player === 'youtube') {\n\t\t\t\tif (this.seekBar) {\n\t\t\t\t\tif (this.youTubePlayerReady) {\n\t\t\t\t\t\tthis.seekBar.setBuffered(this.youTubePlayer.getVideoLoadedFraction());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.player === 'vimeo') {\n\t\t\t\t// TODO: Add support for Vimeo buffering update\n\t\t\t}\n\t\t} // end if context == 'timeline' or 'init'\n\n\t\tif (context === 'descriptions' || context == 'init'){\n\n\t\t\tif (this.$descButton) {\n\t\t\t\tif (this.descOn) {\n\t\t\t\t\tthis.$descButton.removeClass('buttonOff').attr('aria-label',this.tt.turnOffDescriptions);\n\t\t\t\t\tthis.$descButton.find('span.able-clipped').text(this.tt.turnOffDescriptions);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.$descButton.addClass('buttonOff').attr('aria-label',this.tt.turnOnDescriptions);\n\t\t\t\t\tthis.$descButton.find('span.able-clipped').text(this.tt.turnOnDescriptions);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (context === 'captions' || context == 'init'){\n\n\t\t\tif (this.$ccButton) {\n\n\t\t\t\tcaptionsCount = this.captions.length;\n\n\t\t\t\t// Button has a different title depending on the number of captions.\n\t\t\t\t// If only one caption track, this is \"Show captions\" and \"Hide captions\"\n\t\t\t\t// Otherwise, it is just always \"Captions\"\n\t\t\t\tif (!this.captionsOn) {\n\t\t\t\t\tthis.$ccButton.addClass('buttonOff');\n\t\t\t\t\tthis.$ccButton.attr('aria-pressed', 'false')\n\t\t\t\t\tif (captionsCount === 1) {\n\t\t\t\t\t\tthis.$ccButton.attr('aria-label',this.tt.showCaptions);\n\t\t\t\t\t\tthis.$ccButton.find('span.able-clipped').text(this.tt.showCaptions);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.$ccButton.removeClass('buttonOff');\n\t\t\t\t\tthis.$ccButton.attr('aria-pressed', 'true')\n\t\t\t\t\tif (captionsCount === 1) {\n\t\t\t\t\t\tthis.$ccButton.attr('aria-label',this.tt.hideCaptions);\n\t\t\t\t\t\tthis.$ccButton.find('span.able-clipped').text(this.tt.hideCaptions);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (captionsCount > 1) {\n\t\t\t\t\tthis.$ccButton.attr({\n\t\t\t\t\t\t'aria-label': this.tt.captions,\n\t\t\t\t\t\t'aria-haspopup': 'true',\n\t\t\t\t\t\t'aria-controls': this.mediaId + '-captions-menu'\n\t\t\t\t\t});\n\t\t\t\t\tthis.$ccButton.find('span.able-clipped').text(this.tt.captions);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (context === 'fullscreen' || context == 'init'){\n\t\t\tif (this.$fullscreenButton) {\n\t\t\t\tif (!this.fullscreen) {\n\t\t\t\t\tthis.$fullscreenButton.attr('aria-label', this.tt.enterFullscreen);\n\t\t\t\t\tif (this.iconType === 'font') {\n\t\t\t\t\t\tthis.$fullscreenButton.find('span').first().removeClass('icon-fullscreen-collapse').addClass('icon-fullscreen-expand');\n\t\t\t\t\t\tthis.$fullscreenButton.find('span.able-clipped').text(this.tt.enterFullscreen);\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.iconType === 'svg') {\n\t\t\t\t\t\tnewSvgData = this.getSvgData('fullscreen-expand');\n\t\t\t\t\t\tthis.$fullscreenButton.find('svg').attr('viewBox',newSvgData[0]);\n\t\t\t\t\t\tthis.$fullscreenButton.find('path').attr('d',newSvgData[1]);\n\t\t\t\t\t\tthis.$fullscreenButton.find('span.able-clipped').text(this.tt.enterFullscreen);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.$fullscreenButton.find('img').attr('src',this.fullscreenExpandButtonImg);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.$fullscreenButton.attr('aria-label',this.tt.exitFullscreen);\n\t\t\t\t\tif (this.iconType === 'font') {\n\t\t\t\t\t\tthis.$fullscreenButton.find('span').first().removeClass('icon-fullscreen-expand').addClass('icon-fullscreen-collapse');\n\t\t\t\t\t\tthis.$fullscreenButton.find('span.able-clipped').text(this.tt.exitFullscreen);\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.iconType === 'svg') {\n\t\t\t\t\t\tnewSvgData = this.getSvgData('fullscreen-collapse');\n\t\t\t\t\t\tthis.$fullscreenButton.find('svg').attr('viewBox',newSvgData[0]);\n\t\t\t\t\t\tthis.$fullscreenButton.find('path').attr('d',newSvgData[1]);\n\t\t\t\t\t\tthis.$fullscreenButton.find('span.able-clipped').text(this.tt.exitFullscreen);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.$fullscreenButton.find('img').attr('src',this.fullscreenCollapseButtonImg);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (context === 'playpause' || context == 'init'){\n\t\t\tif (typeof this.$bigPlayButton !== 'undefined' && typeof this.seekBar !== 'undefined') {\n\t\t\t\t// Choose show/hide for big play button and adjust position.\n\t\t\t\tif (this.paused && !this.seekBar.tracking) {\n\t\t\t\t\tif (!this.hideBigPlayButton) {\n\t\t\t\t\t\tthis.$bigPlayButton.show();\n\t\t\t\t\t\tthis.$bigPlayButton.attr('aria-hidden', 'false');\n\n\t\t\t\t\t}\n\t\t\t\t\tif (this.fullscreen) {\n\t\t\t\t\t\tthis.$bigPlayButton.width($(window).width());\n\t\t\t\t\t\tthis.$bigPlayButton.height($(window).height());\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.$bigPlayButton.width(this.$mediaContainer.width());\n\t\t\t\t\t\tthis.$bigPlayButton.height(this.$mediaContainer.height());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.$bigPlayButton.hide();\n\t\t\t\t\tthis.$bigPlayButton.attr('aria-hidden', 'true');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (context === 'transcript' || context == 'init'){\n\n\t\t\tif (this.transcriptType) {\n\t\t\t\t// Sync checkbox and autoScrollTranscript with user preference\n\t\t\t\tif (this.prefAutoScrollTranscript === 1) {\n\t\t\t\t\tthis.autoScrollTranscript = true;\n\t\t\t\t\tthis.$autoScrollTranscriptCheckbox.prop('checked',true);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.autoScrollTranscript = false;\n\t\t\t\t\tthis.$autoScrollTranscriptCheckbox.prop('checked',false);\n\t\t\t\t}\n\n\t\t\t\t// If transcript locked, scroll transcript to current highlight location.\n\t\t\t\tif (this.autoScrollTranscript && this.currentHighlight) {\n\t\t\t\t\tnewTop = Math.floor(this.$transcriptDiv.scrollTop() +\n\t\t\t\t\t\t$(this.currentHighlight).position().top -\n\t\t\t\t\t\t(this.$transcriptDiv.height() / 2) +\n\t\t\t\t\t\t($(this.currentHighlight).height() / 2));\n\t\t\t\t\tif (newTop !== Math.floor(this.$transcriptDiv.scrollTop())) {\n\t\t\t\t\t\t// Set a flag to ignore the coming scroll event.\n\t\t\t\t\t\t// there's no other way I know of to differentiate programmatic and user-initiated scroll events.\n\t\t\t\t\t\tthis.scrollingTranscript = true;\n\t\t\t\t\t\t// only scroll once after moving a highlight\n\t\t\t\t\t\tif (this.movingHighlight) {\n\t\t\t\t\t\t\tthis.$transcriptDiv.scrollTop(newTop);\n\t\t\t\t\t\t\t\t\t\t\tthis.movingHighlight = false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (context === 'init') {\n\n\t\t\tif (this.$chaptersButton) {\n\t\t\t\tthis.$chaptersButton.attr({\n\t\t\t\t\t'aria-label': this.tt.chapters,\n\t\t\t\t\t'aria-haspopup': 'true',\n\t\t\t\t\t'aria-controls': this.mediaId + '-chapters-menu'\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (context === 'timeline' || context === 'playpause' || context === 'init') {\n\n\t\t\t// update status\n\t\t\ttextByState = {\n\t\t\t\t'stopped': this.tt.statusStopped,\n\t\t\t\t'paused': this.tt.statusPaused,\n\t\t\t\t'playing': this.tt.statusPlaying,\n\t\t\t\t'buffering': this.tt.statusBuffering,\n\t\t\t\t'ended': this.tt.statusEnd\n\t\t\t};\n\n\t\t\tif (this.stoppingYouTube) {\n\t\t\t\t// stoppingYouTube is true temporarily while video is paused and seeking to 0\n\t\t\t\t// See notes in handleRestart()\n\t\t\t\t// this.stoppingYouTube will be reset when seek to 0 is finished (in event.js > onMediaUpdateTime())\n\t\t\t\tif (this.$status.text() !== this.tt.statusStopped) {\n\t\t\t\t\tthis.$status.text(this.tt.statusStopped);\n\t\t\t\t}\n\t\t\t\tif (this.$playpauseButton.find('span').first().hasClass('icon-pause')) {\n\t\t\t\t\tif (this.iconType === 'font') {\n\t\t\t\t\t\tthis.$playpauseButton.find('span').first().removeClass('icon-pause').addClass('icon-play');\n\t\t\t\t\t\tthis.$playpauseButton.find('span.able-clipped').text(this.tt.play);\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.iconType === 'svg') {\n\t\t\t\t\t\tnewSvgData = this.getSvgData('play');\n\t\t\t\t\t\tthis.$playpauseButton.find('svg').attr('viewBox',newSvgData[0]);\n\t\t\t\t\t\tthis.$playpauseButton.find('path').attr('d',newSvgData[1]);\n\t\t\t\t\t\tthis.$playpauseButton.find('span.able-clipped').text(this.tt.play);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.$playpauseButton.find('img').attr('src',this.playButtonImg);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (typeof this.$status !== 'undefined' && typeof this.seekBar !== 'undefined') {\n\t\t\t\t\t// Update the text only if it's changed since it has role=\"alert\";\n\t\t\t\t\t// also don't update while tracking, since this may Pause/Play the player but we don't want to send a Pause/Play update.\n\t\t\t\t\tthis.getPlayerState().then(function(currentState) {\n\t\t\t\t\t\tif (thisObj.$status.text() !== textByState[currentState] && !thisObj.seekBar.tracking) {\n\t\t\t\t\t\t\t// Debounce updates; only update after status has stayed steadily different for a while\n\t\t\t\t\t\t\t// \"A while\" is defined differently depending on context\n\t\t\t\t\t\t\tif (thisObj.swappingSrc) {\n\t\t\t\t\t\t\t\t// this is where most of the chatter occurs (e.g., playing, paused, buffering, playing),\n\t\t\t\t\t\t\t\t// so set a longer wait time before writing a status message\n\t\t\t\t\t\t\t\tif (!thisObj.debouncingStatus) {\n\t\t\t\t\t\t\t\t\tthisObj.statusMessageThreshold = 2000; // in ms (2 seconds)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t// for all other contexts (e.g., users clicks Play/Pause)\n\t\t\t\t\t\t\t\t// user should receive more rapid feedback\n\t\t\t\t\t\t\t\tif (!thisObj.debouncingStatus) {\n\t\t\t\t\t\t\t\t\tthisObj.statusMessageThreshold = 250; // in ms\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttimestamp = (new Date()).getTime();\n\t\t\t\t\t\t\tif (!thisObj.statusDebounceStart) {\n\t\t\t\t\t\t\t\tthisObj.statusDebounceStart = timestamp;\n\t\t\t\t\t\t\t\t// Call refreshControls() again after allotted time has passed\n\t\t\t\t\t\t\t\tthisObj.debouncingStatus = true;\n\t\t\t\t\t\t\t\tthisObj.statusTimeout = setTimeout(function () {\n\t\t\t\t\t\t\t\t\tthisObj.debouncingStatus = false;\n\t\t\t\t\t\t\t\t\tthisObj.refreshControls(context);\n\t\t\t\t\t\t\t\t}, thisObj.statusMessageThreshold);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ((timestamp - thisObj.statusDebounceStart) > thisObj.statusMessageThreshold) {\n\t\t\t\t\t\t\t\tthisObj.$status.text(textByState[currentState]);\n\t\t\t\t\t\t\t\tthisObj.statusDebounceStart = null;\n\t\t\t\t\t\t\t\tclearTimeout(thisObj.statusTimeout);\n\t\t\t\t\t\t\t\tthisObj.statusTimeout = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthisObj.statusDebounceStart = null;\n\t\t\t\t\t\t\tthisObj.debouncingStatus = false;\n\t\t\t\t\t\t\tclearTimeout(thisObj.statusTimeout);\n\t\t\t\t\t\t\tthisObj.statusTimeout = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Don't change play/pause button display while using the seek bar (or if YouTube stopped)\n\t\t\t\t\t\tif (!thisObj.seekBar.tracking && !thisObj.stoppingYouTube) {\n\t\t\t\t\t\t\tif (currentState === 'paused' || currentState === 'stopped' || currentState === 'ended') {\n\t\t\t\t\t\t\t\tthisObj.$playpauseButton.attr('aria-label',thisObj.tt.play);\n\n\t\t\t\t\t\t\t\tif (thisObj.iconType === 'font') {\n\t\t\t\t\t\t\t\t\tthisObj.$playpauseButton.find('span').first().removeClass('icon-pause').addClass('icon-play');\n\t\t\t\t\t\t\t\t\tthisObj.$playpauseButton.find('span.able-clipped').text(thisObj.tt.play);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (thisObj.iconType === 'svg') {\n\t\t\t\t\t\t\t\t\tnewSvgData = thisObj.getSvgData('play');\n\t\t\t\t\t\t\t\t\tthisObj.$playpauseButton.find('svg').attr('viewBox',newSvgData[0]);\n\t\t\t\t\t\t\t\t\tthisObj.$playpauseButton.find('path').attr('d',newSvgData[1]);\n\t\t\t\t\t\t\t\t\tthisObj.$playpauseButton.find('span.able-clipped').text(thisObj.tt.play);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tthisObj.$playpauseButton.find('img').attr('src',thisObj.playButtonImg);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tthisObj.$playpauseButton.attr('aria-label',thisObj.tt.pause);\n\n\t\t\t\t\t\t\t\tif (thisObj.iconType === 'font') {\n\t\t\t\t\t\t\t\t\tthisObj.$playpauseButton.find('span').first().removeClass('icon-play').addClass('icon-pause');\n\t\t\t\t\t\t\t\t\tthisObj.$playpauseButton.find('span.able-clipped').text(thisObj.tt.pause);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (thisObj.iconType === 'svg') {\n\t\t\t\t\t\t\t\t\tnewSvgData = thisObj.getSvgData('pause');\n\t\t\t\t\t\t\t\t\tthisObj.$playpauseButton.find('svg').attr('viewBox',newSvgData[0]);\n\t\t\t\t\t\t\t\t\tthisObj.$playpauseButton.find('path').attr('d',newSvgData[1]);\n\t\t\t\t\t\t\t\t\tthisObj.$playpauseButton.find('span.able-clipped').text(thisObj.tt.pause);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tthisObj.$playpauseButton.find('img').attr('src',thisObj.pauseButtonImg);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Show/hide status bar content conditionally\n\t\tif (!this.fullscreen) {\n\t\t\tstatusBarWidthBreakpoint = 300;\n\t\t\tstatusBarHeight = this.$statusBarDiv.height();\n\t\t\tspeedHeight = this.$statusBarDiv.find('span.able-speed').height();\n\t\t\tif (speedHeight > (statusBarHeight + 5)) {\n\t\t\t\t// speed bar is wrapping (happens often in German player)\n\t\t\t\tthis.$statusBarDiv.find('span.able-speed').hide();\n\t\t\t\tthis.hidingSpeed = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (this.hidingSpeed) {\n\t\t\t\t\tthis.$statusBarDiv.find('span.able-speed').show();\n\t\t\t\t\tthis.hidingSpeed = false;\n\t\t\t\t}\n\t\t\t\tif (this.$statusBarDiv.width() < statusBarWidthBreakpoint) {\n\t\t\t\t\t// Player is too small for a speed span\n\t\t\t\t\tthis.$statusBarDiv.find('span.able-speed').hide();\n\t\t\t\t\tthis.hidingSpeed = true;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (this.hidingSpeed) {\n\t\t\t\t\t\tthis.$statusBarDiv.find('span.able-speed').show();\n\t\t\t\t\t\tthis.hidingSpeed = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t};\n\n\tAblePlayer.prototype.getHiddenWidth = function($el) {\n\n\t\t// jQuery returns for width() if element is hidden\n\t\t// this function is a workaround\n\n\t\t// save a reference to a cloned element that can be measured\n\t\tvar $hiddenElement = $el.clone().appendTo('body');\n\n\t\t// calculate the width of the clone\n\t\tvar width = $hiddenElement.outerWidth();\n\n\t\t// remove the clone from the DOM\n\t\t$hiddenElement.remove();\n\n\t\treturn width;\n\t};\n\n\tAblePlayer.prototype.handlePlay = function(e) {\n\n\t\tif (this.paused) {\n\t\t\t// user clicked play \n\t\t\tthis.okToPlay = true; \n\t\t\tthis.playMedia();\n\t\t\tif (this.synth.paused) { \n\t\t\t\t// media was paused while description was speaking \n\t\t\t\t// resume utterance \n\t\t\t\tthis.synth.resume(); \n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// user clicked pause\n\t\t\tthis.okToPlay = false; \n\t\t\tthis.pauseMedia();\n\t\t\tif (this.speakingDescription) { \n\t\t\t\t// pause the current utterance \n\t\t\t\t// it will resume when the user presses play \n\t\t\t\tthis.synth.pause();\t\t\t\t\n\t\t\t}\n\t\t}\n\t\tif (this.speechEnabled === null) { \t\t\t\n\t\t\tthis.initSpeech('play'); \n\t\t}\n\t};\n\n\tAblePlayer.prototype.handleRestart = function() {\n\n\t\tif (this.speakingDescription) { \n\t\t\t// cancel audio description \n\t\t\tthis.synth.cancel();\t\t\t\t\n\t\t}\t\t\t\n\t\tthis.seekTo(0);\n\t};\n\n\tAblePlayer.prototype.handlePrevTrack = function() {\n\n\t\tif (this.playlistIndex === 0) {\n\t\t\t// currently on the first track\n\t\t\t// wrap to bottom and play the last track\n\t\t\tthis.playlistIndex = this.$playlist.length - 1;\n\t\t}\n\t\telse {\n\t\t\tthis.playlistIndex--;\n\t\t}\n\t\tthis.cueingPlaylistItem = true; // stopgap to prevent multiple firings\n\t\tthis.cuePlaylistItem(this.playlistIndex);\n\t};\n\n\tAblePlayer.prototype.handleNextTrack = function() {\n\n\t\tif (this.playlistIndex === this.$playlist.length - 1) {\n\t\t\t// currently on the last track\n\t\t\t// wrap to top and play the forst track\n\t\t\tthis.playlistIndex = 0;\n\t\t}\n\t\telse {\n\t\t\tthis.playlistIndex++;\n\t\t}\n\t\tthis.cueingPlaylistItem = true; // stopgap to prevent multiple firings\n\t\tthis.cuePlaylistItem(this.playlistIndex);\n\t};\n\n\tAblePlayer.prototype.handleRewind = function() {\n\n\t\tvar targetTime;\n\n\t\ttargetTime = this.elapsed - this.seekInterval;\n\t\tif (this.useChapterTimes) {\n\t\t\tif (targetTime < this.currentChapter.start) {\n\t\t\t\ttargetTime = this.currentChapter.start;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (targetTime < 0) {\n\t\t\t\ttargetTime = 0;\n\t\t\t}\n\t\t}\n\t\tthis.seekTo(targetTime);\n\t};\n\n\tAblePlayer.prototype.handleFastForward = function() {\n\n\t\tvar targetTime, lastChapterIndex;\n\n\t\tlastChapterIndex = this.chapters.length-1;\n\t\ttargetTime = this.elapsed + this.seekInterval;\n\t\tif (this.useChapterTimes) {\n\t\t\tif (this.chapters[lastChapterIndex] == this.currentChapter) {\n\t\t\t\t// this is the last chapter\n\t\t\t\tif (targetTime > this.duration || targetTime > this.currentChapter.end) {\n\t\t\t\t\t// targetTime would exceed the end of the video (or chapter)\n\t\t\t\t\t// scrub to end of whichever is earliest\n\t\t\t\t\ttargetTime = Math.min(this.duration, this.currentChapter.end);\n\t\t\t\t}\n\t\t\t\telse if (this.duration % targetTime < this.seekInterval) {\n\t\t\t\t\t// nothing left but pocket change after seeking to targetTime\n\t\t\t\t\t// go ahead and seek to end of video (or chapter), whichever is earliest\n\t\t\t\t\ttargetTime = Math.min(this.duration, this.currentChapter.end);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// this is not the last chapter\n\t\t\t\tif (targetTime > this.currentChapter.end) {\n\t\t\t\t\t// targetTime would exceed the end of the chapter\n\t\t\t\t\t// scrub exactly to end of chapter\n\t\t\t\t\ttargetTime = this.currentChapter.end;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// not using chapter times\n\t\t\tif (targetTime > this.duration) {\n\t\t\t\ttargetTime = this.duration;\n\t\t\t}\n\t\t}\n\t\tthis.seekTo(targetTime);\n\t};\n\n\tAblePlayer.prototype.handleRateIncrease = function() {\n\t\tthis.changeRate(1);\n\t};\n\n\tAblePlayer.prototype.handleRateDecrease = function() {\n\t\tthis.changeRate(-1);\n\t};\n\n\t// Increases or decreases playback rate, where dir is 1 or -1 indication direction.\n\tAblePlayer.prototype.changeRate = function (dir) {\n\n\t\tvar rates, currentRate, index, newRate, vimeoMin, vimeoMax;\n\n\t\tif (this.player === 'html5') {\n\t\t\tthis.setPlaybackRate(this.getPlaybackRate() + (0.25 * dir));\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\t\t\tif (this.youTubePlayerReady) {\n\t\t\t\trates = this.youTubePlayer.getAvailablePlaybackRates();\n\t\t\t\tcurrentRate = this.getPlaybackRate();\n\t\t\t\tindex = rates.indexOf(currentRate);\n\t\t\t\tif (index === -1) {\n\t\t\t\t\tconsole.log('ERROR: Youtube returning unknown playback rate ' + currentRate.toString());\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tindex += dir;\n\t\t\t\t\t// Can only increase or decrease rate if there's another rate available.\n\t\t\t\t\tif (index < rates.length && index >= 0) {\n\t\t\t\t\t\tthis.setPlaybackRate(rates[index]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (this.player === 'vimeo') {\n\t\t\t// range is 0.5 to 2\n\t\t\t// increase/decrease in inrements of 0.5\n\t\t\tvimeoMin = 0.5;\n\t\t\tvimeoMax = 2;\n\t\t\tif (dir === 1) {\n\t\t\t\tif (this.vimeoPlaybackRate + 0.5 <= vimeoMax) {\n\t\t\t\t\tnewRate = this.vimeoPlaybackRate + 0.5;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tnewRate = vimeoMax;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (dir === -1) {\n\t\t\t\tif (this.vimeoPlaybackRate - 0.5 >= vimeoMin) {\n\t\t\t\t\tnewRate = this.vimeoPlaybackRate - 0.5;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tnewRate = vimeoMin;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.setPlaybackRate(newRate);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.handleCaptionToggle = function() {\n\n\t\tvar thisObj = this;\n\t\tvar captions;\n\t\tif (this.hidingPopup) {\n\t\t\t// stopgap to prevent spacebar in Firefox from reopening popup\n\t\t\t// immediately after closing it\n\t\t\tthis.hidingPopup = false;\n\t\t\treturn false;\n\t\t}\n\t\tif (this.captions.length) {\n\t\t\tcaptions = this.captions;\n\t\t}\n\t\telse {\n\t\t\tcaptions = [];\n\t\t}\n\t\tif (captions.length === 1) {\n\t\t\t// When there's only one set of captions, just do an on/off toggle.\n\t\t\tif (this.captionsOn === true) {\n\t\t\t\t// turn them off\n\t\t\t\tthis.captionsOn = false;\n\t\t\t\tthis.prefCaptions = 0;\n\t\t\t\tthis.$ccButton.attr('aria-pressed', 'false');\n\t\t\t\tthis.updateCookie('prefCaptions');\n\t\t\t\tif (this.usingYouTubeCaptions) {\n\t\t\t\t\tthis.youTubePlayer.unloadModule('captions');\n\t\t\t\t}\n\t\t\t\telse if (this.usingVimeoCaptions) { \n\t\t\t\t\tthis.vimeoPlayer.disableTextTrack(); \n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.$captionsWrapper.hide();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// captions are off. Turn them on.\n\t\t\t\tthis.captionsOn = true;\n\t\t\t\tthis.prefCaptions = 1;\n\t\t\t\tthis.$ccButton.attr('aria-pressed', 'true');\n\t\t\t\tthis.updateCookie('prefCaptions');\n\t\t\t\tif (this.usingYouTubeCaptions) {\n\t\t\t\t\tthis.youTubePlayer.loadModule('captions');\n\t\t\t\t}\n\t\t\t\telse if (this.usingVimeoCaptions) { \n\t\t\t\t\tthis.vimeoPlayer.enableTextTrack(this.captionLang).then(function(track) {\n\t\t\t\t\t\t// track.language = the iso code for the language\n\t\t\t\t\t\t// track.kind = 'captions' or 'subtitles'\n\t\t\t\t\t\t// track.label = the human-readable label\n\t\t\t\t\t}).catch(function(error) {\n\t\t\t\t\t\tswitch (error.name) {\n\t\t\t\t\t\t\tcase 'InvalidTrackLanguageError':\n\t\t\t\t\t\t\t\t// no track was available with the specified language\n\t\t\t\t\t\t\t\tconsole.log('No ' + track.kind + ' track is available in the specified language (' + track.label + ')');\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'InvalidTrackError':\n\t\t\t\t\t\t\t\t// no track was available with the specified language and kind\n\t\t\t\t\t\t\t\tconsole.log('No ' + track.kind + ' track is available in the specified language (' + track.label + ')');\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t// some other error occurred\n\t\t\t\t\t\t\t\tconsole.log('Error loading ' + track.label + ' ' + track.kind + ' track');\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t});\t\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.$captionsWrapper.show();\n\t\t\t\t}\n\t\t\t\tfor (var i=0; i<captions.length; i++) {\n\t\t\t\t\tif (captions[i].def === true) { // this is the default language\n\t\t\t\t\t\tthis.selectedCaptions = captions[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.selectedCaptions = this.captions[0];\n\t\t\t\tif (this.descriptions.length >= 0) {\n\t\t\t\t\tthis.selectedDescriptions = this.descriptions[0];\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.refreshControls('captions');\n\t\t}\n\t\telse {\n\t\t\t// there is more than one caption track.\n\t\t\t// clicking on a track is handled via caption.js > getCaptionClickFunction()\n\t\t\tif (this.captionsPopup && this.captionsPopup.is(':visible')) {\n\t\t\t\tthis.captionsPopup.hide();\n\t\t\t\tthis.hidingPopup = false;\n\t\t\t\tthis.$ccButton.attr('aria-expanded', 'false')\n\t\t\t\tthis.waitThenFocus(this.$ccButton);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.closePopups();\n\t\t\t\tif (this.captionsPopup) {\n\t\t\t\t\tthis.captionsPopup.show();\n\t\t\t\t\tthis.$ccButton.attr('aria-expanded','true');\n\n\t\t\t\t\t// Gives time to \"register\" expanded ccButton\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tthisObj.captionsPopup.css('top', thisObj.$ccButton.position().top - thisObj.captionsPopup.outerHeight());\n\t\t\t\t\t\tthisObj.captionsPopup.css('left', thisObj.$ccButton.position().left)\n\t\t\t\t\t\t// Place focus on the first button (even if another button is checked)\n\t\t\t\t\t\tthisObj.captionsPopup.find('li').removeClass('able-focus');\n\t\t\t\t\t\tthisObj.captionsPopup.find('li').first().focus().addClass('able-focus');\n\t\t\t\t\t}, 50);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * Gives enough time for DOM changes to take effect before adjusting focus.\n\t * Helpful for allowing screen reading of elements whose state is intermittently changed.\n\t * \n\t * @param {*} $el element to focus on\n\t * @param {*} timeout optional wait time in milliseconds before focus\n\t */\n\tAblePlayer.prototype.waitThenFocus = function($el, timeout) {\n\n\t\t// Default wait time of 50 ms\n\t\tvar _timeout = (timeout === undefined || timeout === null) ? 50 : timeout;\n\t\t\n\t\tsetTimeout(function() {\n\t\t\t$el.focus();\n\t\t}, _timeout);\n\t}\n\n\tAblePlayer.prototype.handleChapters = function () {\n\t\tif (this.hidingPopup) {\n\t\t\t// stopgap to prevent spacebar in Firefox from reopening popup\n\t\t\t// immediately after closing it\n\t\t\tthis.hidingPopup = false;\n\t\t\treturn false;\n\t\t}\n\t\tif (this.chaptersPopup.is(':visible')) {\n\t\t\tthis.chaptersPopup.hide();\n\t\t\tthis.hidingPopup = false;\n\t\t\tthis.$chaptersButton.attr('aria-expanded','false').focus();\n\t\t}\n\t\telse {\n\t\t\tthis.closePopups();\n\t\t\tthis.chaptersPopup.show();\n\t\t\tthis.$chaptersButton.attr('aria-expanded','true');\n\t\t\tthis.chaptersPopup.css('top', this.$chaptersButton.position().top - this.chaptersPopup.outerHeight());\n\t\t\tthis.chaptersPopup.css('left', this.$chaptersButton.position().left)\n\n\t\t\t// Highlight the current chapter, if any chapters are checked\n\t\t\t// Otherwise, place focus on the first chapter\n\t\t\tthis.chaptersPopup.find('li').removeClass('able-focus');\n\t\t\tif (this.chaptersPopup.find('li[aria-checked=\"true\"]').length) {\n\t\t\t\tthis.chaptersPopup.find('li[aria-checked=\"true\"]').focus().addClass('able-focus');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.chaptersPopup.find('li').first().addClass('able-focus').attr('aria-checked','true').focus();\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.handleDescriptionToggle = function() {\n\n\t\tthis.descOn = !this.descOn;\n\t\tthis.prefDesc = + this.descOn; // convert boolean to integer\n\t\tthis.updateCookie('prefDesc');\n\t\tif (typeof this.$descDiv !== 'undefined') {\n\t\t\tif (!this.$descDiv.is(':hidden')) {\n\t\t\t\tthis.$descDiv.hide();\n\t\t\t}\n\t\t\t// NOTE: now showing $descDiv here if previously hidden \n\t\t\t// that's handled elsewhere, dependent on whether there's text to show\n\t\t}\n\t\tthis.initDescription();\n\t\tthis.refreshControls('descriptions');\n\t};\n\n\tAblePlayer.prototype.handlePrefsClick = function(pref) {\n\n\t\t// NOTE: the prefs menu is positioned near the right edge of the player\n\t\t// This assumes the Prefs button is also positioned in that vicinity\n\t\t// (last or second-last button the right)\n\n\t\t// NOTE: If previously unable to fully populate the Description dialog\n\t\t// because the Web Speech API failed to getVoices()\n\t\t// now is a good time to try again\n\t\t// so the Description dialog can be rebuilt before the user requests it\n\n\t\tvar thisObj, prefsButtonPosition, prefsMenuRight, prefsMenuLeft;\n\n\t\tthisObj = this;\n\n\t\tif (this.speechEnabled === null) { \t\t\t\n\t\t\tthis.initSpeech('prefs'); \n\t\t}\n\t\tif (this.hidingPopup) {\n\t\t\t// stopgap to prevent spacebar in Firefox from reopening popup\n\t\t\t// immediately after closing it\n\t\t\tthis.hidingPopup = false;\n\t\t\treturn false;\n\t\t}\n\t\tif (this.prefsPopup.is(':visible')) {\n\t\t\tthis.prefsPopup.hide();\n\t\t\tthis.$prefsButton.attr('aria-expanded','false');\n\t\t\t// restore each menu item to original hidden state\n\t\t\tthis.prefsPopup.find('li').removeClass('able-focus').attr('tabindex','-1');\n\t\t\tif (!this.showingPrefsDialog) {\n\t\t\t\tthis.$prefsButton.focus();\n\t\t\t}\n\t\t\t// wait briefly, then reset hidingPopup\n\t\t\tsetTimeout(function() {\n\t\t\t\tthisObj.hidingPopup = false;\n\t\t\t},100);\n\t\t}\n\t\telse {\n\t\t\tthis.closePopups();\n\t\t\tthis.prefsPopup.show();\n\t\t\tthis.$prefsButton.attr('aria-expanded','true');\n\t\t\tthis.$prefsButton.focus(); // focus first on prefs button to announce expanded state\n\t\t\t// give time for focus on button then adjust popup settings and focus\n\t\t\tsetTimeout(function() {\n\t\t\t\tprefsButtonPosition = thisObj.$prefsButton.position();\n\t\t\t\tprefsMenuRight = thisObj.$ableDiv.width() - 5;\n\t\t\t\tprefsMenuLeft = prefsMenuRight - thisObj.prefsPopup.width();\n\t\t\t\tthisObj.prefsPopup.css('top', prefsButtonPosition.top - thisObj.prefsPopup.outerHeight());\n\t\t\t\tthisObj.prefsPopup.css('left', prefsMenuLeft);\n\t\t\t\t// remove prior focus and set focus on first item; also change tabindex from -1 to 0\n\t\t\t\tthisObj.prefsPopup.find('li').removeClass('able-focus').attr('tabindex','0');\n\t\t\t\tthisObj.prefsPopup.find('li').first().focus().addClass('able-focus');\n\t\t\t}, 50);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.handleHelpClick = function() {\n\t\tthis.setFullscreen(false);\n\t\tthis.helpDialog.show();\n\t};\n\n\tAblePlayer.prototype.handleTranscriptToggle = function () {\n\n\t\tvar thisObj = this;\n\n\t\tif (this.$transcriptDiv.is(':visible')) {\n\t\t\tthis.$transcriptArea.hide();\n\t\t\tthis.$transcriptButton.addClass('buttonOff').attr('aria-label',this.tt.showTranscript);\n\t\t\tthis.$transcriptButton.find('span.able-clipped').text(this.tt.showTranscript);\n\t\t\tthis.prefTranscript = 0;\n\t\t\tthis.$transcriptButton.focus().addClass('able-focus');\n\t\t\t// wait briefly before resetting stopgap var\n\t\t\t// otherwise the keypress used to select 'Close' will trigger the transcript button\n\t\t\t// Benchmark tests: If this is gonna happen, it typically happens in around 3ms; max 12ms\n\t\t\t// Setting timeout to 100ms is a virtual guarantee of proper functionality\n\t\t\tsetTimeout(function() {\n\t\t\t\tthisObj.closingTranscript = false;\n\t\t\t}, 100);\n\t\t}\n\t\telse {\n\t\t\tthis.positionDraggableWindow('transcript');\n\t\t\tthis.$transcriptArea.show();\n\t\t\t// showing transcriptArea has a cascading effect of showing all content *within* transcriptArea\n\t\t\t// need to re-hide the popup menu\n\t\t\tthis.$transcriptPopup.hide();\n\t\t\tthis.$transcriptButton.removeClass('buttonOff').attr('aria-label',this.tt.hideTranscript);\n\t\t\tthis.$transcriptButton.find('span.able-clipped').text(this.tt.hideTranscript);\n\t\t\tthis.prefTranscript = 1;\n\t\t\t// move focus to first focusable element (window options button)\n\t\t\tthis.focusNotClick = true;\n\t\t\tthis.$transcriptArea.find('button').first().focus();\n\t\t\t// wait briefly before resetting stopgap var\n\t\t\tsetTimeout(function() {\n\t\t\t\tthisObj.focusNotClick = false;\n\t\t\t}, 100);\n\t\t}\n\t\tthis.updateCookie('prefTranscript');\n\t};\n\n\tAblePlayer.prototype.handleSignToggle = function () {\n\n\t\tvar thisObj = this;\n\n\t\tif (this.$signWindow.is(':visible')) {\n\t\t\tthis.$signWindow.hide();\n\t\t\tthis.$signButton.addClass('buttonOff').attr('aria-label',this.tt.showSign);\n\t\t\tthis.$signButton.find('span.able-clipped').text(this.tt.showSign);\n\t\t\tthis.prefSign = 0;\n\t\t\tthis.$signButton.focus().addClass('able-focus');\n\t\t\t// wait briefly before resetting stopgap var\n\t\t\t// otherwise the keypress used to select 'Close' will trigger the transcript button\n\t\t\tsetTimeout(function() {\n\t\t\t\tthisObj.closingSign = false;\n\t\t\t}, 100);\n\t\t}\n\t\telse {\n\t\t\tthis.positionDraggableWindow('sign');\n\t\t\tthis.$signWindow.show();\n\t\t\t// showing signWindow has a cascading effect of showing all content *within* signWindow\n\t\t\t// need to re-hide the popup menu\n\t\t\tthis.$signPopup.hide();\n\t\t\tthis.$signButton.removeClass('buttonOff').attr('aria-label',this.tt.hideSign);\n\t\t\tthis.$signButton.find('span.able-clipped').text(this.tt.hideSign);\n\t\t\tthis.prefSign = 1;\n\t\t\tthis.focusNotClick = true;\n\t\t\tthis.$signWindow.find('button').first().focus();\n\t\t\t// wait briefly before resetting stopgap var\n\t\t\t// otherwise the keypress used to select 'Close' will trigger the transcript button\n\t\t\tsetTimeout(function() {\n\t\t\t\tthisObj.focusNotClick = false;\n\t\t\t}, 100);\n\t\t}\n\t\tthis.updateCookie('prefSign');\n\t};\n\n\tAblePlayer.prototype.isFullscreen = function () {\n\n\t\t// NOTE: This has been largely replaced as of 3.2.5 with a Boolean this.fullscreen,\n\t\t// which is defined in setFullscreen()\n\t\t// This function returns true if *any* element is fullscreen\n\t\t// but doesn't tell us whether a particular element is in fullscreen\n\t\t// (e.g., if there are multiple players on the page)\n\t\t// The Boolean this.fullscreen is defined separately for each player instance\n\n\t\tif (this.nativeFullscreenSupported()) {\n\t\t\treturn (document.fullscreenElement ||\n\t\t\t\t\t\t\tdocument.webkitFullscreenElement ||\n\t\t\t\t\t\t\tdocument.webkitCurrentFullscreenElement ||\n\t\t\t\t\t\t\tdocument.mozFullscreenElement ||\n\t\t\t\t\t\t\tdocument.msFullscreenElement) ? true : false;\n\t\t}\n\t\telse {\n\t\t\treturn this.modalFullscreenActive ? true : false;\n\t\t}\n\t}\n\n\tAblePlayer.prototype.setFullscreen = function (fullscreen) {\n\n\t\tif (this.fullscreen == fullscreen) {\n\t\t\t// replace isFullscreen() with a Boolean. see function for explanation\n\t\t\treturn;\n\t\t}\n\t\tvar thisObj = this;\n\t\tvar $el = this.$ableWrapper;\n\t\tvar el = $el[0];\n\n\t\tif (this.nativeFullscreenSupported()) {\n\t\t\t// Note: many varying names for options for browser compatibility.\n\t\t\tif (fullscreen) {\n\t\t\t\t// Initialize fullscreen\n\n\t\t\t\tif (el.requestFullscreen) {\n\t\t\t\t\tel.requestFullscreen();\n\t\t\t\t}\n\t\t\t\telse if (el.webkitRequestFullscreen) {\n\t\t\t\t\tel.webkitRequestFullscreen();\n\t\t\t\t}\n\t\t\t\telse if (el.mozRequestFullscreen) {\n\t\t\t\t\tel.mozRequestFullscreen();\n\t\t\t\t}\n\t\t\t\telse if (el.msRequestFullscreen) {\n\t\t\t\t\tel.msRequestFullscreen();\n\t\t\t\t}\n\t\t\t\tthis.fullscreen = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Exit fullscreen\n\t\t\t\tthis.restoringAfterFullscreen = true; \n\t\t\t\tif (document.exitFullscreen) {\n\t\t\t\t\tdocument.exitFullscreen();\n\t\t\t\t}\n\t\t\t\telse if (document.webkitExitFullscreen) {\n\t\t\t\t\tdocument.webkitExitFullscreen();\n\t\t\t\t}\n\t\t\t\telse if (document.webkitCancelFullscreen) {\n\t\t\t\t\tdocument.webkitCancelFullscreen();\n\t\t\t\t}\n\t\t\t\telse if (document.mozCancelFullscreen) {\n\t\t\t\t\tdocument.mozCancelFullscreen();\n\t\t\t\t}\n\t\t\t\telse if (document.msExitFullscreen) {\n\t\t\t\t\tdocument.msExitFullscreen();\n\t\t\t\t}\n\t\t\t\tthis.fullscreen = false;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// Non-native fullscreen support through modal dialog.\n\t\t\t// Create dialog on first run through.\n\t\t\tif (!this.fullscreenDialog) {\n\t\t\t\tvar $dialogDiv = $('<div>');\n\t\t\t\t// create a hidden alert, communicated to screen readers via aria-describedby\n\t\t\t\tvar $fsDialogAlert = $('<p>',{\n\t\t\t\t\t'class': 'able-screenreader-alert'\n\t\t\t\t}).text(this.tt.fullscreen); // In English: \"Full screen\"; TODO: Add alert text that is more descriptive\n\t\t\t\t$dialogDiv.append($fsDialogAlert);\n\t\t\t\t// now render this as a dialog\n\t\t\t\tthis.fullscreenDialog = new AccessibleDialog($dialogDiv, this.$fullscreenButton, 'dialog', true, 'Fullscreen video player', $fsDialogAlert, this.tt.exitFullscreen, '100%', true, function () { thisObj.handleFullscreenToggle() });\n\t\t\t\t$('body').append($dialogDiv);\n\t\t\t}\n\n\t\t\t// Track whether paused/playing before moving element; moving the element can stop playback.\n\t\t\tvar wasPaused = this.paused;\n\n\t\t\tif (fullscreen) {\n\t\t\t\tthis.modalFullscreenActive = true;\n\t\t\t\tthis.fullscreenDialog.show();\n\n\t\t\t\t// Move player element into fullscreen dialog, then show.\n\t\t\t\t// Put a placeholder element where player was.\n\t\t\t\tthis.$modalFullscreenPlaceholder = $('<div class=\"placeholder\">');\n\t\t\t\tthis.$modalFullscreenPlaceholder.insertAfter($el);\n\t\t\t\t$el.appendTo(this.fullscreenDialog.modal);\n\n\t\t\t\t// Column left css is 50% by default; set to 100% for full screen.\n\t\t\t\tif ($el === this.$ableColumnLeft) {\n\t\t\t\t\t$el.width('100%');\n\t\t\t\t}\n\t\t\t\tvar newHeight = $(window).height() - this.$playerDiv.height();\n\t\t\t\tif (typeof this.$descDiv !== 'undefined') {\t\t\t\t\n\t\t\t\t\tif (!this.$descDiv.is(':hidden')) {\n\t\t\t\t\t\tnewHeight -= this.$descDiv.height();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.modalFullscreenActive = false;\n\t\t\t\tif ($el === this.$ableColumnLeft) {\n\t\t\t\t\t$el.width('50%');\n\t\t\t\t}\n\t\t\t\t$el.insertAfter(this.$modalFullscreenPlaceholder);\n\t\t\t\tthis.$modalFullscreenPlaceholder.remove();\n\t\t\t\tthis.fullscreenDialog.hide();\n\t\t\t}\n\n\t\t\t// Resume playback if moving stopped it.\n\t\t\tif (!wasPaused && this.paused) {\n\t\t\t\tthis.playMedia();\n\t\t\t}\n\t\t}\n\t\t// add event handlers for changes in fullscreen mode. \n\t\t// Browsers natively trigger this event with the Escape key,  \n\t\t// in addition to clicking the exit fullscreen button \n\t\t$(document).on('webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange', function(e) {\n\t\t\t// NOTE: e.type = the specific event that fired (in case needing to control for browser-specific idiosyncrasies)\n\t\t\tif (!thisObj.fullscreen) {\n\t\t\t\t// user has just exited full screen\n\t\t\t\tthisObj.restoringAfterFullscreen = true;\n\t\t\t}\n\t\t\telse if (!thisObj.clickedFullscreenButton) {\n\t\t\t\t// user triggered fullscreenchange without clicking fullscreen button\n\t\t\t\tthisObj.fullscreen = false;\n\t\t\t\tthisObj.restoringAfterFullscreen = true;\n\t\t\t}\n\t\t\tthisObj.resizePlayer();\n\t\t\tthisObj.refreshControls('fullscreen');\n\n\t\t\t// NOTE: The fullscreenchange (or browser-equivalent) event is triggered twice\n\t\t\t// when exiting fullscreen via the \"Exit fullscreen\" button (only once if using Escape)\n\t\t\t// Not sure why, but consequently we need to be sure thisObj.clickedFullscreenButton\n\t\t\t// continues to be true through both events\n\t\t\t// Could use a counter variable to control that (reset to false after the 2nd trigger)\n\t\t\t// However, since I don't know why it's happening, and whether it's 100% reliable\n\t\t\t// resetting clickedFullscreenButton after a timeout seems to be better approach\n\t\t\tsetTimeout(function() {\n\t\t\t\tthisObj.clickedFullscreenButton = false;\n\t\t\t\tthisObj.restoringAfterFullscreen = false; \n\t\t\t},1000);\n\t\t});\t\t\n\t};\n\n\tAblePlayer.prototype.handleFullscreenToggle = function () {\n\n\t\tvar stillPaused = this.paused;\n\t\tthis.setFullscreen(!this.fullscreen);\n\t\tif (stillPaused) {\n\t\t\tthis.pauseMedia(); // when toggling fullscreen and media is just paused, keep media paused.\n\t\t}\n\t\telse if (!stillPaused) {\n\t\t\tthis.playMedia(); // when toggling fullscreen and media is playing, continue playing.\n\t\t}\n\t\t// automatically hide controller in fullscreen mode\n\t\t// then reset back to original setting after exiting fullscreen mode\n\t\tif (this.fullscreen) {\n\t\t\tthis.hideControls = true;\n\t\t\tif (this.playing) {\n\t\t\t\t// go ahead and hide the controls\n\t\t\t\tthis.fadeControls('out');\n\t\t\t\tthis.controlsHidden = true;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// exit fullscreen mode\n\t\t\tthis.hideControls = this.hideControlsOriginal;\n\t\t\tif (!this.hideControls) { // do not hide controls\n\t\t\t\tif (this.controlsHidden) {\n\t\t\t\t\tthis.fadeControls('in');\n\t\t\t\t\tthis.controlsHidden = false;\n\t\t\t\t}\n\t\t\t\t// if there's an active timeout to fade controls out again, clear it\n\t\t\t\tif (this.hideControlsTimeoutStatus === 'active') {\n\t\t\t\t\twindow.clearTimeout(this.hideControlsTimeout);\n\t\t\t\t\tthis.hideControlsTimeoutStatus = 'clear';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// don't resizePlayer yet; that will be called in response to the window resize event \n\t\t// this.resizePlayer();\n\t};\n\n\tAblePlayer.prototype.handleTranscriptLockToggle = function (val) {\n\n\t\tthis.autoScrollTranscript = val; // val is boolean\n\t\tthis.prefAutoScrollTranscript = +val; // convert boolean to numeric 1 or 0 for cookie\n\t\tthis.updateCookie('prefAutoScrollTranscript');\n\t\tthis.refreshControls('transcript');\n\t};\n\n\n\tAblePlayer.prototype.showTooltip = function($tooltip) {\n\n\t\tif (($tooltip).is(':animated')) {\n\t\t\t$tooltip.stop(true,true).show();\n\t\t}\n\t\telse {\n\t\t\t$tooltip.stop().show();\n\t\t}\n\t};\n\n\tAblePlayer.prototype.showAlert = function( msg, location ) {\n\n\t\t// location is either of the following:\n\t\t// 'main' (default)\n\t\t// 'screenreader (visibly hidden)\n\t\t// 'sign' (sign language window)\n\t\t// 'transcript' (trasncript window)\n\t\tvar thisObj, $alertBox, $parentWindow, alertLeft, alertTop;\n\n\t\tthisObj = this;\n\n\t\tif (location === 'transcript') {\n\t\t\t$alertBox = this.$transcriptAlert;\n\t\t\t$parentWindow = this.$transcriptArea;\n\t\t}\n\t\telse if (location === 'sign') {\n\t\t\t$alertBox = this.$signAlert;\n\t\t\t$parentWindow = this.$signWindow;\n\t\t}\n\t\telse if (location === 'screenreader') {\n\t\t\t$alertBox = this.$srAlertBox;\n\t\t}\n\t\telse {\n\t\t\t$alertBox = this.$alertBox;\n\t\t}\n\t\t$alertBox.text(msg).show();\n\t\tif (location == 'transcript' || location === 'sign') {\n\t\t\tif ($parentWindow.width() > $alertBox.width()) {\n\t\t\t\talertLeft = $parentWindow.width() / 2 - $alertBox.width() / 2;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// alert box is wider than its container. Position it far left and let it wrap\n\t\t\t\talertLeft = 10;\n\t\t\t}\n\t\t\tif (location === 'sign') {\n\t\t\t\t// position alert in the lower third of the sign window (to avoid covering the signer)\n\t\t\t\talertTop = ($parentWindow.height() / 3) * 2;\n\t\t\t}\n\t\t\telse if (location === 'transcript') {\n\t\t\t\t// position alert just beneath the toolbar to avoid getting lost among transcript text\n\t\t\t\talertTop = this.$transcriptToolbar.height() + 30;\n\t\t\t}\n\t\t\t$alertBox.css({\n\t\t\t\ttop: alertTop + 'px',\n\t\t\t\tleft: alertLeft + 'px'\n\t\t\t});\n\t\t}\n\t\telse if (location !== 'screenreader') {\n\t\t\t// The original formula incorporated offset() into the calculation\n\t\t\t// but at some point this began resulting in an alert that's off-centered\n\t\t\t// Changed in v2.2.17, but here's the original for reference in case needed:\n\t\t\t// left: this.$playerDiv.offset().left + (this.$playerDiv.width() / 2) - ($alertBox.width() / 2)\n\t\t\t$alertBox.css({\n\t\t\t\tleft: (this.$playerDiv.width() / 2) - ($alertBox.width() / 2)\n\t\t\t});\n\t\t}\n\t\tif (location !== 'screenreader') {\n\t\t\tsetTimeout(function () {\n\t\t\t\t$alertBox.fadeOut(300);\n\t\t\t}, 3000);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.showedAlert = function (which) {\n\n\t\t// returns true if the target alert has already been shown\n\t\t// useful for throttling alerts that only need to be shown once\n\t\t// e.g., move alerts with instructions for dragging a window\n\n\t\tif (which === 'transcript') {\n\t\t\tif (this.showedTranscriptAlert) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\tif (this.showedSignAlert) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t// Resizes all relevant player attributes.\n\tAblePlayer.prototype.resizePlayer = function (width, height) {\n\n\t\tvar captionSizeOkMin, captionSizeOkMax, captionSize, newCaptionSize, newLineHeight;\n\n\t\tvar newWidth, newHeight, $iframe, alertTop; \n\n\t\tif (this.mediaType === 'audio') { \n\t\t\treturn; \n\t\t}\n\n\t\tif (typeof width !== 'undefined' && typeof height !== 'undefined') { \n\t\t\t// this is being called the first time a player is initialized \n\t\t\t// width and height were collected from the HTML, YouTube, or Vimeo media API\n\t\t\t// so are reflective of the actual size of the media \n\t\t\t// use these values to calculate aspectRatio \n\t\t\tthis.aspectRatio = height / width;  \n\t\t\tif (this.playerWidth) { \n\t\t\t\t// default width is already defined via a width or data-width attribute. Use that. \t\t\t\t\n\t\t\t\tnewWidth = this.playerWidth; \n\t\t\t\tif (this.playerHeight) { \n\t\t\t\t\tnewHeight = this.playerHeight; \n\t\t\t\t}\n\t\t\t\telse { \n\t\t\t\t\tnewHeight = Math.round(newWidth * this.aspectRatio); \n\t\t\t\t\tthis.playerHeight = newHeight; \n\t\t\t\t}\n\t\t\t}\n\t\t\telse { \n\t\t\t\t// playerWidth was not defined via HTML attributes \n\t\t\t\tif (this.player === 'html5') { \n\t\t\t\t\tnewWidth = $(window).width();\n\t\t\t\t}\n\t\t\t\telse { \n\t\t\t\t\tnewWidth = this.$ableWrapper.width(); \n\t\t\t\t}\n\t\t\t\tnewHeight = Math.round(newWidth * this.aspectRatio); \n\t\t\t}\t\t\t\t\n\t\t}\t\t\t\n\t\telse if (this.fullscreen) { \n\t\t\tthis.$ableWrapper.addClass('fullscreen');  \n\t\t\tnewWidth = $(window).width();\t\t\t\n\t\t\t// the 5 pixel buffer is arbitrary, but results in a better fit for all browsers\n\t\t\tnewHeight = $(window).height() - this.$playerDiv.outerHeight() - 5; \n\t\t\tthis.positionCaptions('overlay');\n\t\t}\n\t\telse { // not fullscreen, and not first time initializing player \t\t\t\n\t\t\tthis.$ableWrapper.removeClass('fullscreen');\n\t\t\tif (this.player === 'html5') { \n\t\t\t\tif (this.playerWidth) { \n\t\t\t\t\tnewWidth = this.playerWidth; \n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// use full size of window \n\t\t\t\t\t// player will be downsized to fit container if CSS requires it \n\t\t\t\t\tnewWidth = $(window).width();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse { \n\t\t\t\tnewWidth = this.$ableWrapper.width(); \n\t\t\t}\n\t\t\tnewHeight = Math.round(newWidth * this.aspectRatio); \n\t\t\tthis.positionCaptions(this.prefCaptionsPosition); \n\t\t}\n\t\tif (this.debug) {\n\t\t\tconsole.log('resizePlayer to ' + newWidth + 'x' + newHeight); \t\t\n\t\t}\n\t\t// Now size the player with newWidth and newHeight\n\t\tif (this.player === 'youtube' || this.player === 'vimeo') { \n\t\t\t$iframe = this.$ableWrapper.find('iframe'); \n\t\t\tif (this.player === 'youtube' && this.youTubePlayer) { \n\t\t\t\t// alternatively, YouTube API offers a method for setting the video size \n\t\t\t\t// this adds width and height attributes to the iframe \n\t\t\t\t// but might have other effects, so best to do it this way \n\t\t\t\tthis.youTubePlayer.setSize(newWidth,newHeight); \n\t\t\t}\n\t\t\telse { \n\t\t\t\t// Vimeo API does not have a method for changing size of player \n\t\t\t\t// Therefore, need to change iframe attributes directly \n\t\t\t\t$iframe.attr({\n\t\t\t\t\t'width': newWidth,\n\t\t\t\t\t'height': newHeight\n\t\t\t\t}); \n\t\t\t}\n\t\t\tif (this.playerWidth && this.playerHeight) { \n\t\t\t\tif (this.fullscreen) { \n\t\t\t\t\t// remove constraints \n\t\t\t\t\t$iframe.css({ \n\t\t\t\t\t\t'max-width': '',\n\t\t\t\t\t\t'max-height': ''\n\t\t\t\t\t});\t\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// use CSS on iframe to enforce explicitly defined size constraints\n\t\t\t\t\t$iframe.css({ \n\t\t\t\t\t\t'max-width': this.playerWidth + 'px',\n\t\t\t\t\t\t'max-height': this.playerHeight + 'px'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (this.player === 'html5') { \n\t\t\tif (this.fullscreen) {\n\t\t\t\tthis.$media.attr({\n\t\t\t\t\t'width': newWidth,\n\t\t\t\t\t'height': newHeight\n\t\t\t\t});\n\t\t\t\tthis.$ableWrapper.css({\n\t\t\t\t\t'width': newWidth,\n\t\t\t\t\t'height': newHeight\n\t\t\t\t});\n\t\t\t}\n\t\t\telse { \n\t\t\t\t// No constraints. Let CSS handle the positioning. \n\t\t\t\tthis.$media.removeAttr('width height');\n\t\t\t\tthis.$ableWrapper.css({\n\t\t\t\t\t'width': newWidth + 'px',\n\t\t\t\t\t'height': 'auto'\n\t\t\t\t});\n\t\t\t}\t\t\t\t\n\t\t}\n\t\t// Resize captions\n\t\tif (typeof this.$captionsDiv !== 'undefined') {\n\n\t\t\t// Font-size is too small in full screen view \n\t\t\t// use viewport units (vw) instead\n\t\t\t// % units work fine if not fullscreen  \n\t\t\t// prefCaptionSize is expressed as a percentage \n\t\t\tcaptionSize = parseInt(this.prefCaptionsSize,10);\n\t\t\tif (this.fullscreen) { \n\t\t\t\tcaptionSize = (captionSize / 100) + 'vw'; \n\t\t\t}\n\t\t\telse { \n\t\t\t\tcaptionSize = captionSize + '%'; \n\t\t\t}\n\t\t\tthis.$captionsDiv.css({\n\t\t\t\t'font-size': captionSize\n\t\t\t});\n\t\t}\n\n\t\t// Reposition alert message (video player only)\n\t\t// just below the vertical center of the mediaContainer\n\t\t// hopefully above captions, but not too far from the controller bar\t\t\n\t\tif (this.mediaType === 'video') { \n\t\t\talertTop = Math.round(this.$mediaContainer.height() / 3) * 2;\t\t\t\n\t\t\tthis.$alertBox.css({\n\t\t\t\ttop: alertTop + 'px'\n\t\t\t});\n\t\t}\n\n\t\tthis.refreshControls();\t\t\t\n\t};\n\n\tAblePlayer.prototype.retrieveOffscreenWindow = function( which, width, height ) {\n\n\t\t// check to be sure popup windows ('transcript' or 'sign') are positioned on-screen\n\t\t// (they sometimes disappear off-screen when entering fullscreen mode)\n\t\t// if off-screen, recalculate so they are back on screen\n\n\t\tvar window, windowPos, windowTop, windowLeft, windowRight, windowWidth, windowBottom, windowHeight;\n\n\t\tif (which == 'transcript') {\n\t\t\twindow = this.$transcriptArea;\n\t\t}\n\t\telse if (which == 'sign') {\n\t\t\twindow = this.$signWindow;\n\t\t}\n\t\twindowWidth = window.width();\n\t\twindowHeight = window.height();\n\t\twindowPos = window.position();\n\t\twindowTop = windowPos.top;\n\t\twindowLeft = windowPos.left;\n\t\twindowRight = windowLeft + windowWidth;\n\t\twindowBottom = windowTop + windowHeight;\n\n\t\tif (windowTop < 0) { // off-screen to the top\n\t\t\twindowTop = 10;\n\t\t\twindow.css('top',windowTop);\n\t\t}\n\t\tif (windowLeft < 0) { // off-screen to the left\n\t\t\twindowLeft = 10;\n\t\t\twindow.css('left',windowLeft);\n\t\t}\n\t\tif (windowRight > width) { // off-screen to the right\n\t\t\twindowLeft = (width - 20) - windowWidth;\n\t\t\twindow.css('left',windowLeft);\n\t\t}\n\t\tif (windowBottom > height) { // off-screen to the bottom\n\t\t\twindowTop = (height - 10) - windowHeight;\n\t\t\twindow.css('top',windowTop);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getHighestZIndex = function() {\n\n\t\t// returns the highest z-index on page\n\t\t// used to ensure dialogs (or potentially other windows) are on top\n\n\t\tvar max, $elements, z;\n\t\tmax = 0;\n\n\t\t// exclude the Able Player dialogs and windows\n\t\t$elements = $('body *').not('.able-modal-dialog,.able-modal-dialog *,.able-modal-overlay,.able-modal-overlay *,.able-sign-window,.able-transcript-area');\n\n\t\t$elements.each(function(){\n\t\t\tz = $(this).css('z-index');\n\t\t\tif (Number.isInteger(+z)) { // work only with integer values, not 'auto'\n\t\t\t\tif (parseInt(z) > max) {\n\t\t\t\t\tmax = parseInt(z);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn max;\n\t};\n\n\tAblePlayer.prototype.updateZIndex = function(which) {\n\n\t\t// update z-index of 'transcript' or 'sign', relative to each other\n\t\t// direction is always 'up' (i.e., move window to top)\n\t\t// windows come to the top when the user clicks on them\n\t\tvar defHighZ, defLowZ, highestZ, transcriptZ, signZ, newHighZ, newLowZ;\n\n\t\t// set the default z-indexes, as defined in ableplayer.css\n\t\tdefHighZ = 8000; // by default, assigned to the sign window\n\t\tdefLowZ = 7000; // by default, assigned to the transcript area\n\t\thighestZ = this.getHighestZIndex(); // highest z-index on the page, excluding Able Player windows & modals\n\n\t\t// NOTE: Although highestZ is collected here, it currently isn't used.\n\t\t// If something on the page has a higher z-index than the transcript or sign window, do we care?\n\t\t// Excluding it here assumes \"No\". Our immediate concern is with the relationship between our own components.\n\t\t// If we elevate our z-indexes so our content is on top, we run the risk of starting a z-index war.\n\n\t\tif (typeof this.$transcriptArea === 'undefined' || typeof this.$signWindow === 'undefined' ) {\n\t\t\t// at least one of the windows doesn't exist, so there's no conflict\n\t\t\t// since z-index may have been stored to a cookie on another page, need to restore default\n\t\t\tif (typeof this.$transcriptArea !== 'undefined') {\n\t\t\t\ttranscriptZ = parseInt(this.$transcriptArea.css('z-index'));\n\t\t\t\tif (transcriptZ > defLowZ) {\n\t\t\t\t\t// restore to the default\n\t\t\t\t\tthis.$transcriptArea.css('z-index',defLowZ);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (typeof this.$signWindow !== 'undefined') {\n\t\t\t\tsignZ = parseInt(this.$signWindow.css('z-index'));\n\t\t\t\tif (signZ > defHighZ) {\n\t\t\t\t\t// restore to the default\n\t\t\t\t\tthis.$signWindow.css('z-index',defHighZ);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\t// both windows exist\n\n\t\t// get current values\n\t\ttranscriptZ = parseInt(this.$transcriptArea.css('z-index'));\n\t\tsignZ = parseInt(this.$signWindow.css('z-index'));\n\n\t\tif (transcriptZ === signZ) {\n\t\t\t// the two windows are equal; restore defaults (the target window will be on top)\n\t\t\tnewHighZ = defHighZ;\n\t\t\tnewLowZ = defLowZ;\n\t\t}\n\t\telse if (transcriptZ > signZ) {\n\t\t\tif (which === 'transcript') {\n\t\t\t\t// transcript is already on top; nothing to do\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// swap z's\n\t\t\t\tnewHighZ = transcriptZ;\n\t\t\t\tnewLowZ = signZ;\n\t\t\t}\n\t\t}\n\t\telse { // signZ is greater\n\t\t\tif (which === 'sign') {\n\t\t\t\t// sign is already on top; nothing to do\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnewHighZ = signZ;\n\t\t\t\tnewLowZ = transcriptZ;\n\t\t\t}\n\t\t}\n\t\t// now assign the new values\n\t\tif (which === 'transcript') {\n\t\t\tthis.$transcriptArea.css('z-index',newHighZ);\n\t\t\tthis.$signWindow.css('z-index',newLowZ);\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\tthis.$signWindow.css('z-index',newHighZ);\n\t\t\tthis.$transcriptArea.css('z-index',newLowZ);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.syncTrackLanguages = function (source, language) {\n\n\t\t// this function is called when the player is built (source == 'init')\n\t\t// and again when user changes the language of either 'captions' or 'transcript'\n\t\t// It syncs the languages of chapters, descriptions, and metadata tracks\n\t\t// NOTE: Caption and transcript languages are somewhat independent from one another\n\t\t// If a user changes the caption language, the transcript follows\n\t\t// However, if a user changes the transcript language, this only affects the transcript\n\t\t// This was a group decision based on the belief that users may want a transcript\n\t\t// that is in a different language than the captions\n\n\t\tvar i, captions, descriptions, chapters, meta, langHasChanged;\n\n\t\t// Captions\n\t\tfor (i = 0; i < this.captions.length; i++) {\n\t\t\tif (this.captions[i].language === language) {\n\t\t\t\tcaptions = this.captions[i];\n\t\t\t}\n\t\t}\n\t\t// Chapters\n\t\tfor (i = 0; i < this.chapters.length; i++) {\n\t\t\tif (this.chapters[i].language === language) {\n\t\t\t\tchapters = this.chapters[i];\n\t\t\t}\n\t\t}\n\t\t// Descriptions\n\t\tfor (i = 0; i < this.descriptions.length; i++) {\n\t\t\tif (this.descriptions[i].language === language) {\n\t\t\t\tdescriptions = this.descriptions[i];\n\t\t\t}\n\t\t}\n\t\t// Metadata\n\t\tfor (i = 0; i < this.meta.length; i++) {\n\t\t\tif (this.meta[i].language === language) {\n\t\t\t\tmeta = this.meta[i];\n\t\t\t}\n\t\t}\n\t\t// regardless of source...\n\t\tthis.transcriptLang = language;\n\t\tif (source === 'init' || source === 'captions') {\n\t\t\tthis.captionLang = language;\n\t\t\tthis.selectedCaptions = captions;\n\t\t\tthis.selectedChapters = chapters;\n\t\t\tthis.selectedDescriptions = descriptions;\n\t\t\tthis.selectedMeta = meta;\n\t\t\tthis.transcriptCaptions = captions;\n\t\t\tthis.transcriptChapters = chapters;\n\t\t\tthis.transcriptDescriptions = descriptions;\n\t\t\tthis.updateChaptersList();\n\t\t\t// the following was commented out in Oct/Nov 2018.\n\t\t\t// chapters popup is setup automatically when setupPopups() is called later with no param\n\t\t\t// not sure why it was included here.\n\t\t\t// this.setupPopups('chapters');\n\t\t}\n\t\telse if (source === 'transcript') {\n\t\t\tthis.transcriptCaptions = captions;\n\t\t\tthis.transcriptChapters = chapters;\n\t\t\tthis.transcriptDescriptions = descriptions;\n\t\t}\n\t\tif (this.selectedDescriptions) {\n\t\t\t// updating description voice to match new description language\t\t\t\n\t\t\tthis.setDescriptionVoice();\t\t\t\n\t\t\tif (this.$sampleDescDiv) { \n\t\t\t\tif (this.sampleText) { \n\t\t\t\t\tfor (i = 0; i < this.sampleText.length; i++) { \n\t\t\t\t\t\tif (this.sampleText[i].lang === this.selectedDescriptions.language) { \n\t\t\t\t\t\t\tthis.currentSampleText = this.sampleText[i]['text']; \n\t\t\t\t\t\t\tthis.$sampleDescDiv.html(this.currentSampleText); \n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.updateTranscript();\n\t};\n\n})(jQuery);\n\n(function ($) {\n\tAblePlayer.prototype.updateCaption = function (time) {\n\n\t\tif (!this.usingYouTubeCaptions && !this.usingVimeoCaptions && \n\t\t\t(typeof this.$captionsWrapper !== 'undefined')) {\n\t\t\tif (this.captionsOn) {\n\t\t\t\tthis.$captionsWrapper.show();\n\t\t\t\tif (typeof time !== 'undefined') {\n\t\t\t\t\tthis.showCaptions(time);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.$captionsWrapper) {\n\t\t\t\tthis.$captionsWrapper.hide();\n\t\t\t\tthis.prefCaptions = 0;\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.updateCaptionsMenu = function (lang) {\n\t\t\n\t\t// uncheck all previous menu items\n\t\tthis.captionsPopup.find('li').attr('aria-checked','false');\n\t\tif (typeof lang === 'undefined') {\n\t\t\t// check the last menu item (captions off)\n\t\t\tthis.captionsPopup.find('li').last().attr('aria-checked','true');\n\t\t}\n\t\telse {\n\t\t\t// check the newly selected lang\n\t\t\tthis.captionsPopup.find('li[lang=' + lang + ']').attr('aria-checked','true');\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getCaptionClickFunction = function (track) {\n\n\t\t// Returns the function used when a caption is clicked in the captions menu.\n\t\t// Not called if user clicks \"Captions off\". Instead, that triggers getCaptionOffFunction()\n\n\t\tvar thisObj = this;\n\t\treturn function () {\n\n\t\t\tthisObj.selectedCaptions = track;\n\t\t\tthisObj.captionLang = track.language;\n\t\t\tthisObj.currentCaption = -1;\n\t\t\tif (thisObj.usingYouTubeCaptions) {\n\t\t\t\tif (thisObj.captionsOn) {\n\t\t\t\t\t// Two things must be true in order for setOption() to work: \n\t\t\t\t\t// The YouTube caption module must be loaded \n\t\t\t\t\t// and the video must have started playing \n\t\t\t\t\tif (thisObj.youTubePlayer.getOptions('captions') && thisObj.startedPlaying) {\t\t\t\t\t\t\n\t\t\t\t\t\tthisObj.youTubePlayer.setOption('captions', 'track', {'languageCode': thisObj.captionLang});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// the two conditions were not met \n\t\t\t\t\t\t// try again to set the language after onApiChange event is triggered \n\t\t\t\t\t\t// meanwhile, the following variable will hold the value\n\t\t\t\t\t\tthisObj.captionLangPending = thisObj.captionLang;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (thisObj.youTubePlayer.getOptions('captions')) { \n\t\t\t\t\t\tthisObj.youTubePlayer.setOption('captions', 'track', {'languageCode': thisObj.captionLang});\n\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t\telse { \n\t\t\t\t\t\tthisObj.youTubePlayer.loadModule('captions');\n\t\t\t\t\t\tthisObj.captionLangPending = thisObj.captionLang; \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (thisObj.usingVimeoCaptions) {\n\t\t\t\tthisObj.vimeoPlayer.enableTextTrack(thisObj.captionLang).then(function(track) {\n\t\t\t\t\t// track.language = the iso code for the language\n\t\t\t\t\t// track.kind = 'captions' or 'subtitles'\n\t\t\t\t\t// track.label = the human-readable label\n\t\t\t\t}).catch(function(error) {\n\t\t\t\t\tswitch (error.name) {\n\t\t\t\t\t\tcase 'InvalidTrackLanguageError':\n\t\t\t\t\t\t\t// no track was available with the specified language\n\t\t\t\t\t\t\tconsole.log('No ' + track.kind + ' track is available in the specified language (' + track.label + ')');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'InvalidTrackError':\n\t\t\t\t\t\t\t// no track was available with the specified language and kind\n\t\t\t\t\t\t\tconsole.log('No ' + track.kind + ' track is available in the specified language (' + track.label + ')');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t// some other error occurred\n\t\t\t\t\t\t\tconsole.log('Error loading ' + track.label + ' ' + track.kind + ' track');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse { // using local track elements for captions/subtitles\n\t\t\t\tthisObj.syncTrackLanguages('captions',thisObj.captionLang);\n\t\t\t\tif (!thisObj.swappingSrc) {\n\t\t\t\t\tthisObj.updateCaption(thisObj.elapsed);\n\t\t\t\t\tthisObj.showDescription(thisObj.elapsed);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthisObj.captionsOn = true;\n\t\t\t// stopgap to prevent spacebar in Firefox from reopening popup\n\t\t\t// immediately after closing it (used in handleCaptionToggle())\n\t\t\tthisObj.hidingPopup = true;\n\t\t\tthisObj.captionsPopup.hide();\n\t\t\tthisObj.$ccButton.attr('aria-expanded', 'false');\n\t\t\tif (thisObj.mediaType === 'audio') {\n\t\t\t\tthisObj.$captionsContainer.removeClass('captions-off');\n\t\t\t}\n\t\t\t// Ensure stopgap gets cancelled if handleCaptionToggle() isn't called\n\t\t\t// e.g., if user triggered button with Enter or mouse click, not spacebar\n\t\t\tsetTimeout(function() {\n\t\t\t\tthisObj.hidingPopup = false;\n\t\t\t}, 100);\n\t\t\tthisObj.updateCaptionsMenu(thisObj.captionLang);\n\t\t\tthisObj.waitThenFocus(thisObj.$ccButton);\n\n\t\t\t// save preference to cookie\n\t\t\tthisObj.prefCaptions = 1;\n\t\t\tthisObj.updateCookie('prefCaptions');\n\t\t\tthisObj.refreshControls('captions');\n\t\t}\n\t};\n\n\t// Returns the function used when the \"Captions Off\" button is clicked in the captions tooltip.\n\tAblePlayer.prototype.getCaptionOffFunction = function () {\n\n\t\tvar thisObj = this;\n\t\treturn function () {\n\n\t\t\tif (thisObj.player == 'youtube') {\n\t\t\t\tthisObj.youTubePlayer.unloadModule('captions');\n\t\t\t}\n\t\t\telse if (thisObj.usingVimeoCaptions) {\n\t\t\t\tthisObj.vimeoPlayer.disableTextTrack();\n\t\t\t}\n\t\t\tthisObj.captionsOn = false;\n\t\t\tthisObj.currentCaption = -1;\n\n\t\t\tif (thisObj.mediaType === 'audio') {\n\t\t\t\tthisObj.$captionsContainer.addClass('captions-off');\n\t\t\t}\n\n\t\t\t// stopgap to prevent spacebar in Firefox from reopening popup\n\t\t\t// immediately after closing it (used in handleCaptionToggle())\n\t\t\tthisObj.hidingPopup = true;\n\t\t\tthisObj.captionsPopup.hide();\n\t\t\tthisObj.$ccButton.attr('aria-expanded', 'false');\n\t\t\t// Ensure stopgap gets cancelled if handleCaptionToggle() isn't called\n\t\t\t// e.g., if user triggered button with Enter or mouse click, not spacebar\n\t\t\tsetTimeout(function() {\n\t\t\t\tthisObj.hidingPopup = false;\n\t\t\t}, 100);\n\t\t\tthisObj.updateCaptionsMenu();\n\t\t\tthisObj.waitThenFocus(thisObj.$ccButton);\n\n\t\t\t// save preference to cookie\n\t\t\tthisObj.prefCaptions = 0;\n\t\t\tthisObj.updateCookie('prefCaptions');\n\t\t\tif (!this.swappingSrc) {\n\t\t\t\tthisObj.refreshControls('captions');\n\t\t\t\tthisObj.updateCaption();\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.showCaptions = function(now) {\n\n\t\tvar c, thisCaption, captionText;\n\t\tvar cues;\n\t\tif (this.selectedCaptions.cues.length) {\n\t\t\tcues = this.selectedCaptions.cues;\n\t\t}\n\t\telse if (this.captions.length >= 1) {\n\t\t\tcues = this.captions[0].cues;\n\t\t}\n\t\telse {\n\t\t\tcues = [];\n\t\t}\n\t\tfor (c = 0; c < cues.length; c++) {\n\t\t\tif ((cues[c].start <= now) && (cues[c].end > now)) {\n\t\t\t\tthisCaption = c;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (typeof thisCaption !== 'undefined') {\n\t\t\tif (this.currentCaption !== thisCaption) {\n\t\t\t\t// it's time to load the new caption into the container div\n\t\t\t\tcaptionText = this.flattenCueForCaption(cues[thisCaption]).replace('\\n', '<br>');\n\t\t\t\tthis.$captionsDiv.html(captionText);\n\t\t\t\tthis.currentCaption = thisCaption;\n\t\t\t\tif (captionText.length === 0) {\n\t\t\t\t\t// hide captionsDiv; otherwise background-color is visible due to padding\n\t\t\t\t\tthis.$captionsDiv.css('display','none');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.$captionsDiv.css('display','inline-block');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\t\t\t\n\t\t\tthis.$captionsDiv.html('').css('display','none');\n\t\t\tthis.currentCaption = -1;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.flattenCueForCaption = function (cue) {\n\n\t\t// Takes a cue and returns the caption text to display\n\t\t// Also used for chapters\n\n\t\t// Support for 'i' and 'b' tags added in 2.3.66\n\t\t// TODO: Add support for 'c' (class) and 'ruby'\n\n\t\t// c (class): <c.myClass1.myClass2>Some text</c>\n\t\t// Classes can be used to modify other tags too (e.g., <v.loud>)\n\t\t// If <c> tag, should be rendered as a <span>\n\n\t\t// ruby: http://www.w3schools.com/tags/tag_ruby.asp\n\n\t\t// WebVTT also supports 'u' (underline)\n\t\t// I see no reason to support that in Able Player.\n\t\t// If it's available authors are likely to use it incorrectly\n\t\t// where <i> or <b> should be used instead\n\t\t// Here are the rare use cases where an underline is appropriate on the web:\n\t\t// http://html5doctor.com/u-element/\n\n\t\tvar result = [];\n\n\t\tvar flattenComponent = function (component) {\n\t\t\tvar result = [], ii;\n\t\t\tif (component.type === 'string') {\n\t\t\t\tresult.push(component.value);\n\t\t\t}\n\t\t\telse if (component.type === 'v') {\n\t\t\t\tresult.push('(' + component.value + ')');\n\t\t\t\tfor (ii = 0; ii < component.children.length; ii++) {\n\t\t\t\t\tresult.push(flattenComponent(component.children[ii]));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (component.type === 'i') {\n\t\t\t\tresult.push('<em>');\n\t\t\t\tfor (ii = 0; ii < component.children.length; ii++) {\n\t\t\t\t\tresult.push(flattenComponent(component.children[ii]));\n\t\t\t\t}\n\t\t\t\tresult.push('</em>');\n\t\t\t}\n\t\t\telse if (component.type === 'b') {\n\t\t\t\tresult.push('<strong>');\n\t\t\t\tfor (ii = 0; ii < component.children.length; ii++) {\n\t\t\t\t\tresult.push(flattenComponent(component.children[ii]));\n\t\t\t\t}\n\t\t\t\tresult.push('</strong>');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (ii = 0; ii < component.children.length; ii++) {\n\t\t\t\t\tresult.push(flattenComponent(component.children[ii]));\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result.join('');\n\t\t};\n\n\t\tif (typeof cue.components !== 'undefined') {\n\t\t\tfor (var ii = 0; ii < cue.components.children.length; ii++) {\n\t\t\t\tresult.push(flattenComponent(cue.components.children[ii]));\n\t\t\t}\n\t\t}\n\t\treturn result.join('');\n\t};\n\n\tAblePlayer.prototype.getCaptionsOptions = function(pref) {\n\n\t\tvar options = [];\n\n\t\tswitch (pref) {\n\n\t\t\tcase 'prefCaptionsFont':\n\t\t\t\toptions[0] = ['serif',this.tt.serif];\n\t\t\t\toptions[1] = ['sans-serif',this.tt.sans];\n\t\t\t\toptions[2] = ['cursive',this.tt.cursive];\n\t\t\t\toptions[3] = ['fantasy',this.tt.fantasy];\n\t\t\t\toptions[4] = ['monospace',this.tt.monospace];\n\t\t\t\tbreak;\n\n\t\t\tcase 'prefCaptionsColor':\n\t\t\tcase 'prefCaptionsBGColor':\n\t\t\t\t// HTML color values must be in English\n\t\t\t\toptions[0] = ['white',this.tt.white];\n\t\t\t\toptions[1] = ['yellow',this.tt.yellow];\n\t\t\t\toptions[2] = ['green',this.tt.green];\n\t\t\t\toptions[3] = ['cyan',this.tt.cyan];\n\t\t\t\toptions[4] = ['blue',this.tt.blue];\n\t\t\t\toptions[5] = ['magenta',this.tt.magenta];\n\t\t\t\toptions[6] = ['red',this.tt.red];\n\t\t\t\toptions[7] = ['black',this.tt.black];\n\t\t\t\tbreak;\n\n\t\t\tcase 'prefCaptionsSize':\n\t\t\t\toptions[0] = '75%';\n\t\t\t\toptions[1] = '100%';\n\t\t\t\toptions[2] = '125%';\n\t\t\t\toptions[3] = '150%';\n\t\t\t\toptions[4] = '200%';\n\t\t\t\tbreak;\n\n\t\t\tcase 'prefCaptionsOpacity':\n\t\t\t\toptions[0] = '0%';\n\t\t\t\toptions[1] = '25%';\n\t\t\t\toptions[2] = '50%';\n\t\t\t\toptions[3] = '75%';\n\t\t\t\toptions[4] = '100%';\n\t\t\t\tbreak;\n\n\t\t\tcase 'prefCaptionsStyle':\n\t\t\t\toptions[0] = this.tt.captionsStylePopOn;\n\t\t\t\toptions[1] = this.tt.captionsStyleRollUp;\n\t\t\t\tbreak;\n\n\t\t\tcase 'prefCaptionsPosition':\n\t\t\t\toptions[0] = 'overlay';\n\t\t\t\toptions[1] = 'below';\n\t\t\t\tbreak;\n\n\t\t}\n\t\treturn options;\n\t};\n\n\tAblePlayer.prototype.translatePrefs = function(pref, value, outputFormat) {\n\n\t\t// translate current value of pref to a value supported by outputformat\n\t\tif (outputFormat == 'youtube') {\n\t\t\tif (pref === 'size') {\n\t\t\t\t// YouTube font sizes are a range from -1 to 3 (0 = default)\n\t\t\t\tswitch (value) {\n\t\t\t\t\tcase '75%':\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\tcase '100%':\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\tcase '125%':\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\tcase '150%':\n\t\t\t\t\t\treturn 2;\n\t\t\t\t\tcase '200%':\n\t\t\t\t\t\treturn 3;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tAblePlayer.prototype.stylizeCaptions = function($element, pref) {\n\n\t\t// $element is the jQuery element containing the captions\n\t\t// this function handles stylizing of the sample caption text in the Prefs dialog\n\t\t// plus the actual production captions\n\t\t// TODO: consider applying the same user prefs to visible text-based description\n\t\tvar property, newValue, opacity, lineHeight;\n\n\t\tif (typeof $element !== 'undefined') {\n\t\t\tif (pref == 'prefCaptionsPosition') {\n\t\t\t\tthis.positionCaptions();\n\t\t\t}\n\t\t\telse if (typeof pref !== 'undefined') {\n\t\t\t\t// just change the one property that user just changed\n\t\t\t\tif (pref === 'prefCaptionsFont') {\n\t\t\t\t\tproperty = 'font-family';\n\t\t\t\t}\n\t\t\t\telse if (pref === 'prefCaptionsSize') {\n\t\t\t\t\tproperty = 'font-size';\n\t\t\t\t}\n\t\t\t\telse if (pref === 'prefCaptionsColor') {\n\t\t\t\t\tproperty = 'color';\n\t\t\t\t}\n\t\t\t\telse if (pref === 'prefCaptionsBGColor') {\n\t\t\t\t\tproperty = 'background-color';\n\t\t\t\t}\n\t\t\t\telse if (pref === 'prefCaptionsOpacity') {\n\t\t\t\t\tproperty = 'opacity';\n\t\t\t\t}\n\t\t\t\tif (pref === 'prefCaptionsOpacity') {\n\t\t\t\t\tnewValue = parseFloat($('#' + this.mediaId + '_' + pref).val()) / 100.0;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tnewValue = $('#' + this.mediaId + '_' + pref).val();\n\t\t\t\t}\n\t\t\t\t$element.css(property, newValue);\n\t\t\t}\n\t\t\telse { // no property was specified, update all styles with current saved prefs\n\t\t\t\topacity = parseFloat(this.prefCaptionsOpacity) / 100.0;\n\t\t\t\t$element.css({\n\t\t\t\t\t'font-family': this.prefCaptionsFont,\n\t\t\t\t\t'color': this.prefCaptionsColor,\n\t\t\t\t\t'background-color': this.prefCaptionsBGColor,\n\t\t\t\t\t'opacity': opacity\n\t\t\t\t});\n\t\t\t\tif ($element === this.$captionsDiv) {\n\t\t\t\t\tif (typeof this.$captionsDiv !== 'undefined') {\n\t\t\t\t\t\tthis.$captionsDiv.css({\n\t\t\t\t\t\t\t'font-size': this.prefCaptionsSize\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.prefCaptionsPosition === 'below') {\n\t\t\t\t\t// also need to add the background color to the wrapper div\n\t\t\t\t\tif (typeof this.$captionsWrapper !== 'undefined') {\n\t\t\t\t\t\tthis.$captionsWrapper.css({\n\t\t\t\t\t\t\t'background-color': this.prefCaptionsBGColor,\n\t\t\t\t\t\t\t'opacity': '1'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (this.prefCaptionsPosition === 'overlay') {\n\t\t\t\t\t// no background color for overlay wrapper, captions are displayed in-line\n\t\t\t\t\tif (typeof this.$captionsWrapper !== 'undefined') {\n\t\t\t\t\t\tthis.$captionsWrapper.css({\n\t\t\t\t\t\t\t'background-color': 'transparent',\n\t\t\t\t\t\t\t'opacity': ''\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.positionCaptions();\n\t\t\t}\n\t\t}\n\t};\n\tAblePlayer.prototype.positionCaptions = function(position) {\n\n\t\t// set caption position to either 'overlay' or 'below'\n\t\t// if position parameter was passed to this function, use that\n\t\t// otherwise use user preference\n\t\tif (typeof position === 'undefined') {\n\t\t\tposition = this.prefCaptionsPosition;\n\t\t}\n\t\tif (typeof this.$captionsWrapper !== 'undefined') {\n\n\t\t\tif (position == 'below') {\n\t\t\t\tthis.$captionsWrapper.removeClass('able-captions-overlay').addClass('able-captions-below');\n\t\t\t\t// also need to update in-line styles\n\t\t\t\tthis.$captionsWrapper.css({\n\t\t\t\t\t'background-color': this.prefCaptionsBGColor,\n\t\t\t\t\t'opacity': '1'\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.$captionsWrapper.removeClass('able-captions-below').addClass('able-captions-overlay');\n\t\t\t\tthis.$captionsWrapper.css({\n\t\t\t\t\t'background-color': 'transparent',\n\t\t\t\t\t'opacity': ''\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n})(jQuery);\n\n(function ($) {\n\n\tAblePlayer.prototype.populateChaptersDiv = function() {\n\n\t\tvar headingLevel, headingType, headingId, $chaptersHeading,\n\t\t\t$chaptersList;\n\n\t\tif ($('#' + this.chaptersDivLocation)) {\n\n\t\t\tthis.$chaptersDiv = $('#' + this.chaptersDivLocation);\n\t\t\tthis.$chaptersDiv.addClass('able-chapters-div');\n\n\t\t\t// empty content from previous build before starting fresh\n\t\t\tthis.$chaptersDiv.empty(); \n\n\t\t\t// add optional header\n\t\t\tif (this.chaptersTitle) {\n\t\t\t\theadingLevel = this.getNextHeadingLevel(this.$chaptersDiv);\n\t\t\t\theadingType = 'h' + headingLevel.toString();\n\t\t\t\theadingId = this.mediaId + '-chapters-heading';\n\t\t\t\t$chaptersHeading = $('<' + headingType + '>', {\n\t\t\t\t\t'class': 'able-chapters-heading',\n\t\t\t\t\t'id': headingId\n\t\t\t\t}).text(this.chaptersTitle);\n\t\t\t\tthis.$chaptersDiv.append($chaptersHeading);\n\t\t\t}\n\n\t\t\tthis.$chaptersNav = $('<nav>');\n\t\t\tif (this.chaptersTitle) {\n\t\t\t\tthis.$chaptersNav.attr('aria-labelledby',headingId);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.$chaptersNav.attr('aria-label',this.tt.chapters);\n\t\t\t}\n\t\t\tthis.$chaptersDiv.append(this.$chaptersNav);\n\n\t\t\t// populate this.$chaptersNav with a list of chapters\n\t\t\tthis.updateChaptersList();\n\t\t}\n\t};\n\n\tAblePlayer.prototype.updateChaptersList = function() {\n\n\t\tvar thisObj, cues, $chaptersList, c, thisChapter,\n\t\t\t$chapterItem, $chapterButton, buttonId, hasDefault,\n\t\t\tgetClickFunction, $clickedItem, $chaptersList, thisChapterIndex;\n\n\t\tthisObj = this;\n\n\t\t// TODO: Update this so it can change the chapters popup menu \n\t\t// currently it only works if chapters are in an external container\n\t\tif (!this.$chaptersNav) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof this.useChapterTimes === 'undefined') {\n\t\t\tif (this.seekbarScope === 'chapter' && this.selectedChapters.cues.length) {\n\t\t\t\tthis.useChapterTimes = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.useChapterTimes = false;\n\t\t\t}\n\t\t}\n\t\tif (this.useChapterTimes) {\n\t\t\tcues = this.selectedChapters.cues;\n\t\t}\n\t\telse if (this.chapters.length >= 1) {\n\t\t\tcues = this.chapters[0].cues;\n\t\t}\n\t\telse {\n\t\t\tcues = [];\n\t\t}\n\t\tif (cues.length > 0) {\n\t\t\t$chaptersList = $('<ul>');\n\t\t\tfor (c = 0; c < cues.length; c++) {\n\t\t\t\tthisChapter = c;\n\t\t\t\t$chapterItem = $('<li></li>');\n\t\t\t\t$chapterButton = $('<button>',{\n\t\t\t\t\t'type': 'button',\n\t\t\t\t\t'val': thisChapter\n\t\t\t\t}).text(this.flattenCueForCaption(cues[thisChapter]));\n\n\t\t\t\t// add event listeners\n\t\t\t\tgetClickFunction = function (time) {\n\t\t\t\t\treturn function () {\n\t\t\t\t\t\tthisObj.seekTrigger = 'chapter';\n\t\t\t\t\t\t$clickedItem = $(this).closest('li');\n\t\t\t\t\t\t$chaptersList = $(this).closest('ul').find('li');\n\t\t\t\t\t\tthisChapterIndex = $chaptersList.index($clickedItem);\n\t\t\t\t\t\t$chaptersList.removeClass('able-current-chapter')\n\t\t\t\t\t\t\t.children('button').removeAttr('aria-current');\n\t\t\t\t\t\t$clickedItem.addClass('able-current-chapter')\n\t\t\t\t\t\t\t.children('button').attr('aria-current','true');\n\t\t\t\t\t\t// Need to updateChapter before seeking to it\n\t\t\t\t\t\t// Otherwise seekBar is redrawn with wrong chapterDuration and/or chapterTime\n\t\t\t\t\t\tthisObj.updateChapter(time);\n\t\t\t\t\t\tthisObj.seekTo(time);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t$chapterButton.on('click',getClickFunction(cues[thisChapter].start)); // works with Enter too\n\t\t\t\t$chapterButton.on('focus',function() {\n\t\t\t\t\t$(this).closest('ul').find('li').removeClass('able-focus');\n\t\t\t\t\t$(this).closest('li').addClass('able-focus');\n\t\t\t\t});\n\t\t\t\t$chapterItem.on('hover',function() {\n\t\t\t\t\t$(this).closest('ul').find('li').removeClass('able-focus');\n\t\t\t\t\t$(this).addClass('able-focus');\n\t\t\t\t});\n\t\t\t\t$chapterItem.on('mouseleave',function() {\n\t\t\t\t\t$(this).removeClass('able-focus');\n\t\t\t\t});\n\t\t\t\t$chapterButton.on('blur',function() {\n\t\t\t\t\t$(this).closest('li').removeClass('able-focus');\n\t\t\t\t});\n\n\t\t\t\t// put it all together\n\t\t\t\t$chapterItem.append($chapterButton);\n\t\t\t\t$chaptersList.append($chapterItem);\n\t\t\t\tif (this.defaultChapter === cues[thisChapter].id) {\n\t\t\t\t\t$chapterButton.attr('aria-current','true').parent('li').addClass('able-current-chapter');\n\t\t\t\t\tthis.currentChapter = cues[thisChapter];\n\t\t\t\t\thasDefault = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!hasDefault) {\n\t\t\t\t// select the first chapter\n\t\t\t\tthis.currentChapter = cues[0];\n\t\t\t\t$chaptersList.find('button').first().attr('aria-current','true')\n\t\t\t\t\t.parent('li').addClass('able-current-chapter');\n\t\t\t}\n\t\t\tthis.$chaptersNav.html($chaptersList);\n\t\t}\n\t\treturn false;\n\t};\n\n\tAblePlayer.prototype.seekToChapter = function(chapterId) {\n\n\t\t// step through chapters looking for matching ID\n\t\tvar i=0;\n\t\twhile (i < this.selectedChapters.cues.length) {\n\t\t\tif (this.selectedChapters.cues[i].id == chapterId) {\n\t\t\t\t// found the target chapter! Seek to it\n\t\t\t\tthis.seekTo(this.selectedChapters.cues[i].start);\n\t\t\t\tthis.updateChapter(this.selectedChapters.cues[i].start);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.updateChapter = function (now) {\n\n\t\t// as time-synced chapters change during playback, track changes in current chapter\n\t\tif (typeof this.selectedChapters === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tvar chapters, i, thisChapterIndex, chapterLabel;\n\n\t\tchapters = this.selectedChapters.cues;\n\t\tfor (i = 0; i < chapters.length; i++) {\n\t\t\tif ((chapters[i].start <= now) && (chapters[i].end > now)) {\n\t\t\t\tthisChapterIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (typeof thisChapterIndex !== 'undefined') {\n\t\t\tif (this.currentChapter !== chapters[thisChapterIndex]) {\n\t\t\t\t// this is a new chapter\n\t\t\t\tthis.currentChapter = chapters[thisChapterIndex];\n\t\t\t\tif (this.useChapterTimes) {\n\t\t\t\t\tthis.chapterDuration = this.getChapterDuration();\n\t\t\t\t\tthis.seekIntervalCalculated = false; // will be recalculated in setSeekInterval()\n\t\t\t\t}\n\t\t\t\tif (typeof this.$chaptersDiv !== 'undefined') {\n\t\t\t\t\t// chapters are listed in an external container\n\t\t\t\t\tthis.$chaptersDiv.find('ul').find('li')\n\t\t\t\t\t\t.removeClass('able-current-chapter')\n\t\t\t\t\t\t.children('button').removeAttr('aria-current');\n\t\t\t\t\tthis.$chaptersDiv.find('ul').find('li').eq(thisChapterIndex)\n\t\t\t\t\t\t.addClass('able-current-chapter')\n\t\t\t\t\t\t.children('button').attr('aria-current','true');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getChapterDuration = function () {\n\n\t\t// called if this.seekbarScope === 'chapter'\n\t\t// get duration of the current chapter\n\n\t\tvar lastChapterIndex, chapterEnd;\n\n\t\tif (typeof this.currentChapter === 'undefined') {\n\t\t\treturn 0;\n\t\t}\n\t\tif (typeof this.duration === 'undefined') {\n\t\t\treturn 0;\n\t\t}\n\t\tlastChapterIndex = this.selectedChapters.cues.length-1;\n\t\tif (this.selectedChapters.cues[lastChapterIndex] == this.currentChapter) {\n\t\t\t// this is the last chapter\n\t\t\tif (this.currentChapter.end !== this.duration) {\n\t\t\t\t// chapter ends before or after video ends, adjust chapter end to match video end\n\t\t\t\tchapterEnd = this.duration;\n\t\t\t\tthis.currentChapter.end = this.duration;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tchapterEnd = this.currentChapter.end;\n\t\t\t}\n\t\t}\n\t\telse { // this is not the last chapter\n\t\t\tchapterEnd = this.currentChapter.end;\n\t\t}\n\t\treturn chapterEnd - this.currentChapter.start;\n\t};\n\n\tAblePlayer.prototype.getChapterElapsed = function () {\n\t\t// called if this.seekbarScope === 'chapter'\n\t\t// get current elapsed time, relative to the current chapter duration\n\n\t\tif (typeof this.currentChapter === 'undefined') {\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (this.elapsed > this.currentChapter.start) {\n\t\t\treturn this.elapsed - this.currentChapter.start;\n\t\t}\n\t\telse {\n\t\t\treturn 0;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.convertChapterTimeToVideoTime = function (chapterTime) {\n\n\t\t// chapterTime is the time within the current chapter\n\t\t// return the same time, relative to the entire video\n\t\tif (typeof this.currentChapter !== 'undefined') {\n\t\t\tvar newTime = this.currentChapter.start + chapterTime;\n\t\t\tif (newTime > this.currentChapter.end) {\n\t\t\t\treturn this.currentChapter.end;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn newTime;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\treturn chapterTime;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getChapterClickFunction = function (time) {\n\n\t\t// Returns the function used when a chapter is clicked in the chapters menu.\n\t\tvar thisObj = this;\n\t\treturn function () {\n\t\t\tthisObj.seekTrigger = 'chapter';\n\t\t\tthisObj.seekTo(time);\n\t\t\t// stopgap to prevent spacebar in Firefox from reopening popup\n\t\t\t// immediately after closing it (used in handleChapters())\n\t\t\tthisObj.hidingPopup = true;\n\t\t\tthisObj.chaptersPopup.hide();\n\t\t\t// Ensure stopgap gets cancelled if handleChapters() isn't called\n\t\t\t// e.g., if user triggered button with Enter or mouse click, not spacebar\n\t\t\tsetTimeout(function() {\n\t\t\t\tthisObj.hidingPopup = false;\n\t\t\t}, 100);\n\t\t\tthisObj.$chaptersButton.focus();\n\t\t}\n\t};\n\n})(jQuery);\n\n(function ($) {\n\tAblePlayer.prototype.updateMeta = function (time) {\n\t\tif (this.hasMeta) {\n\t\t\tif (this.metaType === 'text') {\n\t\t\t\tthis.$metaDiv.show();\n\t\t\t\tthis.showMeta(time || this.elapsed);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.showMeta(time || this.elapsed);\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.showMeta = function(now) {\n\t\tvar tempSelectors, m, thisMeta,\n\t\t\tcues, cueText, cueLines, i, line,\n\t\t\tshowDuration, focusTarget;\n\n\t\ttempSelectors = [];\n\t\tif (this.meta.length >= 1) {\n\t\t\tcues = this.meta;\n\t\t}\n\t\telse {\n\t\t\tcues = [];\n\t\t}\n\t\tfor (m = 0; m < cues.length; m++) {\n\t\t\tif ((cues[m].start <= now) && (cues[m].end > now)) {\n\t\t\t\tthisMeta = m;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (typeof thisMeta !== 'undefined') {\n\t\t\tif (this.currentMeta !== thisMeta) {\n\t\t\t\tif (this.metaType === 'text') {\n\t\t\t\t\t// it's time to load the new metadata cue into the container div\n\t\t\t\t\tthis.$metaDiv.html(this.flattenCueForMeta(cues[thisMeta]).replace('\\n', '<br>'));\n\t\t\t\t}\n\t\t\t\telse if (this.metaType === 'selector') {\n\t\t\t\t\t// it's time to show content referenced by the designated selector(s)\n\t\t\t\t\tcueText = this.flattenCueForMeta(cues[thisMeta]);\n\t\t\t\t\tcueLines = cueText.split('\\n');\n\t\t\t\t\tfor (i=0; i<cueLines.length; i++) {\n\t\t\t\t\t\tline = $.trim(cueLines[i]);\n\t\t\t\t\t\tif (line.toLowerCase().trim() === 'pause') {\n\t\t\t\t\t\t\t// don't show big play button when pausing via metadata\n\t\t\t\t\t\t\tthis.hideBigPlayButton = true;\n\t\t\t\t\t\t\tthis.pauseMedia();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (line.toLowerCase().substring(0,6) == 'focus:') {\n\t\t\t\t\t\t\tfocusTarget = line.substring(6).trim();\n\t\t\t\t\t\t\tif ($(focusTarget).length) {\n\t\t\t\t\t\t\t\t$(focusTarget).focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif ($(line).length) {\n\t\t\t\t\t\t\t\t// selector exists\n\t\t\t\t\t\t\t\tthis.currentMeta = thisMeta;\n\t\t\t\t\t\t\t\tshowDuration = parseInt($(line).attr('data-duration'));\n\t\t\t\t\t\t\t\tif (typeof showDuration !== 'undefined' && !isNaN(showDuration)) {\n\t\t\t\t\t\t\t\t\t$(line).show().delay(showDuration).fadeOut();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t// no duration specified. Just show the element until end time specified in VTT file\n\t\t\t\t\t\t\t\t\t$(line).show();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// add to array of visible selectors so it can be hidden at end time\n\t\t\t\t\t\t\t\tthis.visibleSelectors.push(line);\n\t\t\t\t\t\t\t\ttempSelectors.push(line);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// now step through this.visibleSelectors and remove anything that's stale\n\t\t\t\t\tif (this.visibleSelectors && this.visibleSelectors.length) {\n\t\t\t\t\t\tif (this.visibleSelectors.length !== tempSelectors.length) {\n\t\t\t\t\t\t\tfor (i=this.visibleSelectors.length-1; i>=0; i--) {\n\t\t\t\t\t\t\t\tif ($.inArray(this.visibleSelectors[i],tempSelectors) == -1) {\n\t\t\t\t\t\t\t\t\t$(this.visibleSelectors[i]).hide();\n\t\t\t\t\t\t\t\t\tthis.visibleSelectors.splice(i,1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// there is currently no metadata. Empty stale content\n\t\t\tif (typeof this.$metaDiv !== 'undefined') {\n\t\t\t\tthis.$metaDiv.html('');\n\t\t\t}\n\t\t\tif (this.visibleSelectors && this.visibleSelectors.length) {\n\t\t\t\tfor (i=0; i<this.visibleSelectors.length; i++) {\n\t\t\t\t\t$(this.visibleSelectors[i]).hide();\n\t\t\t\t}\n\t\t\t\t// reset array\n\t\t\t\tthis.visibleSelectors = [];\n\t\t\t}\n\t\t\tthis.currentMeta = -1;\n\t\t}\n\t};\n\n\t// Takes a cue and returns the metadata text to display for it.\n\tAblePlayer.prototype.flattenCueForMeta = function (cue) {\n\t\tvar result = [];\n\n\t\tvar flattenComponent = function (component) {\n\t\t\tvar result = [], ii;\n\t\t\tif (component.type === 'string') {\n\t\t\t\tresult.push(component.value);\n\t\t\t}\n\t\t\telse if (component.type === 'v') {\n\t\t\t\tresult.push('[' + component.value + ']');\n\t\t\t\tfor (ii = 0; ii < component.children.length; ii++) {\n\t\t\t\t\tresult.push(flattenComponent(component.children[ii]));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (ii = 0; ii < component.children.length; ii++) {\n\t\t\t\t\tresult.push(flattenComponent(component.children[ii]));\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result.join('');\n\t\t}\n\n\t\tfor (var ii = 0; ii < cue.components.children.length; ii++) {\n\t\t\tresult.push(flattenComponent(cue.components.children[ii]));\n\t\t}\n\n\t\treturn result.join('');\n\t};\n\n})(jQuery);\n\n(function ($) {\n\n\tAblePlayer.prototype.setupTranscript = function() {\n\n\t\tvar deferred = new $.Deferred();\n\t\tvar promise = deferred.promise();\n\n\t\tif (this.usingYouTubeCaptions || this.usingVimeoCaptions) { \n\t\t\t// a transcript is not possible \n\t\t\tthis.transcriptType = null; \n\t\t\tdeferred.resolve();\n\t\t}\n\t\telse { \n\t\t\tif (!this.transcriptType) {\n\t\t\t\t// previously set transcriptType to null since there are no <track> elements\n\t\t\t\t// check again to see if captions have been collected from other sources (e.g., YouTube)\n\n\t\t\t\tif (this.captions.length) {\n\t\t\t\t\t// captions are possible! Use the default type (popup)\n\t\t\t\t\t// if other types ('external' and 'manual') were desired, transcriptType would not be null here\n\t\t\t\t\tthis.transcriptType = 'popup';\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.transcriptType) {\n\t\t\t\tif (this.transcriptType === 'popup' || this.transcriptType === 'external') {\n\t\t\t\t\tthis.injectTranscriptArea();\n\t\t\t\t\tdeferred.resolve();\n\t\t\t\t}\n\t\t\t\telse if (this.transcriptType === 'manual') {\n\t\t\t\t\tthis.setupManualTranscript();\n\t\t\t\t\tdeferred.resolve();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// there is no transcript\n\t\t\t\tdeferred.resolve();\n\t\t\t}\n\t\t}\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.injectTranscriptArea = function() {\n\n\t\tvar thisObj, $autoScrollLabel, $languageSelectWrapper, $languageSelectLabel, i, $option;\n\n\t\tthisObj = this;\n\t\tthis.$transcriptArea = $('<div>', {\n\t\t\t'class': 'able-transcript-area',\n\t\t\t'role': 'dialog',\n\t\t\t'aria-label': this.tt.transcriptTitle\n\t\t});\n\n\t\tthis.$transcriptToolbar = $('<div>', {\n\t\t\t'class': 'able-window-toolbar able-' + this.toolbarIconColor + '-controls'\n\t\t});\n\n\t\tthis.$transcriptDiv = $('<div>', {\n\t\t\t'class' : 'able-transcript'\n\t\t});\n\n\t\t// Transcript toolbar content\n\n\t\t// Add auto Scroll checkbox\n\t\tthis.$autoScrollTranscriptCheckbox = $('<input>', {\n\t\t\t'id': 'autoscroll-transcript-checkbox-' + this.mediaId,\n\t\t\t'type': 'checkbox'\n\t\t});\n\t\t$autoScrollLabel = $('<label>', {\n\t\t\t\t'for': 'autoscroll-transcript-checkbox-' + this.mediaId\n\t\t}).text(this.tt.autoScroll);\n\t\tthis.$transcriptToolbar.append($autoScrollLabel,this.$autoScrollTranscriptCheckbox);\n\n\t\t// Add field for selecting a transcript language\n\t\t// Only necessary if there is more than one language\n\t\tif (this.captions.length > 1) {\n\t\t\t$languageSelectWrapper = $('<div>',{\n\t\t\t\t'class': 'transcript-language-select-wrapper'\n\t\t\t});\n\t\t\t$languageSelectLabel = $('<label>',{\n\t\t\t\t'for': 'transcript-language-select-' + this.mediaId\n\t\t\t}).text(this.tt.language);\n\t\t\tthis.$transcriptLanguageSelect = $('<select>',{\n\t\t\t\t'id': 'transcript-language-select-' + this.mediaId\n\t\t\t});\n\t\t\tfor (i=0; i < this.captions.length; i++) {\n\t\t\t\t$option = $('<option></option>',{\n\t\t\t\t\tvalue: this.captions[i]['language'],\n\t\t\t\t\tlang: this.captions[i]['language']\n\t\t\t\t}).text(this.captions[i]['label']);\n\t\t\t\tif (this.captions[i]['def']) {\n\t\t\t\t\t$option.prop('selected',true);\n\t\t\t\t }\n\t\t\t\tthis.$transcriptLanguageSelect.append($option);\n\t\t\t }\n\t\t}\n\t\tif ($languageSelectWrapper) {\n\t\t\t$languageSelectWrapper.append($languageSelectLabel,this.$transcriptLanguageSelect);\n\t\t\tthis.$transcriptToolbar.append($languageSelectWrapper);\n\t\t}\n\t\tthis.$transcriptArea.append(this.$transcriptToolbar, this.$transcriptDiv);\n\n\t\t// If client has provided separate transcript location, put it there.\n\t\t// Otherwise append it to the body\n\t\tif (this.transcriptDivLocation) {\n\t\t\t$('#' + this.transcriptDivLocation).append(this.$transcriptArea);\n\t\t}\n\t\telse {\n\t\t\tthis.$ableWrapper.append(this.$transcriptArea);\n\t\t}\n\n\t\t// make it draggable (popup only; NOT external transcript)\n\t\tif (!this.transcriptDivLocation) {\n\t\t\tthis.initDragDrop('transcript');\n\t\t\tif (this.prefTranscript === 1) {\n\t\t\t\t// transcript is on. Go ahead and position it\n\t\t\t\tthis.positionDraggableWindow('transcript',this.getDefaultWidth('transcript'));\n\t\t\t}\n\t\t}\n\n\t\t// If client has provided separate transcript location, override user's preference for hiding transcript\n\t\tif (!this.prefTranscript && !this.transcriptDivLocation) {\n\t\t\tthis.$transcriptArea.hide();\n\t\t}\n\t};\n\n\tAblePlayer.prototype.addTranscriptAreaEvents = function() {\n\n\t\tvar thisObj = this;\n\n\t\tthis.$autoScrollTranscriptCheckbox.click(function () {\n\t\t\tthisObj.handleTranscriptLockToggle(thisObj.$autoScrollTranscriptCheckbox.prop('checked'));\n\t\t});\n\n\t\tthis.$transcriptDiv.on('mousewheel DOMMouseScroll click scroll', function (e) {\n\t\t\t// Propagation is stopped in transcript click handler, so clicks are on the scrollbar\n\t\t\t// or outside of a clickable span.\n\t\t\tif (!thisObj.scrollingTranscript) {\n\t\t\t\tthisObj.autoScrollTranscript = false;\n\t\t\t\tthisObj.refreshControls('transcript');\n\t\t\t}\n\t\t\tthisObj.scrollingTranscript = false;\n\t\t});\n\n\t\tif (typeof this.$transcriptLanguageSelect !== 'undefined') {\n\n\t\t\tthis.$transcriptLanguageSelect.on('click mousedown',function (e) {\n\t\t\t\t// execute default behavior\n\t\t\t\t// prevent propagation of mouse event to toolbar or window\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\n\t\t\tthis.$transcriptLanguageSelect.on('change',function () {\n\n\t\t\t\tvar language = thisObj.$transcriptLanguageSelect.val();\n\n\t\t\t\tthisObj.syncTrackLanguages('transcript',language);\n\t\t\t});\n\t\t}\n\t};\n\n\tAblePlayer.prototype.transcriptSrcHasRequiredParts = function() {\n\n\t\t// check the external transcript to be sure it has all required components\n\t\t// return true or false\n\t\t// in the process, define all the needed variables and properties\n\n\t\tif ($('#' + this.transcriptSrc).length) {\n\t\t\tthis.$transcriptArea = $('#' + this.transcriptSrc);\n\t\t\tif (this.$transcriptArea.find('.able-window-toolbar').length) {\n\t\t\t\tthis.$transcriptToolbar = this.$transcriptArea.find('.able-window-toolbar').eq(0);\n\t\t\t\tif (this.$transcriptArea.find('.able-transcript').length) {\n\t\t\t\t\tthis.$transcriptDiv = this.$transcriptArea.find('.able-transcript').eq(0);\n\t\t\t\t\tif (this.$transcriptArea.find('.able-transcript-seekpoint').length) {\n\t\t\t\t\t\tthis.$transcriptSeekpoints = this.$transcriptArea.find('.able-transcript-seekpoint');\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tAblePlayer.prototype.setupManualTranscript = function() {\n\n\t\tvar $autoScrollInput, $autoScrollLabel;\n\n\t\t$autoScrollInput = $('<input>', {\n\t\t\t'id': 'autoscroll-transcript-checkbox-' + this.mediaId,\n\t\t\t'type': 'checkbox'\n\t\t});\n\t\t$autoScrollLabel = $('<label>', {\n\t\t\t\t'for': 'autoscroll-transcript-checkbox-' + this.mediaId\n\t\t}).text(this.tt.autoScroll);\n\n\t\t// Add an auto-scroll checkbox to the toolbar.\n\t\tthis.$autoScrollTranscriptCheckbox = $autoScrollInput;\n\t\tthis.$transcriptToolbar.append($autoScrollLabel, this.$autoScrollTranscriptCheckbox);\n\n\t};\n\n\tAblePlayer.prototype.updateTranscript = function() {\n\n\t\tif (!this.transcriptType) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.playerCreated && !this.$transcriptArea) { \n\t\t\treturn; \n\t\t}\n\t\tif (this.transcriptType === 'external' || this.transcriptType === 'popup') {\n\n\t\t\tvar chapters, captions, descriptions;\n\n\t\t\t// Language of transcript might be different than language of captions\n\t\t\t// But both are in sync by default\n\t\t\tif (this.transcriptLang) {\n\t\t\t\tcaptions = this.transcriptCaptions.cues;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (this.transcriptCaptions) {\n\t\t\t\t\tthis.transcriptLang = this.transcriptCaptions.language;\n\t\t\t\t\tcaptions = this.transcriptCaptions.cues;\n\t\t\t\t}\n\t\t\t\telse if (this.selectedCaptions) {\n\t\t\t\t\tthis.transcriptLang = this.captionLang;\n\t\t\t\t\tcaptions = this.selectedCaptions.cues;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// setup chapters\n\t\t\tif (this.transcriptChapters) {\n\t\t\t\tchapters = this.transcriptChapters.cues;\n\t\t\t}\n\t\t\telse if (this.chapters.length > 0) {\n\t\t\t\t// Try and match the caption language.\n\t\t\t\tif (this.transcriptLang) {\n\t\t\t\t\tfor (var i = 0; i < this.chapters.length; i++) {\n\t\t\t\t\t\tif (this.chapters[i].language === this.transcriptLang) {\n\t\t\t\t\t\t\tchapters = this.chapters[i].cues;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof chapters === 'undefined') {\n\t\t\t\t\tchapters = this.chapters[0].cues || [];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// setup descriptions\n\t\t\tif (this.transcriptDescriptions) {\n\t\t\t\tdescriptions = this.transcriptDescriptions.cues;\n\t\t\t}\n\t\t\telse if (this.descriptions.length > 0) {\n\t\t\t\t// Try and match the caption language.\n\t\t\t\tif (this.transcriptLang) {\n\t\t\t\t\tfor (var i = 0; i < this.descriptions.length; i++) {\n\t\t\t\t\t\tif (this.descriptions[i].language === this.transcriptLang) {\n\t\t\t\t\t\t\tdescriptions = this.descriptions[i].cues;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!descriptions) {\n\t\t\t\t\tdescriptions = this.descriptions[0].cues || [];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar div = this.generateTranscript(chapters || [], captions || [], descriptions || []);\n\t\t\tthis.$transcriptDiv.html(div);\n\t\t\t// reset transcript selected <option> to this.transcriptLang\n\t\t\tif (this.$transcriptLanguageSelect) {\n\t\t\t\tthis.$transcriptLanguageSelect.find('option:selected').prop('selected',false);\n\t\t\t\tthis.$transcriptLanguageSelect.find('option[lang=' + this.transcriptLang + ']').prop('selected',true);\n\t\t\t}\n\t\t}\n\n\t\tvar thisObj = this;\n\n\t\t// Make transcript tabbable if preference is turned on.\n\t\tif (this.prefTabbable === 1) {\n\t\t\tthis.$transcriptDiv.find('span.able-transcript-seekpoint').attr('tabindex','0');\n\t\t}\n\n\t\t// handle clicks on text within transcript\n\t\t// Note: This event listeners handles clicks only, not keydown events\n\t\t// Pressing Enter on an element that is not natively clickable does NOT trigger click()\n\t\t// Keydown events are handled elsehwere, both globally (ableplayer-base.js) and locally (event.js)\n\t\tif (this.$transcriptArea.length > 0) {\n\t\t\tthis.$transcriptArea.find('span.able-transcript-seekpoint').click(function(e) {\n\t\t\t\tthisObj.seekTrigger = 'transcript';\n\t\t\t\tvar spanStart = parseFloat($(this).attr('data-start'));\n\t\t\t\t// Add a tiny amount so that we're inside the span.\n\t\t\t\tspanStart += .01;\n\t\t\t\t// Each click within the transcript triggers two click events (not sure why)\n\t\t\t\t// this.seekingFromTranscript is a stopgab to prevent two calls to SeekTo()\n\t\t\t\tif (!thisObj.seekingFromTranscript) {\n\t\t\t\t\tthisObj.seekingFromTranscript = true;\n\t\t\t\t\tthisObj.seekTo(spanStart);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// don't seek a second time, but do reset var\n\t\t\t\t\tthisObj.seekingFromTranscript = false;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tAblePlayer.prototype.highlightTranscript = function (currentTime) {\n\n\t\t// Show highlight in transcript marking current caption.\n\n\t\tif (!this.transcriptType) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar start, end, isChapterHeading;\n\t\tvar thisObj = this;\n\n\t\tcurrentTime = parseFloat(currentTime);\n\n\t\t// Highlight the current transcript item.\n\t\tthis.$transcriptArea.find('span.able-transcript-seekpoint').each(function() {\n\t\t\tstart = parseFloat($(this).attr('data-start'));\n\t\t\tend = parseFloat($(this).attr('data-end'));\n\t\t\t// be sure this isn't a chapter (don't highlight chapter headings)\n\t\t\tif ($(this).parent().hasClass('able-transcript-chapter-heading')) {\n\t\t\t\tisChapterHeading = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tisChapterHeading = false;\n\t\t\t}\n\n\t\t\tif (currentTime >= start && currentTime <= end && !isChapterHeading) {\n\n\t\t\t\t// If this item isn't already highlighted, it should be\n\t\t\t\tif (!($(this).hasClass('able-highlight'))) {\n\t\t\t\t\t// remove all previous highlights before adding one to current span\n\t\t\t\t\tthisObj.$transcriptArea.find('.able-highlight').removeClass('able-highlight');\n\t\t\t\t\t$(this).addClass('able-highlight');\n\t\t\t\t\tthisObj.movingHighlight = true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\tthisObj.currentHighlight = thisObj.$transcriptArea.find('.able-highlight');\n\t\tif (thisObj.currentHighlight.length === 0) {\n\t\t\t// Nothing highlighted.\n\t\t\tthisObj.currentHighlight = null;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.generateTranscript = function(chapters, captions, descriptions) {\n\n\t\tvar thisObj = this;\n\n\t\tvar $main = $('<div class=\"able-transcript-container\"></div>');\n\t\tvar transcriptTitle;\n\n\t\t// set language for transcript container\n\t\t$main.attr('lang', this.transcriptLang);\n\n\t\tif (typeof this.transcriptTitle !== 'undefined') {\n\t\t\ttranscriptTitle = this.transcriptTitle;\n\t\t}\n\t\telse if (this.lyricsMode) {\n\t\t\ttranscriptTitle = this.tt.lyricsTitle;\n\t\t}\n\t\telse {\n\t\t\ttranscriptTitle = this.tt.transcriptTitle;\n\t\t}\n\n\t\tif (!this.transcriptDivLocation) {\n\t\t\t// only add an HTML heading to internal transcript\n\t\t\t// external transcript is expected to have its own heading\n\t\t\tvar headingNumber = this.playerHeadingLevel;\n\t\t\theadingNumber += 1;\n\t\t\tvar chapterHeadingNumber = headingNumber + 1;\n\n\t\t\tif (headingNumber <= 6) {\n\t\t\t\tvar transcriptHeading = 'h' + headingNumber.toString();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar transcriptHeading = 'div';\n\t\t\t}\n\t\t\tvar $transcriptHeadingTag = $('<' + transcriptHeading + '>');\n\t\t\t$transcriptHeadingTag.addClass('able-transcript-heading');\n\t\t\tif (headingNumber > 6) {\n\t\t\t\t$transcriptHeadingTag.attr({\n\t\t\t\t\t'role': 'heading',\n\t\t\t\t\t'aria-level': headingNumber\n\t\t\t\t});\n\t\t\t}\n\t\t\t$transcriptHeadingTag.text(transcriptTitle);\n\n\t\t\t// set language of transcript heading to language of player\n\t\t\t// this is independent of language of transcript\n\t\t\t$transcriptHeadingTag.attr('lang', this.lang);\n\n\t\t\t$main.append($transcriptHeadingTag);\n\t\t}\n\n\t\tvar nextChapter = 0;\n\t\tvar nextCap = 0;\n\t\tvar nextDesc = 0;\n\n\t\tvar addChapter = function(div, chap) {\n\n\t\t\tif (chapterHeadingNumber <= 6) {\n\t\t\t\tvar chapterHeading = 'h' + chapterHeadingNumber.toString();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar chapterHeading = 'div';\n\t\t\t}\n\n\t\t\tvar $chapterHeadingTag = $('<' + chapterHeading + '>',{\n\t\t\t\t'class': 'able-transcript-chapter-heading'\n\t\t\t});\n\t\t\tif (chapterHeadingNumber > 6) {\n\t\t\t\t$chapterHeadingTag.attr({\n\t\t\t\t\t'role': 'heading',\n\t\t\t\t\t'aria-level': chapterHeadingNumber\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvar flattenComponentForChapter = function(comp) {\n\n\t\t\t\tvar result = [];\n\t\t\t\tif (comp.type === 'string') {\n\t\t\t\t\tresult.push(comp.value);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor (var i = 0; i < comp.children.length; i++) {\n\t\t\t\t\t\tresult = result.concat(flattenComponentForChapter(comp.children[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tvar $chapSpan = $('<span>',{\n\t\t\t\t'class': 'able-transcript-seekpoint'\n\t\t\t});\n\t\t\tfor (var i = 0; i < chap.components.children.length; i++) {\n\t\t\t\tvar results = flattenComponentForChapter(chap.components.children[i]);\n\t\t\t\tfor (var jj = 0; jj < results.length; jj++) {\n\t\t\t\t\t$chapSpan.append(results[jj]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t$chapSpan.attr('data-start', chap.start.toString());\n\t\t\t$chapSpan.attr('data-end', chap.end.toString());\n\t\t\t$chapterHeadingTag.append($chapSpan);\n\n\t\t\tdiv.append($chapterHeadingTag);\n\t\t};\n\n\t\tvar addDescription = function(div, desc) {\n\t\t\tvar $descDiv = $('<div>', {\n\t\t\t\t'class': 'able-transcript-desc'\n\t\t\t});\n\t\t\tvar $descHiddenSpan = $('<span>',{\n\t\t\t\t'class': 'able-hidden'\n\t\t\t});\n\t\t\t$descHiddenSpan.attr('lang', thisObj.lang);\n\t\t\t$descHiddenSpan.text(thisObj.tt.prefHeadingDescription + ': ');\n\t\t\t$descDiv.append($descHiddenSpan);\n\n\t\t\tvar flattenComponentForDescription = function(comp) {\n\n\t\t\t\tvar result = [];\n\t\t\t\tif (comp.type === 'string') {\n\t\t\t\t\tresult.push(comp.value);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor (var i = 0; i < comp.children.length; i++) {\n\t\t\t\t\t\tresult = result.concat(flattenComponentForDescription(comp.children[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tvar $descSpan = $('<span>',{\n\t\t\t\t'class': 'able-transcript-seekpoint'\n\t\t\t});\n\t\t\tfor (var i = 0; i < desc.components.children.length; i++) {\n\t\t\t\tvar results = flattenComponentForDescription(desc.components.children[i]);\n\t\t\t\tfor (var jj = 0; jj < results.length; jj++) {\n\t\t\t\t\t$descSpan.append(results[jj]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t$descSpan.attr('data-start', desc.start.toString());\n\t\t\t$descSpan.attr('data-end', desc.end.toString());\n\t\t\t$descDiv.append($descSpan);\n\n\t\t\tdiv.append($descDiv);\n\t\t};\n\n\t\tvar addCaption = function(div, cap) {\n\n\t\t\tvar $capSpan = $('<span>',{\n\t\t\t\t'class': 'able-transcript-seekpoint able-transcript-caption'\n\t\t\t});\n\n\t\t\tvar flattenComponentForCaption = function(comp) {\n\n\t\t\t\tvar result = [];\n\n\t\t\t\tvar parts = 0;\n\n\t\t\t\tvar flattenString = function (str) {\n\n\t\t\t\t\tparts++;\n\n\t\t\t\t\tvar flatStr;\n\t\t\t\t\tvar result = [];\n\t\t\t\t\tif (str === '') {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar openBracket = str.indexOf('[');\n\t\t\t\t\tvar closeBracket = str.indexOf(']');\n\t\t\t\t\tvar openParen = str.indexOf('(');\n\t\t\t\t\tvar closeParen = str.indexOf(')');\n\n\t\t\t\t\tvar hasBrackets = openBracket !== -1 && closeBracket !== -1;\n\t\t\t\t\tvar hasParens = openParen !== -1 && closeParen !== -1;\n\n\t\t\t\t\tif (hasParens || hasBrackets) {\n\t\t\t\t\t\tif (parts > 1) {\n\t\t\t\t\t\t\t// force a line break between sections that contain parens or brackets\n\t\t\t\t\t\t\tvar silentSpanBreak = '<br/>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tvar silentSpanBreak = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar silentSpanOpen = silentSpanBreak + '<span class=\"able-unspoken\">';\n\t\t\t\t\t\tvar silentSpanClose = '</span>';\n\t\t\t\t\t\tif (hasParens && hasBrackets) {\n\t\t\t\t\t\t\t// string has both!\n\t\t\t\t\t\t\tif (openBracket < openParen) {\n\t\t\t\t\t\t\t\t// brackets come first. Parse parens separately\n\t\t\t\t\t\t\t\thasParens = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t// parens come first. Parse brackets separately\n\t\t\t\t\t\t\t\thasBrackets = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (hasParens) {\n\t\t\t\t\t\tflatStr = str.substring(0, openParen);\n\t\t\t\t\t\tflatStr += silentSpanOpen;\n\t\t\t\t\t\tflatStr += str.substring(openParen, closeParen + 1);\n\t\t\t\t\t\tflatStr += silentSpanClose;\n\t\t\t\t\t\tflatStr += flattenString(str.substring(closeParen + 1));\n\t\t\t\t\t\tresult.push(flatStr);\n\t\t\t\t\t}\n\t\t\t\t\telse if (hasBrackets) {\n\t\t\t\t\t\tflatStr = str.substring(0, openBracket);\n\t\t\t\t\t\tflatStr += silentSpanOpen;\n\t\t\t\t\t\tflatStr += str.substring(openBracket, closeBracket + 1);\n\t\t\t\t\t\tflatStr += silentSpanClose;\n\t\t\t\t\t\tflatStr += flattenString(str.substring(closeBracket + 1));\n\t\t\t\t\t\tresult.push(flatStr);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tresult.push(str);\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t};\n\n\t\t\t\tif (comp.type === 'string') {\n\t\t\t\t\tresult = result.concat(flattenString(comp.value));\n\t\t\t\t}\n\t\t\t\telse if (comp.type === 'v') {\n\t\t\t\t\tvar $vSpan = $('<span>',{\n\t\t\t\t\t\t'class': 'able-unspoken'\n\t\t\t\t\t});\n\t\t\t\t\t$vSpan.text('(' + comp.value + ')');\n\t\t\t\t\tresult.push($vSpan);\n\t\t\t\t\tfor (var i = 0; i < comp.children.length; i++) {\n\t\t\t\t\t\tvar subResults = flattenComponentForCaption(comp.children[i]);\n\t\t\t\t\t\tfor (var jj = 0; jj < subResults.length; jj++) {\n\t\t\t\t\t\t\tresult.push(subResults[jj]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (comp.type === 'b' || comp.type === 'i') {\n\t\t\t\t\tif (comp.type === 'b') {\n\t\t\t\t\t\tvar $tag = $('<strong>');\n\t\t\t\t\t}\n\t\t\t\t\telse if (comp.type === 'i') {\n\t\t\t\t\t\tvar $tag = $('<em>');\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i = 0; i < comp.children.length; i++) {\n\t\t\t\t\t\tvar subResults = flattenComponentForCaption(comp.children[i]);\n\t\t\t\t\t\tfor (var jj = 0; jj < subResults.length; jj++) {\n\t\t\t\t\t\t\t$tag.append(subResults[jj]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (comp.type === 'b' || comp.type == 'i') {\n\t\t\t\t\t\tresult.push($tag,' ');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor (var i = 0; i < comp.children.length; i++) {\n\t\t\t\t\t\tresult = result.concat(flattenComponentForCaption(comp.children[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t};\n\n\t\t\tfor (var i = 0; i < cap.components.children.length; i++) {\n\t\t\t\tvar results = flattenComponentForCaption(cap.components.children[i]);\n\t\t\t\tfor (var jj = 0; jj < results.length; jj++) {\n\t\t\t\t\tvar result = results[jj];\n\t\t\t\t\tif (typeof result === 'string') {\n\t\t\t\t\t\tif (thisObj.lyricsMode) {\n\t\t\t\t\t\t\t// add <br> BETWEEN each caption and WITHIN each caption (if payload includes \"\\n\")\n\t\t\t\t\t\t\tresult = result.replace('\\n','<br>') + '<br>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// just add a space between captions\n\t\t\t\t\t\t\tresult += ' ';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t$capSpan.append(result);\n\t\t\t\t}\n\t\t\t}\n\t\t\t$capSpan.attr('data-start', cap.start.toString());\n\t\t\t$capSpan.attr('data-end', cap.end.toString());\n\t\t\tdiv.append($capSpan);\n\t\t\tdiv.append(' \\n');\n\t\t};\n\n\t\t// keep looping as long as any one of the three arrays has content\n\t\twhile ((nextChapter < chapters.length) || (nextDesc < descriptions.length) || (nextCap < captions.length)) {\n\n\t\t\tif ((nextChapter < chapters.length) && (nextDesc < descriptions.length) && (nextCap < captions.length)) {\n\t\t\t\t// they all three have content\n\t\t\t\tvar firstStart = Math.min(chapters[nextChapter].start,descriptions[nextDesc].start,captions[nextCap].start);\n\t\t\t}\n\t\t\telse if ((nextChapter < chapters.length) && (nextDesc < descriptions.length)) {\n\t\t\t\t// chapters & descriptions have content\n\t\t\t\tvar firstStart = Math.min(chapters[nextChapter].start,descriptions[nextDesc].start);\n\t\t\t}\n\t\t\telse if ((nextChapter < chapters.length) && (nextCap < captions.length)) {\n\t\t\t\t// chapters & captions have content\n\t\t\t\tvar firstStart = Math.min(chapters[nextChapter].start,captions[nextCap].start);\n\t\t\t}\n\t\t\telse if ((nextDesc < descriptions.length) && (nextCap < captions.length)) {\n\t\t\t\t// descriptions & captions have content\n\t\t\t\tvar firstStart = Math.min(descriptions[nextDesc].start,captions[nextCap].start);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar firstStart = null;\n\t\t\t}\n\t\t\tif (firstStart !== null) {\n\t\t\t\tif (typeof chapters[nextChapter] !== 'undefined' && chapters[nextChapter].start === firstStart) {\n\t\t\t\t\taddChapter($main, chapters[nextChapter]);\n\t\t\t\t\tnextChapter += 1;\n\t\t\t\t}\n\t\t\t\telse if (typeof descriptions[nextDesc] !== 'undefined' && descriptions[nextDesc].start === firstStart) {\n\t\t\t\t\taddDescription($main, descriptions[nextDesc]);\n\t\t\t\t\tnextDesc += 1;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\taddCaption($main, captions[nextCap]);\n\t\t\t\t\tnextCap += 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (nextChapter < chapters.length) {\n\t\t\t\t\taddChapter($main, chapters[nextChapter]);\n\t\t\t\t\tnextChapter += 1;\n\t\t\t\t}\n\t\t\t\telse if (nextDesc < descriptions.length) {\n\t\t\t\t\taddDescription($main, descriptions[nextDesc]);\n\t\t\t\t\tnextDesc += 1;\n\t\t\t\t}\n\t\t\t\telse if (nextCap < captions.length) {\n\t\t\t\t\taddCaption($main, captions[nextCap]);\n\t\t\t\t\tnextCap += 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// organize transcript into blocks using [] and () as starting points\n\t\tvar $components = $main.children();\n\t\tvar spanCount = 0;\n\t\tvar openBlock = true;\n\t\t$components.each(function() {\n\t\t\tif ($(this).hasClass('able-transcript-caption')) {\n\t\t\t\tif ($(this).text().indexOf('[') !== -1 || $(this).text().indexOf('(') !== -1) {\n\t\t\t\t\t// this caption includes a bracket or parenth. Start a new block\n\t\t\t\t\t// close the previous block first\n\t\t\t\t\tif (spanCount > 0) {\n\t\t\t\t\t\t$main.find('.able-block-temp').removeClass('able-block-temp').wrapAll('<div class=\"able-transcript-block\"></div>');\n\t\t\t\t\t\tspanCount = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t$(this).addClass('able-block-temp');\n\t\t\t\tspanCount++;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// this is not a caption. Close the caption block\n\t\t\t\tif (spanCount > 0) {\n\t\t\t\t\t$main.find('.able-block-temp').removeClass('able-block-temp').wrapAll('<div class=\"able-transcript-block\"></div>');\n\t\t\t\t\tspanCount = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn $main;\n\t};\n\n})(jQuery);\n\n(function ($) {\n\tAblePlayer.prototype.showSearchResults = function() {\n\n\t\t// search VTT file for all instances of searchTerms\n\t\t// Currently just supports search terms separated with one or more spaces\n\n\t\t// TODO: Add support for more robust search syntax:\n\t\t// Search terms wrapped in quotation marks (\"\") must occur exactly as they appear in the quotes\n\t\t// Search terms with an attached minus sign (e.g., -term) are to be excluded from results\n\t\t// Boolean AND/OR operators\n\t\t// ALSO: Add localization support\n\n\t\tvar thisObj = this;\n\t\tif (this.searchDiv && this.searchString) {\n\t\t\tif ($('#' + this.SearchDiv)) {\n\t\t\t\tvar searchStringHtml = '<p>' + this.tt.resultsSummary1 + ' ';\n\t\t\t\t\tsearchStringHtml += '<span id=\"able-search-term-echo\">' + this.searchString + '</span>';\n\t\t\t\t\tsearchStringHtml += '</p>';\n\t\t\t\tvar resultsArray = this.searchFor(this.searchString, this.searchIgnoreCaps);\n\t\t\t\tif (resultsArray.length > 0) {\n\t\t\t\t\tvar $resultsSummary = $('<p>',{\n\t\t\t\t\t\t'class': 'able-search-results-summary'\n\t\t\t\t\t});\n\t\t\t\t\tvar resultsSummaryText = this.tt.resultsSummary2;\n\t\t\t\t\tresultsSummaryText += ' <strong>' + resultsArray.length + '</strong> ';\n\t\t\t\t\tresultsSummaryText += this.tt.resultsSummary3 + ' ';\n\t\t\t\t\tresultsSummaryText += this.tt.resultsSummary4;\n\t\t\t\t\t$resultsSummary.html(resultsSummaryText);\n\t\t\t\t\tvar $resultsList = $('<ul>');\n\t\t\t\t\tfor (var i = 0; i < resultsArray.length; i++) {\n\t\t\t\t\t\tvar resultId = 'aria-search-result-' + i;\n\t\t\t\t\t\tvar $resultsItem = $('<li>',{});\n\t\t\t\t\t\tvar itemStartTime = this.secondsToTime(resultsArray[i]['start']);\n\t\t\t\t\t\tvar itemLabel = this.tt.searchButtonLabel + ' ' + itemStartTime['title'];\n\t\t\t\t\t\tvar itemStartSpan = $('<button>',{\n\t\t\t\t\t\t\t'class': 'able-search-results-time',\n\t\t\t\t\t\t\t'data-start': resultsArray[i]['start'],\n\t\t\t\t\t\t\t'title': itemLabel,\n\t\t\t\t\t\t\t'aria-label': itemLabel,\n\t\t\t\t\t\t\t'aria-describedby': resultId\n\t\t\t\t\t\t});\n\t\t\t\t\t\titemStartSpan.text(itemStartTime['value']);\n\t\t\t\t\t\t// add a listener for clisk on itemStart\n\t\t\t\t\t\titemStartSpan.on('click',function(e) {\n\t\t\t\t\t\t\tthisObj.seekTrigger = 'search';\n\t\t\t\t\t\t\tvar spanStart = parseFloat($(this).attr('data-start'));\n\t\t\t\t\t\t\t// Add a tiny amount so that we're inside the span.\n\t\t\t\t\t\t\tspanStart += .01;\n\t\t\t\t\t\t\tthisObj.seeking = true;\n\t\t\t\t\t\t\tthisObj.seekTo(spanStart);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tvar itemText = $('<span>',{\n\t\t\t\t\t\t\t'class': 'able-search-result-text',\n\t\t\t\t\t\t\t'id': resultId\n\t\t\t\t\t\t})\n\t\t\t\t\t\titemText.html('...' + resultsArray[i]['caption'] + '...');\n\t\t\t\t\t\t$resultsItem.append(itemStartSpan, itemText);\n\t\t\t\t\t\t$resultsList.append($resultsItem);\n\t\t\t\t\t}\n\t\t\t\t\t$('#' + this.searchDiv).html(searchStringHtml).append($resultsSummary,$resultsList);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar noResults = $('<p>').text(this.tt.noResultsFound);\n\t\t\t\t\t$('#' + this.searchDiv).html(searchStringHtml).append(noResults);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.searchFor = function(searchString, ignoreCaps) {\n\n\t\t// return chronological array of caption cues that match searchTerms\n\t\tvar captionLang, captions, results, caption, c, i, j;\n\t\tresults = [];\n\t\t// split searchTerms into an array\n\t\tvar searchTerms = searchString.split(' ');\n\t\tif (this.captions.length > 0) {\n\t\t\t// Get caption track that matches this.searchLang\n\t\t\tfor (i=0; i < this.captions.length; i++) {\n\t\t\t\tif (this.captions[i].language === this.searchLang) {\n\t\t\t\t\tcaptionLang = this.searchLang;\n\t\t\t\t\tcaptions = this.captions[i].cues;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (captions.length > 0) {\n\t\t\t\tc = 0;\n\t\t\t\tfor (i = 0; i < captions.length; i++) {\n\t\t\t\t\tif ($.inArray(captions[i].components.children[0]['type'], ['string','i','b','u','v','c']) !== -1) {\n\t\t\t\t\t\tcaption = this.flattenCueForCaption(captions[i]);\n\t\t\t\t\t\tvar captionNormalized = ignoreCaps ? caption.toLowerCase() : caption;\n\t\t\t\t\t\tfor (j = 0; j < searchTerms.length; j++) {\n\t\t\t\t\t\t\tvar searchTermNormalized = ignoreCaps ? searchTerms[j].toLowerCase() : searchTerms[j];\n\t\t\t\t\t\t\tif (captionNormalized.indexOf(searchTermNormalized) !== -1) {\n\t\t\t\t\t\t\t\tresults[c] = [];\n\t\t\t\t\t\t\t\tresults[c]['start'] = captions[i].start;\n\t\t\t\t\t\t\t\tresults[c]['lang'] = captionLang;\n\t\t\t\t\t\t\t\tresults[c]['caption'] = this.highlightSearchTerm(searchTerms,caption);\n\t\t\t\t\t\t\t\tc++;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t};\n\n\tAblePlayer.prototype.highlightSearchTerm = function(searchTerms, resultString) {\n\t\t// highlight ALL found searchTerms in the current resultString\n\t\t// Need to step through the remaining terms to see if they're present as well\n\t\tsearchTerms.forEach(function(searchTerm) {\n\t\t\tvar reg = new RegExp(searchTerm, 'gi');\n\t\t\tresultString = resultString.replace(reg, '<span class=\"able-search-term\">$&</span>');\n\t\t});\n\t\treturn resultString;\n\t};\n\n\tAblePlayer.prototype.secondsToTime = function(totalSeconds) {\n\n\t\t// return an array of totalSeconds converted into two formats\n\t\t// time['value'] = HH:MM:SS with hours dropped if there are none\n\t\t// time['title'] = a speakable rendering, so speech rec users can easily speak the link\n\n\t\t// first, round down to nearest second\n\t\tvar totalSeconds = Math.floor(totalSeconds);\n\n\t\tvar hours = parseInt( totalSeconds / 3600 , 10) % 24;\n\t\tvar minutes = parseInt( totalSeconds / 60 , 10) % 60;\n\t\tvar seconds = totalSeconds % 60;\n\t\tvar value = '';\n\t\tvar title = '';\n\t\tif (hours > 0) {\n\t\t\tvalue += hours + ':';\n\t\t\tif (hours == 1) {\n\t\t\t\ttitle += '1 ' + this.tt.hour + ' ';\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttitle += hours + ' ' + this.tt.hours + ' ';\n\t\t\t}\n\t\t}\n\t\tif (minutes < 10) {\n\t\t\tvalue += '0' + minutes + ':';\n\t\t\tif (minutes > 0) {\n\t\t\t\tif (minutes == 1) {\n\t\t\t\t\ttitle += '1 ' + this.tt.minute + ' ';\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttitle += minutes + ' ' + this.tt.minutes + ' ';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tvalue += minutes + ':';\n\t\t\ttitle += minutes + ' ' + this.tt.minutes + ' ';\n\t\t}\n\t\tif (seconds < 10) {\n\t\t\tvalue += '0' + seconds;\n\t\t\tif (seconds > 0) {\n\t\t\t\tif (seconds == 1) {\n\t\t\t\t\ttitle += '1 ' + this.tt.second + ' ';\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttitle += seconds + ' ' + this.tt.seconds + ' ';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tvalue += seconds;\n\t\t\ttitle += seconds + ' ' + this.tt.seconds + ' ';\n\t\t}\n\t\tvar time = [];\n\t\ttime['value'] = value;\n\t\ttime['title'] = title;\n\t\treturn time;\n\t};\n})(jQuery);\n\n(function ($) {\n\t// Media events\n\tAblePlayer.prototype.onMediaUpdateTime = function (duration, elapsed) {\n\n\n\t\t// duration and elapsed are passed from callback functions of Vimeo API events\n\t\t// duration is expressed as sss.xxx\n\t\t// elapsed is expressed as sss.xxx\n\t\tvar thisObj = this;\n\t\tthis.getMediaTimes(duration,elapsed).then(function(mediaTimes) {\n\t\t\tthisObj.duration = mediaTimes['duration'];\n\t\t\tthisObj.elapsed = mediaTimes['elapsed'];\n\t\t\tif (thisObj.duration > 0) { \n\t\t\t\t// do all the usual time-sync stuff during playback\n\t\t\t\tif (thisObj.prefHighlight === 1) {\n\t\t\t\t\tthisObj.highlightTranscript(thisObj.elapsed);\n\t\t\t\t}\t\t\t\t\n\t\t\t\tthisObj.updateCaption(thisObj.elapsed);\n\t\t\t\tthisObj.showDescription(thisObj.elapsed);\n\t\t\t\tthisObj.updateChapter(thisObj.elapsed);\n\t\t\t\tthisObj.updateMeta(thisObj.elapsed);\n\t\t\t\tthisObj.refreshControls('timeline', thisObj.duration, thisObj.elapsed); \n\t\t\t}\t\n\t\t});\n\t};\n\n\tAblePlayer.prototype.onMediaPause = function () {\n\n\t\tif (this.controlsHidden) {\n\t\t\tthis.fadeControls('in');\n\t\t\tthis.controlsHidden = false;\n\t\t}\n\t\tif (this.hideControlsTimeoutStatus === 'active') {\n\t\t\twindow.clearTimeout(this.hideControlsTimeout);\n\t\t\tthis.hideControlsTimeoutStatus = 'clear';\n\n\t\t}\n\t\tthis.refreshControls('playpause');\n\t};\n\n\tAblePlayer.prototype.onMediaComplete = function () {\n\t\t// if there's a playlist, advance to next item and start playing\n\t\tif (this.hasPlaylist && !this.cueingPlaylistItem) {\n\t\t\tif (this.playlistIndex === (this.$playlist.length - 1)) {\n\t\t\t\t// this is the last track in the playlist\n\t\t\t\tif (this.loop) {\n\t\t\t\t\tthis.playlistIndex = 0;\n\t\t\t\t\tthis.cueingPlaylistItem = true; // stopgap to prevent multiple firings\n\t\t\t\t\tthis.cuePlaylistItem(0);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.playing = false;\n\t\t\t\t\tthis.paused = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// this is not the last track. Play the next one.\n\t\t\t\tthis.playlistIndex++;\n\t\t\t\tthis.cueingPlaylistItem = true; // stopgap to prevent multiple firings\n\t\t\t\tthis.cuePlaylistItem(this.playlistIndex)\n\t\t\t}\n\t\t}\n\t\tthis.refreshControls('init');\n\t};\n\n\tAblePlayer.prototype.onMediaNewSourceLoad = function () {\n\n\t\tvar loadIsComplete = false; \n\n\t\tif (this.cueingPlaylistItem) {\n\t\t\t// this variable was set in order to address bugs caused by multiple firings of media 'end' event\n\t\t\t// safe to reset now\n\t\t\tthis.cueingPlaylistItem = false;\n\t\t}\n\t\tif (this.recreatingPlayer) { \n\t\t\t// same as above; different bugs \n\t\t\tthis.recreatingPlayer = false; \n\t\t}\n\t\tif (this.playbackRate) {\n\t\t\t// user has set playbackRate on a previous src or track\n\t\t\t// use that setting on the new src or track too\n\t\t\tthis.setPlaybackRate(this.playbackRate);\n\t\t}\n\t\tif (this.userClickedPlaylist) {\n\t\t\tif (!this.startedPlaying || this.okToPlay) {\n\t\t\t\t// start playing; no further user action is required\n\t\t\t\tthis.playMedia();\n\t\t\t\tloadIsComplete = true; \n\t\t\t }\n\t\t}\n\t\telse if (this.seekTrigger == 'restart' ||\n\t\t\t\tthis.seekTrigger == 'chapter' ||\n\t\t\t\tthis.seekTrigger == 'transcript' ||\n\t\t\t\tthis.seekTrigger == 'search'\n\t\t\t\t) {\n\t\t\t// by clicking on any of these elements, user is likely intending to play\n\t\t\t// Not included: elements where user might click multiple times in succession\n\t\t\t// (i.e., 'rewind', 'forward', or seekbar); for these, video remains paused until user initiates play\n\t\t\tthis.playMedia();\n\t\t\tloadIsComplete = true; \n\t\t}\n\t\telse if (this.swappingSrc) {\n\t\t\t// new source file has just been loaded\n\t\t\tif (this.hasPlaylist) {\n\t\t\t\t// a new source file from the playlist has just been loaded\n\t\t\t\tif ((this.playlistIndex !== this.$playlist.length) || this.loop) {\n\t\t\t\t\t// this is not the last track in the playlist (OR playlist is looping so it doesn't matter)\n\t\t\t\t\tthis.playMedia();\n\t\t\t\t\tloadIsComplete = true; \n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.swapTime > 0) {\n\t\t\t\tif (this.seekStatus === 'complete') { \n\t\t\t\t\tif (this.okToPlay) {\n\t\t\t\t\t\t// should be able to resume playback\n\t\t\t\t\t\tthis.playMedia();\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\tloadIsComplete = true; \n\t\t\t\t}\n\t\t\t\telse if (this.seekStatus === 'seeking') { \n\t\t\t\t}\n\t\t\t\telse { \n\t\t\t\t\tif (this.swapTime === this.elapsed) { \n\t\t\t\t\t\t// seek is finished! \n\t\t\t\t\t\tthis.seekStatus = 'complete'; \n\t\t\t\t\t\tif (this.okToPlay) {\n\t\t\t\t\t\t\t// should be able to resume playback\n\t\t\t\t\t\t\tthis.playMedia();\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tloadIsComplete = true; \n\t\t\t\t\t}\n\t\t\t\t\telse { \n\t\t\t\t\t\t// seeking hasn't started yet \n\t\t\t\t\t\t// first, determine whether it's possible \n\t\t\t\t\t\tif (this.hasDescTracks) { \n\t\t\t\t\t\t\t// do nothing. Unable to seek ahead if there are descTracks\n\t\t\t\t\t\t\tloadIsComplete = true; \n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (this.durationsAreCloseEnough(this.duration,this.prevDuration)) {\n\t\t\t\t\t\t\t// durations of two sources are close enough to making seek ahead in new source ok\n\t\t\t\t\t\t\tthis.seekStatus = 'seeking'; \n\t\t\t\t\t\t\tthis.seekTo(this.swapTime);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse { \t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// durations of two sources are too dissimilar to support seeking ahead to swapTime.  \t\t\t\t\t\t\n\t\t\t\t\t\t\tloadIsComplete = true; \n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\t\t\t\t\n\t\t\t\t// swapTime is 0. No seeking required. \n\t\t\t\tif (this.playing) { \n\t\t\t\t\tthis.playMedia(); \n\t\t\t\t\t// swap is complete. Reset vars. \n\t\t\t\t\tloadIsComplete = true; \t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (!this.startedPlaying) {\n\t\t\tif (this.startTime > 0) {\n\t\t\t\tif (this.seeking) {\n\t\t\t\t\t// a seek has already been initiated\n\t\t\t\t\t// since canplaythrough has been triggered, the seek is complete\n\t\t\t\t\tthis.seeking = false;\n\t\t\t\t\tif (this.okToPlay) {\n\t\t\t\t\t\tthis.playMedia();\n\t\t\t\t\t}\n\t\t\t\t\tloadIsComplete = true; \n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// haven't started seeking yet\n\t\t\t\t\tthis.seekTo(this.startTime);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.defaultChapter && typeof this.selectedChapters !== 'undefined') {\n\t\t\t\tthis.seekToChapter(this.defaultChapter);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// there is no startTime, therefore no seeking required\n\t\t\t\tif (this.okToPlay) {\n\t\t\t\t\tthis.playMedia();\n\t\t\t\t}\n\t\t\t\tloadIsComplete = true; \t\t\t\t\n\t\t\t}\n\t\t}\n\t\telse if (this.hasPlaylist) { \n\t\t\t// new source media is part of a playlist, but user didn't click on it \n\t\t\t// (and somehow, swappingSrc is false)\n\t\t\t// this may happen when the previous track ends and next track loads \n\t\t\t// this same code is called above when swappingSrc is true \n\t\t\tif ((this.playlistIndex !== this.$playlist.length) || this.loop) {\n\t\t\t\t// this is not the last track in the playlist (OR playlist is looping so it doesn't matter)\n\t\t\t\tthis.playMedia();\n\t\t\t\tloadIsComplete = true; \n\t\t\t}\n\t\t}\n\t\telse { \n\t\t\t// None of the above. \n\t\t\t// User is likely seeking to a new time, but not loading a new media source\n\t\t\t// need to reset vars \n\t\t\tloadIsComplete = true; \n\t\t}\n\t\tif (loadIsComplete) { \n\t\t\t// reset vars \n\t\t\tthis.swappingSrc = false; \t\t\t\n\t\t\tthis.seekStatus = null; \n\t\t\tthis.swapTime = 0; \n\t\t\tthis.seekTrigger = null;\n\t\t\tthis.seekingFromTranscript = false;\t\t\n\t\t\tthis.userClickedPlaylist = false;\n\t\t\tthis.okToPlay = false; \t\n\t\t}\n\t\tthis.refreshControls('init');\n\t\tif (this.$focusedElement) { \t\t\n\t\t\tthis.restoreFocus(); \n\t\t\tthis.$focusedElement = null; \n\t\t}\n\t};\n\n\tAblePlayer.prototype.durationsAreCloseEnough = function(d1,d2) { \n\n\t\t// Compare the durations of two media sources to determine whether it's ok to seek ahead after swapping src \n\t\t// The durations may not be exact, but they might be \"close enough\" \n\t\t// returns true if \"close enough\", otherwise false \n\n\t\tvar tolerance, diff; \n\t\t\n\t\ttolerance = 1;  // number of seconds between rounded durations that is considered \"close enough\" \n\t\t\n\t\tdiff = Math.abs(Math.round(d1) - Math.round(d2)); \n\t\t\n\t\tif (diff <= tolerance) {\n\t\t\treturn true;  \n\t\t}\n\t\telse { \n\t\t\treturn false; \n\t\t}\n\t};\n\n\tAblePlayer.prototype.restoreFocus = function() { \n\n\t\t// function called after player has been rebuilt (during media swap)\n\t\t// the original focusedElement no longer exists, \n\t\t// but this function finds a match in the new player \n\t\t// and places focus there \n\n\t\tvar classList; \n\n\t\tif (this.$focusedElement) { \n\t\t\t\n\t\t\tif ((this.$focusedElement).attr('role') === 'button') { \n\t\t\t\tclassList = this.$focusedElement.attr(\"class\").split(/\\s+/);\n\t\t\t\t$.each(classList, function(index, item) {\n\t\t\t\t\tif (item.substring(0,20) === 'able-button-handler-') {\n\t\t\t\t\t\t$('div.able-controller div.' + item).focus();  \n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t};\n\n\tAblePlayer.prototype.addSeekbarListeners = function () {\n\n\t\tvar thisObj = this;\n\n\t\t// Handle seek bar events.\n\t\tthis.seekBar.bodyDiv.on('startTracking', function (e) {\n\t\t\tthisObj.pausedBeforeTracking = thisObj.paused;\n\t\t\tthisObj.pauseMedia();\n\t\t}).on('tracking', function (e, position) {\n\t\t\t// Scrub transcript, captions, and metadata.\n\t\t\tthisObj.highlightTranscript(position);\n\t\t\tthisObj.updateCaption(position);\n\t\t\tthisObj.showDescription(position);\n\t\t\tthisObj.updateChapter(thisObj.convertChapterTimeToVideoTime(position));\n\t\t\tthisObj.updateMeta(position);\n\t\t\tthisObj.refreshControls('init');\n\t\t}).on('stopTracking', function (e, position) {\n\t\t\tif (thisObj.useChapterTimes) {\n\t\t\t\tthisObj.seekTo(thisObj.convertChapterTimeToVideoTime(position));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthisObj.seekTo(position);\n\t\t\t}\n\t\t\tif (!thisObj.pausedBeforeTracking) {\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tthisObj.playMedia();\n\t\t\t\t}, 200);\n\t\t\t}\n\t\t});\n\t};\n\n\tAblePlayer.prototype.onClickPlayerButton = function (el) {\n\n\t\tvar whichButton, prefsPopup;\n\n\t\twhichButton = this.getButtonNameFromClass($(el).attr('class')); \n\n\t\tif (whichButton === 'play') {\n\t\t\tthis.clickedPlay = true;\n\t\t\tthis.handlePlay();\n\t\t}\n\t\telse if (whichButton === 'restart') {\n\t\t\tthis.seekTrigger = 'restart';\n\t\t\tthis.handleRestart();\n\t\t}\n\t\telse if (whichButton === 'previous') {\n\t\t\tthis.userClickedPlaylist = true;\n\t\t\tthis.okToPlay = true; \n\t\t\tthis.seekTrigger = 'previous';\n\t\t\tthis.buttonWithFocus = 'previous';\n\t\t\tthis.handlePrevTrack();\n\t\t}\n\t\telse if (whichButton === 'next') {\n\t\t\tthis.userClickedPlaylist = true;\n\t\t\tthis.okToPlay = true; \n\t\t\tthis.seekTrigger = 'next';\n\t\t\tthis.buttonWithFocus = 'next';\n\t\t\tthis.handleNextTrack();\n\t\t}\n\t\telse if (whichButton === 'rewind') {\n\t\t\tthis.seekTrigger = 'rewind';\n\t\t\tthis.handleRewind();\n\t\t}\n\t\telse if (whichButton === 'forward') {\n\t\t\tthis.seekTrigger = 'forward';\n\t\t\tthis.handleFastForward();\n\t\t}\n\t\telse if (whichButton === 'mute') {\n\t\t\tthis.handleMute();\n\t\t}\n\t\telse if (whichButton === 'volume') {\n\t\t\tthis.handleVolumeButtonClick();\n\t\t}\n\t\telse if (whichButton === 'faster') {\n\t\t\tthis.handleRateIncrease();\n\t\t}\n\t\telse if (whichButton === 'slower') {\n\t\t\tthis.handleRateDecrease();\n\t\t}\n\t\telse if (whichButton === 'captions') {\n\t\t\tthis.handleCaptionToggle();\n\t\t}\n\t\telse if (whichButton === 'chapters') {\n\t\t\tthis.handleChapters();\n\t\t}\n\t\telse if (whichButton === 'descriptions') {\n\t\t\tthis.handleDescriptionToggle();\n\t\t}\n\t\telse if (whichButton === 'sign') {\n\t\t\tif (!this.closingSign) {\n\t\t\t\tthis.handleSignToggle();\n\t\t\t}\n\t\t}\n\t\telse if (whichButton === 'preferences') {\n\t\t\tif ($(el).attr('data-prefs-popup') === 'menu') {\n\t\t\t\tthis.handlePrefsClick();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.showingPrefsDialog = true; // stopgap\n\t\t\t\tthis.closePopups();\n\t\t\t\tprefsPopup = $(el).attr('data-prefs-popup');\n\t\t\t\tif (prefsPopup === 'keyboard') {\n\t\t\t\t\tthis.keyboardPrefsDialog.show();\n\t\t\t\t}\n\t\t\t\telse if (prefsPopup === 'captions') {\n\t\t\t\t\tthis.captionPrefsDialog.show();\n\t\t\t\t}\n\t\t\t\telse if (prefsPopup === 'descriptions') {\n\t\t\t\t\tthis.descPrefsDialog.show();\n\t\t\t\t}\n\t\t\t\telse if (prefsPopup === 'transcript') {\n\t\t\t\t\tthis.transcriptPrefsDialog.show();\n\t\t\t\t}\n\t\t\t\tthis.showingPrefsDialog = false;\n\t\t\t}\n\t\t}\n\t\telse if (whichButton === 'help') {\n\t\t\tthis.handleHelpClick();\n\t\t}\n\t\telse if (whichButton === 'transcript') {\n\t\t\tif (!this.closingTranscript) {\n\t\t\t\tthis.handleTranscriptToggle();\n\t\t\t}\n\t\t}\n\t\telse if (whichButton === 'fullscreen') {\n\t\t\tthis.clickedFullscreenButton = true;\n\t\t\tthis.handleFullscreenToggle();\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getButtonNameFromClass = function (classString) { \n\n\t\t// player control buttons all have class=\"able-button-handler-x\"  where x is the identifier \n\t\t// buttons might also have other classes assigned though\n\n\t\tvar classes, i; \n\n\t\tclasses = classString.split(' '); \n\t\tfor (i = 0; i < classes.length; i++) { \n\t\t\tif (classes[i].substring(0,20) === 'able-button-handler-') { \n\t\t\t\treturn classes[i].substring(20); \n\t\t\t}\n\t\t}\t\t\n\t\treturn classString; \n\t}\n\n\tAblePlayer.prototype.okToHandleKeyPress = function () {\n\n\t\t// returns true unless user's focus is on a UI element\n\t\t// that is likely to need supported keystrokes, including space\n\n\t\tvar activeElement = AblePlayer.getActiveDOMElement();\n\n\t\tif ($(activeElement).prop('tagName') === 'INPUT') {\n\t\t\treturn false;\n\t\t}\n\t\telse {\n\t\t\treturn true;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.onPlayerKeyPress = function (e) {\n\n\t\t// handle keystrokes (using DHTML Style Guide recommended key combinations)\n\t\t// https://web.archive.org/web/20130127004544/http://dev.aol.com/dhtml_style_guide/#mediaplayer\n\t\t// Modifier keys Alt + Ctrl are on by default, but can be changed within Preferences\n\t\t// NOTE #1: Style guide only supports Play/Pause, Stop, Mute, Captions, & Volume Up & Down\n\t\t// The rest are reasonable best choices\n\t\t// NOTE #2: If there are multiple players on a single page, keystroke handlers\n\t\t// are only bound to the FIRST player\n\t\t// NOTE #3: The DHTML Style Guide is now the W3C WAI-ARIA Authoring Guide and has undergone many revisions\n\t\t// including removal of the \"media player\" design pattern. There's an issue about that:\n\t\t// https://github.com/w3c/aria-practices/issues/27\n\n\t\tvar which, $thisElement;\n\n\t\t// Convert to lower case.\n\t\twhich = e.which;\n\t\tif (which >= 65 && which <= 90) {\n\t\t\twhich += 32;\n\t\t}\n\t\t$thisElement = $(document.activeElement);\n\n\t\tif (which === 27) { // escape\n\t\t\tif (this.$transcriptArea && $.contains(this.$transcriptArea[0],$thisElement[0]) && !this.hidingPopup) {\n\t\t\t\t// This element is part of transcript area.\n\t\t\t\tthis.handleTranscriptToggle();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tif (!this.okToHandleKeyPress()) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Only use keypress to control player if focus is NOT on a form field or contenteditable element\n\t\t// (or a textarea element with player in stenoMode)\n\t\tif (!(\n\t\t\t$(':focus').is('[contenteditable]') ||\n\t\t\t$(':focus').is('input') ||\n\t\t\t($(':focus').is('textarea') && !this.stenoMode) ||\n\t\t\t$(':focus').is('select') ||\n\t\t\te.target.hasAttribute('contenteditable') ||\n\t\t\te.target.tagName === 'INPUT' ||\n\t\t\t(e.target.tagName === 'TEXTAREA' && !this.stenoMode) ||\n\t\t\te.target.tagName === 'SELECT'\n\t\t)){\n\t\t\tif (which === 27) { // escape\n\t\t\t\tthis.closePopups();\n\t\t\t\tthis.$tooltipDiv.hide();\n\t\t\t\tthis.seekBar.hideSliderTooltips();\n\t\t\t}\n\t\t\telse if (which === 32) { // spacebar = play/pause\n\t\t\t\t// disable spacebar support for play/pause toggle as of 4.2.10\n\t\t\t\t// spacebar should not be handled everywhere on the page, since users use that to scroll the page\n\t\t\t\t// when the player has focus, most controls are buttons so spacebar should be used to trigger the buttons\n\t\t\t\tif ($thisElement.attr('role') === 'button') {\n\t\t\t\t\t// register a click on this element\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\t$thisElement.click();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which === 112) { // p = play/pause\n\t\t\t\tif (this.usingModifierKeys(e)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.handlePlay();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which === 115) { // s = stop (now restart)\n\t\t\t\tif (this.usingModifierKeys(e)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.handleRestart();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which === 109) { // m = mute\n\t\t\t\tif (this.usingModifierKeys(e)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.handleMute();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which === 118) { // v = volume\n\t\t\t\tif (this.usingModifierKeys(e)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.handleVolumeButtonClick();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which >= 49 && which <= 57) { // set volume 1-9\n\t\t\t\tif (this.usingModifierKeys(e)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.handleVolumeKeystroke(which);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which === 99) { // c = caption toggle\n\t\t\t\tif (this.usingModifierKeys(e)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.handleCaptionToggle();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which === 100) { // d = description\n\t\t\t\tif (this.usingModifierKeys(e)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.handleDescriptionToggle();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which === 102) { // f = forward\n\t\t\t\tif (this.usingModifierKeys(e)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.handleFastForward();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which === 114) { // r = rewind\n\t\t\t\tif (this.usingModifierKeys(e)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.handleRewind();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which === 98) { // b = back (previous track)\n\t\t\t\tif (this.usingModifierKeys(e)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.handlePrevTrack();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which === 110) { // n = next track\n\t\t\t\tif (this.usingModifierKeys(e)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.handleNextTrack();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which === 101) { // e = preferences\n\t\t\t\tif (this.usingModifierKeys(e)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.handlePrefsClick();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (which === 13) { // Enter\n\t\t\t\tif ($thisElement.attr('role') === 'button' || $thisElement.prop('tagName') === 'SPAN') {\n\t\t\t\t\t// register a click on this element\n\t\t\t\t\t// if it's a transcript span the transcript span click handler will take over\n\t\t\t\t\t$thisElement.click();\n\t\t\t\t}\n\t\t\t\telse if ($thisElement.prop('tagName') === 'LI') {\n\t\t\t\t\t$thisElement.click();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.addHtml5MediaListeners = function () {\n\n\t\tvar thisObj = this;\n\n\t\t// NOTE: iOS and some browsers do not support autoplay\n\t\t// and no events are triggered until media begins to play\n\t\t// Able Player gets around this by automatically loading media in some circumstances\n\t\t// (see initialize.js > initPlayer() for details)\n\n\t\tthis.$media\n\t\t\t.on('emptied',function() {\n\t\t\t\t// do something\n\t\t\t})\n\t\t\t.on('loadedmetadata',function() {\n\t\t\t\t// should be able to get duration now\n\t\t\t\tthisObj.duration = thisObj.media.duration;\t\t\t\t\n\t\t\t\tvar x = 50.5; \n\t\t\t\tvar y = 51.9; \n\t\t\t\tvar diff = Math.abs(Math.round(x)-Math.round(y)); \n\t\t\t})\n\t\t\t.on('canplay',function() {\n\t\t\t\t// previously handled seeking to startTime here\n\t\t\t\t// but it's probably safer to wait for canplaythrough\n\t\t\t\t// so we know player can seek ahead to anything\n\t\t\t})\n\t\t\t.on('canplaythrough',function() {\n\t\t\t\t// previously onMediaNewSourceLoad() was called on 'loadedmetadata' \n\t\t\t\t// but that proved to be too soon for some of this functionality. \n\t\t\t\t// TODO: Monitor this. If moving it here causes performance issues, \n\t\t\t\t// consider moving some or all of this functionality to 'canplay' \n\t\t\t\t\tthisObj.onMediaNewSourceLoad(); \t\t\t\t\t\t\t\t\n\t\t\t})\n\t\t\t.on('play',function() {\n\t\t\t\t// both 'play' and 'playing' seem to be fired in all browsers (including IE11)\n\t\t\t\t// therefore, doing nothing here & doing everything when 'playing' is triggered\n\t\t\t\t thisObj.refreshControls('playpause');\n\t\t\t})\n\t\t\t.on('playing',function() {\n\t\t\t\tthisObj.playing = true;\n\t\t\t\tthisObj.paused = false;\n\t\t\t\tthisObj.swappingSrc = false; \n\t\t\t\tthisObj.refreshControls('playpause');\n\t\t\t})\n\t\t\t.on('ended',function() {\n\t\t\t\tthisObj.playing = false;\n\t\t\t\tthisObj.paused = true;\n\t\t\t\tthisObj.onMediaComplete();\n\t\t\t})\n\t\t\t.on('progress', function() {\n\t\t\t\tthisObj.refreshControls('timeline');\n\t\t\t})\n\t\t\t.on('waiting',function() {\n\t\t\t\t // do something\n\t\t\t\t // previously called refreshControls() here but this event probably doesn't warrant a refresh\n\t\t\t})\n\t\t\t.on('durationchange',function() {\n\t\t\t\t// Display new duration.\n\t\t\t\tthisObj.refreshControls('timeline');\n\t\t\t})\n\t\t\t.on('timeupdate',function() {\n\t\t\t\tthisObj.onMediaUpdateTime(); // includes a call to refreshControls()\n\t\t\t})\n\t\t\t.on('pause',function() {\t\t\t\t\n\t\t\t\tif (!thisObj.clickedPlay) {\t\t\t\t\t\n\t\t\t\t\t// 'pause' was triggered automatically, not initiated by user\n\t\t\t\t\t// this happens in some browsers when swapping source\n\t\t\t\t\t// (e.g., between tracks in a playlist or swapping description)\n\t\t\t\t\tif (thisObj.hasPlaylist || thisObj.swappingSrc) {\t\t\t\t\t\t\n\t\t\t\t\t\t// do NOT set playing to false.\n\t\t\t\t\t\t// doing so prevents continual playback after new track is loaded\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthisObj.playing = false;\n\t\t\t\t\t\tthisObj.paused = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthisObj.playing = false;\n\t\t\t\t\tthisObj.paused = true;\n\t\t\t\t}\n\t\t\t\tthisObj.clickedPlay = false; // done with this variable\n\t\t\t\tthisObj.onMediaPause(); // includes a call to refreshControls()\n\t\t\t})\n\t\t\t.on('ratechange',function() {\n\t\t\t\t// do something\n\t\t\t})\n\t\t\t.on('volumechange',function() {\n\t\t\t\tthisObj.volume = thisObj.getVolume();\n\t\t\t})\n\t\t\t.on('error',function() {\n\t\t\t\tif (thisObj.debug) {\n\t\t\t\t\tswitch (thisObj.media.error.code) {\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\tconsole.log('HTML5 Media Error: MEDIA_ERR_ABORTED');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\tconsole.log('HTML5 Media Error: MEDIA_ERR_NETWORK ');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\tconsole.log('HTML5 Media Error: MEDIA_ERR_DECODE ');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\tconsole.log('HTML5 Media Error: MEDIA_ERR_SRC_NOT_SUPPORTED ');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\tAblePlayer.prototype.addVimeoListeners = function () {\n\n\t\tvar thisObj = this;\n\n\t\t// Vimeo doesn't seem to support chaining of on() functions\n\t\t// so each event listener must be attached separately\n\t\tthis.vimeoPlayer.on('loaded', function(vimeoId) {\n\t\t\t // Triggered when a new video is loaded in the player\n\t\t\tthisObj.onMediaNewSourceLoad();\n\t\t });\n\t\tthis.vimeoPlayer.on('play', function(data) {\n\t\t\t// Triggered when the video plays\n\t\t\tthisObj.playing = true;\n\t\t\tthisObj.startedPlaying = true;\n\t\t\tthisObj.paused = false;\n\t\t\tthisObj.refreshControls('playpause');\n\t\t});\n\t\tthis.vimeoPlayer.on('ended', function(data) {\n\t\t\t// Triggered any time the video playback reaches the end.\n\t\t\t// Note: when loop is turned on, the ended event will not fire.\n\t\t\tthisObj.playing = false;\n\t\t\tthisObj.paused = true;\n\t\t\tthisObj.onMediaComplete();\n\t\t});\n\t\tthis.vimeoPlayer.on('bufferstart', function() {\n\t\t\t// Triggered when buffering starts in the player.\n\t\t\t// This is also triggered during preload and while seeking.\n\t\t\t// There is no associated data with this event.\n\t\t});\n\t\tthis.vimeoPlayer.on('bufferend', function() {\n\t\t\t// Triggered when buffering ends in the player.\n\t\t\t// This is also triggered at the end of preload and seeking.\n\t\t\t// There is no associated data with this event.\n\t\t});\n\t\tthis.vimeoPlayer.on('progress', function(data) {\n\t\t\t// Triggered as the video is loaded.\n\t\t\t // Reports back the amount of the video that has been buffered (NOT the amount played)\n\t\t\t // Data has keys duration, percent, and seconds\n\t \t});\n\t\tthis.vimeoPlayer.on('seeking', function(data) {\n\t\t \t// Triggered when the player starts seeking to a specific time.\n\t\t\t // A timeupdate event will also be fired at the same time.\n\t \t});\n\t\tthis.vimeoPlayer.on('seeked', function(data) {\n\t\t\t// Triggered when the player seeks to a specific time.\n\t\t\t// A timeupdate event will also be fired at the same time.\n\t\t});\n\t\tthis.vimeoPlayer.on('timeupdate',function(data) {\n\t\t\t// Triggered as the currentTime of the video updates.\n\t\t\t // It generally fires every 250ms, but it may vary depending on the browser.\n\t\t\tthisObj.onMediaUpdateTime(data['duration'], data['seconds']);\n\t\t});\n\t\tthis.vimeoPlayer.on('pause',function(data) {\n\t\t\t// Triggered when the video pauses\n\t\t\tif (!thisObj.clickedPlay) {\n\t\t\t\t\t// 'pause' was triggered automatically, not initiated by user\n\t\t\t\t// this happens in some browsers (not Chrome, as of 70.x)\n\t\t\t\t// when swapping source (e.g., between tracks in a playlist, or swapping description)\n\t\t\t\tif (thisObj.hasPlaylist || thisObj.swappingSrc) {\n\t\t\t\t\t\t// do NOT set playing to false.\n\t\t\t\t\t// doing so prevents continual playback after new track is loaded\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthisObj.playing = false;\n\t\t\t\t\tthisObj.paused = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthisObj.playing = false;\n\t\t\t\tthisObj.paused = true;\n\t\t\t}\n\t\t\tthisObj.clickedPlay = false; // done with this variable\n\t\t\tthisObj.onMediaPause();\n\t\t\tthisObj.refreshControls('playpause');\n\t\t});\n\t\tthis.vimeoPlayer.on('playbackratechange',function(data) {\n\t\t\t// Triggered when the playback rate of the video in the player changes.\n\t\t\t// The ability to change rate can be disabled by the creator\n\t\t\t// and the event will not fire for those videos.\n\t\t\t// data contains one key: 'playbackRate'\n\t\t\tthisObj.vimeoPlaybackRate = data['playbackRate'];\n\t\t});\n\t\tthis.vimeoPlayer.on('texttrackchange', function(data) {\n\t\t\t// Triggered when the active text track (captions/subtitles) changes.\n\t\t\t// The values will be null if text tracks are turned off.\n\t\t\t// data contains three keys: kind, label, language\n\t\t});\n\t\tthis.vimeoPlayer.on('volumechange',function(data) {\n\t\t\t// Triggered when the volume in the player changes.\n\t\t\t// Some devices do not support setting the volume of the video\n\t\t\t// independently from the system volume,\n\t\t\t// so this event will never fire on those devices.\n\t\t\tthisObj.volume = data['volume'] * 10;\n\t\t});\n\t\tthis.vimeoPlayer.on('error',function(data) {\n\t\t\t// do something with the available data\n\t\t\t// data contains three keys: message, method, name\n\t\t\t// message: A user-friendly error message\n\t\t\t// method: The Vimeo API method call that triggered the error\n\t\t\t// name: Name of the error (not necesssarily user-friendly)\n\t\t});\n\t};\n\n\tAblePlayer.prototype.addEventListeners = function () {\n\n\t\tvar thisObj, whichButton, thisElement;\n\n\t\t// Save the current object context in thisObj for use with inner functions.\n\t\tthisObj = this;\n\n\t\t// Appropriately resize media player for full screen.\n\t\t$(window).on('resize',function () {\n\t\t\tthisObj.resizePlayer();\n\t\t});\n\n\t\t// Refresh player if it changes from hidden to visible\n\t\t// There is no event triggered by a change in visibility\n\t\t// but MutationObserver works in most browsers (but NOT in IE 10 or earlier)\n\t\t// http://caniuse.com/#feat=mutationobserver\n\t\tif (window.MutationObserver) {\n\t\t\tvar target = this.$ableDiv[0];\n\t\t\tvar observer = new MutationObserver(function(mutations) {\n\t\t\t\tmutations.forEach(function(mutation) {\n\t\t\t\t\tif (mutation.type === 'attributes' && mutation.attributeName === 'style') {\n\t\t\t\t\t\t// the player's style attribute has changed. Check to see if it's visible\n\t\t\t\t\t\tif (thisObj.$ableDiv.is(':visible')) {\n\t\t\t\t\t\t\tthisObj.refreshControls('init');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tvar config = { attributes: true, childList: true, characterData: true };\n\t\t\tobserver.observe(target, config);\n\t\t}\n\t\telse {\n\t\t\t// browser doesn't support MutationObserver\n\t\t\t// TODO: Figure out an alternative solution for this rare use case in older browsers\n\t\t\t// See example in buildplayer.js > useSvg()\n\t\t}\n\t\tif (typeof this.seekBar !== 'undefined') {\n\t\t\tthis.addSeekbarListeners();\n\t\t}\n\t\telse {\n\t\t\t// wait a bit and try again\n\t\t\t// TODO: Should set this up to keep trying repeatedly.\n\t\t\t// Seekbar listeners are critical.\n\t\t\tsetTimeout(function() {\n\t\t\t\tif (typeof thisObj.seekBar !== 'undefined') {\n\t\t\t\t\tthisObj.addSeekbarListeners();\n\t\t\t\t}\n\t\t\t},2000);\n\t\t}\n\n\t\t// handle clicks on player buttons\n\t\tthis.$controllerDiv.find('div[role=\"button\"]').on('click',function(e){\n\t\t\te.stopPropagation();\n\t\t\tthisObj.onClickPlayerButton(this);\n\t\t});\n\n\t\t// handle clicks (left only) anywhere on the page. If any popups are open, close them.\n\t\t$(document).on('click',function(e) {\n\n\t\t\tif (e.button !== 0) { // not a left click\n\t\t\t\treturn false;\n\t\t\t}\t\t\t\n\t\t\tif ($('.able-popup:visible').length || $('.able-volume-popup:visible')) {\n\t\t\t\t// at least one popup is visible\n\t\t\t\tthisObj.closePopups();\n\t\t\t}\n\t\t\tif (e.target.tagName === 'VIDEO') { \n\t\t\t\t// user clicked the video (not an element that sits on top of the video)\n\t\t\t\t// handle this as a play/pause toggle click \n\t\t\t\tthisObj.clickedPlay = true; \n\t\t\t}\t\t\t\n\t\t});\n\n\t\t// handle mouse movement over player; make controls visible again if hidden\n\t\tthis.$ableDiv.on('mousemove',function() {\n\t\t\tif (thisObj.controlsHidden) {\n\t\t\t\tthisObj.fadeControls('in');\n\t\t\t\tthisObj.controlsHidden = false;\n\t\t\t\t// if there's already an active timeout, clear it and start timer again\n\t\t\t\tif (thisObj.hideControlsTimeoutStatus === 'active') {\n\t\t\t\t\twindow.clearTimeout(thisObj.hideControlsTimeout);\n\t\t\t\t\tthisObj.hideControlsTimeoutStatus = 'clear';\n\t\t\t\t}\n\t\t\t\tif (thisObj.hideControls) {\n\t\t\t\t\t// after showing controls, hide them again after a brief timeout\n\t\t\t\t\tthisObj.invokeHideControlsTimeout();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// if there's already an active timeout, clear it and start timer again\n\t\t\t\tif (thisObj.hideControlsTimeoutStatus === 'active') {\n\t\t\t\t\twindow.clearTimeout(thisObj.hideControlsTimeout);\n\t\t\t\t\tthisObj.hideControlsTimeoutStatus = 'clear';\n\t\t\t\t\tif (thisObj.hideControls) {\n\t\t\t\t\t\tthisObj.invokeHideControlsTimeout();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// if user presses a key from anywhere on the page, show player controls\n\t\t$(document).keydown(function(e) {\n\t\t\tif (thisObj.controlsHidden) {\n\t\t\t\tthisObj.fadeControls('in');\n\t\t\t\tthisObj.controlsHidden = false;\n\t\t\t\tif (thisObj.hideControlsTimeoutStatus === 'active') {\n\t\t\t\t\twindow.clearTimeout(thisObj.hideControlsTimeout);\n\t\t\t\t\tthisObj.hideControlsTimeoutStatus = 'clear';\n\t\t\t\t}\n\t\t\t\tif (thisObj.hideControls) {\n\t\t\t\t\t// after showing controls, hide them again after a brief timeout\n\t\t\t\t\tthisObj.invokeHideControlsTimeout();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// controls are visible\n\t\t\t\t// if there's already an active timeout, clear it and start timer again\n\t\t\t\tif (thisObj.hideControlsTimeoutStatus === 'active') {\n\t\t\t\t\twindow.clearTimeout(thisObj.hideControlsTimeout);\n\t\t\t\t\tthisObj.hideControlsTimeoutStatus = 'clear';\n\n\t\t\t\t\tif (thisObj.hideControls) {\n\t\t\t\t\t\tthisObj.invokeHideControlsTimeout();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// handle local keydown events if this isn't the only player on the page;\n\t\t// otherwise these are dispatched by global handler (see ableplayer-base,js)\n\t\tthis.$ableDiv.keydown(function (e) {\n\t\t\tif (AblePlayer.nextIndex > 1) {\n\t\t\t\tthisObj.onPlayerKeyPress(e);\n\t\t\t}\n\t\t});\n\n\t\t// If stenoMode is enabled in an iframe, handle keydown events from the iframe\n\t\tif (this.stenoMode && (typeof this.stenoFrameContents !== 'undefined')) {\n\t\t\tthis.stenoFrameContents.on('keydown',function(e) {\n\t\t\t\tthisObj.onPlayerKeyPress(e);\n\t\t\t});\n\t\t};\n\n\t\t// transcript is not a child of this.$ableDiv\n\t\t// therefore, must be added separately\n\t\tif (this.$transcriptArea) {\n\t\t\tthis.$transcriptArea.on('keydown',function (e) {\n\t\t\t\tif (AblePlayer.nextIndex > 1) {\n\t\t\t\t\tthisObj.onPlayerKeyPress(e);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// handle clicks on playlist items\n\t\tif (this.$playlist) {\n\t\t\tthis.$playlist.click(function(e) {\n\t\t\t\tif (!thisObj.userClickedPlaylist) {\n\t\t\t\t\t// stopgap in case multiple clicks are fired on the same playlist item\n\t\t\t\t\tthisObj.userClickedPlaylist = true; // will be set to false after new src is loaded & canplaythrough is triggered\n\t\t\t\t\tthisObj.playlistIndex = $(this).index();\n\t\t\t\t\tthisObj.cuePlaylistItem(thisObj.playlistIndex);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Also play/pause when clicking on the media.\n\t\tthis.$media.click(function () {\n\t\t\tthisObj.handlePlay();\n\t\t});\n\n\t\t// add listeners for media events\n\t\tif (this.player === 'html5') {\n\t\t\tthis.addHtml5MediaListeners();\n\t\t}\n\t\telse if (this.player === 'vimeo') {\n\t\t\t this.addVimeoListeners();\n\t\t}\n\t\telse if (this.player === 'youtube') {\n\t\t\t// Youtube doesn't give us time update events, so we just periodically generate them ourselves\n\t\t\tsetInterval(function () {\n\t\t\t\tthisObj.onMediaUpdateTime();\n\t\t\t}, 300);\n\t\t}\n\t};\n})(jQuery);\n\n(function ($) {\n\n\tAblePlayer.prototype.initDragDrop = function ( which ) {\n\n\t\t// supported values of which: 'sign', 'transcript'\n\n\t\t// NOTE: \"Drag and Drop\" for Able Player is a metaphor only!!!\n\t\t// HTML5 Drag & Drop API enables moving elements to new locations in the DOM\n\t\t// Thats not our purpose; we're simply changing the visible position on-screen\n\t\t// Therefore, the drag & drop interface was overhauled in v2.3.41 to simple\n\t\t// use mouse (and keyboard) events to change CSS positioning properties\n\n\t\t// There are nevertheless lessons to be learned from Drag & Drop about accessibility:\n\t\t// http://dev.opera.com/articles/accessible-drag-and-drop/\n\n\t\tvar thisObj, $window, $toolbar, windowName, $resizeHandle, $resizeSvg, \n\t\t\ti, x1, y1, x2, y2, $resizeLine, resizeZIndex;\n\n\t\tthisObj = this;\n\n\t\tif (which === 'transcript') {\n\t\t\t$window = this.$transcriptArea;\n\t\t\twindowName = 'transcript-window';\n\t\t\t$toolbar = this.$transcriptToolbar;\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\t$window = this.$signWindow;\n\t\t\twindowName = 'sign-window';\n\t\t\t$toolbar = this.$signToolbar;\n\t\t}\n\n\t\t// add class to trigger change in cursor on hover\n\t\t$toolbar.addClass('able-draggable');\n\n\t\t// add resize handle selector to bottom right corner\n\t\t$resizeHandle = $('<div>',{\n\t\t\t'class': 'able-resizable'\n\t\t});\n\n\t\t// fill it with three parallel diagonal lines \n\t\t$resizeSvg = $('<svg>').attr({\n\t\t\t'width': '100%',\n\t\t\t'height': '100%',\n\t\t\t'viewBox': '0 0 100 100',\n\t\t\t'preserveAspectRatio': 'none'\n\t\t});\n\t\tfor (i=1; i<=3; i++) { \n\t\t\tif (i === 1) { \n\t\t\t\tx1 = '100'; \n\t\t\t\ty1 = '0'; \n\t\t\t\tx2 = '0'; \n\t\t\t\ty2 = '100'; \n\t\t\t}\n\t\t\telse if (i === 2) { \n\t\t\t\tx1 = '33'; \n\t\t\t\ty1 = '100'; \n\t\t\t\tx2 = '100'; \n\t\t\t\ty2 = '33'; \n\t\t\t}\n\t\t\telse if (i === 3) { \n\t\t\t\tx1 = '67'; \n\t\t\t\ty1 = '100'; \n\t\t\t\tx2 = '100'; \n\t\t\t\ty2 = '67'; \n\t\t\t}\n\t\t\t$resizeLine = $('<line>').attr({ \n\t\t\t\t'x1': x1,\n\t\t\t\t'y1': y1,\n\t\t\t\t'x2': x2,\n\t\t\t\t'y2': y2,\n\t\t\t\t'vector-effect': 'non-scaling-stroke'\t\t\t\t\n\t\t\t})\n\t\t\t$resizeSvg.append($resizeLine); \n\t\t}\n\t\t$resizeHandle.html($resizeSvg); \n\n\t\t// assign z-index that's slightly higher than parent window\n\t\tresizeZIndex = parseInt($window.css('z-index')) + 100;\n\t\t$resizeHandle.css('z-index',resizeZIndex);\n\t\t$window.append($resizeHandle);\n\n\t\t// Final step: Need to refresh the DOM in order for browser to process & display the SVG\n\t\t$resizeHandle.html($resizeHandle.html());\n\n\t\t// add event listener to toolbar to start and end drag\n\t\t// other event listeners will be added when drag starts\n\t\t$toolbar.on('mousedown mouseup touchstart touchend', function(e) {\n\t\t\te.stopPropagation();\n\t\t\tif (e.type === 'mousedown' || e.type === 'touchstart') {\n\t\t\t\tif (!thisObj.windowMenuClickRegistered) {\n\t\t\t\t\tthisObj.windowMenuClickRegistered = true;\n\t\t\t\t\tthisObj.startMouseX = e.pageX;\n\t\t\t\t\tthisObj.startMouseY = e.pageY;\n\t\t\t\t\tthisObj.dragDevice = 'mouse'; // ok to use this even if device is a touchpad\n\t\t\t\t\tthisObj.startDrag(which, $window);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (e.type === 'mouseup' || e.type === 'touchend') {\n\t\t\t\tif (thisObj.dragging && thisObj.dragDevice === 'mouse') {\n\t\t\t\t\tthisObj.endDrag(which);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\t// add event listeners for resizing\n\t\t$resizeHandle.on('mousedown mouseup touchstart touchend', function(e) {\n\t\t\te.stopPropagation();\n\t\t\tif (e.type === 'mousedown' || e.type === 'touchstart') {\n\t\t\t\tif (!thisObj.windowMenuClickRegistered) {\n\t\t\t\t\tthisObj.windowMenuClickRegistered = true;\n\t\t\t\t\tthisObj.startMouseX = e.pageX;\n\t\t\t\t\tthisObj.startMouseY = e.pageY;\n\t\t\t\t\tthisObj.startResize(which, $window);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (e.type === 'mouseup' || e.type === 'touchend') {\n\t\t\t\tif (thisObj.resizing) {\n\t\t\t\t\tthisObj.endResize(which);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\t// whenever a window is clicked, bring it to the foreground\n\t\t$window.on('click', function() {\n\n\t\t\tif (!thisObj.windowMenuClickRegistered && !thisObj.finishingDrag) {\n\t\t\t\tthisObj.updateZIndex(which);\n\t\t\t}\n\t\t\tthisObj.finishingDrag = false;\n\t\t});\n\n\t\tthis.addWindowMenu(which,$window,windowName);\n\t};\n\n\tAblePlayer.prototype.addWindowMenu = function(which, $window, windowName) {\n\n\t\tvar thisObj, $windowAlert, menuId, $newButton, $buttonIcon, buttonImgSrc, $buttonImg,\n\t\t\t$buttonLabel, tooltipId, $tooltip, $popup,\n\t\t\tlabel, position, buttonHeight, buttonWidth, tooltipY, tooltipX, tooltipStyle, tooltip,\n\t\t\t$optionList, menuBaseId, options, i, $optionItem, option, menuId;\n\n\t\tthisObj = this;\n\n\t\t// Add a Boolean that will be set to true temporarily if window button or a menu item is clicked\n\t\t// This will prevent the click event from also triggering a mousedown event on the toolbar\n\t\t// (which would unexpectedly send the window into drag mode)\n\t\tthis.windowMenuClickRegistered = false;\n\n\t\t// Add another Boolean that will be set to true temporarily when mouseup fires at the end of a drag\n\t\t// this will prevent the click event from being triggered\n\t\tthis.finishingDrag = false;\n\n\t\t// create an alert div and add it to window\n\t\t$windowAlert = $('<div role=\"alert\"></div>');\n\t\t$windowAlert.addClass('able-alert');\n\t\t$windowAlert.hide();\n\t\t$windowAlert.appendTo(this.$activeWindow);\n\t\t$windowAlert.css({\n\t\t\ttop: $window.offset().top\n\t\t});\n\n\t\t// add button to draggable window which triggers a popup menu\n\t\t// for now, re-use preferences icon for this purpose\n\t\tmenuId = this.mediaId + '-' + windowName + '-menu';\n\t\t$newButton = $('<button>',{\n\t\t\t'type': 'button',\n\t\t\t'tabindex': '0',\n\t\t\t'aria-label': this.tt.windowButtonLabel,\n\t\t\t'aria-haspopup': 'true',\n\t\t\t'aria-controls': menuId,\n\t\t\t'aria-expanded': 'false',\n\t\t\t'class': 'able-button-handler-preferences'\n\t\t});\n\t\tif (this.iconType === 'font') {\n\t\t\t$buttonIcon = $('<span>',{\n\t\t\t\t'class': 'icon-preferences',\n\t\t\t\t'aria-hidden': 'true'\n\t\t\t});\n\t\t\t$newButton.append($buttonIcon);\n\t\t}\n\t\telse {\n\t\t\t// use image\n\t\t\tbuttonImgSrc = this.rootPath + 'button-icons/' + this.toolbarIconColor + '/preferences.png';\n\t\t\t$buttonImg = $('<img>',{\n\t\t\t\t'src': buttonImgSrc,\n\t\t\t\t'alt': '',\n\t\t\t\t'role': 'presentation'\n\t\t\t});\n\t\t\t$newButton.append($buttonImg);\n\t\t}\n\n\t\t// add the visibly-hidden label for screen readers that don't support aria-label on the button\n\t\t$buttonLabel = $('<span>',{\n\t\t\t'class': 'able-clipped'\n\t\t}).text(this.tt.windowButtonLabel);\n\t\t$newButton.append($buttonLabel);\n\n\t\t// add a tooltip that displays aria-label on mouseenter or focus\n\t\ttooltipId = this.mediaId + '-' + windowName + '-tooltip';\n\t\t$tooltip = $('<div>',{\n\t\t\t'class' : 'able-tooltip',\n\t\t\t'id' : tooltipId\n\t\t}).hide();\n\t\t$newButton.on('mouseenter focus',function(e) {\n\t\t\tvar label = $(this).attr('aria-label');\n\t\t\t// get position of this button\n\t\t\tvar position = $(this).position();\n\t\t\tvar buttonHeight = $(this).height();\n\t\t\tvar buttonWidth = $(this).width();\n\t\t\tvar tooltipY = position.top - buttonHeight - 5;\n\t\t\tvar tooltipX = 0;\n\t\t\tvar tooltipStyle = {\n\t\t\t\tleft: '',\n\t\t\t\tright: tooltipX + 'px',\n\t\t\t\ttop: tooltipY + 'px'\n\t\t\t};\n\t\t\tvar tooltip = AblePlayer.localGetElementById($newButton[0], tooltipId).text(label).css(tooltipStyle);\n\t\t\tthisObj.showTooltip(tooltip);\n\t\t\t$(this).on('mouseleave blur',function() {\n\t\t\t\tAblePlayer.localGetElementById($newButton[0], tooltipId).text('').hide();\n\t\t\t});\n\t\t});\n\n\t\t// setup popup menu\n\t\t$popup = this.setupPopups(windowName); // 'transcript-window' or 'sign-window'\n\t\t// define vars and assemble all the parts\n\t\tif (which === 'transcript') {\n\t\t\tthis.$transcriptAlert = $windowAlert;\n\t\t\tthis.$transcriptPopupButton = $newButton;\n\t\t\tthis.$transcriptPopup = $popup;\n\t\t\tthis.$transcriptToolbar.prepend($windowAlert,$newButton,$tooltip,$popup);\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\tthis.$signAlert = $windowAlert;\n\t\t\tthis.$signPopupButton = $newButton;\n\t\t\tthis.$signPopup = $popup;\n\t\t\tthis.$signToolbar.append($windowAlert,$newButton,$tooltip,$popup);\n\t\t}\n\n\t\t// handle button click\n\t\t$newButton.on('click mousedown keydown',function(e) {\n\n\t\t\tif (thisObj.focusNotClick) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (thisObj.dragging) {\n\t\t\t\tthisObj.dragKeys(which, e);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\te.stopPropagation();\n\t\t\tif (!thisObj.windowMenuClickRegistered && !thisObj.finishingDrag) {\n\t\t\t\t// don't set windowMenuClickRegistered yet; that happens in handler function\n\t\t\t\tthisObj.handleWindowButtonClick(which, e);\n\t\t\t}\n\t\t\tthisObj.finishingDrag = false;\n\t\t});\n\n\t\tthis.addResizeDialog(which, $window);\n\t};\n\n\tAblePlayer.prototype.addResizeDialog = function (which, $window) {\n\n\t\tvar thisObj, $windowPopup, $windowButton,\n\t\t\twidthId, heightId, startingWidth, startingHeight, aspectRatio,\n\t\t\t$resizeForm, $resizeWrapper,\n\t\t\t$resizeWidthDiv, $resizeWidthInput, $resizeWidthLabel,\n\t\t\t$resizeHeightDiv, $resizeHeightInput, $resizeHeightLabel,\n\t\t\ttempWidth, tempHeight,\n\t\t\t$saveButton, $cancelButton, newWidth, newHeight, resizeDialog;\n\n\t\tthisObj = this;\n\n\t\tif (which === 'transcript') {\n\t\t\t$windowPopup = this.$transcriptPopup;\n\t\t\t$windowButton = this.$transcriptPopupButton;\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\t$windowPopup = this.$signPopup;\n\t\t\t$windowButton = this.$signPopupButton;\n\t\t}\n\n\t\twidthId = this.mediaId + '-resize-' + which + '-width';\n\t\theightId = this.mediaId + '-resize-' + which + '-height';\n\t\tstartingWidth = $window.width();\n\t\tstartingHeight = $window.height();\n\t\taspectRatio = startingWidth / startingHeight;\n\n\t\t$resizeForm = $('<div></div>',{\n\t\t\t'class' : 'able-resize-form'\n\t\t});\n\n\t\t// inner container for all content, will be assigned to modal div's aria-describedby\n\t\t$resizeWrapper = $('<div></div>');\n\n\t\t// width field\n\t\t$resizeWidthDiv = $('<div></div>');\n\t\t$resizeWidthInput = $('<input>',{\n\t\t\t'type': 'text',\n\t\t\t'id': widthId,\n\t\t\t'value': startingWidth\n\t\t});\n\t\t$resizeWidthLabel = $('<label>',{\n\t\t\t'for': widthId\n\t\t}).text(this.tt.width);\n\n\t\t// height field\n\t\t$resizeHeightDiv = $('<div></div>');\n\t\t$resizeHeightInput = $('<input>',{\n\t\t\t'type': 'text',\n\t\t\t'id': heightId,\n\t\t\t'value': startingHeight\n\t\t});\n\t\t$resizeHeightLabel = $('<label>',{\n\t\t\t'for': heightId\n\t\t}).text(this.tt.height);\n\n\t\tif (which === 'sign') {\n\t\t\t// make height a read-only field\n\t\t\t// and calculate its value based on width to preserve aspect ratio\n\t\t\t$resizeHeightInput.prop('readonly',true);\n\t\t\t$resizeWidthInput.on('input',function() {\n\t\t\t\ttempWidth = $(this).val();\n\t\t\t\ttempHeight = Math.round(tempWidth/aspectRatio, 0);\n\t\t\t\t$resizeHeightInput.val(tempHeight);\n\t\t\t})\n\t\t}\n\n\t\t// Add save and cancel buttons.\n\t\t$saveButton = $('<button class=\"modal-button\">' + this.tt.save + '</button>');\n\t\t$cancelButton = $('<button class=\"modal-button\">' + this.tt.cancel + '</button>');\n\t\t$saveButton.on('click',function () {\n\t\t\tnewWidth = $('#' + widthId).val();\n\t\t\tnewHeight = $('#' + heightId).val();\n\t\t\tif (newWidth !== startingWidth || newHeight !== startingHeight) {\n\t\t\t\tthisObj.resizeObject(which,newWidth,newHeight);\n\t\t\t\tthisObj.updateCookie(which);\n\t\t\t}\n\t\t\tresizeDialog.hide();\n\t\t\t$windowPopup.hide();\n\t\t\t$windowButton.focus();\n\t\t});\n\t\t$cancelButton.on('click',function () {\n\t\t\tresizeDialog.hide();\n\t\t\t$windowPopup.hide();\n\t\t\t$windowButton.focus();\n\t\t});\n\n\t\t// Now assemble all the parts\n\t\t$resizeWidthDiv.append($resizeWidthLabel,$resizeWidthInput);\n\t\t$resizeHeightDiv.append($resizeHeightLabel,$resizeHeightInput);\n\t\t$resizeWrapper.append($resizeWidthDiv,$resizeHeightDiv);\n\t\t$resizeForm.append($resizeWrapper,'<hr>',$saveButton,$cancelButton);\n\n\t\t// must be appended to the BODY!\n\t\t// otherwise when aria-hidden=\"true\" is applied to all background content\n\t\t// that will include an ancestor of the dialog,\n\t\t// which will render the dialog unreadable by screen readers\n\t\t$('body').append($resizeForm);\n\t\tresizeDialog = new AccessibleDialog($resizeForm, $windowButton, 'dialog', true, this.tt.windowResizeHeading, $resizeWrapper, this.tt.closeButtonLabel, '20em');\n\t\tif (which === 'transcript') {\n\t\t\tthis.transcriptResizeDialog = resizeDialog;\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\tthis.signResizeDialog = resizeDialog;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.handleWindowButtonClick = function (which, e) {\n\n\t\tvar thisObj, $windowPopup, $windowButton, $toolbar, popupTop;\n\n\t\tthisObj = this;\n\n\t\tif (this.focusNotClick) {\n\t\t\t// transcript or sign window has just opened,\n\t\t\t// and focus moved to the window button\n\t\t\t// ignore the keystroke that triggered the popup\n\t\t\treturn false;\n\t\t}\n\n\t\tif (which === 'transcript') {\n\t\t\t$windowPopup = this.$transcriptPopup;\n\t\t\t$windowButton = this.$transcriptPopupButton;\n\t\t\t$toolbar = this.$transcriptToolbar;\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\t$windowPopup = this.$signPopup;\n\t\t\t$windowButton = this.$signPopupButton;\n\t\t\t$toolbar = this.$signToolbar;\n\t\t}\n\n\t\tif (e.type === 'keydown') {\n\t\t\t// user pressed a key\n\t\t\tif (e.which === 32 || e.which === 13) {\n\t\t\t\t// this was Enter or space\n\t\t\t\tthis.windowMenuClickRegistered = true;\n\t\t\t}\n\t\t\telse if (e.which === 27) { // escape\n\t\t\t\tif ($windowPopup.is(':visible')) {\n\t\t\t\t\t// close the popup menu\n\t\t\t\t\t$windowPopup.hide('fast', function() {\n\t\t\t\t\t\t// also reset the Boolean\n\t\t\t\t\t\tthisObj.windowMenuClickRegistered = false;\n\t\t\t\t\t\t// also restore menu items to their original state\n\t\t\t\t\t\t$windowPopup.find('li').removeClass('able-focus').attr('tabindex','-1');\n\t\t\t\t\t\t// also return focus to window options button\n\t\t\t\t\t\t$windowButton.focus();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// popup isn't open. Close the window\n\t\t\t\t\tif (which === 'sign') {\n\t\t\t\t\t\tthis.handleSignToggle();\n\t\t\t\t\t}\n\t\t\t\t\telse if (which === 'transcript') {\n\t\t\t\t\t\tthis.handleTranscriptToggle();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// this was a mouse event\n\t\t\tthis.windowMenuClickRegistered = true;\n\t\t}\n\n\t\tif ($windowPopup.is(':visible')) {\n\t\t\t$windowPopup.hide(200,'',function() {\n\t\t\t\tthisObj.windowMenuClickRegistered = false; // reset\n\t\t\t});\n\t\t\t$windowPopup.find('li').removeClass('able-focus');\n\t\t\t$windowButton.attr('aria-expanded','false').focus();\n\t\t}\n\t\telse {\n\t\t\t// first, be sure window is on top\n\t\t\tthis.updateZIndex(which);\n\t\t\tpopupTop = $windowButton.position().top + $windowButton.outerHeight();\n\t\t\t$windowPopup.css('top', popupTop);\n\t\t\t$windowPopup.show(200,'',function() {\n\t\t\t\t$windowButton.attr('aria-expanded','true');\n\t\t\t\t$(this).find('li').first().focus().addClass('able-focus');\n\t\t\t\tthisObj.windowMenuClickRegistered = false; // reset\n\t\t\t});\n\t\t}\n\t};\n\n\tAblePlayer.prototype.handleMenuChoice = function (which, choice, e) {\n\n\t\tvar thisObj, $window, $windowPopup, $windowButton, resizeDialog, width, height, $thisRadio;\n\n\t\tthisObj = this;\n\t\tif (which === 'transcript') {\n\t\t\t$window = this.$transcriptArea;\n\t\t\t$windowPopup = this.$transcriptPopup;\n\t\t\t$windowButton = this.$transcriptPopupButton;\n\t\t\tresizeDialog = this.transcriptResizeDialog;\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\t$window = this.$signWindow;\n\t\t\t$windowPopup = this.$signPopup;\n\t\t\t$windowButton = this.$signPopupButton;\n\t\t\tresizeDialog = this.signResizeDialog;\n\t\t}\n\t\tthis.$activeWindow = $window;\n\n\t\tif (e.type === 'keydown') {\n\t\t\tif (e.which === 27) { // escape\n\t\t\t\t// hide the popup menu\n\t\t\t\t$windowPopup.hide('fast', function() {\n\t\t\t\t\t// also reset the Boolean\n\t\t\t\t\tthisObj.windowMenuClickRegistered = false;\n\t\t\t\t\t// also restore menu items to their original state\n\t\t\t\t\t$windowPopup.find('li').removeClass('able-focus').attr('tabindex','-1');\n\t\t\t\t\t$windowButton.attr('aria-expanded','false');\n\t\t\t\t\t// also return focus to window options button\n\t\t\t\t\t$windowButton.focus();\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// all other keys will be handled by upstream functions\n\t\t\t\tif (choice !== 'close') {\n\t\t\t\t\tthis.$activeWindow = $window;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\t// hide the popup menu\n\t\t$windowPopup.hide('fast', function() {\n\t\t\t// also reset the boolean\n\t\t\tthisObj.windowMenuClickRegistered = false;\n\t\t\t// also restore menu items to their original state\n\t\t\t$windowPopup.find('li').removeClass('able-focus').attr('tabindex','-1');\n\t\t\t$windowButton.attr('aria-expanded','false');\n\t\t});\n\t\tif (choice !== 'close') {\n\t\t\t$windowButton.focus();\n\t\t}\n\t\tif (choice === 'move') {\n\n\t\t\t// temporarily add role=\"application\" to activeWindow\n\t\t\t// otherwise, screen readers incercept arrow keys and moving window will not work\n\t\t\tthis.$activeWindow.attr('role','application');\n\n\t\t\tif (!this.showedAlert(which)) {\n\t\t\t\tthis.showAlert(this.tt.windowMoveAlert,which);\n\t\t\t\tif (which === 'transcript') {\n\t\t\t\t\tthis.showedTranscriptAlert = true;\n\t\t\t\t}\n\t\t\t\telse if (which === 'sign') {\n\t\t\t\t\tthis.showedSignAlert = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (e.type === 'keydown') {\n\t\t\t\tthis.dragDevice = 'keyboard';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.dragDevice = 'mouse';\n\t\t\t}\n\t\t\tthis.startDrag(which, $window);\n\t\t\t$windowPopup.hide().parent().focus();\n\t\t}\n\t\telse if (choice == 'resize') {\n\t\t\t// resize through the menu uses a form, not drag\n\t\t\tvar resizeFields = resizeDialog.getInputs();\n\t\t\tif (resizeFields) {\n\t\t\t\t// reset width and height values in form\n\t\t\t\tresizeFields[0].value = $window.width();\n\t\t\t\tresizeFields[1].value = $window.height();\n\t\t\t}\n\t\t\tresizeDialog.show();\n\t\t}\n\t\telse if (choice == 'close') {\n\t\t\t// close window, place focus on corresponding button on controller bar\n\t\t\tif (which === 'transcript') {\n\t\t\t\tthis.closingTranscript = true; // stopgrap to prevent double-firing of keypress\n\t\t\t\tthis.handleTranscriptToggle();\n\t\t\t}\n\t\t\telse if (which === 'sign') {\n\t\t\t\tthis.closingSign = true; // stopgrap to prevent double-firing of keypress\n\t\t\t\tthis.handleSignToggle();\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.startDrag = function(which, $element) {\n\n\t\tvar thisObj, $windowPopup, zIndex, startPos, newX, newY;\n\n\t\tthisObj = this;\n\n\t\tif (!this.$activeWindow) {\n\t\t\tthis.$activeWindow = $element;\n\t\t}\n\t\tthis.dragging = true;\n\n\t\tif (which === 'transcript') {\n\t\t\t$windowPopup = this.$transcriptPopup;\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\t$windowPopup = this.$signPopup;\n\t\t}\n\n\t\tif (!this.showedAlert(which)) {\n\t\t\tthis.showAlert(this.tt.windowMoveAlert,which);\n\t\t\tif (which === 'transcript') {\n\t\t\t\tthis.showedTranscriptAlert = true;\n\t\t\t}\n\t\t\telse if (which === 'sign') {\n\t\t\t\tthis.showedSignAlert = true;\n\t\t\t}\n\t\t}\n\n\t\t// if window's popup menu is open, close it\n\t\tif ($windowPopup.is(':visible')) {\n\t\t\t$windowPopup.hide();\n\t\t}\n\n\t\t// be sure this window is on top\n\t\tthis.updateZIndex(which);\n\n\t\t// get starting position of element\n\t\tstartPos = this.$activeWindow.position();\n\t\tthis.dragStartX = startPos.left;\n\t\tthis.dragStartY = startPos.top;\n\n\t\tif (typeof this.startMouseX === 'undefined') {\n\t\t\tthis.dragDevice = 'keyboard';\n\t\t\tthis.dragKeyX = this.dragStartX;\n\t\t\tthis.dragKeyY = this.dragStartY;\n\t\t\t// add stopgap to prevent the Enter that triggered startDrag() from also triggering dragEnd()\n\t\t\tthis.startingDrag = true;\n\t\t}\n\t\telse {\n\t\t\tthis.dragDevice = 'mouse';\n\t\t\t// get offset between mouse position and top left corner of draggable element\n\t\t\tthis.dragOffsetX = this.startMouseX - this.dragStartX;\n\t\t\tthis.dragOffsetY = this.startMouseY - this.dragStartY;\n\t\t}\n\n\t\t// prepare element for dragging\n\t\tthis.$activeWindow.addClass('able-drag').css({\n\t\t\t'position': 'absolute',\n\t\t\t'top': this.dragStartY + 'px',\n\t\t\t'left': this.dragStartX + 'px'\n\t\t}).focus();\n\n\t\t// add device-specific event listeners\n\t\tif (this.dragDevice === 'mouse') { // might also be a touchpad\n\t\t\t$(document).on('mousemove touchmove',function(e) {\n\t\t\t\tif (thisObj.dragging) {\n\t\t\t\t\t// calculate new top left based on current mouse position - offset\n\t\t\t\t\tnewX = e.pageX - thisObj.dragOffsetX;\n\t\t\t\t\tnewY = e.pageY - thisObj.dragOffsetY;\n\t\t\t\t\tthisObj.resetDraggedObject( newX, newY );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (this.dragDevice === 'keyboard') {\n\t\t\tthis.$activeWindow.on('keydown',function(e) {\n\t\t\t\tif (thisObj.dragging) {\n\t\t\t\t\tthisObj.dragKeys(which, e);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn false;\n\t};\n\n\tAblePlayer.prototype.dragKeys = function(which, e) {\n\n\t\tvar key, keySpeed;\n\n\t\tvar thisObj = this;\n\n\t\t// stopgap to prevent firing on initial Enter or space\n\t\t// that selected \"Move\" from menu\n\t\tif (this.startingDrag) {\n\t\t\tthis.startingDrag = false;\n\t\t\treturn false;\n\t\t}\n\t\tkey = e.which;\n\t\tkeySpeed = 10; // pixels per keypress event\n\n\t\tswitch (key) {\n\t\t\tcase 37:\t// left\n\t\t\tcase 63234:\n\t\t\t\t this.dragKeyX -= keySpeed;\n\t\t\t\tbreak;\n\t\t\tcase 38:\t// up\n\t\t\tcase 63232:\n\t\t\t\tthis.dragKeyY -= keySpeed;\n\t\t\t\tbreak;\n\t\t\tcase 39:\t// right\n\t\t\tcase 63235:\n\t\t\t\tthis.dragKeyX += keySpeed;\n\t\t\t\tbreak;\n\t\t\tcase 40:\t// down\n\t\t\tcase 63233:\n\t\t\t\tthis.dragKeyY += keySpeed;\n\t\t\t\tbreak;\n\t\t\tcase 13: \t// enter\n\t\t\tcase 27: \t// escape\n\t\t\t\tthis.endDrag(which);\n\t\t\t\treturn false;\n\t\t\tdefault:\n\t\t\t\treturn false;\n\t\t}\n\t\tthis.resetDraggedObject(this.dragKeyX,this.dragKeyY);\n\t\tif (e.preventDefault) {\n\t\t\te.preventDefault();\n\t\t}\n\t\treturn false;\n\t};\n\n\tAblePlayer.prototype.resetDraggedObject = function ( x, y) {\n\n\t\tthis.$activeWindow.css({\n\t\t\t'left': x + 'px',\n\t\t\t'top': y + 'px'\n\t\t});\n\t},\n\n\tAblePlayer.prototype.resizeObject = function ( which, width, height ) {\n\n\t\tvar innerHeight;\n\n\t\t// which is either 'transcript' or 'sign'\n\t\tthis.$activeWindow.css({\n\t\t\t'width': width + 'px',\n\t\t\t'height': height + 'px'\n\t\t});\n\n\t\tif (which === 'transcript') {\n\t\t\t// $activeWindow is the outer $transcriptArea\n\t\t\t// but the inner able-transcript also needs to be resized proporitionally\n\t\t\t// (it's 50px less than its outer container)\n\t\t\tinnerHeight = height - 50;\n\t\t\tthis.$transcriptDiv.css('height', innerHeight + 'px');\n\t\t}\n\t};\n\n\tAblePlayer.prototype.endDrag = function(which) {\n\n\t\tvar thisObj, $window, $windowPopup, $windowButton;\n\t\tthisObj = this;\n\n\t\tif (which === 'transcript') {\n\t\t\t$windowPopup = this.$transcriptPopup;\n\t\t\t$windowButton = this.$transcriptPopupButton;\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\t$windowPopup = this.$signPopup;\n\t\t\t$windowButton = this.$signPopupButton;\n\t\t}\n\n\t\t$(document).off('mousemove mouseup touchmove touchup');\n\t\tthis.$activeWindow.off('keydown').removeClass('able-drag');\n\t\t// restore activeWindow role from 'application' to 'dialog'\n\t\tthis.$activeWindow.attr('role','dialog');\n\t\tthis.$activeWindow = null;\n\n\t\tif (this.dragDevice === 'keyboard') {\n\t\t\t$windowButton.focus();\n\t\t}\n\t\tthis.dragging = false;\n\n\t\t// save final position of dragged element\n\t\tthis.updateCookie(which);\n\n\t\t// reset starting mouse positions\n\t\tthis.startMouseX = undefined;\n\t\tthis.startMouseY = undefined;\n\n\t\t// Boolean to stop stray events from firing\n\t\tthis.windowMenuClickRegistered = false;\n\t\tthis.finishingDrag = true; // will be reset after window click event\n\t\t// finishingDrag should e reset after window click event,\n\t\t// which is triggered automatically after mouseup\n\t\t// However, in case that's not reliable in some browsers\n\t\t// need to ensure this gets cancelled\n\t\tsetTimeout(function() {\n\t\t\tthisObj.finishingDrag = false;\n\t\t}, 100);\n\t};\n\n\tAblePlayer.prototype.isCloseToCorner = function($window, mouseX, mouseY) {\n\n\t\t// return true if mouse is close to bottom right corner (resize target)\n\t\tvar tolerance, position, top, left, width, height, bottom, right;\n\n\t\ttolerance = 10; // number of pixels in both directions considered \"close enough\"\n\n\t\t// first, get position of element\n\t\tposition = $window.offset();\n\t\ttop = position.top;\n\t\tleft = position.left;\n\t\twidth = $window.width();\n\t\theight = $window.height();\n\t\tbottom = top + height;\n\t\tright = left + width;\n\t\tif ((Math.abs(bottom-mouseY) <= tolerance) && (Math.abs(right-mouseX) <= tolerance)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\tAblePlayer.prototype.startResize = function(which, $element) {\n\n\t\tvar thisObj, $windowPopup, zIndex, startPos, newWidth, newHeight;\n\n\t\tthisObj = this;\n\t\tthis.$activeWindow = $element;\n\t\tthis.resizing = true;\n\n\t\tif (which === 'transcript') {\n\t\t\t$windowPopup = this.$transcriptPopup;\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\t$windowPopup = this.$signPopup;\n\t\t}\n\n\t\t// if window's popup menu is open, close it & place focus on button (???)\n\t\tif ($windowPopup.is(':visible')) {\n\t\t\t$windowPopup.hide().parent().focus();\n\t\t}\n\n\t\t// get starting width and height\n\t\tstartPos = this.$activeWindow.position();\n\t\tthis.dragKeyX = this.dragStartX;\n\t\tthis.dragKeyY = this.dragStartY;\n\t\tthis.dragStartWidth = this.$activeWindow.width();\n\t\tthis.dragStartHeight = this.$activeWindow.height();\n\n\t\t// add event listeners\n\t\t$(document).on('mousemove touchmove',function(e) {\n\t\t\tif (thisObj.resizing) {\n\t\t\t\t// calculate new width and height based on changes to mouse position\n\t\t\t\tnewWidth = thisObj.dragStartWidth + (e.pageX - thisObj.startMouseX);\n\t\t\t\tnewHeight = thisObj.dragStartHeight + (e.pageY - thisObj.startMouseY);\n\t\t\t\tthisObj.resizeObject( which, newWidth, newHeight );\n\t\t\t}\n\t\t});\n\t\treturn false;\n\t};\n\n\tAblePlayer.prototype.endResize = function(which) {\n\n\t\tvar $window, $windowPopup, $windowButton;\n\n\t\tif (which === 'transcript') {\n\t\t\t$windowPopup = this.$transcriptPopup;\n\t\t\t$windowButton = this.$transcriptPopupButton;\n\t\t}\n\t\telse if (which === 'sign') {\n\t\t\t$windowPopup = this.$signPopup;\n\t\t\t$windowButton = this.$signPopupButton;\n\t\t}\n\n\t\t$(document).off('mousemove mouseup touchmove touchup');\n\t\tthis.$activeWindow.off('keydown');\n\t\t$windowButton.show().focus();\n\t\tthis.resizing = false;\n\t\tthis.$activeWindow.removeClass('able-resize');\n\n\t\t// save final width and height of dragged element\n\t\tthis.updateCookie(which);\n\n\t\t// Booleans for preventing stray events\n\t\tthis.windowMenuClickRegistered = false;\n\t\tthis.finishingDrag = true;\n\n\t\t// finishingDrag should e reset after window click event,\n\t\t// which is triggered automatically after mouseup\n\t\t// However, in case that's not reliable in some browsers\n\t\t// need to ensure this gets cancelled\n\t\tsetTimeout(function() {\n\t\t\tthis.finishingDrag = false;\n\t\t}, 100);\n\t};\n\n})(jQuery);\n\n(function ($) {\n\tAblePlayer.prototype.initSignLanguage = function() {\n\n\t\t// Sign language is only currently supported in HTML5 player, not YouTube or Vimeo\n\t\tif (this.player === 'html5') {\n\t\t\t// check to see if there's a sign language video accompanying this video\n\t\t\t// check only the first source\n\t\t\t// If sign language is provided, it must be provided for all sources\n\t\t\tthis.signFile = this.$sources.first().attr('data-sign-src');\n\t\t\tif (this.signFile) {\n\t\t\t\tif (this.isIOS()) {\n\t\t\t\t\t// IOS does not allow multiple videos to play simultaneously\n\t\t\t\t\t// Therefore, sign language as rendered by Able Player unfortunately won't work\n\t\t\t\t\tthis.hasSignLanguage = false;\n\t\t\t\t\tif (this.debug) {\n\t\t\t\t\t\tconsole.log('Sign language has been disabled due to IOS restrictions');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (this.debug) {\n\t\t\t\t\t\tconsole.log('This video has an accompanying sign language video: ' + this.signFile);\n\t\t\t\t\t}\n\t\t\t\t\tthis.hasSignLanguage = true;\n\t\t\t\t\tthis.injectSignPlayerCode();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.hasSignLanguage = false;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.hasSignLanguage = false;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.injectSignPlayerCode = function() {\n\n\t\t// create and inject surrounding HTML structure\n\n\t\tvar thisObj, signVideoId, signVideoWidth, i, signSrc, srcType, $signSource;\n\n\t\tthisObj = this;\n\n\t\tsignVideoWidth = this.getDefaultWidth('sign');\n\n\t\tsignVideoId = this.mediaId + '-sign';\n\t\tthis.$signVideo = $('<video>',{\n\t\t\t'id' : signVideoId,\n\t\t\t'tabindex' : '-1'\n\t\t});\n\t\tthis.signVideo = this.$signVideo[0];\n\t\t// for each original <source>, add a <source> to the sign <video>\n\t\tfor (i=0; i < this.$sources.length; i++) {\n\t\t\tsignSrc = this.$sources[i].getAttribute('data-sign-src');\n\t\t\tsrcType = this.$sources[i].getAttribute('type');\n\t\t\tif (signSrc) {\n\t\t\t\t$signSource = $('<source>',{\n\t\t\t\t\t'src' : signSrc,\n\t\t\t\t\t'type' : srcType\n\t\t\t\t});\n\t\t\t\tthis.$signVideo.append($signSource);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// source is missing a sign language version\n\t\t\t\t// can't include sign language\n\t\t\t\tthis.hasSignLanguage = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.$signWindow = $('<div>',{\n\t\t\t'class' : 'able-sign-window',\n\t\t\t'role': 'dialog',\n\t\t\t'aria-label': this.tt.sign\n\t\t});\n\t\tthis.$signToolbar = $('<div>',{\n\t\t\t'class': 'able-window-toolbar able-' + this.toolbarIconColor + '-controls'\n\t\t});\n\n\t\tthis.$signWindow.append(this.$signToolbar, this.$signVideo);\n\n\t\tthis.$ableWrapper.append(this.$signWindow);\n\n\t\t// make it draggable\n\t\tthis.initDragDrop('sign');\n\n\t\tif (this.prefSign === 1) {\n\t\t\t// sign window is on. Go ahead and position it and show it\n\t\t\tthis.positionDraggableWindow('sign',this.getDefaultWidth('sign'));\n\t\t}\n\t\telse {\n\t\t\tthis.$signWindow.hide();\n\t\t}\n\t};\n\n})(jQuery);\n\n(function ($) {\n\t// Look up ISO 639-1 language codes to be used as subtitle labels\n\t// In some instances \"name\" has been trunctation for readability\n\t// Sources:\n\t// http://stackoverflow.com/questions/3217492/list-of-language-codes-in-yaml-or-json/4900304#4900304\n\t// https://www.venea.net/web/culture_code\n\n\tvar isoLangs = {\n\t\t\"ab\":{\n\t\t\t\t\"name\":\"Abkhaz\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"aa\":{\n\t\t\t\t\"name\":\"Afar\",\n\t\t\t\t\"nativeName\":\"Afaraf\"\n\t\t},\n\t\t\"af\":{\n\t\t\t\t\"name\":\"Afrikaans\",\n\t\t\t\t\"nativeName\":\"Afrikaans\"\n\t\t},\n\t\t\"ak\":{\n\t\t\t\t\"name\":\"Akan\",\n\t\t\t\t\"nativeName\":\"Akan\"\n\t\t},\n\t\t\"sq\":{\n\t\t\t\t\"name\":\"Albanian\",\n\t\t\t\t\"nativeName\":\"Shqip\"\n\t\t},\n\t\t\"am\":{\n\t\t\t\t\"name\":\"Amharic\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"ar\":{\n\t\t\t\t\"name\":\"Arabic\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"an\":{\n\t\t\t\t\"name\":\"Aragonese\",\n\t\t\t\t\"nativeName\":\"Aragons\"\n\t\t},\n\t\t\"hy\":{\n\t\t\t\t\"name\":\"Armenian\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"as\":{\n\t\t\t\t\"name\":\"Assamese\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"av\":{\n\t\t\t\t\"name\":\"Avaric\",\n\t\t\t\t\"nativeName\":\" ,  \"\n\t\t},\n\t\t\"ae\":{\n\t\t\t\t\"name\":\"Avestan\",\n\t\t\t\t\"nativeName\":\"avesta\"\n\t\t},\n\t\t\"ay\":{\n\t\t\t\t\"name\":\"Aymara\",\n\t\t\t\t\"nativeName\":\"aymar aru\"\n\t\t},\n\t\t\"az\":{\n\t\t\t\t\"name\":\"Azerbaijani\",\n\t\t\t\t\"nativeName\":\"azrbaycan dili\"\n\t\t},\n\t\t\"bm\":{\n\t\t\t\t\"name\":\"Bambara\",\n\t\t\t\t\"nativeName\":\"bamanankan\"\n\t\t},\n\t\t\"ba\":{\n\t\t\t\t\"name\":\"Bashkir\",\n\t\t\t\t\"nativeName\":\" \"\n\t\t},\n\t\t\"eu\":{\n\t\t\t\t\"name\":\"Basque\",\n\t\t\t\t\"nativeName\":\"euskara, euskera\"\n\t\t},\n\t\t\"be\":{\n\t\t\t\t\"name\":\"Belarusian\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"bn\":{\n\t\t\t\t\"name\":\"Bengali\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"bh\":{\n\t\t\t\t\"name\":\"Bihari\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"bi\":{\n\t\t\t\t\"name\":\"Bislama\",\n\t\t\t\t\"nativeName\":\"Bislama\"\n\t\t},\n\t\t\"bs\":{\n\t\t\t\t\"name\":\"Bosnian\",\n\t\t\t\t\"nativeName\":\"bosanski jezik\"\n\t\t},\n\t\t\"br\":{\n\t\t\t\t\"name\":\"Breton\",\n\t\t\t\t\"nativeName\":\"brezhoneg\"\n\t\t},\n\t\t\"bg\":{\n\t\t\t\t\"name\":\"Bulgarian\",\n\t\t\t\t\"nativeName\":\" \"\n\t\t},\n\t\t\"my\":{\n\t\t\t\t\"name\":\"Burmese\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"ca\":{\n\t\t\t\t\"name\":\"Catalan\",\n\t\t\t\t\"nativeName\":\"Catal\"\n\t\t},\n\t\t\"ch\":{\n\t\t\t\t\"name\":\"Chamorro\",\n\t\t\t\t\"nativeName\":\"Chamoru\"\n\t\t},\n\t\t\"ce\":{\n\t\t\t\t\"name\":\"Chechen\",\n\t\t\t\t\"nativeName\":\" \"\n\t\t},\n\t\t\"ny\":{\n\t\t\t\t\"name\":\"Chichewa\",\n\t\t\t\t\"nativeName\":\"chiChea, chinyanja\"\n\t\t},\n\t\t\"zh\":{\n\t\t\t\t\"name\":\"Chinese\",\n\t\t\t\t\"nativeName\":\" (Zhngwn), , \"\n\t\t},\n\t\t\"cv\":{\n\t\t\t\t\"name\":\"Chuvash\",\n\t\t\t\t\"nativeName\":\" \"\n\t\t},\n\t\t\"kw\":{\n\t\t\t\t\"name\":\"Cornish\",\n\t\t\t\t\"nativeName\":\"Kernewek\"\n\t\t},\n\t\t\"co\":{\n\t\t\t\t\"name\":\"Corsican\",\n\t\t\t\t\"nativeName\":\"corsu, lingua corsa\"\n\t\t},\n\t\t\"cr\":{\n\t\t\t\t\"name\":\"Cree\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"hr\":{\n\t\t\t\t\"name\":\"Croatian\",\n\t\t\t\t\"nativeName\":\"hrvatski\"\n\t\t},\n\t\t\"cs\":{\n\t\t\t\t\"name\":\"Czech\",\n\t\t\t\t\"nativeName\":\"esky, etina\"\n\t\t},\n\t\t\"da\":{\n\t\t\t\t\"name\":\"Danish\",\n\t\t\t\t\"nativeName\":\"dansk\"\n\t\t},\n\t\t\"dv\":{\n\t\t\t\t\"name\":\"Divehi\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"nl\":{\n\t\t\t\t\"name\":\"Dutch\",\n\t\t\t\t\"nativeName\":\"Nederlands, Vlaams\"\n\t\t},\n\t\t\"en\":{\n\t\t\t\t\"name\":\"English\",\n\t\t\t\t\"nativeName\":\"English\"\n\t\t},\n\t\t\"eo\":{\n\t\t\t\t\"name\":\"Esperanto\",\n\t\t\t\t\"nativeName\":\"Esperanto\"\n\t\t},\n\t\t\"et\":{\n\t\t\t\t\"name\":\"Estonian\",\n\t\t\t\t\"nativeName\":\"eesti, eesti keel\"\n\t\t},\n\t\t\"ee\":{\n\t\t\t\t\"name\":\"Ewe\",\n\t\t\t\t\"nativeName\":\"Eegbe\"\n\t\t},\n\t\t\"fo\":{\n\t\t\t\t\"name\":\"Faroese\",\n\t\t\t\t\"nativeName\":\"froyskt\"\n\t\t},\n\t\t\"fj\":{\n\t\t\t\t\"name\":\"Fijian\",\n\t\t\t\t\"nativeName\":\"vosa Vakaviti\"\n\t\t},\n\t\t\"fi\":{\n\t\t\t\t\"name\":\"Finnish\",\n\t\t\t\t\"nativeName\":\"suomi, suomen kieli\"\n\t\t},\n\t\t\"fr\":{\n\t\t\t\t\"name\":\"French\",\n\t\t\t\t\"nativeName\":\"franais, langue franaise\"\n\t\t},\n\t\t\"ff\":{\n\t\t\t\t\"name\":\"Fula\",\n\t\t\t\t\"nativeName\":\"Fulfulde, Pulaar, Pular\"\n\t\t},\n\t\t\"gl\":{\n\t\t\t\t\"name\":\"Galician\",\n\t\t\t\t\"nativeName\":\"Galego\"\n\t\t},\n\t\t\"ka\":{\n\t\t\t\t\"name\":\"Georgian\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"de\":{\n\t\t\t\t\"name\":\"German\",\n\t\t\t\t\"nativeName\":\"Deutsch\"\n\t\t},\n\t\t\"el\":{\n\t\t\t\t\"name\":\"Greek\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"gn\":{\n\t\t\t\t\"name\":\"Guaran\",\n\t\t\t\t\"nativeName\":\"Avae\"\n\t\t},\n\t\t\"gu\":{\n\t\t\t\t\"name\":\"Gujarati\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"ht\":{\n\t\t\t\t\"name\":\"Haitian\",\n\t\t\t\t\"nativeName\":\"Kreyl ayisyen\"\n\t\t},\n\t\t\"ha\":{\n\t\t\t\t\"name\":\"Hausa\",\n\t\t\t\t\"nativeName\":\"Hausa, \"\n\t\t},\n\t\t\"he\":{\n\t\t\t\t\"name\":\"Hebrew\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"hz\":{\n\t\t\t\t\"name\":\"Herero\",\n\t\t\t\t\"nativeName\":\"Otjiherero\"\n\t\t},\n\t\t\"hi\":{\n\t\t\t\t\"name\":\"Hindi\",\n\t\t\t\t\"nativeName\":\", \"\n\t\t},\n\t\t\"ho\":{\n\t\t\t\t\"name\":\"Hiri Motu\",\n\t\t\t\t\"nativeName\":\"Hiri Motu\"\n\t\t},\n\t\t\"hu\":{\n\t\t\t\t\"name\":\"Hungarian\",\n\t\t\t\t\"nativeName\":\"Magyar\"\n\t\t},\n\t\t\"ia\":{\n\t\t\t\t\"name\":\"Interlingua\",\n\t\t\t\t\"nativeName\":\"Interlingua\"\n\t\t},\n\t\t\"id\":{\n\t\t\t\t\"name\":\"Indonesian\",\n\t\t\t\t\"nativeName\":\"Bahasa Indonesia\"\n\t\t},\n\t\t\"ie\":{\n\t\t\t\t\"name\":\"Interlingue\",\n\t\t\t\t\"nativeName\":\"Originally called Occidental; then Interlingue after WWII\"\n\t\t},\n\t\t\"ga\":{\n\t\t\t\t\"name\":\"Irish\",\n\t\t\t\t\"nativeName\":\"Gaeilge\"\n\t\t},\n\t\t\"ig\":{\n\t\t\t\t\"name\":\"Igbo\",\n\t\t\t\t\"nativeName\":\"Ass Igbo\"\n\t\t},\n\t\t\"ik\":{\n\t\t\t\t\"name\":\"Inupiaq\",\n\t\t\t\t\"nativeName\":\"Iupiaq, Iupiatun\"\n\t\t},\n\t\t\"io\":{\n\t\t\t\t\"name\":\"Ido\",\n\t\t\t\t\"nativeName\":\"Ido\"\n\t\t},\n\t\t\"is\":{\n\t\t\t\t\"name\":\"Icelandic\",\n\t\t\t\t\"nativeName\":\"slenska\"\n\t\t},\n\t\t\"it\":{\n\t\t\t\t\"name\":\"Italian\",\n\t\t\t\t\"nativeName\":\"Italiano\"\n\t\t},\n\t\t\"iu\":{\n\t\t\t\t\"name\":\"Inuktitut\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"ja\":{\n\t\t\t\t\"name\":\"Japanese\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"jv\":{\n\t\t\t\t\"name\":\"Javanese\",\n\t\t\t\t\"nativeName\":\"basa Jawa\"\n\t\t},\n\t\t\"kl\":{\n\t\t\t\t\"name\":\"Kalaallisut\",\n\t\t\t\t\"nativeName\":\"kalaallisut, kalaallit oqaasii\"\n\t\t},\n\t\t\"kn\":{\n\t\t\t\t\"name\":\"Kannada\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"kr\":{\n\t\t\t\t\"name\":\"Kanuri\",\n\t\t\t\t\"nativeName\":\"Kanuri\"\n\t\t},\n\t\t\"ks\":{\n\t\t\t\t\"name\":\"Kashmiri\",\n\t\t\t\t\"nativeName\":\", \"\n\t\t},\n\t\t\"kk\":{\n\t\t\t\t\"name\":\"Kazakh\",\n\t\t\t\t\"nativeName\":\" \"\n\t\t},\n\t\t\"km\":{\n\t\t\t\t\"name\":\"Khmer\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"ki\":{\n\t\t\t\t\"name\":\"Kikuyu\",\n\t\t\t\t\"nativeName\":\"Gky\"\n\t\t},\n\t\t\"rw\":{\n\t\t\t\t\"name\":\"Kinyarwanda\",\n\t\t\t\t\"nativeName\":\"Ikinyarwanda\"\n\t\t},\n\t\t\"ky\":{\n\t\t\t\t\"name\":\"Kyrgyz\",\n\t\t\t\t\"nativeName\":\" \"\n\t\t},\n\t\t\"kv\":{\n\t\t\t\t\"name\":\"Komi\",\n\t\t\t\t\"nativeName\":\" \"\n\t\t},\n\t\t\"kg\":{\n\t\t\t\t\"name\":\"Kongo\",\n\t\t\t\t\"nativeName\":\"KiKongo\"\n\t\t},\n\t\t\"ko\":{\n\t\t\t\t\"name\":\"Korean\",\n\t\t\t\t\"nativeName\":\" (),  ()\"\n\t\t},\n\t\t\"ku\":{\n\t\t\t\t\"name\":\"Kurdish\",\n\t\t\t\t\"nativeName\":\"Kurd, \"\n\t\t},\n\t\t\"kj\":{\n\t\t\t\t\"name\":\"Kuanyama\",\n\t\t\t\t\"nativeName\":\"Kuanyama\"\n\t\t},\n\t\t\"la\":{\n\t\t\t\t\"name\":\"Latin\",\n\t\t\t\t\"nativeName\":\"latine, lingua latina\"\n\t\t},\n\t\t\"lb\":{\n\t\t\t\t\"name\":\"Luxembourgish\",\n\t\t\t\t\"nativeName\":\"Ltzebuergesch\"\n\t\t},\n\t\t\"lg\":{\n\t\t\t\t\"name\":\"Luganda\",\n\t\t\t\t\"nativeName\":\"Luganda\"\n\t\t},\n\t\t\"li\":{\n\t\t\t\t\"name\":\"Limburgish\",\n\t\t\t\t\"nativeName\":\"Limburgs\"\n\t\t},\n\t\t\"ln\":{\n\t\t\t\t\"name\":\"Lingala\",\n\t\t\t\t\"nativeName\":\"Lingla\"\n\t\t},\n\t\t\"lo\":{\n\t\t\t\t\"name\":\"Lao\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"lt\":{\n\t\t\t\t\"name\":\"Lithuanian\",\n\t\t\t\t\"nativeName\":\"lietuvi kalba\"\n\t\t},\n\t\t\"lu\":{\n\t\t\t\t\"name\":\"Luba-Katanga\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"lv\":{\n\t\t\t\t\"name\":\"Latvian\",\n\t\t\t\t\"nativeName\":\"latvieu valoda\"\n\t\t},\n\t\t\"gv\":{\n\t\t\t\t\"name\":\"Manx\",\n\t\t\t\t\"nativeName\":\"Gaelg, Gailck\"\n\t\t},\n\t\t\"mk\":{\n\t\t\t\t\"name\":\"Macedonian\",\n\t\t\t\t\"nativeName\":\" \"\n\t\t},\n\t\t\"mg\":{\n\t\t\t\t\"name\":\"Malagasy\",\n\t\t\t\t\"nativeName\":\"Malagasy fiteny\"\n\t\t},\n\t\t\"ms\":{\n\t\t\t\t\"name\":\"Malay\",\n\t\t\t\t\"nativeName\":\"bahasa Melayu,  \"\n\t\t},\n\t\t\"ml\":{\n\t\t\t\t\"name\":\"Malayalam\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"mt\":{\n\t\t\t\t\"name\":\"Maltese\",\n\t\t\t\t\"nativeName\":\"Malti\"\n\t\t},\n\t\t\"mi\":{\n\t\t\t\t\"name\":\"Mori\",\n\t\t\t\t\"nativeName\":\"te reo Mori\"\n\t\t},\n\t\t\"mr\":{\n\t\t\t\t\"name\":\"Marathi\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"mh\":{\n\t\t\t\t\"name\":\"Marshallese\",\n\t\t\t\t\"nativeName\":\"Kajin Maje\"\n\t\t},\n\t\t\"mn\":{\n\t\t\t\t\"name\":\"Mongolian\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"na\":{\n\t\t\t\t\"name\":\"Nauru\",\n\t\t\t\t\"nativeName\":\"Ekakair Naoero\"\n\t\t},\n\t\t\"nv\":{\n\t\t\t\t\"name\":\"Navajo\",\n\t\t\t\t\"nativeName\":\"Din bizaad, Dinkeh\"\n\t\t},\n\t\t\"nb\":{\n\t\t\t\t\"name\":\"Norwegian Bokml\",\n\t\t\t\t\"nativeName\":\"Norsk bokml\"\n\t\t},\n\t\t\"nd\":{\n\t\t\t\t\"name\":\"North Ndebele\",\n\t\t\t\t\"nativeName\":\"isiNdebele\"\n\t\t},\n\t\t\"ne\":{\n\t\t\t\t\"name\":\"Nepali\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"ng\":{\n\t\t\t\t\"name\":\"Ndonga\",\n\t\t\t\t\"nativeName\":\"Owambo\"\n\t\t},\n\t\t\"nn\":{\n\t\t\t\t\"name\":\"Norwegian Nynorsk\",\n\t\t\t\t\"nativeName\":\"Norsk nynorsk\"\n\t\t},\n\t\t\"no\":{\n\t\t\t\t\"name\":\"Norwegian\",\n\t\t\t\t\"nativeName\":\"Norsk\"\n\t\t},\n\t\t\"ii\":{\n\t\t\t\t\"name\":\"Nuosu\",\n\t\t\t\t\"nativeName\":\" Nuosuhxop\"\n\t\t},\n\t\t\"nr\":{\n\t\t\t\t\"name\":\"South Ndebele\",\n\t\t\t\t\"nativeName\":\"isiNdebele\"\n\t\t},\n\t\t\"oc\":{\n\t\t\t\t\"name\":\"Occitan\",\n\t\t\t\t\"nativeName\":\"Occitan\"\n\t\t},\n\t\t\"oj\":{\n\t\t\t\t\"name\":\"Ojibwe\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"cu\":{\n\t\t\t\t\"name\":\"Church Slavonic\",\n\t\t\t\t\"nativeName\":\" \"\n\t\t},\n\t\t\"om\":{\n\t\t\t\t\"name\":\"Oromo\",\n\t\t\t\t\"nativeName\":\"Afaan Oromoo\"\n\t\t},\n\t\t\"or\":{\n\t\t\t\t\"name\":\"Oriya\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"os\":{\n\t\t\t\t\"name\":\"Ossetian\",\n\t\t\t\t\"nativeName\":\" \"\n\t\t},\n\t\t\"pa\":{\n\t\t\t\t\"name\":\"Punjabi\",\n\t\t\t\t\"nativeName\":\", \"\n\t\t},\n\t\t\"pi\":{\n\t\t\t\t\"name\":\"Pli\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"fa\":{\n\t\t\t\t\"name\":\"Persian\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"pl\":{\n\t\t\t\t\"name\":\"Polish\",\n\t\t\t\t\"nativeName\":\"polski\"\n\t\t},\n\t\t\"ps\":{\n\t\t\t\t\"name\":\"Pashto\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"pt\":{\n\t\t\t\t\"name\":\"Portuguese\",\n\t\t\t\t\"nativeName\":\"Portugus\"\n\t\t},\n\t\t\"qu\":{\n\t\t\t\t\"name\":\"Quechua\",\n\t\t\t\t\"nativeName\":\"Runa Simi, Kichwa\"\n\t\t},\n\t\t\"rm\":{\n\t\t\t\t\"name\":\"Romansh\",\n\t\t\t\t\"nativeName\":\"rumantsch grischun\"\n\t\t},\n\t\t\"rn\":{\n\t\t\t\t\"name\":\"Kirundi\",\n\t\t\t\t\"nativeName\":\"kiRundi\"\n\t\t},\n\t\t\"ro\":{\n\t\t\t\t\"name\":\"Romanian\",\n\t\t\t\t\"nativeName\":\"romn\"\n\t\t},\n\t\t\"ru\":{\n\t\t\t\t\"name\":\"Russian\",\n\t\t\t\t\"nativeName\":\" \"\n\t\t},\n\t\t\"sa\":{\n\t\t\t\t\"name\":\"Sanskrit\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"sc\":{\n\t\t\t\t\"name\":\"Sardinian\",\n\t\t\t\t\"nativeName\":\"sardu\"\n\t\t},\n\t\t\"sd\":{\n\t\t\t\t\"name\":\"Sindhi\",\n\t\t\t\t\"nativeName\":\",  \"\n\t\t},\n\t\t\"se\":{\n\t\t\t\t\"name\":\"Northern Sami\",\n\t\t\t\t\"nativeName\":\"Davvismegiella\"\n\t\t},\n\t\t\"sm\":{\n\t\t\t\t\"name\":\"Samoan\",\n\t\t\t\t\"nativeName\":\"gagana faa Samoa\"\n\t\t},\n\t\t\"sg\":{\n\t\t\t\t\"name\":\"Sango\",\n\t\t\t\t\"nativeName\":\"yng t sng\"\n\t\t},\n\t\t\"sr\":{\n\t\t\t\t\"name\":\"Serbian\",\n\t\t\t\t\"nativeName\":\" \"\n\t\t},\n\t\t\"gd\":{\n\t\t\t\t\"name\":\"Gaelic\",\n\t\t\t\t\"nativeName\":\"Gidhlig\"\n\t\t},\n\t\t\"sn\":{\n\t\t\t\t\"name\":\"Shona\",\n\t\t\t\t\"nativeName\":\"chiShona\"\n\t\t},\n\t\t\"si\":{\n\t\t\t\t\"name\":\"Sinhalese\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"sk\":{\n\t\t\t\t\"name\":\"Slovak\",\n\t\t\t\t\"nativeName\":\"slovenina\"\n\t\t},\n\t\t\"sl\":{\n\t\t\t\t\"name\":\"Slovene\",\n\t\t\t\t\"nativeName\":\"slovenina\"\n\t\t},\n\t\t\"so\":{\n\t\t\t\t\"name\":\"Somali\",\n\t\t\t\t\"nativeName\":\"Soomaaliga, af Soomaali\"\n\t\t},\n\t\t\"st\":{\n\t\t\t\t\"name\":\"Southern Sotho\",\n\t\t\t\t\"nativeName\":\"Sesotho\"\n\t\t},\n\t\t\"es\":{\n\t\t\t\t\"name\":\"Spanish\",\n\t\t\t\t\"nativeName\":\"espaol, castellano\"\n\t\t},\n\t\t\"su\":{\n\t\t\t\t\"name\":\"Sundanese\",\n\t\t\t\t\"nativeName\":\"Basa Sunda\"\n\t\t},\n\t\t\"sw\":{\n\t\t\t\t\"name\":\"Swahili\",\n\t\t\t\t\"nativeName\":\"Kiswahili\"\n\t\t},\n\t\t\"ss\":{\n\t\t\t\t\"name\":\"Swati\",\n\t\t\t\t\"nativeName\":\"SiSwati\"\n\t\t},\n\t\t\"sv\":{\n\t\t\t\t\"name\":\"Swedish\",\n\t\t\t\t\"nativeName\":\"svenska\"\n\t\t},\n\t\t\"ta\":{\n\t\t\t\t\"name\":\"Tamil\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"te\":{\n\t\t\t\t\"name\":\"Telugu\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"tg\":{\n\t\t\t\t\"name\":\"Tajik\",\n\t\t\t\t\"nativeName\":\", toik, \"\n\t\t},\n\t\t\"th\":{\n\t\t\t\t\"name\":\"Thai\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"ti\":{\n\t\t\t\t\"name\":\"Tigrinya\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"bo\":{\n\t\t\t\t\"name\":\"Tibetan\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"tk\":{\n\t\t\t\t\"name\":\"Turkmen\",\n\t\t\t\t\"nativeName\":\"Trkmen, \"\n\t\t},\n\t\t\"tl\":{\n\t\t\t\t\"name\":\"Tagalog\",\n\t\t\t\t\"nativeName\":\"Wikang Tagalog,  \"\n\t\t},\n\t\t\"tn\":{\n\t\t\t\t\"name\":\"Tswana\",\n\t\t\t\t\"nativeName\":\"Setswana\"\n\t\t},\n\t\t\"to\":{\n\t\t\t\t\"name\":\"Tonga\",\n\t\t\t\t\"nativeName\":\"faka Tonga\"\n\t\t},\n\t\t\"tr\":{\n\t\t\t\t\"name\":\"Turkish\",\n\t\t\t\t\"nativeName\":\"Trke\"\n\t\t},\n\t\t\"ts\":{\n\t\t\t\t\"name\":\"Tsonga\",\n\t\t\t\t\"nativeName\":\"Xitsonga\"\n\t\t},\n\t\t\"tt\":{\n\t\t\t\t\"name\":\"Tatar\",\n\t\t\t\t\"nativeName\":\", tatara, \"\n\t\t},\n\t\t\"tw\":{\n\t\t\t\t\"name\":\"Twi\",\n\t\t\t\t\"nativeName\":\"Twi\"\n\t\t},\n\t\t\"ty\":{\n\t\t\t\t\"name\":\"Tahitian\",\n\t\t\t\t\"nativeName\":\"Reo Tahiti\"\n\t\t},\n\t\t\"ug\":{\n\t\t\t\t\"name\":\"Uyghur\",\n\t\t\t\t\"nativeName\":\"Uyurq, \"\n\t\t},\n\t\t\"uk\":{\n\t\t\t\t\"name\":\"Ukrainian\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"ur\":{\n\t\t\t\t\"name\":\"Urdu\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"uz\":{\n\t\t\t\t\"name\":\"Uzbek\",\n\t\t\t\t\"nativeName\":\"zbek, , \"\n\t\t},\n\t\t\"ve\":{\n\t\t\t\t\"name\":\"Venda\",\n\t\t\t\t\"nativeName\":\"Tshivena\"\n\t\t},\n\t\t\"vi\":{\n\t\t\t\t\"name\":\"Vietnamese\",\n\t\t\t\t\"nativeName\":\"Ting Vit\"\n\t\t},\n\t\t\"vo\":{\n\t\t\t\t\"name\":\"Volapk\",\n\t\t\t\t\"nativeName\":\"Volapk\"\n\t\t},\n\t\t\"wa\":{\n\t\t\t\t\"name\":\"Walloon\",\n\t\t\t\t\"nativeName\":\"Walon\"\n\t\t},\n\t\t\"cy\":{\n\t\t\t\t\"name\":\"Welsh\",\n\t\t\t\t\"nativeName\":\"Cymraeg\"\n\t\t},\n\t\t\"wo\":{\n\t\t\t\t\"name\":\"Wolof\",\n\t\t\t\t\"nativeName\":\"Wollof\"\n\t\t},\n\t\t\"fy\":{\n\t\t\t\t\"name\":\"Western Frisian\",\n\t\t\t\t\"nativeName\":\"Frysk\"\n\t\t},\n\t\t\"xh\":{\n\t\t\t\t\"name\":\"Xhosa\",\n\t\t\t\t\"nativeName\":\"isiXhosa\"\n\t\t},\n\t\t\"yi\":{\n\t\t\t\t\"name\":\"Yiddish\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"yo\":{\n\t\t\t\t\"name\":\"Yoruba\",\n\t\t\t\t\"nativeName\":\"Yorb\"\n\t\t},\n\t\t\"za\":{\n\t\t\t\t\"name\":\"Zhuang\",\n\t\t\t\t\"nativeName\":\"Sa cue, Saw cuengh\"\n\t\t},\n\t\t\"ar-dz\":{\n\t\t\t\t\"name\":\"Arabic (Algeria)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"ar-bh\":{\n\t\t\t\t\"name\":\"Arabic (Bahrain)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"ar-eg\":{\n\t\t\t\t\"name\":\"Arabic (Egypt)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"ar-iq\":{\n\t\t\t\t\"name\":\"Arabic (Iraq)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"ar-jo\":{\n\t\t\t\t\"name\":\"Arabic (Jordan)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"ar-kw\":{\n\t\t\t\t\"name\":\"Arabic (Kuwait)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"ar-lb\":{\n\t\t\t\t\"name\":\"Arabic (Lebanon)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"ar-ly\":{\n\t\t\t\t\"name\":\"Arabic (Libya)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"ar-ma\":{\n\t\t\t\t\"name\":\"Arabic (Morocco)\",\n\t\t\t\t\"nativeName\":\" ( )\"\n\t\t},\n\t\t\"ar-om\":{\n\t\t\t\t\"name\":\"Arabic (Oman)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"ar-qa\":{\n\t\t\t\t\"name\":\"Arabic (Qatar)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"ar-sa\":{\n\t\t\t\t\"name\":\"Arabic (Saudi Arabia)\",\n\t\t\t\t\"nativeName\":\" (  )\"\n\t\t},\n\t\t\"ar-sy\":{\n\t\t\t\t\"name\":\"Arabic (Syria)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"ar-tn\":{\n\t\t\t\t\"name\":\"Arabic (Tunisia)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"ar-ae\":{\n\t\t\t\t\"name\":\"Arabic (U.A.E.)\",\n\t\t\t\t\"nativeName\":\" (  )\"\n\t\t},\n\t\t\"ar-ye\":{\n\t\t\t\t\"name\":\"Arabic (Yemen)\",\n\t\t\t\t\"nativeName\":\" ()\"\n\t\t},\n\t\t\"de-at\":{\n\t\t\t\t\"name\":\"German (Austria)\",\n\t\t\t\t\"nativeName\":\"Deutsch (sterreich)\"\n\t\t},\n\t\t\"de-li\":{\n\t\t\t\t\"name\":\"German (Liechtenstein)\",\n\t\t\t\t\"nativeName\":\"Deutsch (Liechtenstein)\"\n\t\t},\n\t\t\"de-lu\":{\n\t\t\t\t\"name\":\"German (Luxembourg)\",\n\t\t\t\t\"nativeName\":\"Deutsch (Luxemburg)\"\n\t\t},\n\t\t\"de-ch\":{\n\t\t\t\t\"name\":\"German (Switzerland)\",\n\t\t\t\t\"nativeName\":\"Deutsch (Schweiz)\"\n\t\t},\n\t\t\"en-au\":{\n\t\t\t\t\"name\":\"English (Australia)\",\n\t\t\t\t\"nativeName\":\"English (Australia)\"\n\t\t},\n\t\t\"en-bz\":{\n\t\t\t\t\"name\":\"English (Belize)\",\n\t\t\t\t\"nativeName\":\"English (Belize)\"\n\t\t},\n\t\t\"en-ca\":{\n\t\t\t\t\"name\":\"English (Canada)\",\n\t\t\t\t\"nativeName\":\"English (Canada)\"\n\t\t},\n\t\t\"en-ie\":{\n\t\t\t\t\"name\":\"English (Ireland)\",\n\t\t\t\t\"nativeName\":\"English (Ireland)\"\n\t\t},\n\t\t\"en-jm\":{\n\t\t\t\t\"name\":\"English (Jamaica)\",\n\t\t\t\t\"nativeName\":\"English (Jamaica)\"\n\t\t},\n\t\t\"en-nz\":{\n\t\t\t\t\"name\":\"English (New Zealand)\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t},\n\t\t\"en-za\":{\n\t\t\t\t\"name\":\"English (South Africa)\",\n\t\t\t\t\"nativeName\":\"English (South Africa)\"\n\t\t},\n\t\t\"en-tt\":{\n\t\t\t\t\"name\":\"English (Trinidad)\",\n\t\t\t\t\"nativeName\":\"English (Trinidad y Tobago)\"\n\t\t},\n\t\t\"en-gb\":{\n\t\t\t\t\"name\":\"English (United Kingdom)\",\n\t\t\t\t\"nativeName\":\"English (United Kingdom)\"\n\t\t},\n\t\t\"en-us\":{\n\t\t\t\t\"name\":\"English (United States)\",\n\t\t\t\t\"nativeName\":\"English (United States)\"\n\t\t},\n\t\t\"es-ar\":{\n\t\t\t\t\"name\":\"Spanish (Argentina)\",\n\t\t\t\t\"nativeName\":\"Espaol (Argentina)\"\n\t\t},\n\t\t\"es-bo\":{\n\t\t\t\t\"name\":\"Spanish (Bolivia)\",\n\t\t\t\t\"nativeName\":\"Espaol (Bolivia)\"\n\t\t},\n\t\t\"es-cl\":{\n\t\t\t\t\"name\":\"Spanish (Chile)\",\n\t\t\t\t\"nativeName\":\"Espaol (Chile)\"\n\t\t},\n\t\t\"es-co\":{\n\t\t\t\t\"name\":\"Spanish (Colombia)\",\n\t\t\t\t\"nativeName\":\"Espaol (Colombia)\"\n\t\t},\n\t\t\"es-cr\":{\n\t\t\t\t\"name\":\"Spanish (Costa Rica)\",\n\t\t\t\t\"nativeName\":\"Espaol (Costa Rica)\"\n\t\t},\n\t\t\"es-do\":{\n\t\t\t\t\"name\":\"Spanish (Dominican Republic)\",\n\t\t\t\t\"nativeName\":\"Espaol (Repblica Dominicana)\"\n\t\t},\n\t\t\"es-ec\":{\n\t\t\t\t\"name\":\"Spanish (Ecuador)\",\n\t\t\t\t\"nativeName\":\"Espaol (Ecuador)\"\n\t\t},\n\t\t\"es-sv\":{\n\t\t\t\t\"name\":\"Spanish (El Salvador)\",\n\t\t\t\t\"nativeName\":\"Espaol (El Salvador)\"\n\t\t},\n\t\t\"es-gt\":{\n\t\t\t\t\"name\":\"Spanish (Guatemala)\",\n\t\t\t\t\"nativeName\":\"Espaol (Guatemala)\"\n\t\t},\n\t\t\"es-hn\":{\n\t\t\t\t\"name\":\"Spanish (Honduras)\",\n\t\t\t\t\"nativeName\":\"Espaol (Honduras)\"\n\t\t},\n\t\t\"es-mx\":{\n\t\t\t\t\"name\":\"Spanish (Mexico)\",\n\t\t\t\t\"nativeName\":\"Espaol (Mxico)\"\n\t\t},\n\t\t\"es-ni\":{\n\t\t\t\t\"name\":\"Spanish (Nicaragua)\",\n\t\t\t\t\"nativeName\":\"Espaol (Nicaragua)\"\n\t\t},\n\t\t\"es-pa\":{\n\t\t\t\t\"name\":\"Spanish (Panama)\",\n\t\t\t\t\"nativeName\":\"Espaol (Panam)\"\n\t\t},\n\t\t\"es-py\":{\n\t\t\t\t\"name\":\"Spanish (Paraguay)\",\n\t\t\t\t\"nativeName\":\"Espaol (Paraguay)\"\n\t\t},\n\t\t\"es-pe\":{\n\t\t\t\t\"name\":\"Spanish (Peru)\",\n\t\t\t\t\"nativeName\":\"Espaol (Per)\"\n\t\t},\n\t\t\"es-pr\":{\n\t\t\t\t\"name\":\"Spanish (Puerto Rico)\",\n\t\t\t\t\"nativeName\":\"Espaol (Puerto Rico)\"\n\t\t},\n\t\t\"es-uy\":{\n\t\t\t\t\"name\":\"Spanish (Uruguay)\",\n\t\t\t\t\"nativeName\":\"Espaol (Uruguay)\"\n\t\t},\n\t\t\"es-ve\":{\n\t\t\t\t\"name\":\"Spanish (Venezuela)\",\n\t\t\t\t\"nativeName\":\"Espaol (Venezuela)\"\n\t\t},\n\t\t\"fr-be\":{\n\t\t\t\t\"name\":\"French (Belgium)\",\n\t\t\t\t\"nativeName\":\"franais (Belgique)\"\n\t\t},\n\t\t\"fr-ca\":{\n\t\t\t\t\"name\":\"French (Canada)\",\n\t\t\t\t\"nativeName\":\"franais (Canada)\"\n\t\t},\n\t\t\"fr-lu\":{\n\t\t\t\t\"name\":\"French (Luxembourg)\",\n\t\t\t\t\"nativeName\":\"franais (Luxembourg)\"\n\t\t},\n\t\t\"fr-ch\":{\n\t\t\t\t\"name\":\"French (Switzerland)\",\n\t\t\t\t\"nativeName\":\"franais (Suisse)\"\n\t\t},\n\t\t\"it-ch\":{\n\t\t\t\t\"name\":\"Italian (Switzerland)\",\n\t\t\t\t\"nativeName\":\"italiano (Svizzera)\"\n\t\t},\n\t\t\"nl-be\":{\n\t\t\t\t\"name\":\"Dutch (Belgium)\",\n\t\t\t\t\"nativeName\":\"Nederlands (Belgi)\"\n\t\t},\n\t\t\"pt-br\":{\n\t\t\t\t\"name\":\"Portuguese (Brazil)\",\n\t\t\t\t\"nativeName\":\"Portugus (Brasil)\"\n\t\t},\n\t\t\"sv-fi\":{\n\t\t\t\t\"name\":\"Swedish (Finland)\",\n\t\t\t\t\"nativeName\":\"svenska (Finland)\"\n\t\t},\n\t\t\"zh-hk\":{\n\t\t\t\t\"name\":\"Chinese (Hong Kong)\",\n\t\t\t\t\"nativeName\":\"()\"\n\t\t},\n\t\t\"zh-cn\":{\n\t\t\t\t\"name\":\"Chinese (PRC)\",\n\t\t\t\t\"nativeName\":\"()\"\n\t\t},\n\t\t\"zh-sg\":{\n\t\t\t\t\"name\":\"Chinese (Singapore)\",\n\t\t\t\t\"nativeName\":\"()\"\n\t\t},\n\t\t\"zh-tw\":{\n\t\t\t\t\"name\":\"Chinese Traditional (Taiwan)\",\n\t\t\t\t\"nativeName\":\"\"\n\t\t}\n\t}\n\n\tAblePlayer.prototype.getLanguageName = function (key,whichName) {\n\n\t\t// return language name associated with lang code \"key\"\n\t\t// whichName is either \"English\" or \"local\" (i.e., native name)\n\n\t\tvar lang, code, subTag; \n\t\tlang = isoLangs[key.toLowerCase()];\n\t\tif (lang) { \n\t\t\tif (whichName === 'local') { \n\t\t\t\treturn lang.nativeName; \n\t\t\t}\n\t\t\telse { \n\t\t\t\treturn lang.name; \n\t\t\t}\n\t\t}\n\t\telse if (key.includes('-')) {\n\t\t\tcode = key.substring(0,2);\n\t\t\tsubTag = key.substring(3);  \n\t\t\tlang = isoLangs[code.toLowerCase()]; \n\t\t\tif (lang) { \n\t\t\t\tif (whichName === 'local') { \n\t\t\t\t\treturn lang.nativeName + ' (' + subTag + ')'; \n\t\t\t\t}\n\t\t\t\telse { \n\t\t\t\t\treturn lang.name + ' (' + subTag + ')'; \n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// if all else has failed, use the key as the label \n\t\treturn key;\n\t};\n\n})(jQuery);\n(function ($) {\n\tAblePlayer.prototype.getSupportedLangs = function() {\n\t\t// returns an array of languages for which AblePlayer has translation tables\n\t\tvar langs = ['ca','cs','da','de','en','es','fr','he','id','it','ja','nb','nl','pt','pt-br','sv','tr','zh-tw'];\n\t\treturn langs;\n\t};\n\n\tAblePlayer.prototype.getTranslationText = function() {\n\n\t\t// determine language, then get labels and prompts from corresponding translation var\n\n\t\tvar deferred, thisObj, supportedLangs, docLang, msg, translationFile, collapsedLang, i, \n\t\t\tsimilarLangFound;\n\t\tdeferred = $.Deferred();\n\t\tthisObj = this;\n\n\t\tsupportedLangs = this.getSupportedLangs(); // returns an array\n\n\t\tif (this.lang) { // a data-lang attribute is included on the media element\n\t\t\tif ($.inArray(this.lang,supportedLangs) === -1) {\n\t\t\t\t// the specified language is not supported\n\t\t\t\tif (this.lang.indexOf('-') == 2) {\n\t\t\t\t\t// this is a localized lang attribute (e.g., fr-CA)\n\t\t\t\t\t// try the parent language, given the first two characters\n\t\t\t\t\tif ($.inArray(this.lang.substring(0,2),supportedLangs) !== -1) {\n\t\t\t\t\t\t// parent lang is supported. Use that.\n\t\t\t\t\t\tthis.lang = this.lang.substring(0,2);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// the parent language is not supported either\n\t\t\t\t\t\t// unable to use the specified language\n\t\t\t\t\t\tthis.lang = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// this is not a localized language.\n\t\t\t\t\t// but maybe there's a similar localized language supported  \n\t\t\t\t\t// that has the same parent?  \n\t\t\t\t\tsimilarLangFound = false; \n\t\t\t\t\ti = 0; \n\t\t\t\t\twhile (i < supportedLangs.length) { \n\t\t\t\t\t\tif (supportedLangs[i].substring(0,2) == this.lang) { \n\t\t\t\t\t\t\tthis.lang = supportedLangs[i]; \t\t\t\t\n\t\t\t\t\t\t\tsimilarLangFound = true; \n\t\t\t\t\t\t}\n\t\t\t\t\t\ti++; \n\t\t\t\t\t}\n\t\t\t\t\tif (!similarLangFound) { \n\t\t\t\t\t\t// language requested via data-lang is not supported\n\t\t\t\t\t\tthis.lang = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!this.lang) {\n\t\t\t// try the language of the web page, if specified\n\t\t\tif ($('body').attr('lang')) {\n\t\t\t\tdocLang = $('body').attr('lang').toLowerCase();\n\t\t\t}\n\t\t\telse if ($('html').attr('lang')) {\n\t\t\t\tdocLang = $('html').attr('lang').toLowerCase();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdocLang = null;\n\t\t\t}\n\t\t\tif (docLang) {\n\t\t\t\tif ($.inArray(docLang,supportedLangs) !== -1) {\n\t\t\t\t\t// the document language is supported\n\t\t\t\t\tthis.lang = docLang;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// the document language is not supported\n\t\t\t\t\tif (docLang.indexOf('-') == 2) {\n\t\t\t\t\t\t// this is a localized lang attribute (e.g., fr-CA)\n\t\t\t\t\t\t// try the parent language, given the first two characters\n\t\t\t\t\t\tif ($.inArray(docLang.substring(0,2),supportedLangs) !== -1) {\n\t\t\t\t\t\t\t// the parent language is supported. use that.\n\t\t\t\t\t\t\tthis.lang = docLang.substring(0,2);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!this.lang) {\n\t\t\t// No supported language has been specified by any means\n\t\t\t// Fallback to English\n\t\t\tthis.lang = 'en';\n\t\t}\n\n\t\tif (!this.searchLang) {\n\t\t\tthis.searchLang = this.lang;\n\t\t}\n\t\ttranslationFile = this.rootPath + 'translations/' + this.lang + '.js';\n\t\t$.getJSON(translationFile, function(data) {\n\t\t\t// success!\n\t\t\tthisObj.tt = data; \n\t\t\tdeferred.resolve(); \n\t\t})\n\t\t.fail(function() {\n\t\t\tconsole.log( \"Critical Error: Unable to load translation file:\",translationFile);\t\t\t\n\t\t\tthisObj.provideFallback();\n\t\t\tdeferred.fail();\n\t\t})\n\t\treturn deferred.promise();\n\t};\n\n\tAblePlayer.prototype.getSampleDescriptionText = function() {\n\n\t\t// Create an array of sample description text in all languages \n\t\t// This needs to be readily available for testing different voices \n\t\t// in the Description Preferences dialog \n\t\tvar thisObj, supportedLangs, i, thisLang, translationFile, thisText, translation; \n\t\t\n\t\tsupportedLangs = this.getSupportedLangs(); \n\n\t\tthisObj = this; \n\n\t\tthis.sampleText = []; \n\t\tfor (i=0; i < supportedLangs.length; i++) { \n\t\t\ttranslationFile = this.rootPath + 'translations/' + supportedLangs[i] + '.js';\n\t\t\t$.getJSON(translationFile, thisLang, (function(thisLang) {\n\t\t\t\t\treturn function(data) { \n\t\t\t\t\t\tthisText = data.sampleDescriptionText; \n\t\t\t\t\t\ttranslation = {'lang':thisLang, 'text': thisText}; \n\t\t\t\t\t\tthisObj.sampleText.push(translation); \t\t\t\t\t\t\n\t\t\t\t\t};\n\t\t\t}(supportedLangs[i])) // pass lang to callback function \n\t\t\t); \t\t\t\t \n\t\t}\n\t};\n\n})(jQuery);\n\n(function($) {\n\tAblePlayer.prototype.computeEndTime = function(startTime, durationTime) {\n\t\tvar SECONDS = 0;\n\t\tvar MINUTES = 1;\n\t\tvar HOURS = 2;\n\n\t\tvar startParts = startTime\n\t\t\t.split(':')\n\t\t\t.reverse()\n\t\t\t.map(function(value) {\n\t\t\t\treturn parseFloat(value);\n\t\t\t});\n\n\t\tvar durationParts = durationTime\n\t\t\t.split(':')\n\t\t\t.reverse()\n\t\t\t.map(function(value) {\n\t\t\t\treturn parseFloat(value);\n\t\t\t});\n\n\t\tvar endTime = startParts\n\t\t\t.reduce(function(acc, val, index) {\n\t\t\t\tvar sum = val + durationParts[index];\n\n\t\t\t\tif (index === SECONDS) {\n\t\t\t\t\tif (sum > 60) {\n\t\t\t\t\t\tdurationParts[index + 1] += 1;\n\t\t\t\t\t\tsum -= 60;\n\t\t\t\t\t}\n\n\t\t\t\t\tsum = sum.toFixed(3);\n\t\t\t\t}\n\n\t\t\t\tif (index === MINUTES) {\n\t\t\t\t\tif (sum > 60) {\n\t\t\t\t\t\tdurationParts[index + 1] += 1;\n\t\t\t\t\t\tsum -= 60;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (sum < 10) {\n\t\t\t\t\tsum = '0' + sum;\n\t\t\t\t}\n\n\t\t\t\tacc.push(sum);\n\n\t\t\t\treturn acc;\n\t\t\t}, [])\n\t\t\t.reverse()\n\t\t\t.join(':');\n\n\t\treturn endTime;\n\t};\n\n\tAblePlayer.prototype.ttml2webvtt = function(contents) {\n\t\tvar thisObj = this;\n\n\t\tvar xml = thisObj.convert.xml2json(contents, {\n\t\t\tignoreComment: true,\n\t\t\talwaysChildren: true,\n\t\t\tcompact: true,\n\t\t\tspaces: 2\n\t\t});\n\n\t\tvar vttHeader = 'WEBVTT\\n\\n\\n';\n\t\tvar captions = JSON.parse(xml).tt.body.div.p;\n\n\t\tvar vttCaptions = captions.reduce(function(acc, value, index) {\n\t\t\tvar text = value._text;\n\t\t\tvar isArray = Array.isArray(text);\n\t\t\tvar attributes = value._attributes;\n\t\t\tvar endTime = thisObj.computeEndTime(attributes.begin, attributes.dur);\n\n\t\t\tvar caption =\n\t\t\t\tthisObj.computeEndTime(attributes.begin, '00:00:0') +\n\t\t\t\t' --> ' +\n\t\t\t\tthisObj.computeEndTime(attributes.begin, attributes.dur) +\n\t\t\t\t'\\n' +\n\t\t\t\t(isArray ? text.join('\\n') : text) +\n\t\t\t\t'\\n\\n';\n\n\t\t\treturn acc + caption;\n\t\t}, vttHeader);\n\n\t\treturn vttCaptions;\n\t};\n})(jQuery);\n\n/*! Copyright (c) 2014 - Paul Tavares - purtuga - @paul_tavares - MIT License */\n;(function($){\n\n\t\t/**\n\t\t * Delays the execution of a function until an expression returns true.\n\t\t * The expression is checked every 100 milliseconds for as many tries\n\t\t * as defined in in the attempts option\n\t\t *\n\t\t * @param {Object} options\n\t\t * @param {Function} options.when\n\t\t *                      Function to execute on every interval.\n\t\t *                      Must return true (boolean) in order for\n\t\t *                      options.do to be executed.\n\t\t * @param {Function} [options.exec]\n\t\t *                      Function to be executed once options.when()\n\t\t *                      returns true.\n\t\t * @param {Interger} [options.interval=100]\n\t\t *                      How long to wait in-between tries.\n\t\t * @param {Interger} [options.attempts=100]\n\t\t *                      How many tries to use before its considered\n\t\t *                      a failure.\n\t\t * @param {Interger} [options.delayed=0]\n\t\t *                      Number of miliseconds to wait before execution\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tis started. Default is imediately.\n\t\t *\n\t\t * @return {jQuery.Promise}\n\t\t *\n\t\t * @example\n\t\t *\n\t\t *      $.doWhen({\n\t\t *          when: function(){\n\t\t *              return false;\n\t\t *          },\n\t\t *          exec: function(){\n\t\t *              alert(\"never called given false response on when param!\");\n\t\t *          }\n\t\t *      })\n\t\t *      .fail(function(){\n\t\t *          alert('ALERT: FAILED CONDITION');\n\t\t *      })\n\t\t *      .then(function(){\n\t\t *          alert(\"resolved.\");\n\t\t *      });\n\t\t *\n\t\t */\n\t\t$.doWhen = function(options) {\n\n\t\t\t\treturn $.Deferred(function(dfd){\n\n\t\t\t\t\t\tvar opt = $.extend({}, {\n\t\t\t\t\t\t\t\t\t\twhen:       null,\n\t\t\t\t\t\t\t\t\t\texec:       function(){},\n\t\t\t\t\t\t\t\t\t\tinterval:   100,\n\t\t\t\t\t\t\t\t\t\tattempts:   100,\n\t\t\t\t\t\t\t\t\t\tdelayed:    0\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tcheckId: null\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tstartChecking = function(){\n\n\t\t\t\t\t\t\t\t\t\t// Check condition now and if true, then resolve object\n\t\t\t\t\t\t\t\t\t\tif (opt.when() === true) {\n\n\t\t\t\t\t\t\t\t\t\t\t\topt.exec.call(dfd.promise());\n\t\t\t\t\t\t\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// apply minimal UI and hide the overlay\n\t\t\t\t\t\t\t\t\t\topt.checkId = setInterval(function(){\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (opt.attempts === 0) {\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclearInterval(opt.checkId);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdfd.reject();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--opt.attempts;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (opt.when() === true) {\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topt.attempts = 0;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclearInterval(opt.checkId);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topt.exec.call(dfd.promise());\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdfd.resolve();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t}, opt.interval);\n\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (opt.delayed > 0) {\n\n\t\t\t\t\t\t\t\tsetTimeout(startChecking, Number(opt.delayed));\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tstartChecking();\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}).promise();\n\n\t\t};\n\n})(jQuery);\n/* Video Transcript Sorter (VTS)\n * Used to synchronize time stamps from WebVTT resources\n * so they appear in the proper sequence within an auto-generated interactive transcript\n*/\n\n(function ($) {\n\tAblePlayer.prototype.injectVTS = function() {\n\n\t\t// To add a transcript sorter to a web page:\n\t\t// Add <div id=\"able-vts\"></div> to the web page\n\n\t\t// Define all variables\n\t\tvar thisObj, tracks, $heading;\n\t\tvar $instructions, $p1, $p2, $ul, $li1, $li2, $li3;\n\t\tvar $fieldset, $legend, i, $radioDiv, radioId, $label, $radio;\n\t\tvar $saveButton, $savedTable;\n\n\t\tthisObj = this;\n\n\t\tif ($('#able-vts').length) {\n\t\t\t// Page includes a container for a VTS instance\n\n\t\t\t// Are they qualifying tracks?\n\t\t\tif (this.vtsTracks.length) {\n\t\t\t\t// Yes - there are!\n\n\t\t\t\t// Build an array of unique languages\n\t\t\t\tthis.langs = [];\n\t\t\t\tthis.getAllLangs(this.vtsTracks);\n\n\t\t\t\t// Set the default VTS language\n\t\t\t\tthis.vtsLang = this.lang;\n\n\t\t\t\t// Inject a heading\n\t\t\t\t$heading = $('<h2>').text('Video Transcript Sorter'); // TODO: Localize; intelligently assign proper heading level\n\t\t\t\t$('#able-vts').append($heading);\n\n\t\t\t\t// Inject an empty div for writing messages\n\t\t\t\tthis.$vtsAlert = $('<div>',{\n\t\t\t\t\t'id': 'able-vts-alert',\n\t\t\t\t\t'aria-live': 'polite',\n\t\t\t\t\t'aria-atomic': 'true'\n\t\t\t\t})\n\t\t\t\t$('#able-vts').append(this.$vtsAlert);\n\n\t\t\t\t// Inject instructions (TODO: Localize)\n\t\t\t\t$instructions = $('<div>',{\n\t\t\t\t\t'id': 'able-vts-instructions'\n\t\t\t\t});\n\t\t\t\t$p1 = $('<p>').text('Use the Video Transcript Sorter to perform any of the following tasks:');\n\t\t\t\t$ul = $('<ul>');\n\t\t\t\t$li1 = $('<li>').text('Reorder chapters, descriptions, captions, and/or subtitles so they appear in the proper sequence in Able Player\\'s auto-generated transcript.');\n\t\t\t\t$li2 = $('<li>').text('Modify content or start/end times (all are directly editable within the table).');\n\t\t\t\t$li3 = $('<li>').text('Insert new content, such as chapters or descriptions.');\n\t\t\t\t$p2 = $('<p>').text('When finished editing, click the \"Save Changes\" button. This will auto-generate new content for all relevant timed text files (chapters, descriptions, captions, and/or subtitles), which can be copied and pasted into separate WebVTT files for use by Able Player.');\n\t\t\t\t$ul.append($li1,$li2,$li3);\n\t\t\t\t$instructions.append($p1,$ul,$p2);\n\t\t\t\t$('#able-vts').append($instructions);\n\n\t\t\t\t// Inject a fieldset with radio buttons for each language\n\t\t\t\t$fieldset = $('<fieldset>');\n\t\t\t\t$legend = $('<legend>').text('Select a language'); // TODO: Localize this\n\t\t\t\t$fieldset.append($legend)\n\t\t\t\tfor (i in this.langs) {\n\t\t\t\t\tradioId = 'vts-lang-radio-' + this.langs[i];\n\t\t\t\t\t$radioDiv = $('<div>',{\n\t\t\t\t\t\t// uncomment the following if label is native name\n\t\t\t\t\t\t// 'lang': this.langs[i]\n\t\t\t\t\t});\n\t\t\t\t\t$radio = $('<input>', {\n\t\t\t\t\t\t'type': 'radio',\n\t\t\t\t\t\t'name': 'vts-lang',\n\t\t\t\t\t\t'id': radioId,\n\t\t\t\t\t\t'value': this.langs[i]\n\t\t\t\t\t}).on('click',function() {\n\t\t\t\t\t\tthisObj.vtsLang = $(this).val();\n\t\t\t\t\t\tthisObj.showVtsAlert('Loading ' + thisObj.getLanguageName(thisObj.vtsLang) + ' tracks');\n\t\t\t\t\t\tthisObj.injectVtsTable('update',thisObj.vtsLang);\n\t\t\t\t\t});\n\t\t\t\t\tif (this.langs[i] == this.lang) {\n\t\t\t\t\t\t// this is the default language.\n\t\t\t\t\t\t$radio.prop('checked',true);\n\t\t\t\t\t}\n\t\t\t\t\t$label = $('<label>', {\n\t\t\t\t\t\t'for': radioId\n\t\t\t\t\t\t// Two options for label:\n\t\t\t\t\t\t// getLanguageName() - with second parameter \"local\" would return native name, otherwise returns English; \n\t\t\t\t\t\t// TODO: if using this be sure to add lang attr to <div> (see above)\n\t\t\t\t\t}).text(this.getLanguageName(this.langs[i]));\n\t\t\t\t\t$radioDiv.append($radio,$label);\n\t\t\t\t\t$fieldset.append($radioDiv);\n\t\t\t\t}\n\t\t\t\t$('#able-vts').append($fieldset);\n\n\t\t\t\t// Inject a 'Save Changes' button\n\t\t\t\t$saveButton = $('<button>',{\n\t\t\t\t\t'type': 'button',\n\t\t\t\t\t'id': 'able-vts-save',\n\t\t\t\t\t'value': 'save'\n\t\t\t\t}).text('Save Changes'); // TODO: Localize this\n\t\t\t\t$('#able-vts').append($saveButton);\n\n\t\t\t\t// Inject a table with one row for each cue in the default language\n\t\t\t\tthis.injectVtsTable('add',this.vtsLang);\n\n\t\t\t\t// TODO: Add drag/drop functionality for mousers\n\n\t\t\t\t// Add event listeners for contenteditable cells\n\t\t\t\tvar kindOptions, beforeEditing, editedCell, editedContent, i, closestKind;\n\t\t\t\tkindOptions = ['captions','chapters','descriptions','subtitles'];\n\t\t\t\t$('td[contenteditable=\"true\"]').on('focus',function() {\n\t\t\t\t\tbeforeEditing = $(this).text();\n\t\t\t\t}).on('blur',function() {\n\t\t\t\t\tif (beforeEditing != $(this).text()) {\n\t\t\t\t\t\teditedCell = $(this).index();\n\t\t\t\t\t\teditedContent = $(this).text();\n\t\t\t\t\t\tif (editedCell === 1) {\n\t\t\t\t\t\t\t// do some simple spelling auto-correct\n\t\t\t\t\t\t\tif ($.inArray(editedContent,kindOptions) === -1) {\n\t\t\t\t\t\t\t\t// whatever user typed is not a valid kind\n\t\t\t\t\t\t\t\t// assume they correctly typed the first character\n\t\t\t\t\t\t\t\tif (editedContent.substring(0,1) === 's') {\n\t\t\t\t\t\t\t\t\t$(this).text('subtitles');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (editedContent.substring(0,1) === 'd') {\n\t\t\t\t\t\t\t\t\t$(this).text('descriptions');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (editedContent.substring(0,2) === 'ch') {\n\t\t\t\t\t\t\t\t\t$(this).text('chapters');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t// whatever else they types, assume 'captions'\n\t\t\t\t\t\t\t\t\t$(this).text('captions');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (editedCell === 2 || editedCell === 3) {\n\t\t\t\t\t\t\t// start or end time\n\t\t\t\t\t\t\t// ensure proper formatting (with 3 decimal places)\n\t\t\t\t\t\t\t$(this).text(thisObj.formatTimestamp(editedContent));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).on('keydown',function(e) {\n\t\t\t\t\t// don't allow keystrokes to trigger Able Player (or other) functions\n\t\t\t\t\t// while user is editing\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t});\n\n\t\t\t\t// handle click on the Save button\n\n\t\t\t\t// handle click on the Save button\n\t\t\t\t$('#able-vts-save').on('click',function(e) {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tif ($(this).attr('value') == 'save') {\n\t\t\t\t\t\t// replace table with WebVTT output in textarea fields (for copying/pasting)\n\t\t\t\t\t\t$(this).attr('value','cancel').text('Return to Editor'); // TODO: Localize this\n\t\t\t\t\t\t$savedTable = $('#able-vts table');\n\t\t\t\t\t\t$('#able-vts-instructions').hide();\n\t\t\t\t\t\t$('#able-vts > fieldset').hide();\n\t\t\t\t\t\t$('#able-vts table').remove();\n\t\t\t\t\t\t$('#able-vts-icon-credit').remove();\n\t\t\t\t\t\tthisObj.parseVtsOutput($savedTable);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// cancel saving, and restore the table using edited content\n\t\t\t\t\t\t$(this).attr('value','save').text('Save Changes'); // TODO: Localize this\n\t\t\t\t\t\t$('#able-vts-output').remove();\n\t\t\t\t\t\t$('#able-vts-instructions').show();\n\t\t\t\t\t\t$('#able-vts > fieldset').show();\n\t\t\t\t\t\t$('#able-vts').append($savedTable);\n\t\t\t\t\t\t$('#able-vts').append(thisObj.getIconCredit());\n\t\t\t\t\t\tthisObj.showVtsAlert('Cancelling saving. Any edits you made have been restored in the VTS table.'); // TODO: Localize this\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.setupVtsTracks = function(kind, lang, trackDesc, label, src, contents) {\n\n\t\t// TODO: Add support for trackDesc \n\t\t// (to destinguish between tracks for the decribed vs non-described versions)\t\t\n\n\t\t// Called from tracks.js\n\t\tvar srcFile, vtsCues;\n\n\t\tsrcFile = this.getFilenameFromPath(src);\n\t\tvtsCues = this.parseVtsTracks(contents);\n\n\t\tthis.vtsTracks.push({\n\t\t\t'kind': kind,\n\t\t\t'language': lang,\n\t\t\t'label': label,\n\t\t\t'srcFile': srcFile,\n\t\t\t'cues': vtsCues\n\t\t});\n\t};\n\n\tAblePlayer.prototype.getFilenameFromPath = function(path) {\n\n\t\tvar lastSlash;\n\n\t\tlastSlash = path.lastIndexOf('/');\n\t\tif (lastSlash === -1) {\n\t\t\t// there are no slashes in path.\n\t\t\treturn path;\n\t\t}\n\t\telse {\n\t\t\treturn path.substring(lastSlash+1);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getFilenameFromTracks = function(kind,lang) {\n\n\t\tfor (var i=0; i<this.vtsTracks.length; i++) {\n\t\t\tif (this.vtsTracks[i].kind === kind && this.vtsTracks[i].language === lang) {\n\t\t\t\t// this is a matching track\n\t\t\t\t// srcFile has already been converted to filename from path before saving to vtsTracks\n\t\t\t\treturn this.vtsTracks[i].srcFile;\n\t\t\t}\n\t\t}\n\t\t// no matching track found\n\t\treturn false;\n\t};\n\n\tAblePlayer.prototype.parseVtsTracks = function(contents) {\n\n\t\tvar rows, timeParts, cues, i, j, thisRow, nextRow, content, blankRow;\n\t\trows = contents.split(\"\\n\");\n\t\tcues = [];\n\t\ti = 0;\n\t\twhile (i < rows.length) {\n\t\t\tthisRow = rows[i];\n\t\t\tif (thisRow.indexOf(' --> ') !== -1) {\n\t\t\t\t// this is probably a time row\n\t\t\t\ttimeParts = thisRow.trim().split(' ');\n\t\t\t\tif (this.isValidTimestamp(timeParts[0]) && this.isValidTimestamp(timeParts[2])) {\n\t\t\t\t\t// both timestamps are valid. This is definitely a time row\n\t\t\t\t\tcontent = '';\n\t\t\t\t\tj = i+1;\n\t\t\t\t\tblankRow = false;\n\t\t\t\t\twhile (j < rows.length && !blankRow) {\n\t\t\t\t\t\tnextRow = rows[j].trim();\n\t\t\t\t\t\tif (nextRow.length > 0) {\n\t\t\t\t\t\t\tif (content.length > 0) {\n\t\t\t\t\t\t\t\t// add back the EOL between rows of content\n\t\t\t\t\t\t\t\tcontent += \"\\n\" + nextRow;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t// this is the first row of content. No need for an EOL\n\t\t\t\t\t\t\t\tcontent += nextRow;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tblankRow = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tj++;\n\t\t\t\t\t}\n\t\t\t\t\tcues.push({\n\t\t\t\t\t\t'start': timeParts[0],\n\t\t\t\t\t\t'end': timeParts[2],\n\t\t\t\t\t\t'content': content\n\t\t\t\t\t});\n\t\t\t\t\ti = j; //skip ahead\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t\treturn cues;\n\t};\n\n\tAblePlayer.prototype.isValidTimestamp = function(timestamp) {\n\n\t\t// return true if timestamp contains only numbers or expected punctuation\n\t\tif (/^[0-9:,.]*$/.test(timestamp)) {\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tAblePlayer.prototype.formatTimestamp = function(timestamp) {\n\n\t\t// timestamp is a string in the form \"HH:MM:SS.xxx\"\n\t\t// Take some simple steps to ensure edited timestamp values still adhere to expected format\n\n\t\tvar firstPart, lastPart;\n\n\t\tfirstPart = timestamp.substring(0,timestamp.lastIndexOf('.')+1);\n\t\tlastPart = timestamp.substring(timestamp.lastIndexOf('.')+1);\n\n\t\t// TODO: Be sure each component within firstPart has only exactly two digits\n\t\t// Probably can't justify doing this automatically\n\t\t// If users enters '5' for minutes, that could be either '05' or '50'\n\t\t// This should trigger an error and prompt the user to correct the value before proceeding\n\n\t\t// Be sure lastPart has exactly three digits\n\t\tif (lastPart.length > 3) {\n\t\t\t// chop off any extra digits\n\t\t\tlastPart = lastPart.substring(0,3);\n\t\t}\n\t\telse if (lastPart.length < 3) {\n\t\t\t// add trailing zeros\n\t\t\twhile (lastPart.length < 3) {\n\t\t\t\tlastPart += '0';\n\t\t\t}\n\t\t}\n\t\treturn firstPart + lastPart;\n\t};\n\n\n\tAblePlayer.prototype.injectVtsTable = function(action,lang) {\n\n\t\t// action is either 'add' (for a new table) or 'update' (if user has selected a new lang)\n\n\t\tvar $table, headers, i, $tr, $th, $td, rows, rowNum, rowId;\n\n\t\tif (action === 'update') {\n\t\t\t// remove existing table\n\t\t\t$('#able-vts table').remove();\n\t\t\t$('#able-vts-icon-credit').remove();\n\t\t}\n\n\t\t$table = $('<table>',{\n\t\t\t'lang': lang\n\t\t});\n\t\t$tr = $('<tr>',{\n\t\t\t'lang': 'en' // TEMP, until header row is localized\n\t\t});\n\t\theaders = ['Row #','Kind','Start','End','Content','Actions']; // TODO: Localize this\n\t\tfor (i=0; i < headers.length; i++) {\n\t\t\t$th = $('<th>', {\n\t\t\t\t'scope': 'col'\n\t\t\t}).text(headers[i]);\n\t\t\tif (headers[i] === 'Actions') {\n\t\t\t\t$th.addClass('actions');\n\t\t\t}\n\t\t\t$tr.append($th);\n\t\t}\n\t\t$table.append($tr);\n\n\t\t// Get all rows (sorted by start time), and inject them into table\n\t\trows = this.getAllRows(lang);\n\t\tfor (i=0; i < rows.length; i++) {\n\t\t\trowNum = i + 1;\n\t\t\trowId = 'able-vts-row-' + rowNum;\n\t\t\t$tr = $('<tr>',{\n\t\t\t\t'id': rowId,\n\t\t\t\t'class': 'kind-' + rows[i].kind\n\t\t\t});\n\t\t\t// Row #\n\t\t\t$td = $('<td>').text(rowNum);\n\t\t\t$tr.append($td);\n\n\t\t\t// Kind\n\t\t\t$td = $('<td>',{\n\t\t\t\t'contenteditable': 'true'\n\t\t\t}).text(rows[i].kind);\n\t\t\t$tr.append($td);\n\n\t\t\t// Start\n\t\t\t$td = $('<td>',{\n\t\t\t\t'contenteditable': 'true'\n\t\t\t}).text(rows[i].start);\n\t\t\t$tr.append($td);\n\n\t\t\t// End\n\t\t\t$td = $('<td>',{\n\t\t\t\t'contenteditable': 'true'\n\t\t\t}).text(rows[i].end);\n\t\t\t$tr.append($td);\n\n\t\t\t// Content\n\t\t\t$td = $('<td>',{\n\t\t\t\t'contenteditable': 'true'\n\t\t\t}).text(rows[i].content); // TODO: Preserve tags\n\t\t\t$tr.append($td);\n\n\t\t\t\t\t// Actions\n\t\t\t$td = this.addVtsActionButtons(rowNum,rows.length);\n\t\t\t$tr.append($td);\n\n\t\t\t$table.append($tr);\n\t\t}\n\t\t$('#able-vts').append($table);\n\n\t\t// Add credit for action button SVG icons\n\t\t$('#able-vts').append(this.getIconCredit());\n\n\t};\n\n\tAblePlayer.prototype.addVtsActionButtons = function(rowNum,numRows) {\n\n\t\t// rowNum is the number of the current table row (starting with 1)\n\t\t// numRows is the total number of rows (excluding the header row)\n\t\t// TODO: Position buttons so they're vertically aligned, even if missing an Up or Down button\n\t\tvar thisObj, $td, buttons, i, button, $button, $svg, $g, pathString, pathString2, $path, $path2;\n\t\tthisObj = this;\n\t\t$td = $('<td>');\n\t\tbuttons = ['up','down','insert','delete'];\n\n\t\tfor (i=0; i < buttons.length; i++) {\n\t\t\tbutton = buttons[i];\n\t\t\tif (button === 'up') {\n\t\t\t\tif (rowNum > 1) {\n\t\t\t\t\t$button = $('<button>',{\n\t\t\t\t\t\t'id': 'able-vts-button-up-' + rowNum,\n\t\t\t\t\t\t'title': 'Move up',\n\t\t\t\t\t\t'aria-label': 'Move Row ' + rowNum + ' up'\n\t\t\t\t\t}).on('click', function(el) {\n\t\t\t\t\t\tthisObj.onClickVtsActionButton(el.currentTarget);\n\t\t\t\t\t});\n\t\t\t\t\t$svg = $('<svg>',{\n\t\t\t\t\t\t'focusable': 'false',\n\t\t\t\t\t\t'aria-hidden': 'true',\n\t\t\t\t\t\t'x': '0px',\n\t\t\t\t\t\t'y': '0px',\n\t\t\t\t\t\t'width': '254.296px',\n\t\t\t\t\t\t'height': '254.296px',\n\t\t\t\t\t\t'viewBox': '0 0 254.296 254.296',\n\t\t\t\t\t\t'style': 'enable-background:new 0 0 254.296 254.296'\n\t\t\t\t\t});\n\t\t\t\t\tpathString = 'M249.628,176.101L138.421,52.88c-6.198-6.929-16.241-6.929-22.407,0l-0.381,0.636L4.648,176.101'\n\t\t\t\t\t\t+ 'c-6.198,6.897-6.198,18.052,0,24.981l0.191,0.159c2.892,3.305,6.865,5.371,11.346,5.371h221.937c4.577,0,8.613-2.161,11.41-5.594'\n\t\t\t\t\t\t+ 'l0.064,0.064C255.857,194.153,255.857,182.998,249.628,176.101z';\n\t\t\t\t\t$path = $('<path>',{\n\t\t\t\t\t\t'd': pathString\n\t\t\t\t\t});\n\t\t\t\t\t$g = $('<g>').append($path);\n\t\t\t\t\t$svg.append($g);\n\t\t\t\t\t$button.append($svg);\n\t\t\t\t\t// Refresh button in the DOM in order for browser to process & display the SVG\n\t\t\t\t\t$button.html($button.html());\n\t\t\t\t\t$td.append($button);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (button === 'down') {\n\t\t\t\tif (rowNum < numRows) {\n\t\t\t\t\t$button = $('<button>',{\n\t\t\t\t\t\t'id': 'able-vts-button-down-' + rowNum,\n\t\t\t\t\t\t'title': 'Move down',\n\t\t\t\t\t\t'aria-label': 'Move Row ' + rowNum + ' down'\n\t\t\t\t\t}).on('click', function(el) {\n\t\t\t\t\t\tthisObj.onClickVtsActionButton(el.currentTarget);\n\t\t\t\t\t});\n\t\t\t\t\t$svg = $('<svg>',{\n\t\t\t\t\t\t'focusable': 'false',\n\t\t\t\t\t\t'aria-hidden': 'true',\n\t\t\t\t\t\t'x': '0px',\n\t\t\t\t\t\t'y': '0px',\n\t\t\t\t\t\t'width': '292.362px',\n\t\t\t\t\t\t'height': '292.362px',\n\t\t\t\t\t\t'viewBox': '0 0 292.362 292.362',\n\t\t\t\t\t\t'style': 'enable-background:new 0 0 292.362 292.362'\n\t\t\t\t\t});\n\t\t\t\t\tpathString = 'M286.935,69.377c-3.614-3.617-7.898-5.424-12.848-5.424H18.274c-4.952,0-9.233,1.807-12.85,5.424'\n\t\t\t\t\t\t+ 'C1.807,72.998,0,77.279,0,82.228c0,4.948,1.807,9.229,5.424,12.847l127.907,127.907c3.621,3.617,7.902,5.428,12.85,5.428'\n\t\t\t\t\t\t+ 's9.233-1.811,12.847-5.428L286.935,95.074c3.613-3.617,5.427-7.898,5.427-12.847C292.362,77.279,290.548,72.998,286.935,69.377z';\n\t\t\t\t\t$path = $('<path>',{\n\t\t\t\t\t\t'd': pathString\n\t\t\t\t\t});\n\t\t\t\t\t$g = $('<g>').append($path);\n\t\t\t\t\t$svg.append($g);\n\t\t\t\t\t$button.append($svg);\n\t\t\t\t\t// Refresh button in the DOM in order for browser to process & display the SVG\n\t\t\t\t\t$button.html($button.html());\n\t\t\t\t\t$td.append($button);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (button === 'insert') {\n\t\t\t\t// Add Insert button to all rows\n\t\t\t\t$button = $('<button>',{\n\t\t\t\t\t'id': 'able-vts-button-insert-' + rowNum,\n\t\t\t\t\t'title': 'Insert row below',\n\t\t\t\t\t'aria-label': 'Insert row before Row ' + rowNum\n\t\t\t\t}).on('click', function(el) {\n\t\t\t\t\tthisObj.onClickVtsActionButton(el.currentTarget);\n\t\t\t\t});\n\t\t\t\t$svg = $('<svg>',{\n\t\t\t\t\t'focusable': 'false',\n\t\t\t\t\t'aria-hidden': 'true',\n\t\t\t\t\t'x': '0px',\n\t\t\t\t\t'y': '0px',\n\t\t\t\t\t'width': '401.994px',\n\t\t\t\t\t'height': '401.994px',\n\t\t\t\t\t'viewBox': '0 0 401.994 401.994',\n\t\t\t\t\t'style': 'enable-background:new 0 0 401.994 401.994'\n\t\t\t\t});\n\t\t\t\tpathString = 'M394,154.175c-5.331-5.33-11.806-7.994-19.417-7.994H255.811V27.406c0-7.611-2.666-14.084-7.994-19.414'\n\t\t\t\t\t+ 'C242.488,2.666,236.02,0,228.398,0h-54.812c-7.612,0-14.084,2.663-19.414,7.993c-5.33,5.33-7.994,11.803-7.994,19.414v118.775'\n\t\t\t\t\t+ 'H27.407c-7.611,0-14.084,2.664-19.414,7.994S0,165.973,0,173.589v54.819c0,7.618,2.662,14.086,7.992,19.411'\n\t\t\t\t\t+ 'c5.33,5.332,11.803,7.994,19.414,7.994h118.771V374.59c0,7.611,2.664,14.089,7.994,19.417c5.33,5.325,11.802,7.987,19.414,7.987'\n\t\t\t\t\t+ 'h54.816c7.617,0,14.086-2.662,19.417-7.987c5.332-5.331,7.994-11.806,7.994-19.417V255.813h118.77'\n\t\t\t\t\t+ 'c7.618,0,14.089-2.662,19.417-7.994c5.329-5.325,7.994-11.793,7.994-19.411v-54.819C401.991,165.973,399.332,159.502,394,154.175z';\n\t\t\t\t$path = $('<path>',{\n\t\t\t\t\t'd': pathString\n\t\t\t\t});\n\t\t\t\t$g = $('<g>').append($path);\n\t\t\t\t$svg.append($g);\n\t\t\t\t$button.append($svg);\n\t\t\t\t// Refresh button in the DOM in order for browser to process & display the SVG\n\t\t\t\t$button.html($button.html());\n\t\t\t\t$td.append($button);\n\t\t\t}\n\t\t\telse if (button === 'delete') {\n\t\t\t\t// Add Delete button to all rows\n\t\t\t\t$button = $('<button>',{\n\t\t\t\t\t'id': 'able-vts-button-delete-' + rowNum,\n\t\t\t\t\t'title': 'Delete row ',\n\t\t\t\t\t'aria-label': 'Delete Row ' + rowNum\n\t\t\t\t}).on('click', function(el) {\n\t\t\t\t\tthisObj.onClickVtsActionButton(el.currentTarget);\n\t\t\t\t});\n\t\t\t\t$svg = $('<svg>',{\n\t\t\t\t\t'focusable': 'false',\n\t\t\t\t\t'aria-hidden': 'true',\n\t\t\t\t\t'x': '0px',\n\t\t\t\t\t'y': '0px',\n\t\t\t\t\t'width': '508.52px',\n\t\t\t\t\t'height': '508.52px',\n\t\t\t\t\t'viewBox': '0 0 508.52 508.52',\n\t\t\t\t\t'style': 'enable-background:new 0 0 508.52 508.52'\n\t\t\t\t});\n\t\t\t\tpathString = 'M397.281,31.782h-63.565C333.716,14.239,319.478,0,301.934,0h-95.347'\n\t\t\t\t\t+ 'c-17.544,0-31.782,14.239-31.782,31.782h-63.565c-17.544,0-31.782,14.239-31.782,31.782h349.607'\n\t\t\t\t\t+ 'C429.063,46.021,414.825,31.782,397.281,31.782z';\n\t\t\t\t$path = $('<path>',{\n\t\t\t\t\t'd': pathString\n\t\t\t\t});\n\t\t\t\tpathString2 = 'M79.456,476.737c0,17.544,14.239,31.782,31.782,31.782h286.042'\n\t\t\t\t\t+ 'c17.544,0,31.782-14.239,31.782-31.782V95.347H79.456V476.737z M333.716,174.804c0-8.772,7.151-15.891,15.891-15.891'\n\t\t\t\t\t+ 'c8.74,0,15.891,7.119,15.891,15.891v254.26c0,8.74-7.151,15.891-15.891,15.891c-8.74,0-15.891-7.151-15.891-15.891V174.804z'\n\t\t\t\t\t+ 'M238.369,174.804c0-8.772,7.119-15.891,15.891-15.891c8.74,0,15.891,7.119,15.891,15.891v254.26'\n\t\t\t\t\t+ 'c0,8.74-7.151,15.891-15.891,15.891c-8.772,0-15.891-7.151-15.891-15.891V174.804z M143.021,174.804'\n\t\t\t\t\t+ 'c0-8.772,7.119-15.891,15.891-15.891c8.772,0,15.891,7.119,15.891,15.891v254.26c0,8.74-7.119,15.891-15.891,15.891'\n\t\t\t\t\t+ 'c-8.772,0-15.891-7.151-15.891-15.891V174.804z';\n\t\t\t\t$path2 = $('<path>',{\n\t\t\t\t\t'd': pathString2\n\t\t\t\t});\n\n\t\t\t\t$g = $('<g>').append($path,$path2);\n\t\t\t\t$svg.append($g);\n\t\t\t\t$button.append($svg);\n\t\t\t\t// Refresh button in the DOM in order for browser to process & display the SVG\n\t\t\t\t$button.html($button.html());\n\t\t\t\t$td.append($button);\n\t\t\t}\n\t\t}\n\t\treturn $td;\n\t};\n\n\tAblePlayer.prototype.updateVtsActionButtons = function($buttons,nextRowNum) {\n\n\t\t// TODO: Add some filters to this function to add or delete 'Up' and 'Down' buttons\n\t\t// if row is moved to/from the first/last rows\n\t\tvar i, $thisButton, id, label, newId, newLabel;\n\t\tfor (i=0; i < $buttons.length; i++) {\n\t\t\t$thisButton = $buttons.eq(i);\n\t\t\tid = $thisButton.attr('id');\n\t\t\tlabel = $thisButton.attr('aria-label');\n\t\t\t// replace the integer (id) within each of the above strings\n\t\t\tnewId = id.replace(/[0-9]+/g, nextRowNum);\n\t\t\tnewLabel = label.replace(/[0-9]+/g, nextRowNum);\n\t\t\t$thisButton.attr('id',newId);\n\t\t\t$thisButton.attr('aria-label',newLabel);\n\t\t}\n\t}\n\n\tAblePlayer.prototype.getIconCredit = function() {\n\n\t\tvar credit;\n\t\tcredit = '<div id=\"able-vts-icon-credit\">'\n\t\t\t+ 'Action buttons made by <a href=\"https://www.flaticon.com/authors/elegant-themes\">Elegant Themes</a> '\n\t\t\t+ 'from <a href=\"https://www.flaticon.com/\" title=\"Flaticon\">www.flaticon.com</a> '\n\t\t\t+ 'are licensed by <a href=\"http://creativecommons.org/licenses/by/3.0/\" title=\"Creative Commons BY 3.0\" '\n\t\t\t+ 'target=\"_blank\">CC 3.0 BY</a>'\n\t\t\t+ '</div>';\n\t\t\treturn credit;\n\t};\n\n\tAblePlayer.prototype.getAllLangs = function(tracks) {\n\n\t\t// update this.langs with any unique languages found in tracks\n\t\tvar i;\n\t\tfor (i in tracks) {\n\t\t\tif (tracks[i].hasOwnProperty('language')) {\n\t\t\t\tif ($.inArray(tracks[i].language,this.langs) === -1) {\n\t\t\t\t\t// this language is not already in the langs array. Add it.\n\t\t\t\t\tthis.langs[this.langs.length] = tracks[i].language;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getAllRows = function(lang) {\n\n\t\t// returns an array of data to be displayed in VTS table\n\t\t// includes all cues for tracks of any type with matching lang\n\t\t// cues are sorted by start time\n\t\tvar i, track, c, cues;\n\t\tcues = [];\n\t\tfor (i=0; i < this.vtsTracks.length; i++) {\n\t\t\ttrack = this.vtsTracks[i];\n\t\t\tif (track.language == lang) {\n\t\t\t\t// this track matches the language. Add its cues to array\n\t\t\t\tfor (c in track.cues) {\n\t\t\t\t\tcues.push({\n\t\t\t\t\t\t'kind': track.kind,\n\t\t\t\t\t\t'lang': lang,\n\t\t\t\t\t\t'id': track.cues[c].id,\n\t\t\t\t\t\t'start': track.cues[c].start,\n\t\t\t\t\t\t'end': track.cues[c].end,\n\t\t\t\t\t\t'content': track.cues[c].content\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Now sort cues by start time\n\t\tcues.sort(function(a,b) {\n\t\t\treturn a.start > b.start ? 1 : -1;\n\t\t});\n\t\treturn cues;\n\t};\n\n\n\tAblePlayer.prototype.onClickVtsActionButton = function(el) {\n\n\t\t// handle click on up, down, insert, or delete button\n\t\tvar idParts, action, rowNum;\n\t\tidParts = $(el).attr('id').split('-');\n\t\taction = idParts[3];\n\t\trowNum = idParts[4];\n\t\tif (action == 'up') {\n\t\t\t// move the row up\n\t\t\tthis.moveRow(rowNum,'up');\n\t\t}\n\t\telse if (action == 'down') {\n\t\t\t// move the row down\n\t\t\tthis.moveRow(rowNum,'down');\n\t\t}\n\t\telse if (action == 'insert') {\n\t\t\t// insert a row below\n\t\t\tthis.insertRow(rowNum);\n\t\t}\n\t\telse if (action == 'delete') {\n\t\t\t// delete the row\n\t\t\tthis.deleteRow(rowNum);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.insertRow = function(rowNum) {\n\n\t\t// Insert empty row below rowNum\n\t\tvar $table, $rows, numRows, newRowNum, newRowId, newTimes, $tr, $td;\n\t\tvar $select, options, i, $option, newKind, newClass, $parentRow;\n\t\tvar i, nextRowNum, $buttons;\n\n\t\t$table = $('#able-vts table');\n\t\t$rows = $table.find('tr');\n\n\t\tnumRows = $rows.length - 1; // exclude header row\n\n\t\tnewRowNum = parseInt(rowNum) + 1;\n\t\tnewRowId = 'able-vts-row-' + newRowNum;\n\n\t\t// Create an empty row\n\t\t$tr = $('<tr>',{\n\t\t\t'id': newRowId\n\t\t});\n\n\t\t// Row #\n\t\t$td = $('<td>').text(newRowNum);\n\t\t$tr.append($td);\n\n\t\t// Kind (add a select field for chosing a kind)\n\t\tnewKind = null;\n\t\t$select = $('<select>',{\n\t\t\t'id': 'able-vts-kind-' + newRowNum,\n\t\t\t'aria-label': 'What kind of track is this?',\n\t\t\t'placeholder': 'Select a kind'\n\t\t}).on('change',function() {\n\t\t\tnewKind = $(this).val();\n\t\t\tnewClass = 'kind-' + newKind;\n\t\t\t$parentRow = $(this).closest('tr');\n\t\t\t// replace the select field with the chosen value as text\n\t\t\t$(this).parent().text(newKind);\n\t\t\t// add a class to the parent row\n\t\t\t$parentRow.addClass(newClass);\n\t\t});\n\t\toptions = ['','captions','chapters','descriptions','subtitles'];\n\t\tfor (i=0; i<options.length; i++) {\n\t\t\t$option = $('<option>',{\n\t\t\t\t'value': options[i]\n\t\t\t}).text(options[i]);\n\t\t\t$select.append($option);\n\t\t}\n\t\t$td = $('<td>').append($select);\n\t\t$tr.append($td);\n\n\t\t// Start\n\t\t$td = $('<td>',{\n\t\t\t'contenteditable': 'true'\n\t\t}); // TODO; Intelligently assign a new start time (see getAdjustedTimes())\n\t\t$tr.append($td);\n\n\t\t// End\n\t\t$td = $('<td>',{\n\t\t\t'contenteditable': 'true'\n\t\t}); // TODO; Intelligently assign a new end time (see getAdjustedTimes())\n\t\t$tr.append($td);\n\n\t\t// Content\n\t\t$td = $('<td>',{\n\t\t\t'contenteditable': 'true'\n\t\t});\n\t\t$tr.append($td);\n\n\t\t// Actions\n\t\t$td = this.addVtsActionButtons(newRowNum,numRows);\n\t\t$tr.append($td);\n\n\t\t// Now insert the new row\n\t\t$table.find('tr').eq(rowNum).after($tr);\n\n\t\t// Update row.id, Row # cell, & action items for all rows after the inserted one\n\t\tfor (i=newRowNum; i <= numRows; i++) {\n\t\t\tnextRowNum = i + 1;\n\t\t\t$rows.eq(i).attr('id','able-vts-row-' + nextRowNum); // increment tr id\n\t\t\t$rows.eq(i).find('td').eq(0).text(nextRowNum); // increment Row # as expressed in first td\n\t\t\t$buttons = $rows.eq(i).find('button');\n\t\t\tthis.updateVtsActionButtons($buttons,nextRowNum);\n\t\t}\n\n\t\t// Auto-adjust times\n\t\tthis.adjustTimes(newRowNum);\n\n\t\t// Announce the insertion\n\t\tthis.showVtsAlert('A new row ' + newRowNum + ' has been inserted'); // TODO: Localize this\n\n\t\t// Place focus in new select field\n\t\t$select.focus();\n\n\t};\n\n\tAblePlayer.prototype.deleteRow = function(rowNum) {\n\n\t\tvar $table, $rows, numRows, i, nextRowNum, $buttons;\n\n\t\t$table = $('#able-vts table');\n\t\t$table[0].deleteRow(rowNum);\n\t\t$rows = $table.find('tr'); // this does not include the deleted row\n\t\tnumRows = $rows.length - 1; // exclude header row\n\n\t\t// Update row.id, Row # cell, & action buttons for all rows after the deleted one\n\t\tfor (i=rowNum; i <= numRows; i++) {\n\t\t\tnextRowNum = i;\n\t\t\t$rows.eq(i).attr('id','able-vts-row-' + nextRowNum); // increment tr id\n\t\t\t$rows.eq(i).find('td').eq(0).text(nextRowNum); // increment Row # as expressed in first td\n\t\t\t$buttons = $rows.eq(i).find('button');\n\t\t\tthis.updateVtsActionButtons($buttons,nextRowNum);\n\t\t}\n\n\t\t// Announce the deletion\n\t\tthis.showVtsAlert('Row ' + rowNum + ' has been deleted'); // TODO: Localize this\n\n\t};\n\n\tAblePlayer.prototype.moveRow = function(rowNum,direction) {\n\n\t\t// swap two rows\n\t\tvar $rows, $thisRow, otherRowNum, $otherRow, newTimes, msg;\n\n\t\t$rows = $('#able-vts table').find('tr');\n\t\t$thisRow = $('#able-vts table').find('tr').eq(rowNum);\n\t\tif (direction == 'up') {\n\t\t\totherRowNum = parseInt(rowNum) - 1;\n\t\t\t$otherRow = $('#able-vts table').find('tr').eq(otherRowNum);\n\t\t\t$otherRow.before($thisRow);\n\t\t}\n\t\telse if (direction == 'down') {\n\t\t\totherRowNum = parseInt(rowNum) + 1;\n\t\t\t$otherRow = $('#able-vts table').find('tr').eq(otherRowNum);\n\t\t\t$otherRow.after($thisRow);\n\t\t}\n\t\t// Update row.id, Row # cell, & action buttons for the two swapped rows\n\t\t$thisRow.attr('id','able-vts-row-' + otherRowNum);\n\t\t$thisRow.find('td').eq(0).text(otherRowNum);\n\t\tthis.updateVtsActionButtons($thisRow.find('button'),otherRowNum);\n\t\t$otherRow.attr('id','able-vts-row-' + rowNum);\n\t\t$otherRow.find('td').eq(0).text(rowNum);\n\t\tthis.updateVtsActionButtons($otherRow.find('button'),rowNum);\n\n\t\t// auto-adjust times\n\t\tthis.adjustTimes(otherRowNum);\n\n\t\t// Announce the move (TODO: Localize this)\n\t\tmsg = 'Row ' + rowNum + ' has been moved ' + direction;\n\t\tmsg += ' and is now Row ' + otherRowNum;\n\t\tthis.showVtsAlert(msg);\n\t};\n\n\tAblePlayer.prototype.adjustTimes = function(rowNum) {\n\n\t\t// Adjusts start and end times of the current, previous, and next rows in VTS table\n\t\t// after a move or insert\n\t\t// NOTE: Fully automating this process would be extraordinarily complicated\n\t\t// The goal here is simply to make subtle tweaks to ensure rows appear\n\t\t// in the new order within the Able Player transcript\n\t\t// Additional tweaking will likely be required by the user\n\n\t\t// HISTORY: Originally set minDuration to 2 seconds for captions and .500 for descriptions\n\t\t// However, this can results in significant changes to existing caption timing,\n\t\t// with not-so-positive results.\n\t\t// As of 3.1.15, setting minDuration to .001 for all track kinds\n\t\t// Users will have to make further adjustments manually if needed\n\n\t\t// TODO: Add WebVTT validation on save, since tweaking times is risky\n\n\t\tvar\t minDuration, $rows, prevRowNum, nextRowNum, $row, $prevRow, $nextRow,\n\t\t\t\tkind, prevKind, nextKind,\n\t\t\t\tstart, prevStart, nextStart,\n\t\t\t\tend, prevEnd, nextEnd;\n\n\t\t// Define minimum duration (in seconds) for each kind of track\n\t\tminDuration = [];\n\t\tminDuration['captions'] = .001;\n\t\tminDuration['descriptions'] = .001;\n\t\tminDuration['chapters'] = .001;\n\n\t\t// refresh rows object\n\t\t$rows = $('#able-vts table').find('tr');\n\n\t\t// Get kind, start, and end from current row\n\t\t$row = $rows.eq(rowNum);\n\t\tif ($row.is('[class^=\"kind-\"]')) {\n\t\t\t// row has a class that starts with \"kind-\"\n\t\t\t// Extract kind from the class name\n\t\t\tkind = this.getKindFromClass($row.attr('class'));\n\t\t}\n\t\telse {\n\t\t\t// Kind has not been assigned (e.g., newly inserted row)\n\t\t\t// Set as captions row by default\n\t\t\tkind = 'captions';\n\t\t}\n\t\tstart = this.getSecondsFromColonTime($row.find('td').eq(2).text());\n\t\tend = this.getSecondsFromColonTime($row.find('td').eq(3).text());\n\n\t\t// Get kind, start, and end from previous row\n\t\tif (rowNum > 1) {\n\t\t\t// this is not the first row. Include the previous row\n\t\t\tprevRowNum = rowNum - 1;\n\t\t\t$prevRow = $rows.eq(prevRowNum);\n\t\t\tif ($prevRow.is('[class^=\"kind-\"]')) {\n\t\t\t\t// row has a class that starts with \"kind-\"\n\t\t\t\t// Extract kind from the class name\n\t\t\t prevKind = this.getKindFromClass($prevRow.attr('class'));\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Kind has not been assigned (e.g., newly inserted row)\n\t\t\t\tprevKind = null;\n\t\t\t}\n\t\t\tprevStart = this.getSecondsFromColonTime($prevRow.find('td').eq(2).text());\n\t\t\tprevEnd = this.getSecondsFromColonTime($prevRow.find('td').eq(3).text());\n\t\t}\n\t\telse {\n\t\t\t// this is the first row\n\t\t\tprevRowNum = null;\n\t\t\t$prevRow = null;\n\t\t\tprevKind = null;\n\t\t\tprevStart = null;\n\t\t\tprevEnd = null;\n\t\t}\n\n\t\t// Get kind, start, and end from next row\n\t\tif (rowNum < ($rows.length - 1)) {\n\t\t\t// this is not the last row. Include the next row\n\t\t\tnextRowNum = rowNum + 1;\n\t\t\t$nextRow = $rows.eq(nextRowNum);\n\t\t\tif ($nextRow.is('[class^=\"kind-\"]')) {\n\t\t\t\t// row has a class that starts with \"kind-\"\n\t\t\t\t// Extract kind from the class name\n\t\t\t nextKind = this.getKindFromClass($nextRow.attr('class'));\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Kind has not been assigned (e.g., newly inserted row)\n\t\t\t\tnextKind = null;\n\t\t\t}\n\t\t\tnextStart = this.getSecondsFromColonTime($nextRow.find('td').eq(2).text());\n\t\t\tnextEnd = this.getSecondsFromColonTime($nextRow.find('td').eq(3).text());\n\t\t}\n\t\telse {\n\t\t\t// this is the last row\n\t\t\tnextRowNum = null;\n\t\t\t$nextRow = null;\n\t\t\tnextKind = null;\n\t\t\tnextStart = null;\n\t\t\tnextEnd = null;\n\t\t}\n\n\t\tif (isNaN(start)) {\n\t\t\tif (prevKind == null) {\n\t\t\t\t// The previous row was probably inserted, and user has not yet selected a kind\n\t\t\t\t// automatically set it to captions\n\t\t\t\tprevKind = 'captions';\n\t\t\t\t$prevRow.attr('class','kind-captions');\n\t\t\t\t$prevRow.find('td').eq(1).html('captions');\n\t\t\t}\n\t\t\t// Current row has no start time (i.e., it's an inserted row)\n\t\t\tif (prevKind === 'captions') {\n\t\t\t\t// start the new row immediately after the captions end\n\t\t\t\tstart = (parseFloat(prevEnd) + .001).toFixed(3);\n\t\t\t\tif (nextStart) {\n\t\t\t\t\t// end the new row immediately before the next row starts\n\t\t\t\t\tend = (parseFloat(nextStart) - .001).toFixed(3);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// this is the last row. Use minDuration to calculate end time.\n\t\t\t\t\tend = (parseFloat(start) + minDuration[kind]).toFixed(3);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (prevKind === 'chapters') {\n\t\t\t\t// start the new row immediately after the chapter start (not end)\n\t\t\t\tstart = (parseFloat(prevStart) + .001).toFixed(3);\n\t\t\t\tif (nextStart) {\n\t\t\t\t\t// end the new row immediately before the next row starts\n\t\t\t\t\tend = (parseFloat(nextStart) - .001).toFixed(3);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// this is the last row. Use minDuration to calculate end time.\n\t\t\t\t\tend = (parseFloat(start) + minDurartion[kind]).toFixed(3);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (prevKind === 'descriptions') {\n\t\t\t\t// start the new row minDuration['descriptions'] after the description starts\n\t\t\t\t// this will theoretically allow at least a small cushion for the description to be read\n\t\t\t\tstart = (parseFloat(prevStart) + minDuration['descriptions']).toFixed(3);\n\t\t\t\tend = (parseFloat(start) + minDuration['descriptions']).toFixed(3);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// current row has a start time (i.e., an existing row has been moved))\n\t\t\tif (prevStart) {\n\t\t\t\t// this is not the first row.\n\t\t\t\tif (prevStart < start) {\n\t\t\t\t\tif (start < nextStart) {\n\t\t\t\t\t\t// No change is necessary\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// nextStart needs to be incremented\n\t\t\t\t\t\tnextStart = (parseFloat(start) + minDuration[kind]).toFixed(3);\n\t\t\t\t\t\tnextEnd = (parseFloat(nextStart) + minDuration[nextKind]).toFixed(3);\n\t\t\t\t\t\t// TODO: Ensure nextEnd does not exceed the following start (nextNextStart)\n\t\t\t\t\t\t// Or... maybe this is getting too complicated and should be left up to the user\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// start needs to be incremented\n\t\t\t\t\tstart = (parseFloat(prevStart) + minDuration[prevKind]).toFixed(3);\n\t\t\t\t\tend = (parseFloat(start) + minDuration[kind]).toFixed(3);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// this is the first row\n\t\t\t\tif (start < nextStart) {\n\t\t\t\t\t// No change is necessary\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// nextStart needs to be incremented\n\t\t\t\t\tnextStart = (parseFloat(start) + minDuration[kind]).toFixed(3);\n\t\t\t\t\tnextEnd = (parseFloat(nextStart) + minDuration[nextKind]).toFixed(3);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// check to be sure there is sufficient duration between new start & end times\n\t\tif (end - start < minDuration[kind]) {\n\t\t\t// duration is too short. Change end time\n\t\t\tend = (parseFloat(start) + minDuration[kind]).toFixed(3);\n\t\t\tif (nextStart) {\n\t\t\t\t// this is not the last row\n\t\t\t\t// increase start time of next row\n\t\t\t\tnextStart = (parseFloat(end) + .001).toFixed(3);\n\t\t\t}\n\t\t}\n\n\t\t// Update all affected start/end times\n\t\t$row.find('td').eq(2).text(this.formatSecondsAsColonTime(start,true));\n\t\t$row.find('td').eq(3).text(this.formatSecondsAsColonTime(end,true));\n\t\tif ($prevRow) {\n\t\t\t$prevRow.find('td').eq(2).text(this.formatSecondsAsColonTime(prevStart,true));\n\t\t\t$prevRow.find('td').eq(3).text(this.formatSecondsAsColonTime(prevEnd,true));\n\t\t}\n\t\tif ($nextRow) {\n\t\t\t$nextRow.find('td').eq(2).text(this.formatSecondsAsColonTime(nextStart,true));\n\t\t\t$nextRow.find('td').eq(3).text(this.formatSecondsAsColonTime(nextEnd,true));\n\t\t}\n\t};\n\n\tAblePlayer.prototype.getKindFromClass = function(myclass) {\n\n\t\t// This function is called when a class with prefix \"kind-\" is found in the class attribute\n\n\t\tvar kindStart, kindEnd;\n\n\t\tkindStart = myclass.indexOf('kind-')+5;\n\t\tkindEnd = myclass.indexOf(' ',kindStart);\n\t\tif (kindEnd == -1) {\n\t\t\t// no spaces found, \"kind-\" must be the only myclass\n\t\t\treturn myclass.substring(kindStart);\n\t\t}\n\t\telse {\n\t\t\t// kind-* is one of multiple classes \n\t\t\t// the following will find it regardless of position of \"kind-*\" within the class string\n\t\t\treturn myclass.substring(kindStart,kindEnd);\n\t\t}\n\t};\n\n\tAblePlayer.prototype.showVtsAlert = function(message) {\n\n\t\t// this is distinct from greater Able Player showAlert()\n\t\t// because it's positioning needs are unique\n\t\t// For now, alertDiv is fixed at top left of screen\n\t\t// but could ultimately be modified to appear near the point of action in the VTS table\n\t\tthis.$vtsAlert.text(message).show().delay(3000).fadeOut('slow');\n\t};\n\n\tAblePlayer.prototype.parseVtsOutput = function($table) {\n\n\t\t// parse table into arrays, then into WebVTT content, for each kind\n\t\t// Display the WebVTT content in textarea fields for users to copy and paste\n\t\tvar lang, i, kinds, kind, vtt, $rows, start, end, content, $output;\n\n\t\tlang = $table.attr('lang');\n\t\tkinds = ['captions','chapters','descriptions','subtitles'];\n\t\tvtt = {};\n\t\tfor (i=0; i < kinds.length; i++) {\n\t\t\tkind = kinds[i];\n\t\t\tvtt[kind] = 'WEBVTT' + \"\\n\\n\";\n\t\t}\n\t\t$rows = $table.find('tr');\n\t\tif ($rows.length > 0) {\n\t\t\tfor (i=0; i < $rows.length; i++) {\n\t\t\t\tkind = $rows.eq(i).find('td').eq(1).text();\n\t\t\t\tif ($.inArray(kind,kinds) !== -1) {\n\t\t\t\t\tstart = $rows.eq(i).find('td').eq(2).text();\n\t\t\t\t\tend = $rows.eq(i).find('td').eq(3).text();\n\t\t\t\t\tcontent = $rows.eq(i).find('td').eq(4).text();\n\t\t\t\t\tif (start !== undefined && end !== undefined) {\n\t\t\t\t\t\tvtt[kind] += start + ' --> ' + end + \"\\n\";\n\t\t\t\t\t\tif (content !== 'undefined') {\n\t\t\t\t\t\t\tvtt[kind] += content;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvtt[kind] += \"\\n\\n\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t$output = $('<div>',{\n\t\t\t'id': 'able-vts-output'\n\t\t})\n\t\t$('#able-vts').append($output);\n\t\tfor (i=0; i < kinds.length; i++) {\n\t\t\tkind = kinds[i];\n\t\t\tif (vtt[kind].length > 8) {\n\t\t\t\t// some content has been added\n\t\t\t\tthis.showWebVttOutput(kind,vtt[kind],lang)\n\t\t\t}\n\t\t}\n\t};\n\n\tAblePlayer.prototype.showWebVttOutput = function(kind,vttString,lang) {\n\n\t\tvar $heading, filename, $p, pText, $textarea;\n\n\t\t$heading = $('<h3>').text(kind.charAt(0).toUpperCase() + kind.slice(1));\n\t\tfilename = this.getFilenameFromTracks(kind,lang);\n\t\tpText = 'If you made changes, copy/paste the following content ';\n\t\tif (filename) {\n\t\t\tpText += 'to replace the original content of your ' + this.getLanguageName(lang) + ' ';\n\t\t\tpText += '<em>' + kind + '</em> WebVTT file (<strong>' + filename + '</strong>).';\n\t\t}\n\t\telse {\n\t\t\tpText += 'into a new ' + this.getLanguageName(lang) + ' <em>' + kind + '</em> WebVTT file.';\n\t\t}\n\t\t$p = $('<p>',{\n\t\t\t'class': 'able-vts-output-instructions'\n\t\t}).html(pText);\n\t\t$textarea = $('<textarea>').text(vttString);\n\t\t$('#able-vts-output').append($heading,$p,$textarea);\n\t};\n\n})(jQuery);\n\n\n(function ($) {\n\tAblePlayer.prototype.initVimeoPlayer = function () {\n\n\t\tvar thisObj, deferred, promise, containerId, vimeoId, autoplay, videoDimensions, options;\n\t\tthisObj = this;\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\n\t\tcontainerId = this.mediaId + '_vimeo';\n\n\t\t// add container to which Vimeo player iframe will be appended\n\t\tthis.$mediaContainer.prepend($('<div>').attr('id', containerId));\n\n\t\t// if a described version is available && user prefers desription\n\t\t// init player using the described version\n\t\tif (this.vimeoDescId && this.prefDesc) {\n\t\t\tvimeoId = this.vimeoDescId;\n\t\t}\n\t\telse {\n\t\t\tvimeoId = this.vimeoId;\n\t\t}\n\t\tthis.activeVimeoId = vimeoId;\n\n\t\t// Notes re. Vimeo Embed Options:\n\t\t// If a video is owned by a user with a paid Plus, PRO, or Business account,\n\t\t// setting the \"controls\" option to \"false\" will hide the default controls, without hiding captions.\n\t\t// This is a new option from Vimeo; previously used \"background:true\" to hide the controller,\n\t\t// but that had unwanted side effects:\n\t\t//  - In addition to hiding the controls, it also hides captions\n\t\t//  - It automatically autoplays (initializing the player with autoplay:false does not override this)\n\t\t//  - It automatically loops (but this can be overridden by initializing the player with loop:false)\n\t\t//  - It automatically sets volume to 0 (not sure if this can be overridden, since no longer using the background option)\n\n\t\tif (this.okToPlay) {\n\t\t\tautoplay = 'true';\n\t\t}\n\t\telse {\n\t\t\tautoplay = 'false';\n\t\t}\n\n\t\tif (this.playerWidth) {\t\t\t\n\t\t\tif (this.vimeoUrlHasParams) { \n\t\t\t\t// use url param, not id \n\t\t\t\toptions = {\n\t\t\t\t\turl: vimeoId,\n\t\t\t\t\twidth: this.playerWidth,\n\t\t\t\t\tcontrols: false\n\t\t\t\t}\n\t\t\t}\n\t\t\telse { \n\t\t\t\toptions = {\n\t\t\t\t\tid: vimeoId,\n\t\t\t\t\twidth: this.playerWidth,\n\t\t\t\t\tcontrols: false\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse { \n\t\t\t// initialize without width & set width later \n\t\t\tif (this.vimeoUrlHasParams) { \n\t\t\t\toptions = {\n\t\t\t\t\turl: vimeoId,\n\t\t\t\t\tcontrols: false\n\t\t\t\t}\n\t\t\t}\n\t\t\telse { \n\t\t\t\toptions = {\n\t\t\t\t\tid: vimeoId,\n\t\t\t\t\tcontrols: false\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.vimeoPlayer = new Vimeo.Player(containerId, options);\n\n\t\tthis.vimeoPlayer.ready().then(function() {\n\t\t\t// add tabindex -1 on iframe so vimeo frame cannot be focused on\n\t\t\t$('#'+containerId).children('iframe').attr({\n\t\t\t\t'tabindex': '-1',\n\t\t\t\t'aria-hidden': true\n\t\t\t});\n\n\t\t\t// get video's intrinsic size and initiate player dimensions\n\t\t\tthisObj.vimeoPlayer.getVideoWidth().then(function(width) {\t\t\t\t\t\t\n\t\t\t\tif (width) { \n\t\t\t\t\t// also get height \n\t\t\t\t\tthisObj.vimeoPlayer.getVideoHeight().then(function(height) {\t\n\t\t\t\t\t\tif (height) { \t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tthisObj.resizePlayer(width,height); \t\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t});\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}).catch(function(error) {\n\t\t\t\t// an error occurred getting height or width \n\t\t\t\t// TODO: Test this to see how gracefully it organically recovers \n\t\t\t});\n\n\t\t\tif (!thisObj.hasPlaylist) {\n\t\t\t\t// remove the media element, since Vimeo replaces that with its own element in an iframe\n\t\t\t\t// this is handled differently for playlists. See buildplayer.js > cuePlaylistItem()\n\t\t\t\tthisObj.$media.remove();\n\n\t\t\t\t// define variables that will impact player setup\n\n\t\t\t\t// vimeoSupportsPlaybackRateChange\n\t\t\t\t// changing playbackRate is only supported if the video is hosted on a Pro or Business account\n\t\t\t\t// unfortunately there is no direct way to query for that information.\n\t\t\t\t// this.vimeoPlayer.getPlaybackRate() returns a value, regardless of account type\n\t\t\t\t// This is a hack:\n\t\t\t\t// Attempt to change the playbackRate. If it results in an error, assume changing playbackRate is not supported.\n\t\t\t\t// Supported playbackRate values are 0.5 to 2.\n\t\t\t\tthisObj.vimeoPlaybackRate = 1;\n\t\t\t\tthisObj.vimeoPlayer.setPlaybackRate(thisObj.vimeoPlaybackRate).then(function(playbackRate) {\n\t\t\t\t// playback rate was set\n\t\t\t\t\tthisObj.vimeoSupportsPlaybackRateChange = true;\n\t\t\t\t}).catch(function(error) {\n\t\t\t\t\tthisObj.vimeoSupportsPlaybackRateChange = false;\n\t\t\t\t});\n\t\t\t\tdeferred.resolve();\n\t\t\t}\n\t\t});\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.getVimeoPaused = function () {\n\n\t\tvar deferred, promise;\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\n\t\tthis.vimeoPlayer.getPaused().then(function (paused) {\n\t\t\t// paused is Boolean\n\t\t\tdeferred.resolve(paused);\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\tAblePlayer.prototype.getVimeoEnded = function () {\n\n\t\tvar deferred, promise;\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\n\t\tthis.vimeoPlayer.getEnded().then(function (ended) {\n\t\t\t// ended is Boolean\n\t\t\tdeferred.resolve(ended);\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\tAblePlayer.prototype.getVimeoState = function () {\n\n\t\tvar thisObj, deferred, promise, promises, gettingPausedPromise, gettingEndedPromise;\n\n\t\tthisObj = this;\n\n\t\tdeferred = new $.Deferred();\n\t\tpromise = deferred.promise();\n\t\tpromises = [];\n\n\t\tgettingPausedPromise = this.vimeoPlayer.getPaused();\n\t\tgettingEndedPromise = this.vimeoPlayer.getEnded();\n\n\t\tpromises.push(gettingPausedPromise);\n\t\tpromises.push(gettingEndedPromise);\n\n\t\tgettingPausedPromise.then(function (paused) {\n\t\t\tdeferred.resolve(paused);\n\t\t});\n\t\tgettingEndedPromise.then(function (ended) {\n\t\t\tdeferred.resolve(ended);\n\t\t});\n\t\t$.when.apply($, promises).then(function () {\n\t\t\tdeferred.resolve();\n\t\t});\n\t\treturn promise;\n\t}\n\n\tAblePlayer.prototype.getVimeoCaptionTracks = function () {\n\n\t\t// get data via Vimeo Player API, and push data to this.captions\n\t\t// Note: Vimeo doesn't expose the caption cues themselves\n\t\t// so this.captions will only include metadata about caption tracks; not cues\n\t\tvar deferred = new $.Deferred();\n\t\tvar promise = deferred.promise();\n\n\t\tvar thisObj, i, trackId, isDefaultTrack;\n\n\t\tthisObj = this;\n\n\t\tthis.vimeoPlayer.getTextTracks().then(function(tracks) {\n\n\t\t\t\t// each Vimeo track includes the following:\n\t\t\t\t// label (local name of the language)\n\t\t\t\t// language (2-character code)\n\t\t\t\t// kind (captions or subtitles, as declared by video owner)\n\t\t\t\t// mode ('disabled' or 'showing')\n\n\t\t\t\tif (tracks.length) {\n\n\t\t\t\t\t// create a new button for each caption track\n\t\t\t\t\tfor (i=0; i<tracks.length; i++) {\n\n\t\t\t\t\t\tthisObj.hasCaptions = true;\n\t\t\t\t\t\tif (thisObj.prefCaptions === 1) {\n\t\t\t\t\t\t\t\tthisObj.captionsOn = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthisObj.captionsOn = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// assign the default track based on language of the player\n\t\t\t\t\t\tif (tracks[i]['language'] === thisObj.lang) {\n\t\t\t\t\t\t\tisDefaultTrack = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tisDefaultTrack = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthisObj.tracks.push({\n\t\t\t\t\t\t\t'kind': tracks[i]['kind'],\n\t\t\t\t\t\t\t'language': tracks[i]['language'],\n\t\t\t\t\t\t\t'label': tracks[i]['label'],\n\t\t\t\t\t\t\t'def': isDefaultTrack\n\t\t\t\t\t\t});\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\tthisObj.captions = thisObj.tracks; \n\t\t\t\t\tthisObj.hasCaptions = true;\n\n\t\t\t\t\t// setupPopups again with new captions array, replacing original\n\t\t\t\t\tthisObj.setupPopups('captions');\n\t\t\t\t\tdeferred.resolve();\n\t\t\t \t}\n\t\t\t \telse {\n\t\t\t\t\tthisObj.hasCaptions = false;\n\t\t\t\t\tthisObj.usingVimeoCaptions = false; \n\t\t\t\t\tdeferred.resolve();\n\t\t\t\t}\n\t\t\t});\n\n\t\treturn promise;\n\t};\n\n\tAblePlayer.prototype.getVimeoPosterUrl = function (vimeoId, width) {\n\n\t\t// this is a placeholder, copied from getYouTubePosterUrl()\n\t\t// Vimeo doesn't seem to have anything similar, \n\t\t// nor does it seem to be possible to get the poster via the Vimeo API\n\t\t// Vimeo playlist support (with thumbnail images) may require use of data-poster \n\n\t\t// return a URL for retrieving a YouTube poster image\n\t\t// supported values of width: 120, 320, 480, 640\n\n\t\tvar url = 'https://img.youtube.com/vi/' + youTubeId;\n\t\tif (width == '120') {\n\t\t\t// default (small) thumbnail, 120 x 90\n\t\t\treturn url + '/default.jpg';\n\t\t}\n\t\telse if (width == '320') {\n\t\t\t// medium quality thumbnail, 320 x 180\n\t\t\treturn url + '/hqdefault.jpg';\n\t\t}\n\t\telse if (width == '480') {\n\t\t\t// high quality thumbnail, 480 x 360\n\t\t\treturn url + '/hqdefault.jpg';\n\t\t}\n\t\telse if (width == '640') {\n\t\t\t// standard definition poster image, 640 x 480\n\t\t\treturn url + '/sddefault.jpg';\n\t\t}\n\t\treturn false;\n\t};\t\n\n\tAblePlayer.prototype.getVimeoId = function (url) {\n\t\t\n\t\t// return a Vimeo ID, extracted from a full Vimeo URL\n\t\t// Supported URL patterns are anything containing 'vimeo.com'\n\t\t//  and ending with a '/' followed by the ID. \n\t\t// (Vimeo IDs do not have predicatable lengths)\n\t\t\n\t\t// Update: If URL contains parameters, return the full url \n\t\t// This will need to be passed to the Vimeo Player API \n\t\t// as a url parameter, not as an id parameter\t\t \n\t\tthis.vimeoUrlHasParams = false; \n\t\n\t\tvar idStartPos, id; \n\n\t\tif (typeof url === 'number') { \n\t\t\t// this is likely already a vimeo ID \n\t\t\treturn url; \n\t\t}\n\t\telse if (url.indexOf('vimeo.com') !== -1) { \n\t\t\t// this is a full Vimeo URL \n\t\t\tif (url.indexOf('?') !== -1) { \n\t\t\t\t// URL contains parameters \n\t\t\t\tthis.vimeoUrlHasParams = true; \n\t\t\t\treturn url; \n\t\t\t}\n\t\t\telse { \t\t\t\n\t\t\t\turl = url.trim(); \n\t\t\t\tidStartPos = url.lastIndexOf('/') + 1; \n\t\t\t\tid = url.substring(idStartPos); \n\t\t\t\treturn id; \n\t\t\t}\n\t\t}\n\t\telse { \n\t\t\treturn url; \n\t\t}\n};\t\n\n})(jQuery);\n"],"names":["$","isoLangs","AblePlayerInstances","jQuery","each","index","element","undefined","data","push","AblePlayer","this","window","onYouTubeIframeAPIReady","youTubeIframeAPIReady","trigger","on","e","nextIndex","lastCreated","onPlayerKeyPress","media","length","attr","autoplay","okToPlay","loop","playsInline","hasPoster","width","height","isNumeric","startTime","debug","rootPath","replace","getRootPath","defaultVolume","volume","useChaptersButton","readDescriptionsAloud","descReader","defaultStateCaptions","defaultStateDescriptions","defaultDescPause","headingLevel","test","playerHeadingLevel","transcriptDivLocation","hideTranscriptButton","transcriptType","transcriptSrc","transcriptSrcHasRequiredParts","console","log","find","lyricsMode","transcriptTitle","defaultCaptionsPosition","chaptersDivLocation","chaptersTitle","defaultChapter","speedIcons","seekbarScope","youTubeId","getYouTubeId","youTubeDescId","youTubeNoCookie","vimeoId","getVimeoId","vimeoDescId","skin","playerWidth","parseInt","getAttribute","iconType","forceIconType","allowFullscreen","clickedFullscreenButton","restoringAfterFullscreen","defaultSeekInterval","useFixedSeekInterval","seekInterval","showNowPlaying","useTtml","convert","require","testFallback","lang","toLowerCase","metaType","metaDiv","searchDiv","searchString","searchLang","searchIgnoreCaps","hideControls","hideControlsOriginal","stenoMode","stenoFrameId","$stenoFrame","setDefaults","ableIndex","title","tt","thisObj","when","getTranslationText","then","countProperties","setup","provideFallback","fail","prototype","initializing","reinitialize","player","setupInstance","setupInstancePlaylist","hasPlaylist","recreatePlayer","playerCreated","getActiveDOMElement","activeElement","document","shadowRoot","localGetElementById","id","getRootNode","querySelector","getElementById","loadingYouTubeIframeAPI","playing","paused","clickedPlay","fullscreen","swappingSrc","cueingPlaylistItems","buttonWithFocus","speechEnabled","setIconColor","setButtonImages","scripts","i","scriptSrc","fullPath","ablePath","parentFolderIndex","getElementsByTagName","src","substring","lastIndexOf","indexOf","split","slice","join","$elements","$el","rgb","iconColor","hide","append","css","toolbarIconColor","remove","imgPath","playButtonImg","pauseButtonImg","restartButtonImg","rewindButtonImg","forwardButtonImg","previousButtonImg","nextButtonImg","fasterButtonImg","slowerButtonImg","captionsButtonImg","chaptersButtonImg","signButtonImg","transcriptButtonImg","descriptionsButtonImg","fullscreenExpandButtonImg","fullscreenCollapseButtonImg","prefsButtonImg","helpButtonImg","getSvgData","button","svg","Array","deferred","promise","Deferred","startedPlaying","autoScrollTranscript","$media","first","is","mediaType","$sources","getPlayer","setIconType","resolve","setPlayerSize","$ableWrapper","playerHeight","aspectRatio","$tempButton","$testButton","controllerFont","createElementNS","createSVGRect","getComputedStyle","get","getPropertyValue","mediaId","$playlist","youTubePoster","getYouTubePosterUrl","$youTubeImg","prepend","vimeoPoster","getVimeoPosterUrl","$vimeoImg","playlistIndex","dataEmbedded","playlistEmbed","removeAttribute","parent","$playlistDom","clone","cuePlaylistItem","prefsGroups","playerDeleted","recreatingPlayer","loadCurrentPreferences","injectPlayerCode","resizePlayer","videoWidth","videoHeight","getSampleDescriptionText","initSignLanguage","initPlayer","getTracks","initDescription","setupTracks","hasClosedDesc","$descDiv","contains","$ableDiv","injectTextDescriptionArea","initSpeech","setupTranscript","initStenoFrame","stenoFrameContents","contents","getMediaTimes","mediaTimes","duration","elapsed","setFullscreen","setVolume","addTranscriptAreaEvents","updateTranscript","captions","initDefaultCaption","setMediaAttributes","addControls","addEventListeners","getPreferencesGroups","injectPrefsForm","setupPopups","updateCaption","injectVTS","populateChaptersDiv","showSearchResults","loadingMedia","load","setTimeout","refreshControls","playerPromise","initHtml5Player","initYouTubePlayer","initVimeoPlayer","done","seekIntervalCalculated","setSeekInterval","reject","contentWindow","readyState","useChapterTimes","chapterDuration","def","captionLang","language","selectedCaptions","$transcriptLanguageSelect","prop","syncTrackLanguages","usingVimeoCaptions","prefCaptions","vimeoPlayer","enableTextTrack","track","catch","error","name","kind","label","disableTextTrack","textTracks","mode","canPlayType","setCookie","cookieValue","Cookies","set","JSON","stringify","expires","sameSite","getCookie","cookie","defaultCookie","preferences","sign","transcript","voices","parse","err","updateCookie","setting","$window","windowPos","available","prefName","voiceLangFound","newVoice","$transcriptArea","position","top","left","$signWindow","v","prefDescVoiceLang","prefDescVoice","getAvailablePreferences","usingYouTubeCaptions","prefs","prefAltKey","prefCtrlKey","prefShiftKey","prefHighlight","prefTabbable","prefCaptionsPosition","prefCaptionsFont","prefCaptionsSize","prefCaptionsColor","prefCaptionsBGColor","prefCaptionsOpacity","prefDescPitch","prefDescRate","prefDescPause","prefDescVisible","ii","defaultValue","prefVoices","form","$prefsDiv","formTitle","introText","$prefsIntroP2","p3Text","$prefsIntroP3","j","$fieldset","fieldsetClass","fieldsetId","$legend","legendId","thisPref","$thisDiv","thisClass","thisId","$thisLabel","$thisField","options","$thisOption","optionValue","optionLang","optionText","changedPref","changedSpan","changedText","currentDescState","$kbHeading","$kbList","kbLabels","keys","kbListText","$kbListItem","dialog","saveButton","cancelButton","customClass","addClass","prefTitleCaptions","prefTitleDescriptions","$prefsIntro","text","prefIntroDescription1","$prefsIntroUL","$prefsIntroLI1","prefDescFormatOption1","$prefsIntroLI2","prefDescFormatOption2","hasOpenDesc","prefIntroDescription2","prefDescFormatOption1b","and","prefDescFormatOption2b","prefIntroDescriptionNone","html","prefIntroDescription3","prefIntroDescription4","prefTitleKeyboard","prefIntroKeyboard1","prefIntroKeyboard2","prefIntroKeyboard3","prefTitleTranscript","prefHeadingKeyboard1","prefHeadingTextDescription","change","stylizeCaptions","$sampleCapsDiv","getCaptionsOptions","captionsPositionOverlay","captionsPositionBelow","transparent","solid","value","type","synth","descVoices","getPrefDescVoice","$voiceSelectField","makePrefsValueReadable","announceDescriptionText","currentSampleText","sampleCaptionText","$sampleDescDiv","sampleDescriptionText","prefHeadingKeyboard2","controls","play","pause","or","spacebar","restart","prevTrack","nextTrack","rewind","forward","mute","unmute","captionsOn","hideCaptions","showCaptions","descOn","turnOffDescriptions","turnOnDescriptions","help","escapeKey","escapeKeyFunction","AccessibleDialog","$prefsButton","closeButtonLabel","save","cancel","click","savePrefsFromForm","resetPrefsForm","titleH1","captionPrefsDialog","descPrefsDialog","keyboardPrefsDialog","transcriptPrefsDialog","keydown","which","selectedDescriptions","rebuildDescPrefsForm","empty","pref","prefDescPitch1","prefDescPitch2","prefDescPitch3","prefDescPitch4","prefDescPitch5","val","prefId","voiceSelectId","numChanges","numCapChanges","capSizeChanged","capSizeValue","newValue","prefDescMethod","showAlert","prefSuccess","prefNoChange","youTubePlayer","setOption","translatePrefs","updatePrefs","geteferences","$captionsDiv","$transcriptDiv","removeAttr","removeClass","usingModifierKeys","altKey","ctrlKey","shiftKey","actList","state","list","results","act","action","updatePosition","cutText","column","line","cut","returnText","cutLine","nextEOL","peekLine","parseFileBody","eatOptionalBOM","eatSignature","c","eatUntilEOLInclusive","parseMetadataHeaders","eatAtLeast1EmptyLines","parseCuesAndComments","nextLine","keyValue","getMetadataKeyValue","metadata","nextSpaceOrNewline","s","possible","spaceIndex","tabIndex","lineIndex","Math","min","apply","next","pair","colon","getSettingsKeyValue","trim","eatEmptyLines","parseCue","eatComment","cueId","errString","warn","cueTimings","getTiming","eatAtLeast1SpacesOrTabs","eatArrow","endTime","eatSpacesOrTabs","cueSettings","getCueSettings","components","getCuePayload","cues","start","end","settings","result","tagName","classes","annotation","children","current","languageStack","token","getCueToken","inArray","pop","tempState","timing","tokenState","buffer","match","numEaten","linesEaten","nextSpace","timestamp","exec","time","hours","minutes","seconds","parseWebVTT","srcFile","parserState","captionsContainer","$mediaContainer","wrap","injectBigPlayButton","injectPlayerControlArea","$captionsContainer","injectAlert","injectPlaylist","injectOffscreenHeading","headingType","getNextHeadingLevel","toString","$headingDiv","playerHeading","svgData","buttonIcon","svgPath","$bigPlayButton","$bigPlayIcon","event","preventDefault","handlePlay","$playerDiv","$nowPlayingDiv","$controllerDiv","$statusBarDiv","$timer","$elapsedTimeContainer","$durationContainer","$speed","speed","$status","getDefaultWidth","positionDraggableWindow","cookiePos","isEmptyObject","getOptimumPosition","updateZIndex","targetWindow","targetWidth","ableWidth","ableOffset","ableLeft","windowWidth","otherWindowWidth","offset","$alertBox","appendTo","$srAlertBox","playlistClone","insertBefore","createPopup","tracks","$menu","$menuItem","prefCat","hasDefault","windowOptions","whichPref","$thisItem","$prevItem","$nextItem","prefCats","prefMenuCaptions","prefMenuDescriptions","prefMenuKeyboard","prefMenuTranscript","showingPrefsDialog","show","closePopups","getCaptionClickFunction","flattenCueForCaption","formatSecondsAsColonTime","getChapterClickFunction","captionsOff","getCaptionOffFunction","windowMove","windowResize","windowClose","stopPropagation","windowMenuClickRegistered","finishingDrag","handleMenuChoice","last","prev","focus","chaptersPopup","$chaptersButton","captionsPopup","$ccButton","waitThenFocus","prefsPopup","hidingPopup","$volumeSlider","$volumeButton","$transcriptPopup","$transcriptPopupButton","$signPopup","$signPopupButton","popups","chapters","hasSignLanguage","popup","selectedChapters","$fallback","usingFallback","floor","random","hasFallback","replaceWith","$newFallbackElement","calculateControlLayout","controlLayout","playbackSupported","numA11yButtons","isPlaybackRateSupported","hasCaptions","hasChapters","browserSupportsVolume","volumeButton","getVolumeName","numSections","$controllerSpan","$sliderDiv","sliderLabel","$pipe","$pipeImg","control","$buttonImg","buttonImgSrc","buttonTitle","$newButton","iconClass","tooltipId","tooltipTimerId","captionLabel","popupMenuId","$tooltipDiv","seekbarLabel","seekBar","AccessibleSlider","alt","role","getButtonTitle","$buttonLabel","clearTimeout","buttonText","buttonHeight","buttonWidth","controllerWidth","right","tooltipY","hasClass","buttonSide","tooltipWidth","tooltipX","tooltipStyle","tooltip","showTooltip","prefDesc","$playpauseButton","$prevButton","$nextButton","$signButton","$descButton","$muteButton","$transcriptButton","showTranscript","$fullscreenButton","addVolumeSlider","sec","hasOwnProperty","concat","useSvg","checkUseElems","tid","cache","Object","create","debouncedCheck","unobserveChanges","xlinkNS","base","bcr","hash","Request","isHidden","url","uses","xhr","inProgressCount","XMLHttpRequest","withCredentials","XDomainRequest","getBoundingClientRect","ignore","getAttributeNS","bottom","attrUpdateFunc","useEl","onload","onloadFunc","onerror","onErrorTimeout","ontimeout","open","send","abort","observeIfDone","observer","addEventListener","MutationObserver","observe","documentElement","childList","subtree","attributes","disconnect","removeEventListener","spec","setAttributeNS","body","x","createElement","innerHTML","responseText","setAttribute","style","overflow","firstChild","sourceIndex","$newItem","prevPlayer","newPlayer","itemTitle","itemLang","nowPlayingSpan","deletePlayer","eq","hasAttr","pauseMedia","$sourceSpans","$newSource","$trackSpans","$newTrack","selectedTrack","context","destroy","$captionsWrapper","hasDescTracks","hideTranscript","faster","slower","exitFullscreen","enterFullscreen","charAt","toUpperCase","loadingPromises","loadingPromise","vtsTracks","hasVts","altTracks","loadTextObject","trackLang","trackLabel","trackDesc","desc","trackSrc","trackText","trackContents","setupVtsTracks","setupCaptions","setupDescriptions","setupChapters","setupMetadata","isDefault","forDesc","hasTrackInDefLang","trackFound","$tracks","descriptions","meta","hasCaptionsTrack","getLanguageName","getYouTubeCaptionTracks","getVimeoCaptionTracks","inserted","splice","currentCaption","currentDescription","$metaDiv","hasMeta","visibleSelectors","$tempDiv","status","req","youTubePlayerReady","activeYouTubeId","finalizeYoutubeInit","getScript","containerId","YT","Player","videoId","host","playerVars","enablejsapi","disableKb","playsinline","cc_load_policy","cc_lang_pref","hl","modestbranding","rel","iv_load_policy","events","onReady","getYouTubeDimensions","setSize","restoreFocus","cueingPlaylistItem","playMedia","userClickedPlaylist","onError","onStateChange","getPlayerState","playerState","onMediaComplete","stoppingYouTube","$posterImg","seeking","getOptions","unloadModule","onPlaybackQualityChange","youTubeContainerId","$iframe","ytTracks","isDefaultTrack","getOption","getDuration","loadingYouTubeCaptions","pauseVideo","languageCode","languageName","playVideo","captionLangPending","getYouTubeTimedTextUrl","trackName","idStartPos","div","orientation","max","bigInterval","className","trackingMedia","initialState","coords","tracking","trackDevice","keyTrackPosition","lastTrackPosition","nextStep","inertiaCount","bodyDiv","loadedDiv","playedDiv","seekHead","timeTooltipTimeoutId","overTooltip","timeTooltip","clearInterval","wrapperDiv","setDuration","pointerEventToXY","overHead","overBody","stopTracking","pageXToPosition","trackHeadAtPageX","startTracking","refreshTooltip","overBodyMousePos","y","trackImmediatelyTo","arrowKeyDown","multiplier","boundPos","trackHeadAtPosition","pageX","resetHeadLocation","setWidth","resizeDivs","getWidth","buffered","ratio","center","setPosition","updateLive","updateAriaValues","setBuffered","isNaN","redrawDivs","device","newLeft","reportTrackAtPosition","descriptionText","pHours","pMinutes","pSeconds","pMinuteWord","pSecondWord","liveAriaRegion","positionToStr","setTooltipPosition","_this","hideSliderTooltips","dHours","dMinutes","dSeconds","out","touch","originalEvent","touches","changedTouches","pageY","$div","volumeSliderId","volumeHelpId","volumePct","tickLabelsId","$tickLabels","$tickOption","tickLabel","$volumeSliderTooltip","$volumeRange","volumeUpDown","$volumeHelp","handleVolumeChange","closingVolume","hideVolumePopup","showVolumePopup","refreshVolumeHelp","refreshVolumeButton","volumeName","volumeLabel","volumeIconClass","volumeImg","newSvgData","handleVolumeButtonClick","handleVolumeKeystroke","keycode","isMuted","setMute","handleMute","muted","lastVolume","unMute","newVolume","signVideo","getVolume","focusableElementsSelector","modalDiv","$returnElement","dialogRole","isModal","escapeHook","focusedElementBeforeModal","baseId","modal","closeButton","focusable","filter","focused","currentIndex","not","overlay","blur","getInputs","$element","$foundHeadings","numHeadings","headingNumber","parents","obj","count","showFullTime","parts","milliSeconds","numShort","getSecondsFromColonTime","timeStr","timeParts","parseFloat","capitalizeFirstLetter","string","roundDown","decimals","Number","object","attribute","isInteger","isFinite","descFile","descMethod","usingDescribedVersion","swapDescription","activeVimeoId","speechSynthesis","greeting","SpeechSynthesisUtterance","rate","speak","onstart","off","onend","getBrowserVoices","descLangs","voiceLang","preferredLang","getVoices","getDescriptionLangs","setDescriptionVoice","descVoice","descLang","prefVoiceFound","origSrc","descSrc","$focusedElement","swapTime","prevDuration","alertDescribedVersion","alertNonDescribedVersion","loadVideoById","cueVideoById","loadVideo","setCurrentTime","showDescription","now","d","thisDescription","descText","flattenComponentForDescription","component","pausedForDescription","syncSpeechToPlaybackRate","speechRate","voiceName","voice","pitch","utterance","timeElapsed","secondsElapsed","prefDescVolume","voiceURI","onpause","speakingDescription","elapsedTime","toFixed","resume","isIOS","version","userAgent","navigator","audio","Audio","nativeFullscreenSupported","fullscreenEnabled","webkitFullscreenEnabled","mozFullscreenEnabled","msFullscreenEnabled","seekTo","newTime","seekable","seekFromTime","currentTime","seekToTime","liveUpdatePending","seekStatus","getElapsed","getCurrentTime","ended","getPaused","getEnded","playbackRate","getAvailablePlaybackRates","vimeoSupportsPlaybackRateChange","setPlaybackRate","getPlaybackRate","isPaused","hidingControls","invokeHideControlsTimeout","fadeControls","direction","fadeTo","hideControlsTimeout","controlsHidden","hideControlsTimeoutStatus","lastChapterIndex","displayElapsed","textByState","widthUsed","leftControls","rightControls","seekbarWidth","captionsCount","newTop","statusBarHeight","getChapterDuration","chapterElapsed","getChapterElapsed","currentChapter","outerWidth","abs","getVideoLoadedFraction","hideBigPlayButton","prefAutoScrollTranscript","$autoScrollTranscriptCheckbox","currentHighlight","scrollTop","scrollingTranscript","movingHighlight","statusStopped","statusPaused","statusPlaying","statusBuffering","statusEnd","currentState","statusDebounceStart","debouncingStatus","statusTimeout","statusMessageThreshold","Date","getTime","hidingSpeed","getHiddenWidth","$hiddenElement","handleRestart","handlePrevTrack","handleNextTrack","handleRewind","targetTime","handleFastForward","handleRateIncrease","changeRate","handleRateDecrease","dir","rates","currentRate","newRate","vimeoPlaybackRate","handleCaptionToggle","loadModule","outerHeight","timeout","handleChapters","handleDescriptionToggle","handlePrefsClick","prefsButtonPosition","prefsMenuRight","prefsMenuLeft","handleHelpClick","helpDialog","handleTranscriptToggle","prefTranscript","closingTranscript","focusNotClick","handleSignToggle","showSign","prefSign","closingSign","hideSign","isFullscreen","fullscreenElement","webkitFullscreenElement","webkitCurrentFullscreenElement","mozFullscreenElement","msFullscreenElement","modalFullscreenActive","el","requestFullscreen","webkitRequestFullscreen","mozRequestFullscreen","msRequestFullscreen","webkitExitFullscreen","webkitCancelFullscreen","mozCancelFullscreen","msExitFullscreen","fullscreenDialog","$dialogDiv","$fsDialogAlert","handleFullscreenToggle","wasPaused","$modalFullscreenPlaceholder","insertAfter","$ableColumnLeft","stillPaused","handleTranscriptLockToggle","$tooltip","stop","msg","location","$parentWindow","alertLeft","alertTop","$transcriptAlert","$signAlert","$transcriptToolbar","fadeOut","showedAlert","showedTranscriptAlert","showedSignAlert","captionSize","newWidth","newHeight","round","positionCaptions","retrieveOffscreenWindow","windowTop","windowLeft","windowRight","windowBottom","windowHeight","getHighestZIndex","z","transcriptZ","signZ","newHighZ","newLowZ","source","transcriptLang","selectedMeta","transcriptCaptions","transcriptChapters","transcriptDescriptions","updateChaptersList","sampleText","updateCaptionsMenu","thisCaption","captionText","cue","flattenComponent","serif","sans","cursive","fantasy","monospace","white","yellow","green","cyan","blue","magenta","red","black","captionsStylePopOn","captionsStyleRollUp","outputFormat","property","opacity","headingId","$chaptersHeading","$chaptersDiv","$chaptersNav","thisChapter","$chapterItem","$chapterButton","getClickFunction","$clickedItem","$chaptersList","seekTrigger","closest","updateChapter","seekToChapter","chapterId","thisChapterIndex","chapterEnd","convertChapterTimeToVideoTime","chapterTime","updateMeta","showMeta","tempSelectors","m","thisMeta","cueLines","showDuration","focusTarget","currentMeta","flattenCueForMeta","delay","injectTranscriptArea","setupManualTranscript","$autoScrollLabel","$languageSelectWrapper","$languageSelectLabel","$option","autoScroll","initDragDrop","$transcriptSeekpoints","$autoScrollInput","generateTranscript","spanStart","seekingFromTranscript","highlightTranscript","isChapterHeading","$main","lyricsTitle","chapterHeadingNumber","transcriptHeading","$transcriptHeadingTag","nextChapter","nextCap","nextDesc","addChapter","chap","chapterHeading","$chapterHeadingTag","flattenComponentForChapter","comp","$chapSpan","jj","addDescription","$descHiddenSpan","prefHeadingDescription","$descSpan","addCaption","cap","$capSpan","flattenComponentForCaption","flattenString","str","flatStr","openBracket","closeBracket","openParen","closeParen","hasBrackets","hasParens","silentSpanBreak","silentSpanOpen","silentSpanClose","$vSpan","subResults","$tag","firstStart","$components","spanCount","wrapAll","SearchDiv","searchStringHtml","resultsSummary1","resultsArray","searchFor","$resultsSummary","resultsSummaryText","resultsSummary2","resultsSummary3","resultsSummary4","$resultsList","resultId","$resultsItem","itemStartTime","secondsToTime","itemLabel","searchButtonLabel","itemStartSpan","itemText","noResults","noResultsFound","ignoreCaps","caption","searchTerms","captionNormalized","searchTermNormalized","highlightSearchTerm","resultString","forEach","searchTerm","reg","RegExp","totalSeconds","hour","minute","second","onMediaUpdateTime","onMediaPause","onMediaNewSourceLoad","loadIsComplete","durationsAreCloseEnough","d1","d2","classList","item","addSeekbarListeners","pausedBeforeTracking","onClickPlayerButton","whichButton","getButtonNameFromClass","classString","okToHandleKeyPress","$thisElement","target","hasAttribute","addHtml5MediaListeners","code","addVimeoListeners","mutations","mutation","attributeName","characterData","setInterval","$toolbar","windowName","$resizeHandle","$resizeSvg","x1","y1","x2","y2","$resizeLine","resizeZIndex","$signToolbar","startMouseX","startMouseY","dragDevice","startDrag","dragging","endDrag","startResize","resizing","endResize","addWindowMenu","$windowAlert","$buttonIcon","$popup","menuId","$activeWindow","windowButtonLabel","dragKeys","handleWindowButtonClick","addResizeDialog","$windowPopup","$windowButton","widthId","heightId","startingWidth","startingHeight","$resizeForm","$resizeWrapper","$resizeWidthDiv","$resizeWidthInput","$resizeWidthLabel","$resizeHeightDiv","$resizeHeightInput","$resizeHeightLabel","tempWidth","tempHeight","$saveButton","$cancelButton","resizeDialog","resizeObject","windowResizeHeading","transcriptResizeDialog","signResizeDialog","popupTop","choice","windowMoveAlert","resizeFields","startPos","newX","newY","dragStartX","dragStartY","dragKeyX","dragKeyY","startingDrag","dragOffsetX","dragOffsetY","resetDraggedObject","innerHeight","isCloseToCorner","mouseX","mouseY","dragStartWidth","dragStartHeight","signFile","injectSignPlayerCode","signVideoId","signSrc","srcType","$signSource","$signVideo","key","whichName","subTag","nativeName","includes","getSupportedLangs","supportedLangs","docLang","translationFile","similarLangFound","getJSON","thisText","translation","thisLang","computeEndTime","durationTime","startParts","reverse","map","durationParts","reduce","acc","sum","ttml2webvtt","xml","xml2json","ignoreComment","alwaysChildren","compact","spaces","p","_text","isArray","_attributes","begin","dur","doWhen","dfd","opt","extend","interval","attempts","delayed","checkId","startChecking","call","$heading","$instructions","$p1","$p2","$ul","$li1","$li2","$li3","$radioDiv","radioId","$label","$radio","$savedTable","langs","getAllLangs","vtsLang","$vtsAlert","showVtsAlert","injectVtsTable","kindOptions","beforeEditing","editedCell","editedContent","formatTimestamp","parseVtsOutput","getIconCredit","vtsCues","getFilenameFromPath","parseVtsTracks","path","lastSlash","getFilenameFromTracks","rows","thisRow","nextRow","content","blankRow","isValidTimestamp","firstPart","lastPart","$table","headers","$tr","$th","$td","rowNum","getAllRows","addVtsActionButtons","numRows","buttons","$button","$svg","$g","$path","$path2","onClickVtsActionButton","currentTarget","updateVtsActionButtons","$buttons","nextRowNum","$thisButton","newId","newLabel","sort","a","b","idParts","moveRow","insertRow","deleteRow","$rows","newRowNum","$select","newKind","newClass","$parentRow","after","adjustTimes","$thisRow","otherRowNum","$otherRow","before","minDuration","prevRowNum","$row","$prevRow","$nextRow","prevKind","nextKind","prevStart","nextStart","prevEnd","nextEnd","getKindFromClass","minDurartion","myclass","kindStart","kindEnd","message","kinds","vtt","$output","showWebVttOutput","vttString","filename","$p","pText","$textarea","vimeoUrlHasParams","Vimeo","ready","getVideoWidth","getVideoHeight","getVimeoPaused","getVimeoEnded","getVimeoState","promises","gettingPausedPromise","gettingEndedPromise","getTextTracks"],"mappings":"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MACI,qBACM,YAEV,MACI,qBACM,aAEV,MACI,sBACM,cAEV,MACI,qBACM,mBAEV,MACI,sBACM,0BAEV,MACI,qBACM,4BAEV,MACI,qBACM,kBAEV,MACI,qBACM,eAEV,MACI,sBACM,0BAEV,MACI,kBACM,cAEV,MACI,sBACM,eAEV,MACI,mBACM,qBAEV,MACI,oBACM,YAEV,MACI,oBACM,aAEV,MACI,mBACM,yBAEV,MACI,qBACM,cAEV,MACI,uBACM,gBAEV,MACI,sBACM,wBAEV,MACI,iBACM,aAEV,MACI,qBACM,eAEV,MACI,oBACM,oBAEV,MACI,qBACM,0BAEV,MACI,oBACM,iCAEV,MACI,kBACM,8BAEV,MACI,sBACM,aAEV,MACI,sBACM,cAEV,MACI,oBACM,cAEV,MACI,mBACM,eAEV,MACI,qBACM,aAEV,MACI,sBACM,cAEV,MACI,qBACM,qBAEV,MACI,mBACM,oBAEV,MACI,oBACM,YAEV,MACI,oBACM,iBAEV,MACI,mBACM,oBAEV,MACI,uBACM,gBAEV,MACI,uBACM,aAEV,MACI,yBACM,kBAEV,MACI,wBACM,uBAEV,MACI,yBACM,gEAEV,MACI,mBACM,cAEV,MACI,kBACM,iBAEV,MACI,qBACM,yBAEV,MACI,iBACM,UAEV,MACI,uBACM,eAEV,MACI,qBACM,eAEV,MACI,uBACM,aAEV,MACI,sBACM,uBAEV,MACI,sBACM,gBAEV,MACI,yBACM,qCAEV,MACI,qBACM,YAEV,MACI,oBACM,aAEV,MACI,sBACM,uBAEV,MACI,oBACM,iBAEV,MACI,mBACM,gBAEV,MACI,oBACM,aAEV,MACI,yBACM,mBAEV,MACI,oBACM,kBAEV,MACI,kBACM,eAEV,MACI,mBACM,cAEV,MACI,oBACM,2BAEV,MACI,qBACM,oBAEV,MACI,sBACM,eAEV,MACI,mBACM,4BAEV,MACI,2BACM,qBAEV,MACI,qBACM,cAEV,MACI,wBACM,eAEV,MACI,qBACM,cAEV,MACI,iBACM,cAEV,MACI,wBACM,qBAEV,MACI,0BACM,OAEV,MACI,qBACM,sBAEV,MACI,kBACM,oBAEV,MACI,wBACM,uBAEV,MACI,sBACM,sBAEV,MACI,mBACM,iCAEV,MACI,uBACM,aAEV,MACI,qBACM,YAEV,MACI,mBACM,mBAEV,MACI,qBACM,YAEV,MACI,yBACM,mBAEV,MACI,uBACM,aAEV,MACI,mBACM,sBAEV,MACI,oBACM,8BAEV,MACI,8BACM,mBAEV,MACI,2BACM,iBAEV,MACI,oBACM,aAEV,MACI,oBACM,aAEV,MACI,+BACM,oBAEV,MACI,uBACM,YAEV,MACI,mBACM,oBAEV,MACI,2BACM,iBAEV,MACI,qBACM,cAEV,MACI,oBACM,eAEV,MACI,6BACM,uBAEV,MACI,mBACM,mBAEV,MACI,mBACM,YAEV,MACI,sBACM,iBAEV,MACI,qBACM,sBAEV,MACI,kBACM,WAEV,MACI,qBACM,YAEV,MACI,oBACM,aAEV,MACI,oBACM,WAEV,MACI,wBACM,gBAEV,MACI,qBACM,wBAEV,MACI,qBACM,yBAEV,MACI,qBACM,cAEV,MACI,sBACM,aAEV,MACI,qBACM,mBAEV,MACI,sBACM,gBAEV,MACI,uBACM,YAEV,MACI,oBACM,2BAEV,MACI,2BACM,sBAEV,MACI,oBACM,uBAEV,MACI,mBACM,qBAEV,MACI,qBACM,mBAEV,MACI,oBACM,eAEV,MACI,mBACM,eAEV,MACI,uBACM,YAEV,MACI,oBACM,iBAEV,MACI,qBACM,kBAEV,MACI,oBACM,8BAEV,MACI,4BACM,cAEV,MACI,qBACM,0BAEV,MACI,uBACM,iBAEV,MACI,qBACM,gBAEV,MACI,mBACM,cAEV,MACI,qBACM,cAEV,MACI,mBACM,YAEV,MACI,oBACM,aAEV,MACI,mBACM,8BAEV,MACI,kBACM,UAEV,MACI,sBACM,WAEV,MACI,qBACM,cAEV,MACI,qBACM,uBAEV,MACI,qBACM,mCAEV,MACI,oBACM,eAEV,MACI,mBACM,iBAEV,MACI,qBACM,aAEV,MACI,oBACM,eAEV,MACI,mBACM,iCAEV,MACI,iBACM,UAEV,MACI,sBACM,iBAEV,MACI,oBACM,yBAEV,MACI,uBACM,iBAEV,MACI,kBACM,WAEV,MACI,mBACM,2BAEV,MACI,mBACM,gBAEV,MACI,wBACM,iBAEV,MACI,qBACM,cAEV,MACI,qBACM,YAEV,MACI,mBACM,cAEV,MACI,mBACM,aAEV,MACI,6BACM,YAEV,MACI,mBACM,eAEV,MACI,qBACM,aAEV,MACI,oBACM,aAEV,MACI,oBACM,iCAEP,MACC,8BACM,6BAEP,MACC,8BACM,6BAEP,MACC,4BACM,yBAEP,MACC,2BACM,4BAEP,MACC,6BACM,4BAEP,MACC,6BACM,4BAEP,MACC,8BACM,2BAEP,MACC,4BACM,2BAEP,MACC,8BACM,sCAEP,MACC,2BACM,0BAEP,MACC,4BACM,yBAEP,MACC,mCACM,8CAEP,MACC,4BACM,2BAEP,MACC,8BACM,0BAEP,MACC,6BACM,8CAEP,MACC,4BACM,2BAEP,MACC,8BACM,gCAEP,MACC,oCACM,mCAEP,MACC,iCACM,+BAEP,MACC,kCACM,6BAEP,MACC,iCACM,+BAEP,MACC,8BACM,4BAEP,MACC,8BACM,4BAEP,MACC,+BACM,6BAEP,MACC,+BACM,6BAEP,MACC,mCACM,YAEP,MACC,oCACM,kCAEP,MACC,gCACM,uCAEP,MACC,sCACM,oCAEP,MACC,qCACM,mCAEP,MACC,iCACM,+BAEP,MACC,+BACM,6BAEP,MACC,6BACM,2BAEP,MACC,gCACM,8BAEP,MACC,kCACM,gCAEP,MACC,0CACM,0CAEP,MACC,+BACM,6BAEP,MACC,mCACM,iCAEP,MACC,iCACM,+BAEP,MACC,gCACM,8BAEP,MACC,8BACM,4BAEP,MACC,iCACM,+BAEP,MACC,8BACM,4BAEP,MACC,gCACM,8BAEP,MACC,4BACM,0BAEP,MACC,mCACM,iCAEP,MACC,+BACM,6BAEP,MACC,iCACM,+BAEP,MACC,8BACM,+BAEP,MACC,6BACM,6BAEP,MACC,iCACM,iCAEP,MACC,kCACM,6BAEP,MACC,mCACM,+BAEP,MACC,6BACM,+BAEP,MACC,iCACM,8BAEP,MACC,+BACM,6BAEP,MACC,iCACM,uBAEP,MACC,2BACM,uBAEP,MACC,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"}